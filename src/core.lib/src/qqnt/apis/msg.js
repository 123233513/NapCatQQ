const _0x1f0de3=_0x3dff;function _0x1267(){const _0x1f07f1=['getMsgsIncludeSelf','onAddSendMsg','kBGzS','jsTUp','USioJ','arkElement','2265090IXGHcH','service','XZWvp','msgId','activateChatAndGetHistory','forEach','abFuJ','addLoginSuccessCallback','nPAik','setMsgRead','multiForwardMsg','sendStatus','2748966pGKXEF','parse','YyaFV','kernelService','onMsgInfoListUpdate','getMsgHistory','peerUid','WhexO','elements','12838oJcZuv','SpAEH','napCatCore','发送超时','uid','addMsgListener','recallMsg','forwardMsg','1714380eShvvn','2012424MDhSuI','com.tencent.multimsg','2730852tSNGSD','catch','RLaed','sendMsg','NkLKT','senderUid','find','878TtMkfw','oDWPB','60KFPztf','xWnhv','rnxCv','2248SiQZkT','map','转发消息超时','750RsHqgV','msg','nnPhM','ppWqT','getMultiMsg','chatType','5Wkilht','then','activateChat'];_0x1267=function(){return _0x1f07f1;};return _0x1267();}function _0x3dff(_0x5708bc,_0x4917ae){const _0x126764=_0x1267();return _0x3dff=function(_0x3dfffa,_0x272ab5){_0x3dfffa=_0x3dfffa-0xe7;let _0x495381=_0x126764[_0x3dfffa];return _0x495381;},_0x3dff(_0x5708bc,_0x4917ae);}(function(_0xaec8c3,_0x3398bc){const _0x1be2b7=_0x3dff,_0xeb671d=_0xaec8c3();while(!![]){try{const _0x4a167a=parseInt(_0x1be2b7(0x120))/0x1*(parseInt(_0x1be2b7(0xea))/0x2)+-parseInt(_0x1be2b7(0x116))/0x3+-parseInt(_0x1be2b7(0x117))/0x4+-parseInt(_0x1be2b7(0xf0))/0x5*(-parseInt(_0x1be2b7(0xf9))/0x6)+parseInt(_0x1be2b7(0x10e))/0x7*(-parseInt(_0x1be2b7(0xe7))/0x8)+-parseInt(_0x1be2b7(0x119))/0x9+parseInt(_0x1be2b7(0x122))/0xa*(parseInt(_0x1be2b7(0x105))/0xb);if(_0x4a167a===_0x3398bc)break;else _0xeb671d['push'](_0xeb671d['shift']());}catch(_0x4d2d27){_0xeb671d['push'](_0xeb671d['shift']());}}}(_0x1267,0x4c615));import{selfInfo}from'@/common/data';import{log}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/qqnt/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},msgListener=new MsgListener();msgListener[_0x1f0de3(0xf4)]=_0x3a3e3d=>{const _0x6b95a0=_0x1f0de3;if(sendMessagePool[_0x3a3e3d[_0x6b95a0(0x10b)]]){const _0x3f7f50=sendMessagePool[_0x3a3e3d['peerUid']]?.(_0x3a3e3d);_0x3f7f50 instanceof Promise&&_0x3f7f50[_0x6b95a0(0xf1)]()[_0x6b95a0(0xf1)](log);}},msgListener[_0x1f0de3(0x109)]=_0x5c7f15=>{const _0x17f5ae=_0x1f0de3,_0x597a6e={'NkLKT':function(_0xcf162e,_0x5df566){return _0xcf162e instanceof _0x5df566;}};_0x5c7f15[_0x17f5ae(0xfe)](_0x4bb6d9=>{const _0x5271b0=_0x17f5ae,_0x3aad53={'jsTUp':function(_0x175fe2,_0x49cfdb){return _0x175fe2(_0x49cfdb);},'rEoJT':function(_0x59f23a,_0x2f7435){const _0x456517=_0x3dff;return _0x597a6e[_0x456517(0x11d)](_0x59f23a,_0x2f7435);},'ppWqT':function(_0x1defd7,_0x1cb9b9){return _0x1defd7(_0x1cb9b9);}};new Promise((_0x3937eb,_0x2c2533)=>{const _0x141742=_0x3dff;for(const _0x44bb83 in sendSuccessCBMap){const _0x2e93d3=sendSuccessCBMap[_0x44bb83],_0x224798=_0x3aad53[_0x141742(0xf6)](_0x2e93d3,_0x4bb6d9),_0xaeb2b3=_0x218d30=>{_0x218d30&&delete sendSuccessCBMap[_0x44bb83];};_0x3aad53['rEoJT'](_0x224798,Promise)?_0x224798[_0x141742(0xf1)](_0xaeb2b3):_0x3aad53[_0x141742(0xed)](_0xaeb2b3,_0x224798);}})['then']()[_0x5271b0(0x11a)](log);});},setTimeout(()=>{const _0x278081=_0x1f0de3;napCatCore[_0x278081(0x100)](()=>{const _0x32d474=_0x278081;napCatCore[_0x32d474(0xfa)][_0x32d474(0xeb)][_0x32d474(0x113)](msgListener);});},0x64);export class NTQQMsgApi{static [_0x1f0de3(0x110)]=null;static async[_0x1f0de3(0xee)](_0x42ee7a,_0x2cfe18,_0x29d472){const _0x5595c1=_0x1f0de3;return napCatCore[_0x5595c1(0xfa)][_0x5595c1(0xeb)][_0x5595c1(0x108)]?.[_0x5595c1(0xee)](_0x42ee7a,_0x2cfe18,_0x29d472);}static async[_0x1f0de3(0xf2)](_0x3d83b2){}static async[_0x1f0de3(0xfd)](_0x3109b7){}static async[_0x1f0de3(0x102)](_0x2a5df3){const _0xc55dda=_0x1f0de3;return napCatCore[_0xc55dda(0xfa)]['msg'][_0xc55dda(0x108)]['setMsgRead'](_0x2a5df3[_0xc55dda(0xef)],_0x2a5df3[_0xc55dda(0x10b)],_0x2a5df3['guildId']);}static async[_0x1f0de3(0x10a)](_0x2ea663,_0x5629ca,_0x39c4b2){const _0xf69eb8=_0x1f0de3;return napCatCore[_0xf69eb8(0xfa)]['msg']['kernelService'][_0xf69eb8(0xf3)](_0x2ea663,_0x5629ca,_0x39c4b2,!![]);}static async['fetchRecentContact'](){}static async['recallMsg'](_0x2af9dd,_0x52cf31){const _0x206719=_0x1f0de3;await napCatCore[_0x206719(0xfa)]['msg'][_0x206719(0x108)]?.[_0x206719(0x114)]({'chatType':_0x2af9dd[_0x206719(0xef)],'peerUid':_0x2af9dd['peerUid']},_0x52cf31);}static async['sendMsg'](_0x154588,_0x47ab0b,_0x587ef4=!![],_0x131fa9=0x2710){const _0x2d72db=_0x1f0de3,_0xee1ea8={'rnxCv':function(_0x46e441,_0x1fd8bc){return _0x46e441>_0x1fd8bc;},'abFuJ':_0x2d72db(0x111),'USioJ':function(_0x2faced,_0x1f2e70){return _0x2faced(_0x1f2e70);},'XZWvp':function(_0x20e061){return _0x20e061();},'oDWPB':function(_0x5c9196,_0xac6bbc){return _0x5c9196===_0xac6bbc;},'EZBEP':function(_0x3dbe20,_0x248592,_0x4e0ebb){return _0x3dbe20(_0x248592,_0x4e0ebb);}},_0x5b039a=_0x154588[_0x2d72db(0x10b)];let _0x17c7b6=0x0;const _0x1beb96=async()=>{const _0x27cf8f=_0x2d72db;if(_0xee1ea8[_0x27cf8f(0x124)](_0x17c7b6,_0x131fa9))throw _0xee1ea8['abFuJ'];const _0x382f0a=sendMessagePool[_0x154588[_0x27cf8f(0x10b)]];if(_0x382f0a)return await _0xee1ea8[_0x27cf8f(0xf7)](sleep,0x1f4),_0x17c7b6+=0x1f4,await _0xee1ea8[_0x27cf8f(0xfb)](_0x1beb96);else return;};return await _0xee1ea8[_0x2d72db(0xfb)](_0x1beb96),new Promise((_0x15d7af,_0x158344)=>{const _0x2a5ce7=_0x2d72db;let _0x5746e3=![],_0x1f6c76=null;const _0x402f32=randomUUID();sendSuccessCBMap[_0x402f32]=_0x572cc7=>{const _0x2c3ae4=_0x3dff;if(_0x572cc7['msgId']===_0x1f6c76?.[_0x2c3ae4(0xfc)]){if(_0xee1ea8[_0x2c3ae4(0x121)](_0x572cc7[_0x2c3ae4(0x104)],0x2))return delete sendSuccessCBMap[_0x402f32],_0x5746e3=!![],_0x15d7af(_0x572cc7),!![];return![];}return![];},sendMessagePool[_0x5b039a]=async _0x15b0dd=>{delete sendMessagePool[_0x5b039a],_0x1f6c76=_0x15b0dd;},_0xee1ea8['EZBEP'](setTimeout,()=>{const _0x3e05c2=_0x3dff;if(_0x5746e3)return;delete sendMessagePool[_0x5b039a],delete sendSuccessCBMap[_0x402f32],_0x158344(_0xee1ea8[_0x3e05c2(0xff)]);},_0x131fa9);const _0x1a8368=napCatCore[_0x2a5ce7(0xfa)][_0x2a5ce7(0xeb)]['kernelService']?.[_0x2a5ce7(0x11c)]('0',_0x154588,_0x47ab0b,new Map());});}static async[_0x1f0de3(0x115)](_0x2cd7e5,_0xa61c9e,_0xabc9e6){}static async[_0x1f0de3(0x103)](_0x41b75e,_0x4c51c3,_0x32a8c5){const _0x23cb2=_0x1f0de3,_0x23f9ea={'nPAik':function(_0x1c4210,_0x4ad2bd){return _0x1c4210!=_0x4ad2bd;},'WhexO':_0x23cb2(0x118),'RLaed':function(_0x1b8b97,_0x38116d){return _0x1b8b97==_0x38116d;},'SpAEH':function(_0x489dc4,_0x5c0b68){return _0x489dc4(_0x5c0b68);},'nnPhM':_0x23cb2(0xe9)},_0x229d66=_0x32a8c5[_0x23cb2(0xe8)](_0x51b930=>{return{'msgId':_0x51b930,'senderShowName':selfInfo['nick']};});return new Promise((_0x1a91a3,_0x483019)=>{const _0x2d9e6b=_0x23cb2,_0x1cd034={'vNiXb':function(_0x4e65f8,_0x272234){const _0x22bab5=_0x3dff;return _0x23f9ea[_0x22bab5(0x101)](_0x4e65f8,_0x272234);},'AQuWE':_0x23f9ea[_0x2d9e6b(0x10c)],'YyaFV':function(_0x138acb,_0x5b4f55){return _0x138acb==_0x5b4f55;},'kBGzS':function(_0x1796e7,_0x5ab92e){const _0x153d78=_0x2d9e6b;return _0x23f9ea[_0x153d78(0x11b)](_0x1796e7,_0x5ab92e);},'fwayd':function(_0x12a7b3,_0x1f721d){const _0x52ef51=_0x2d9e6b;return _0x23f9ea[_0x52ef51(0x10f)](_0x12a7b3,_0x1f721d);},'xWnhv':_0x23f9ea[_0x2d9e6b(0xec)]};let _0x5a830f=![];const _0x37fb09=new MsgListener(),_0x5de57d=_0x32296c=>{const _0x5118dd=_0x2d9e6b,_0x11e0d8=_0x32296c[_0x5118dd(0x10d)][_0x5118dd(0x11f)](_0x26f18b=>_0x26f18b[_0x5118dd(0xf8)]);if(!_0x11e0d8)return;const _0x4ed6b2=JSON[_0x5118dd(0x106)](_0x11e0d8[_0x5118dd(0xf8)]['bytesData']);if(_0x1cd034['vNiXb'](_0x4ed6b2['app'],_0x1cd034['AQuWE']))return;_0x1cd034[_0x5118dd(0x107)](_0x32296c[_0x5118dd(0x10b)],_0x4c51c3['peerUid'])&&_0x1cd034[_0x5118dd(0xf5)](_0x32296c[_0x5118dd(0x11e)],selfInfo[_0x5118dd(0x112)])&&(_0x5a830f=!![],napCatCore[_0x5118dd(0xfa)]['msg'][_0x5118dd(0x108)]?.['removeKernelMsgListener'](_0x260f09),_0x1cd034['fwayd'](_0x1a91a3,_0x32296c));};_0x37fb09[_0x2d9e6b(0xf4)]=_0x5de57d;const _0x260f09=napCatCore['service'][_0x2d9e6b(0xeb)][_0x2d9e6b(0x113)](_0x37fb09);setTimeout(()=>{const _0x3b20b3=_0x2d9e6b;!_0x5a830f&&(napCatCore['service'][_0x3b20b3(0xeb)][_0x3b20b3(0x108)]?.['removeKernelMsgListener'](_0x260f09),_0x1cd034['fwayd'](_0x483019,_0x1cd034[_0x3b20b3(0x123)]));},0x1388),napCatCore[_0x2d9e6b(0xfa)]['msg']['kernelService']?.['multiForwardMsgWithComment'](_0x229d66,_0x41b75e,_0x4c51c3,[],new Map());});}}