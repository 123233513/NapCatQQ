const _0x1a6de2=_0x562e;function _0x562e(_0x19ad66,_0x5cb23b){const _0x535241=_0x5352();return _0x562e=function(_0x562e9b,_0x48f33c){_0x562e9b=_0x562e9b-0x151;let _0x38839c=_0x535241[_0x562e9b];return _0x38839c;},_0x562e(_0x19ad66,_0x5cb23b);}function _0x5352(){const _0x1cc3a7=['setMsgRead','recallMsg','6798390ikQrgc','bytesData','发送超时','onMsgInfoListUpdate','getMsgService','KbwzA','com.tencent.multimsg','1ZiEDRG','FimPj','1305964XCnSQR','110NxJhgs','1342494hAtmep','arkElement','jjppD','sendStatus','ddbaY','sendMsg','oVhdd','length','kqoGd','jMjEk','231uKmOoa','QbCsy','activateChat','catch','find','klmaz','mbdDV','jRRHz','388754JDMdcN','toString','addListener','peerUid','fetchRecentContact','getMultiMsg','getMsgsIncludeSelf','msgId','senderUid','5440ykDvPG','delete','xHVph','uid','onLoginSuccess','34752cHzAiB','forwardMsg','getMsgsBySeqAndCount','activateChatAndGetHistory','then','session','multiForwardMsgWithComment','setEmojiLike','chatType','qUqoc','WsfTv','app','setMsgEmojiLikes','CMUmL','504444fSTTuq','xHdRv','multiForwardMsg'];_0x5352=function(){return _0x1cc3a7;};return _0x5352();}(function(_0x37c944,_0x4e7f9c){const _0x281104=_0x562e,_0x3d1eb7=_0x37c944();while(!![]){try{const _0x4474a3=parseInt(_0x281104(0x166))/0x1*(-parseInt(_0x281104(0x17c))/0x2)+-parseInt(_0x281104(0x15a))/0x3+-parseInt(_0x281104(0x168))/0x4+parseInt(_0x281104(0x169))/0x5*(parseInt(_0x281104(0x18a))/0x6)+-parseInt(_0x281104(0x174))/0x7*(-parseInt(_0x281104(0x185))/0x8)+parseInt(_0x281104(0x16a))/0x9+parseInt(_0x281104(0x15f))/0xa;if(_0x4474a3===_0x4e7f9c)break;else _0x3d1eb7['push'](_0x3d1eb7['shift']());}catch(_0x757645){_0x3d1eb7['push'](_0x3d1eb7['shift']());}}}(_0x5352,0x46c3d));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onAddSendMsg']=_0x4ae197=>{const _0x4acc16=_0x562e,_0x13899b={'UKnlI':function(_0xa62da,_0x400b2f){return _0xa62da(_0x400b2f);},'kqoGd':function(_0x163899,_0x584b55){return _0x163899 instanceof _0x584b55;}};for(const [_0x174c25,_0x535d85]of sentMsgTasks){_0x13899b['UKnlI'](_0x535d85,_0x4ae197),sentMsgTasks[_0x4acc16(0x186)](_0x174c25);}if(sendMessagePool[_0x4ae197['peerUid']]){const _0x5b0ab5=sendMessagePool[_0x4ae197[_0x4acc16(0x17f)]]?.(_0x4ae197);_0x13899b[_0x4acc16(0x172)](_0x5b0ab5,Promise)&&_0x5b0ab5[_0x4acc16(0x18e)]()[_0x4acc16(0x177)](logError);}},msgListener[_0x1a6de2(0x162)]=_0x33d083=>{_0x33d083['forEach'](_0x44129a=>{const _0x4d1d6a=_0x562e;new Promise((_0x47ff3c,_0x3e89de)=>{const _0x365870=_0x562e;for(const _0x175e7d in sendSuccessCBMap){const _0x4e8d2e=sendSuccessCBMap[_0x175e7d],_0x2cf53b=_0x4e8d2e(_0x44129a),_0x1571b7=_0x8dca29=>{_0x8dca29&&delete sendSuccessCBMap[_0x175e7d];};_0x2cf53b instanceof Promise?_0x2cf53b[_0x365870(0x18e)](_0x1571b7):_0x1571b7(_0x2cf53b);}})[_0x4d1d6a(0x18e)]()[_0x4d1d6a(0x177)](log);});},setTimeout(()=>{const _0x4aef41=_0x1a6de2;napCatCore[_0x4aef41(0x189)](()=>{const _0x439ec2=_0x4aef41;napCatCore[_0x439ec2(0x17e)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x1a6de2(0x153)](_0x571393,_0x531afb,_0x123d6a,_0x445b48=!![]){const _0x5f1398=_0x1a6de2,_0x3294fb={'TWIrn':function(_0x36ba5d,_0x528b15){return _0x36ba5d>_0x528b15;}};return _0x123d6a=_0x123d6a[_0x5f1398(0x17d)](),napCatCore['session'][_0x5f1398(0x163)]()[_0x5f1398(0x158)](_0x571393,_0x531afb,_0x123d6a,_0x3294fb['TWIrn'](_0x123d6a[_0x5f1398(0x171)],0x3)?'2':'1',_0x445b48);}static async[_0x1a6de2(0x181)](_0x218fd4,_0x5944ab,_0x3b5de1){const _0x370f2a=_0x1a6de2;return napCatCore[_0x370f2a(0x151)][_0x370f2a(0x163)]()[_0x370f2a(0x181)](_0x218fd4,_0x5944ab,_0x3b5de1);}static async['getMsgsByMsgId'](_0x2f0494,_0x52f65d){const _0x4688d2=_0x1a6de2;return await napCatCore[_0x4688d2(0x151)][_0x4688d2(0x163)]()['getMsgsByMsgId'](_0x2f0494,_0x52f65d);}static async[_0x1a6de2(0x18c)](_0x36bb84,_0x42ec58,_0x2ecbfc,_0x2d2e7f,_0x254c90){const _0x3142b0=_0x1a6de2;return await napCatCore[_0x3142b0(0x151)][_0x3142b0(0x163)]()[_0x3142b0(0x18c)](_0x36bb84,_0x42ec58,_0x2ecbfc,_0x2d2e7f,_0x254c90);}static async[_0x1a6de2(0x176)](_0x341691){}static async[_0x1a6de2(0x18d)](_0x2e554d){}static async[_0x1a6de2(0x15d)](_0x293d87){const _0x39237b=_0x1a6de2;return napCatCore[_0x39237b(0x151)][_0x39237b(0x163)]()['setMsgRead'](_0x293d87);}static async['getMsgHistory'](_0x1ce980,_0x48693f,_0x1b4ce9){const _0x582b21=_0x1a6de2;return napCatCore['session'][_0x582b21(0x163)]()[_0x582b21(0x182)](_0x1ce980,_0x48693f,_0x1b4ce9,!![]);}static async[_0x1a6de2(0x180)](){}static async[_0x1a6de2(0x15e)](_0x1dc2ed,_0x2f3c59){const _0x2915d7=_0x1a6de2;await napCatCore[_0x2915d7(0x151)][_0x2915d7(0x163)]()['recallMsg']({'chatType':_0x1dc2ed[_0x2915d7(0x154)],'peerUid':_0x1dc2ed[_0x2915d7(0x17f)]},_0x2f3c59);}static async[_0x1a6de2(0x16f)](_0x34d055,_0x56f862,_0x11bc9f=!![],_0x40f05e=0x2710){const _0x2578e9=_0x1a6de2,_0x6cf6a2={'QbCsy':function(_0x3c1ad6,_0x4f1e7a){return _0x3c1ad6>_0x4f1e7a;},'klmaz':_0x2578e9(0x161),'WsfTv':function(_0x15a277,_0x5bbfd1){return _0x15a277===_0x5bbfd1;},'ddbaY':function(_0x38ef03,_0x51090d){return _0x38ef03(_0x51090d);},'qQSfP':function(_0x39c1fb){return _0x39c1fb();}},_0xe79ae0=_0x34d055['peerUid'];let _0x563c7b=0x0;const _0xedf08b=async()=>{const _0x43c37a=_0x2578e9;if(_0x6cf6a2[_0x43c37a(0x175)](_0x563c7b,_0x40f05e))throw _0x6cf6a2[_0x43c37a(0x179)];const _0xf8900e=sendMessagePool[_0x34d055[_0x43c37a(0x17f)]];if(_0xf8900e)return await sleep(0x1f4),_0x563c7b+=0x1f4,await _0xedf08b();else return;};return await _0x6cf6a2['qQSfP'](_0xedf08b),new Promise((_0x21477c,_0x4bb0f5)=>{const _0x47b236=_0x2578e9,_0x14e8bb={'mbdDV':function(_0x199055,_0x36816e){const _0x11354c=_0x562e;return _0x6cf6a2[_0x11354c(0x156)](_0x199055,_0x36816e);},'xHdRv':function(_0x52dc19,_0x3ea039){const _0x2baa1e=_0x562e;return _0x6cf6a2[_0x2baa1e(0x156)](_0x52dc19,_0x3ea039);},'KbwzA':function(_0x4308b1,_0x35884d){const _0x264466=_0x562e;return _0x6cf6a2[_0x264466(0x16e)](_0x4308b1,_0x35884d);},'CiIHA':_0x6cf6a2[_0x47b236(0x179)]};let _0x3687bb=![],_0x501e7f=null;const _0x69c8ef=randomUUID();sendSuccessCBMap[_0x69c8ef]=_0x1e9b3f=>{const _0x26bee6=_0x47b236;if(_0x14e8bb[_0x26bee6(0x17a)](_0x1e9b3f['msgId'],_0x501e7f?.[_0x26bee6(0x183)])){if(_0x14e8bb[_0x26bee6(0x15b)](_0x1e9b3f[_0x26bee6(0x16d)],0x2))return delete sendSuccessCBMap[_0x69c8ef],_0x3687bb=!![],_0x14e8bb[_0x26bee6(0x164)](_0x21477c,_0x1e9b3f),!![];return![];}return![];},sendMessagePool[_0xe79ae0]=async _0x9f0ddd=>{delete sendMessagePool[_0xe79ae0],_0x501e7f=_0x9f0ddd;},setTimeout(()=>{const _0x237a72=_0x47b236;if(_0x3687bb)return;delete sendMessagePool[_0xe79ae0],delete sendSuccessCBMap[_0x69c8ef],_0x14e8bb[_0x237a72(0x164)](_0x4bb0f5,_0x14e8bb['CiIHA']);},_0x40f05e);const _0x2d03a3=napCatCore[_0x47b236(0x151)][_0x47b236(0x163)]()['sendMsg']('0',_0x34d055,_0x56f862,new Map());});}static async['forwardMsg'](_0x1b9d5a,_0xcf0448,_0x17f931){const _0x566aae=_0x1a6de2;return napCatCore['session'][_0x566aae(0x163)]()[_0x566aae(0x18b)](_0x17f931,_0x1b9d5a,[_0xcf0448],new Map());}static async[_0x1a6de2(0x15c)](_0x1941f5,_0x4ab2b8,_0x2948cb){const _0x1c5ef9={'jRRHz':function(_0x34a16c,_0x442696){return _0x34a16c!=_0x442696;},'FimPj':function(_0x2593be,_0x3902d6){return _0x2593be==_0x3902d6;},'qUqoc':function(_0x1b3bfa,_0x13136a){return _0x1b3bfa(_0x13136a);},'jjppD':'转发消息超时','jMjEk':function(_0x2b9c34){return _0x2b9c34();},'rDtIZ':function(_0x3a9e36,_0x397b9d,_0x1c58a2){return _0x3a9e36(_0x397b9d,_0x1c58a2);}},_0x17fc3c=_0x2948cb['map'](_0x5e8147=>{return{'msgId':_0x5e8147,'senderShowName':selfInfo['nick']};});return new Promise((_0x335542,_0x1a5c46)=>{const _0x295fb9=_0x562e,_0xafd5e7={'gPNOR':function(_0x4c7dd2,_0x31cd41){const _0x38e986=_0x562e;return _0x1c5ef9[_0x38e986(0x17b)](_0x4c7dd2,_0x31cd41);},'xHVph':_0x295fb9(0x165),'VCTOq':function(_0x2ee5e6,_0x5a5d53){const _0x5e6c61=_0x295fb9;return _0x1c5ef9[_0x5e6c61(0x167)](_0x2ee5e6,_0x5a5d53);},'CMUmL':function(_0x3dcaf9,_0x4778f9){const _0xa8ad45=_0x295fb9;return _0x1c5ef9[_0xa8ad45(0x155)](_0x3dcaf9,_0x4778f9);},'oVhdd':_0x1c5ef9[_0x295fb9(0x16c)]};let _0x409e6c=![];const _0x1f2ecc=_0x23a99d=>{const _0x48e2e7=_0x295fb9,_0x4ba54e=_0x23a99d['elements'][_0x48e2e7(0x178)](_0x4dba3b=>_0x4dba3b[_0x48e2e7(0x16b)]);if(!_0x4ba54e)return;const _0x3b0bb3=JSON['parse'](_0x4ba54e[_0x48e2e7(0x16b)][_0x48e2e7(0x160)]);if(_0xafd5e7['gPNOR'](_0x3b0bb3[_0x48e2e7(0x157)],_0xafd5e7[_0x48e2e7(0x187)]))return;_0xafd5e7['VCTOq'](_0x23a99d['peerUid'],_0x4ab2b8[_0x48e2e7(0x17f)])&&_0x23a99d[_0x48e2e7(0x184)]==selfInfo[_0x48e2e7(0x188)]&&(_0x409e6c=!![],_0xafd5e7[_0x48e2e7(0x159)](_0x335542,_0x23a99d));};sentMsgTasks['set'](_0x1c5ef9[_0x295fb9(0x173)](randomUUID),_0x1f2ecc),_0x1c5ef9['rDtIZ'](setTimeout,()=>{const _0x51f5b5=_0x295fb9;!_0x409e6c&&_0xafd5e7[_0x51f5b5(0x159)](_0x1a5c46,_0xafd5e7[_0x51f5b5(0x170)]);},0x1388),napCatCore[_0x295fb9(0x151)][_0x295fb9(0x163)]()[_0x295fb9(0x152)](_0x17fc3c,_0x1941f5,_0x4ab2b8,[],new Map());});}}