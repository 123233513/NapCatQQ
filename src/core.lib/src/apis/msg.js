const _0x457f07=_0xba3f;(function(_0x29a9bc,_0x4845d6){const _0x171552=_0xba3f,_0x1733b6=_0x29a9bc();while(!![]){try{const _0x18b602=-parseInt(_0x171552(0xee))/0x1*(parseInt(_0x171552(0xda))/0x2)+parseInt(_0x171552(0x103))/0x3*(-parseInt(_0x171552(0xef))/0x4)+parseInt(_0x171552(0xbb))/0x5*(-parseInt(_0x171552(0xdf))/0x6)+-parseInt(_0x171552(0xe8))/0x7*(-parseInt(_0x171552(0xea))/0x8)+parseInt(_0x171552(0xd6))/0x9*(parseInt(_0x171552(0xf5))/0xa)+parseInt(_0x171552(0xbc))/0xb+-parseInt(_0x171552(0xc7))/0xc*(-parseInt(_0x171552(0xe3))/0xd);if(_0x18b602===_0x4845d6)break;else _0x1733b6['push'](_0x1733b6['shift']());}catch(_0xae5a42){_0x1733b6['push'](_0x1733b6['shift']());}}}(_0x3e3c,0xa7261));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';function _0xba3f(_0x523c08,_0x1362b6){const _0x3e3c32=_0x3e3c();return _0xba3f=function(_0xba3f0d,_0x1d729d){_0xba3f0d=_0xba3f0d-0xb9;let _0x5da817=_0x3e3c32[_0xba3f0d];return _0x5da817;},_0xba3f(_0x523c08,_0x1362b6);}function _0x3e3c(){const _0x2eb7aa=['XDdMh','发送超时','multiForwardMsgWithComment','NQCmf','getRichMediaService','yDpiU','onLoginSuccess','90IcuHzJ','forEach','recallMsg','item','106JIHxrQ','delete','QschU','获取群文件列表超时','sendMsg','5302842urZLip','addListener','qzAWp','toString','18341843ZPyBcc','bytesData','rpRws','getMsgsIncludeSelf','multiForwardMsg','14DLHBDC','getGroupFileList','2930912rEhybI','getMsgService','set','arkElement','23887jlnFEt','12eQHqpo','SapMw','XDLfd','catch','getMsgsBySeqAndCount','sendStatus','502070kIqBBv','onAddSendMsg','activateChatAndGetHistory','forwardMsg','GzAjA','SeHGb','SrWaO','chatType','getMsgsByMsgId','EyYQv','session','elements','map','uid','41214rlsPvF','activateChat','OZXBe','nick','5GtftYD','2529604wjwOKP','find','app','setMsgEmojiLikes','vZfiG','setEmojiLike','dpQrd','getMultiMsg','fetchRecentContact','com.tencent.multimsg','setMsgRead','12wzJJef','USSMT','peerUid','getMsgHistory','then','MeyND','msgId','MaFGL'];_0x3e3c=function(){return _0x2eb7aa;};return _0x3e3c();}import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onGroupFileInfoUpdate']=_0x4321ae=>{const _0x290cd8=_0xba3f,_0x57bce1={'MeyND':function(_0x4abb6a,_0x139ed6){return _0x4abb6a(_0x139ed6);}};for(const [_0x3ee026,_0x3e5c81]of GroupFileInfoUpdateTasks){_0x57bce1[_0x290cd8(0xcc)](_0x3e5c81,_0x4321ae),GroupFileInfoUpdateTasks[_0x290cd8(0xdb)](_0x3ee026);}},msgListener[_0x457f07(0xf6)]=_0x4d0bda=>{const _0x42a4b8=_0x457f07,_0xe176b1={'znWJt':function(_0x3a9590,_0x4ecffd){return _0x3a9590 instanceof _0x4ecffd;}};for(const [_0x4cb3f0,_0x3fef41]of sentMsgTasks){_0x3fef41(_0x4d0bda),sentMsgTasks[_0x42a4b8(0xdb)](_0x4cb3f0);}if(sendMessagePool[_0x4d0bda[_0x42a4b8(0xc9)]]){const _0x195974=sendMessagePool[_0x4d0bda[_0x42a4b8(0xc9)]]?.(_0x4d0bda);_0xe176b1['znWJt'](_0x195974,Promise)&&_0x195974[_0x42a4b8(0xcb)]()[_0x42a4b8(0xf2)](logError);}},msgListener['onMsgInfoListUpdate']=_0x56e2b0=>{const _0x1c0c8d=_0x457f07;_0x56e2b0[_0x1c0c8d(0xd7)](_0x3ea57a=>{const _0x48c1d0=_0x1c0c8d,_0x5b819b={'yDpiU':function(_0x26746d,_0x267475){return _0x26746d(_0x267475);}};new Promise((_0x688bb6,_0xd8d227)=>{const _0xaf488a=_0xba3f;for(const _0x2dd72b in sendSuccessCBMap){const _0x4566df=sendSuccessCBMap[_0x2dd72b],_0x5e9a53=_0x4566df(_0x3ea57a),_0x3a1dc8=_0x5c4cba=>{_0x5c4cba&&delete sendSuccessCBMap[_0x2dd72b];};_0x5e9a53 instanceof Promise?_0x5e9a53[_0xaf488a(0xcb)](_0x3a1dc8):_0x5b819b[_0xaf488a(0xd4)](_0x3a1dc8,_0x5e9a53);}})['then']()[_0x48c1d0(0xf2)](log);});},setTimeout(()=>{const _0x3caf53=_0x457f07;napCatCore[_0x3caf53(0xd5)](()=>{const _0x14313e=_0x3caf53;napCatCore[_0x14313e(0xe0)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x457f07(0xc1)](_0x296116,_0x1a781f,_0x4d57b4,_0x46f76d=!![]){const _0xba73ce=_0x457f07;return _0x4d57b4=_0x4d57b4[_0xba73ce(0xe2)](),napCatCore['session'][_0xba73ce(0xeb)]()[_0xba73ce(0xbf)](_0x296116,_0x1a781f,_0x4d57b4,_0x4d57b4['length']>0x3?'2':'1',_0x46f76d);}static async[_0x457f07(0xc3)](_0x36b4c1,_0x2ae8b5,_0x3758d8){const _0x47887c=_0x457f07;return napCatCore['session']['getMsgService']()[_0x47887c(0xc3)](_0x36b4c1,_0x2ae8b5,_0x3758d8);}static async[_0x457f07(0xfd)](_0x13e533,_0xa05257){const _0x1a16b7=_0x457f07;return await napCatCore['session'][_0x1a16b7(0xeb)]()[_0x1a16b7(0xfd)](_0x13e533,_0xa05257);}static async[_0x457f07(0xf3)](_0x548fbd,_0x197795,_0x26c915,_0x1cd43b,_0x775088){const _0x39b6db=_0x457f07;return await napCatCore['session'][_0x39b6db(0xeb)]()[_0x39b6db(0xf3)](_0x548fbd,_0x197795,_0x26c915,_0x1cd43b,_0x775088);}static async[_0x457f07(0x104)](_0x43cb61){}static async[_0x457f07(0xf7)](_0x5e1ffb){}static async[_0x457f07(0xc6)](_0x38e5cf){const _0x32a1c9=_0x457f07;return napCatCore[_0x32a1c9(0xff)]['getMsgService']()['setMsgRead'](_0x38e5cf);}static async[_0x457f07(0xe9)](_0x3e4225,_0x4c53da){const _0x2de089=_0x457f07,_0x4c1f3a={'XDdMh':function(_0x1ccc48,_0x21b60f){return _0x1ccc48(_0x21b60f);},'QschU':_0x2de089(0xdd),'SeHGb':function(_0x1ca132,_0x207403){return _0x1ca132(_0x207403);},'tpuRC':function(_0x57f3a5,_0x44869d,_0x255248){return _0x57f3a5(_0x44869d,_0x255248);},'MaFGL':function(_0x22715c){return _0x22715c();}};return new Promise(async(_0x505ba6,_0x24ba84)=>{const _0x58037b=_0x2de089,_0x35a78b={'qzAWp':function(_0x17b62c,_0x3adb02){const _0x5c089e=_0xba3f;return _0x4c1f3a[_0x5c089e(0xfa)](_0x17b62c,_0x3adb02);}};let _0xb3291c=![];_0x4c1f3a['tpuRC'](setTimeout,()=>{const _0x416431=_0xba3f;!_0xb3291c&&_0x4c1f3a[_0x416431(0xcf)](_0x24ba84,_0x4c1f3a[_0x416431(0xdc)]);},0x1388);const _0x12219a=_0x30a1dd=>{const _0x2d4133=_0xba3f;_0xb3291c=!![],_0x35a78b[_0x2d4133(0xe1)](_0x505ba6,_0x30a1dd[_0x2d4133(0xd9)]);};GroupFileInfoUpdateTasks[_0x58037b(0xec)](_0x4c1f3a[_0x58037b(0xce)](randomUUID),_0x12219a),await napCatCore[_0x58037b(0xff)][_0x58037b(0xd3)]()[_0x58037b(0xe9)](_0x3e4225,_0x4c53da);});}static async[_0x457f07(0xca)](_0x47d85d,_0x3f7878,_0x3959fd){const _0x4c3518=_0x457f07;return napCatCore['session'][_0x4c3518(0xeb)]()[_0x4c3518(0xe6)](_0x47d85d,_0x3f7878,_0x3959fd,!![]);}static async[_0x457f07(0xc4)](){}static async[_0x457f07(0xd8)](_0x1f061f,_0x27fbe2){const _0x3358df=_0x457f07;await napCatCore[_0x3358df(0xff)][_0x3358df(0xeb)]()[_0x3358df(0xd8)]({'chatType':_0x1f061f[_0x3358df(0xfc)],'peerUid':_0x1f061f[_0x3358df(0xc9)]},_0x27fbe2);}static async[_0x457f07(0xde)](_0x56b41f,_0x1d515f,_0x3ad492=!![],_0x279236=0x2710){const _0x1c0e80=_0x457f07,_0x44ae2a={'SapMw':_0x1c0e80(0xd0),'SrWaO':function(_0x54aec6,_0x487fb2){return _0x54aec6(_0x487fb2);},'dpQrd':function(_0x2db415){return _0x2db415();},'vZfiG':function(_0x1cabe3,_0x2e5597){return _0x1cabe3(_0x2e5597);},'GzAjA':function(_0x33c79e,_0x325c5e,_0x191416){return _0x33c79e(_0x325c5e,_0x191416);}},_0x48f2a3=_0x56b41f[_0x1c0e80(0xc9)];let _0x4d4fef=0x0;const _0x4d01c8=async()=>{const _0x584045=_0x1c0e80;if(_0x4d4fef>_0x279236)throw _0x44ae2a[_0x584045(0xf0)];const _0x3956f5=sendMessagePool[_0x56b41f[_0x584045(0xc9)]];if(_0x3956f5)return await _0x44ae2a[_0x584045(0xfb)](sleep,0x1f4),_0x4d4fef+=0x1f4,await _0x44ae2a[_0x584045(0xc2)](_0x4d01c8);else return;};return await _0x4d01c8(),new Promise((_0x1d88d5,_0x58c8b0)=>{const _0x1c5c9b=_0x1c0e80;let _0x88d778=![],_0x1be3e3=null;const _0x414d33=_0x44ae2a[_0x1c5c9b(0xc2)](randomUUID);sendSuccessCBMap[_0x414d33]=_0x3f6726=>{const _0x845a2f=_0x1c5c9b;if(_0x3f6726[_0x845a2f(0xcd)]===_0x1be3e3?.[_0x845a2f(0xcd)]){if(_0x3f6726[_0x845a2f(0xf4)]===0x2)return delete sendSuccessCBMap[_0x414d33],_0x88d778=!![],_0x44ae2a[_0x845a2f(0xfb)](_0x1d88d5,_0x3f6726),!![];return![];}return![];},sendMessagePool[_0x48f2a3]=async _0x52b4e4=>{delete sendMessagePool[_0x48f2a3],_0x1be3e3=_0x52b4e4;},_0x44ae2a[_0x1c5c9b(0xf9)](setTimeout,()=>{const _0x3515ae=_0x1c5c9b;if(_0x88d778)return;delete sendMessagePool[_0x48f2a3],delete sendSuccessCBMap[_0x414d33],_0x44ae2a[_0x3515ae(0xc0)](_0x58c8b0,_0x44ae2a[_0x3515ae(0xf0)]);},_0x279236);const _0x4e2660=napCatCore[_0x1c5c9b(0xff)][_0x1c5c9b(0xeb)]()['sendMsg']('0',_0x56b41f,_0x1d515f,new Map());});}static async[_0x457f07(0xf8)](_0x285d19,_0x5169e6,_0x11c79b){const _0x44ef7f=_0x457f07;return napCatCore['session'][_0x44ef7f(0xeb)]()[_0x44ef7f(0xf8)](_0x11c79b,_0x285d19,[_0x5169e6],new Map());}static async[_0x457f07(0xe7)](_0xbcb4ad,_0x4ffe99,_0x3e7055){const _0xb52098=_0x457f07,_0x550e4c={'rpRws':_0xb52098(0xc5),'NQCmf':function(_0x1f1e5e,_0x5b623d){return _0x1f1e5e(_0x5b623d);},'BgYEc':'转发消息超时','rMqFP':function(_0x2ccb5a){return _0x2ccb5a();}},_0xfe0f8b=_0x3e7055[_0xb52098(0x101)](_0x4a04cc=>{const _0x2d370f=_0xb52098;return{'msgId':_0x4a04cc,'senderShowName':selfInfo[_0x2d370f(0xba)]};});return new Promise((_0x30d963,_0x18d144)=>{const _0x3d55a9=_0xb52098,_0x162f85={'lVLeW':_0x550e4c[_0x3d55a9(0xe5)],'USSMT':function(_0x54082a,_0x47a415){return _0x54082a==_0x47a415;},'OZXBe':function(_0x1b2356,_0x5e242f){const _0x3d641f=_0x3d55a9;return _0x550e4c[_0x3d641f(0xd2)](_0x1b2356,_0x5e242f);},'XDLfd':function(_0x43d6c2,_0x52fb00){return _0x550e4c['NQCmf'](_0x43d6c2,_0x52fb00);},'EyYQv':_0x550e4c['BgYEc']};let _0x5ce722=![];const _0x5710f6=_0x3d15df=>{const _0x4ada0c=_0x3d55a9,_0x477b05=_0x3d15df[_0x4ada0c(0x100)][_0x4ada0c(0xbd)](_0x5dc80a=>_0x5dc80a[_0x4ada0c(0xed)]);if(!_0x477b05)return;const _0xeed6e8=JSON['parse'](_0x477b05['arkElement'][_0x4ada0c(0xe4)]);if(_0xeed6e8[_0x4ada0c(0xbe)]!=_0x162f85['lVLeW'])return;_0x162f85[_0x4ada0c(0xc8)](_0x3d15df[_0x4ada0c(0xc9)],_0x4ffe99[_0x4ada0c(0xc9)])&&_0x162f85[_0x4ada0c(0xc8)](_0x3d15df['senderUid'],selfInfo[_0x4ada0c(0x102)])&&(_0x5ce722=!![],_0x162f85[_0x4ada0c(0xb9)](_0x30d963,_0x3d15df));};sentMsgTasks[_0x3d55a9(0xec)](_0x550e4c['rMqFP'](randomUUID),_0x5710f6),setTimeout(()=>{const _0x1a4db4=_0x3d55a9;!_0x5ce722&&_0x162f85[_0x1a4db4(0xf1)](_0x18d144,_0x162f85[_0x1a4db4(0xfe)]);},0x1388),napCatCore[_0x3d55a9(0xff)][_0x3d55a9(0xeb)]()[_0x3d55a9(0xd1)](_0xfe0f8b,_0xbcb4ad,_0x4ffe99,[],new Map());});}}