const _0x1c8b79=_0xdca5;(function(_0x365349,_0x25cb60){const _0xdcd108=_0xdca5,_0x2657b7=_0x365349();while(!![]){try{const _0x23c33e=-parseInt(_0xdcd108(0x142))/0x1+-parseInt(_0xdcd108(0x102))/0x2+-parseInt(_0xdcd108(0x10d))/0x3+-parseInt(_0xdcd108(0x108))/0x4+-parseInt(_0xdcd108(0x112))/0x5*(-parseInt(_0xdcd108(0x12e))/0x6)+parseInt(_0xdcd108(0x122))/0x7*(-parseInt(_0xdcd108(0x140))/0x8)+parseInt(_0xdcd108(0x11c))/0x9*(parseInt(_0xdcd108(0x139))/0xa);if(_0x23c33e===_0x25cb60)break;else _0x2657b7['push'](_0x2657b7['shift']());}catch(_0x1961f2){_0x2657b7['push'](_0x2657b7['shift']());}}}(_0x3864,0xbd858));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x1c8b79(0x10a)]=_0x47cb11=>{const _0x2d8a93=_0x1c8b79,_0x154c99={'doaLH':function(_0x797345,_0x310ad2){return _0x797345(_0x310ad2);}};for(const [_0x4c72ed,_0x4e1c3f]of GroupFileInfoUpdateTasks){_0x154c99[_0x2d8a93(0x13c)](_0x4e1c3f,_0x47cb11),GroupFileInfoUpdateTasks[_0x2d8a93(0x13d)](_0x4c72ed);}},msgListener[_0x1c8b79(0x104)]=_0x528695=>{const _0x1644ea=_0x1c8b79;for(const [_0x9f98b8,_0x4103f7]of sentMsgTasks){_0x4103f7(_0x528695),sentMsgTasks[_0x1644ea(0x13d)](_0x9f98b8);}if(sendMessagePool[_0x528695[_0x1644ea(0x120)]]){const _0x110115=sendMessagePool[_0x528695['peerUid']]?.(_0x528695);_0x110115 instanceof Promise&&_0x110115[_0x1644ea(0x100)]()[_0x1644ea(0x113)](logError);}},msgListener[_0x1c8b79(0x12d)]=_0x3ed505=>{const _0x2d7cf8={'WQJvs':function(_0x41bf26,_0x21b440){return _0x41bf26(_0x21b440);},'GWsFc':function(_0x30b33f,_0x35e046){return _0x30b33f(_0x35e046);}};_0x3ed505['forEach'](_0x3c8696=>{const _0x666133=_0xdca5,_0x29c144={'RbcEI':function(_0x39285d,_0x50d6bc){const _0x5e3127=_0xdca5;return _0x2d7cf8[_0x5e3127(0x127)](_0x39285d,_0x50d6bc);},'pEVZB':function(_0x2254a1,_0x4600cc){return _0x2254a1 instanceof _0x4600cc;},'YQvhd':function(_0x1d5554,_0x5105be){const _0x43f38d=_0xdca5;return _0x2d7cf8[_0x43f38d(0x13e)](_0x1d5554,_0x5105be);}};new Promise((_0x377ac0,_0x1d6c32)=>{const _0x11cfbc=_0xdca5;for(const _0x1586e3 in sendSuccessCBMap){const _0x58af7b=sendSuccessCBMap[_0x1586e3],_0xd368a2=_0x29c144[_0x11cfbc(0x129)](_0x58af7b,_0x3c8696),_0x237e97=_0x25360b=>{_0x25360b&&delete sendSuccessCBMap[_0x1586e3];};_0x29c144[_0x11cfbc(0x125)](_0xd368a2,Promise)?_0xd368a2['then'](_0x237e97):_0x29c144['YQvhd'](_0x237e97,_0xd368a2);}})[_0x666133(0x100)]()['catch'](log);});},setTimeout(()=>{napCatCore['onLoginSuccess'](()=>{napCatCore['addListener'](msgListener);});},0x64);function _0xdca5(_0x2f7c08,_0x2cc148){const _0x3864c2=_0x3864();return _0xdca5=function(_0xdca511,_0x4d0a00){_0xdca511=_0xdca511-0x100;let _0x83687d=_0x3864c2[_0xdca511];return _0x83687d;},_0xdca5(_0x2f7c08,_0x2cc148);}function _0x3864(){const _0x43df75=['session','获取群文件列表超时','bytesData','arkElement','27EATSEr','setEmojiLike','item','multiForwardMsgWithComment','peerUid','chatType','2807yqZsaX','find','com.tencent.multimsg','pEVZB','getMsgsBySeqAndCount','WQJvs','sendMsg','RbcEI','echvP','tdDnK','senderUid','onMsgInfoListUpdate','3048LYtkwu','IedKH','FileList','OsTIi','parse','CRKKA','uid','getMsgService','hTSWR','activateChat','getMsgHistory','9736290lLdXBh','nick','forwardMsg','doaLH','delete','GWsFc','pJKAH','14632WmpJDB','recallMsg','558710yOEbJJ','groupSpaceResult','发送超时','multiForwardMsg','then','getMultiMsg','69026gZhmRe','app','onAddSendMsg','getMsgsByMsgId','allUpload','setMsgEmojiLikes','2936052fUecbh','setMsgRead','onGroupFileInfoUpdate','usedSpace','转发消息超时','253350nQkfaA','getGroupFileList','toString','svkuE','map','5fRgMMa','catch','length','oFQcn','totalSpace','msgId'];_0x3864=function(){return _0x43df75;};return _0x3864();}export class NTQQMsgApi{static async[_0x1c8b79(0x11d)](_0x491f25,_0x40a50f,_0x22ba94,_0x2e4007=!![]){const _0xd3f905=_0x1c8b79,_0x415f72={'echvP':function(_0x26a026,_0x3c760f){return _0x26a026>_0x3c760f;}};return _0x22ba94=_0x22ba94[_0xd3f905(0x10f)](),napCatCore[_0xd3f905(0x118)]['getMsgService']()[_0xd3f905(0x107)](_0x491f25,_0x40a50f,_0x22ba94,_0x415f72[_0xd3f905(0x12a)](_0x22ba94[_0xd3f905(0x114)],0x3)?'2':'1',_0x2e4007);}static async[_0x1c8b79(0x101)](_0x451bf4,_0x363852,_0x54daeb){const _0x483245=_0x1c8b79;return napCatCore[_0x483245(0x118)][_0x483245(0x135)]()['getMultiMsg'](_0x451bf4,_0x363852,_0x54daeb);}static async['getMsgsByMsgId'](_0x5f276f,_0x4127a1){const _0x591590=_0x1c8b79;return await napCatCore['session'][_0x591590(0x135)]()[_0x591590(0x105)](_0x5f276f,_0x4127a1);}static async[_0x1c8b79(0x126)](_0x15cf52,_0x2bef38,_0x412cd3,_0x3fa7f1,_0x469b1f){const _0xd8ac8=_0x1c8b79;return await napCatCore[_0xd8ac8(0x118)]['getMsgService']()[_0xd8ac8(0x126)](_0x15cf52,_0x2bef38,_0x412cd3,_0x3fa7f1,_0x469b1f);}static async[_0x1c8b79(0x137)](_0x344947){}static async['activateChatAndGetHistory'](_0x57c500){}static async[_0x1c8b79(0x109)](_0x19d93d){const _0x4fe633=_0x1c8b79;return napCatCore[_0x4fe633(0x118)][_0x4fe633(0x135)]()['setMsgRead'](_0x19d93d);}static async[_0x1c8b79(0x10e)](_0x2c72f5,_0x6d6cda){const _0x31ca6a={'oFQcn':function(_0xf37063,_0x3a9ca8,_0x2b76cb){return _0xf37063(_0x3a9ca8,_0x2b76cb);},'nrcza':function(_0x56a940){return _0x56a940();}};return new Promise(async(_0x2b4929,_0x1b4bc7)=>{const _0x305759=_0xdca5;let _0xf84ae1=![],_0x36cc7a={};_0x31ca6a[_0x305759(0x115)](setTimeout,()=>{const _0x180510=_0x305759;!_0xf84ae1&&_0x1b4bc7(_0x180510(0x119));},0x1388);const _0x671e92=_0x169984=>{const _0x21fe5f=_0x305759;_0xf84ae1=!![],_0x36cc7a[_0x21fe5f(0x130)]=_0x169984[_0x21fe5f(0x11e)],_0x2b4929(_0x36cc7a);};GroupFileInfoUpdateTasks['set'](_0x31ca6a['nrcza'](randomUUID),_0x671e92);const _0x1b3f8f=await napCatCore['session']['getRichMediaService']()['getGroupFileList'](_0x2c72f5,_0x6d6cda);_0x36cc7a[_0x305759(0x106)]=_0x1b3f8f[_0x305759(0x143)][_0x305759(0x106)],_0x36cc7a[_0x305759(0x116)]=_0x1b3f8f[_0x305759(0x143)][_0x305759(0x116)],_0x36cc7a[_0x305759(0x10b)]=_0x1b3f8f[_0x305759(0x143)][_0x305759(0x10b)];});}static async[_0x1c8b79(0x138)](_0x2ab437,_0x3e11a9,_0x1589df){const _0x40b7ae=_0x1c8b79;return napCatCore[_0x40b7ae(0x118)][_0x40b7ae(0x135)]()['getMsgsIncludeSelf'](_0x2ab437,_0x3e11a9,_0x1589df,!![]);}static async['fetchRecentContact'](){}static async[_0x1c8b79(0x141)](_0x50ed4f,_0x4a5dad){const _0x517734=_0x1c8b79;await napCatCore[_0x517734(0x118)]['getMsgService']()[_0x517734(0x141)]({'chatType':_0x50ed4f[_0x517734(0x121)],'peerUid':_0x50ed4f[_0x517734(0x120)]},_0x4a5dad);}static async[_0x1c8b79(0x128)](_0x41a92b,_0x585c16,_0x52e474=!![],_0x35efc1=0x2710){const _0x1ca3b5=_0x1c8b79,_0x2358d8={'CRKKA':_0x1ca3b5(0x144),'pmbtb':function(_0x3a6349,_0x4bb874){return _0x3a6349(_0x4bb874);},'svkuE':function(_0x3b63d4){return _0x3b63d4();},'hTSWR':function(_0x28a58b){return _0x28a58b();}},_0x205f59=_0x41a92b['peerUid'];let _0x3f1d0f=0x0;const _0x1a2bd6=async()=>{const _0x3b303c=_0x1ca3b5;if(_0x3f1d0f>_0x35efc1)throw _0x2358d8[_0x3b303c(0x133)];const _0x55f5cd=sendMessagePool[_0x41a92b['peerUid']];if(_0x55f5cd)return await _0x2358d8['pmbtb'](sleep,0x1f4),_0x3f1d0f+=0x1f4,await _0x2358d8[_0x3b303c(0x110)](_0x1a2bd6);else return;};return await _0x2358d8[_0x1ca3b5(0x136)](_0x1a2bd6),new Promise((_0x33fdbf,_0x19c114)=>{const _0x5c852c=_0x1ca3b5,_0x4c95a2={'YHWOh':function(_0x5718e5,_0x542bcf){return _0x5718e5===_0x542bcf;}};let _0x7ab065=![],_0x2c86a4=null;const _0x1257fc=_0x2358d8[_0x5c852c(0x110)](randomUUID);sendSuccessCBMap[_0x1257fc]=_0x58f591=>{const _0x85ff8f=_0x5c852c;if(_0x58f591[_0x85ff8f(0x117)]===_0x2c86a4?.[_0x85ff8f(0x117)]){if(_0x4c95a2['YHWOh'](_0x58f591['sendStatus'],0x2))return delete sendSuccessCBMap[_0x1257fc],_0x7ab065=!![],_0x33fdbf(_0x58f591),!![];return![];}return![];},sendMessagePool[_0x205f59]=async _0x53ed47=>{delete sendMessagePool[_0x205f59],_0x2c86a4=_0x53ed47;},setTimeout(()=>{const _0x184db3=_0x5c852c;if(_0x7ab065)return;delete sendMessagePool[_0x205f59],delete sendSuccessCBMap[_0x1257fc],_0x19c114(_0x184db3(0x144));},_0x35efc1);const _0x10b971=napCatCore[_0x5c852c(0x118)][_0x5c852c(0x135)]()[_0x5c852c(0x128)]('0',_0x41a92b,_0x585c16,new Map());});}static async[_0x1c8b79(0x13b)](_0x4ec643,_0xb26c18,_0x510954){const _0x45507c=_0x1c8b79;return napCatCore['session'][_0x45507c(0x135)]()['forwardMsg'](_0x510954,_0x4ec643,[_0xb26c18],new Map());}static async[_0x1c8b79(0x145)](_0x4e636e,_0x381160,_0x2969a9){const _0xe3254b=_0x1c8b79,_0x4b7d24={'pJKAH':function(_0x1c1134,_0x2362ce){return _0x1c1134(_0x2362ce);},'tdDnK':function(_0x2150ba,_0x2f6f28,_0x33bcb6){return _0x2150ba(_0x2f6f28,_0x33bcb6);}},_0x260471=_0x2969a9[_0xe3254b(0x111)](_0x15c563=>{const _0x4f6f92=_0xe3254b;return{'msgId':_0x15c563,'senderShowName':selfInfo[_0x4f6f92(0x13a)]};});return new Promise((_0x4876a0,_0x39ab3a)=>{const _0x314572=_0xe3254b,_0x3c954d={'OsTIi':_0x314572(0x124),'IedKH':function(_0x23ce7f,_0x221958){const _0x224a8e=_0x314572;return _0x4b7d24[_0x224a8e(0x13f)](_0x23ce7f,_0x221958);}};let _0x38ec4f=![];const _0x185bed=_0x2b994b=>{const _0x434754=_0x314572,_0x1da31b=_0x2b994b['elements'][_0x434754(0x123)](_0x5720eb=>_0x5720eb['arkElement']);if(!_0x1da31b)return;const _0x6d7424=JSON[_0x434754(0x132)](_0x1da31b[_0x434754(0x11b)][_0x434754(0x11a)]);if(_0x6d7424[_0x434754(0x103)]!=_0x3c954d[_0x434754(0x131)])return;_0x2b994b['peerUid']==_0x381160[_0x434754(0x120)]&&_0x2b994b[_0x434754(0x12c)]==selfInfo[_0x434754(0x134)]&&(_0x38ec4f=!![],_0x3c954d[_0x434754(0x12f)](_0x4876a0,_0x2b994b));};sentMsgTasks['set'](randomUUID(),_0x185bed),_0x4b7d24[_0x314572(0x12b)](setTimeout,()=>{const _0x3553fe=_0x314572;!_0x38ec4f&&_0x39ab3a(_0x3553fe(0x10c));},0x1388),napCatCore[_0x314572(0x118)][_0x314572(0x135)]()[_0x314572(0x11f)](_0x260471,_0x4e636e,_0x381160,[],new Map());});}}