const _0x3d1541=_0x4921;(function(_0x1d6f6e,_0x373bb9){const _0xd7f087=_0x4921,_0xbcd50c=_0x1d6f6e();while(!![]){try{const _0x5e5171=parseInt(_0xd7f087(0x117))/0x1*(-parseInt(_0xd7f087(0x123))/0x2)+-parseInt(_0xd7f087(0x147))/0x3+parseInt(_0xd7f087(0x129))/0x4+parseInt(_0xd7f087(0x11b))/0x5*(parseInt(_0xd7f087(0x119))/0x6)+-parseInt(_0xd7f087(0x113))/0x7+-parseInt(_0xd7f087(0x13d))/0x8+parseInt(_0xd7f087(0x120))/0x9;if(_0x5e5171===_0x373bb9)break;else _0xbcd50c['push'](_0xbcd50c['shift']());}catch(_0x50de17){_0xbcd50c['push'](_0xbcd50c['shift']());}}}(_0x46b6,0x2ed35));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();function _0x46b6(){const _0x3006d7=['tYLhu','转发消息超时','bYkVt','parse','activateChatAndGetHistory','getMsgHistory','getMsgsByMsgId','length','sendMsg','SHySO','session','2155024waXNIr','forwardMsg','vnNex','rchiu','onGroupFileInfoUpdate','mrRVB','delete','activateChat','FeAYX','sendStatus','772521XQRBxs','ntsZw','app','multiForwardMsg','msgId','getMsgService','onAddSendMsg','arkElement','uid','com.tencent.multimsg','vnGDg','获取群文件列表超时','dQiLl','bytesData','forEach','catch','map','senderUid','发送超时','peerUid','1678411gNnvZt','recallMsg','onLoginSuccess','wqgdr','1PqoKjn','gmtTr','494958wTrlha','Kyvdv','15eZEuTz','nick','setEmojiLike','ukvxY','QOjfw','7756389Peassv','multiForwardMsgWithComment','elements','724606pLWUgk','Milox','set','then','ygPkW','oxVlT','845832kDKFIH','getMultiMsg','fetchRecentContact','Vxoch','setMsgRead','setMsgEmojiLikes','getGroupFileList','xVmAi','aWLHn'];_0x46b6=function(){return _0x3006d7;};return _0x46b6();}function _0x4921(_0x5e3e79,_0x4ee62b){const _0x46b6c5=_0x46b6();return _0x4921=function(_0x492137,_0xdc01d6){_0x492137=_0x492137-0x10a;let _0x341880=_0x46b6c5[_0x492137];return _0x341880;},_0x4921(_0x5e3e79,_0x4ee62b);}msgListener[_0x3d1541(0x141)]=_0x597190=>{const _0x39d5e3=_0x3d1541;for(const [_0x2566f3,_0x2340eb]of GroupFileInfoUpdateTasks){_0x2340eb(_0x597190),GroupFileInfoUpdateTasks[_0x39d5e3(0x143)](_0x2566f3);}},msgListener[_0x3d1541(0x14d)]=_0x42160e=>{const _0x2e6b1a=_0x3d1541,_0x337218={'vnNex':function(_0x165a74,_0x5b44bf){return _0x165a74(_0x5b44bf);},'ukvxY':function(_0x3be8f9,_0x11a3fb){return _0x3be8f9 instanceof _0x11a3fb;}};for(const [_0x3484af,_0x5964b0]of sentMsgTasks){_0x337218[_0x2e6b1a(0x13f)](_0x5964b0,_0x42160e),sentMsgTasks[_0x2e6b1a(0x143)](_0x3484af);}if(sendMessagePool[_0x42160e[_0x2e6b1a(0x112)]]){const _0x4b6172=sendMessagePool[_0x42160e[_0x2e6b1a(0x112)]]?.(_0x42160e);_0x337218[_0x2e6b1a(0x11e)](_0x4b6172,Promise)&&_0x4b6172[_0x2e6b1a(0x126)]()[_0x2e6b1a(0x10e)](logError);}},msgListener['onMsgInfoListUpdate']=_0x5f01b5=>{const _0x1d21e9=_0x3d1541,_0x1a3e5f={'QOjfw':function(_0x263b42,_0x2d3b62){return _0x263b42(_0x2d3b62);},'xVmAi':function(_0x2817a3,_0x5473b6){return _0x2817a3 instanceof _0x5473b6;},'SHySO':function(_0x592ada,_0x26b40a){return _0x592ada(_0x26b40a);}};_0x5f01b5[_0x1d21e9(0x10d)](_0x31dbb3=>{const _0x1b33c1=_0x1d21e9;new Promise((_0x30de5e,_0x5b61a2)=>{const _0x156074=_0x4921;for(const _0x226ba0 in sendSuccessCBMap){const _0x47a2d0=sendSuccessCBMap[_0x226ba0],_0x18d314=_0x1a3e5f[_0x156074(0x11f)](_0x47a2d0,_0x31dbb3),_0x8d1dd2=_0x4faacc=>{_0x4faacc&&delete sendSuccessCBMap[_0x226ba0];};_0x1a3e5f[_0x156074(0x130)](_0x18d314,Promise)?_0x18d314['then'](_0x8d1dd2):_0x1a3e5f[_0x156074(0x13b)](_0x8d1dd2,_0x18d314);}})[_0x1b33c1(0x126)]()[_0x1b33c1(0x10e)](log);});},setTimeout(()=>{const _0x1467cd=_0x3d1541;napCatCore[_0x1467cd(0x115)](()=>{napCatCore['addListener'](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x3d1541(0x11d)](_0x19206c,_0x1c503e,_0x2eb15e,_0x523a96=!![]){const _0xec7222=_0x3d1541,_0x414d53={'Milox':function(_0x5b4e98,_0x49e6a2){return _0x5b4e98>_0x49e6a2;}};return _0x2eb15e=_0x2eb15e['toString'](),napCatCore[_0xec7222(0x13c)]['getMsgService']()[_0xec7222(0x12e)](_0x19206c,_0x1c503e,_0x2eb15e,_0x414d53[_0xec7222(0x124)](_0x2eb15e[_0xec7222(0x139)],0x3)?'2':'1',_0x523a96);}static async[_0x3d1541(0x12a)](_0x283b9d,_0x5084ef,_0x252978){const _0x459082=_0x3d1541;return napCatCore[_0x459082(0x13c)]['getMsgService']()['getMultiMsg'](_0x283b9d,_0x5084ef,_0x252978);}static async[_0x3d1541(0x138)](_0x16bf75,_0x3bf903){const _0x103f99=_0x3d1541;return await napCatCore['session'][_0x103f99(0x14c)]()['getMsgsByMsgId'](_0x16bf75,_0x3bf903);}static async['getMsgsBySeqAndCount'](_0x47b512,_0x5248cd,_0x559d4c,_0x3ab1d9,_0x4c293d){const _0x32db53=_0x3d1541;return await napCatCore[_0x32db53(0x13c)]['getMsgService']()['getMsgsBySeqAndCount'](_0x47b512,_0x5248cd,_0x559d4c,_0x3ab1d9,_0x4c293d);}static async[_0x3d1541(0x144)](_0x47131e){}static async[_0x3d1541(0x136)](_0x621b75){}static async[_0x3d1541(0x12d)](_0x1e0637){const _0x266aaf=_0x3d1541;return napCatCore[_0x266aaf(0x13c)][_0x266aaf(0x14c)]()['setMsgRead'](_0x1e0637);}static async['getGroupFileList'](_0x11a670,_0x30d3ca){const _0x3e7576=_0x3d1541,_0x3493dd={'rchiu':function(_0x37092d,_0x1260be){return _0x37092d(_0x1260be);},'oxVlT':_0x3e7576(0x10a),'bYkVt':function(_0x58ccb6,_0x2f3a4b,_0x1766c1){return _0x58ccb6(_0x2f3a4b,_0x1766c1);},'Kyvdv':function(_0xf63802){return _0xf63802();}};return new Promise(async(_0xe41731,_0x40300d)=>{const _0x44b9b9=_0x3e7576;let _0x2a6bb=![];_0x3493dd[_0x44b9b9(0x134)](setTimeout,()=>{const _0x3c0537=_0x44b9b9;!_0x2a6bb&&_0x3493dd[_0x3c0537(0x140)](_0x40300d,_0x3493dd[_0x3c0537(0x128)]);},0x1388);const _0x1dfccf=_0x57c278=>{const _0x158c3f=_0x44b9b9;_0x2a6bb=!![],_0x3493dd[_0x158c3f(0x140)](_0xe41731,_0x57c278['item']);};GroupFileInfoUpdateTasks[_0x44b9b9(0x125)](_0x3493dd[_0x44b9b9(0x11a)](randomUUID),_0x1dfccf),await napCatCore[_0x44b9b9(0x13c)]['getRichMediaService']()[_0x44b9b9(0x12f)](_0x11a670,_0x30d3ca);});}static async[_0x3d1541(0x137)](_0x2b6214,_0x202b2e,_0x3ac1e9){const _0x531103=_0x3d1541;return napCatCore[_0x531103(0x13c)][_0x531103(0x14c)]()['getMsgsIncludeSelf'](_0x2b6214,_0x202b2e,_0x3ac1e9,!![]);}static async[_0x3d1541(0x12b)](){}static async[_0x3d1541(0x114)](_0x2b74b4,_0x55886a){const _0x55dc2a=_0x3d1541;await napCatCore[_0x55dc2a(0x13c)][_0x55dc2a(0x14c)]()['recallMsg']({'chatType':_0x2b74b4['chatType'],'peerUid':_0x2b74b4['peerUid']},_0x55886a);}static async['sendMsg'](_0x4aac21,_0xc81c03,_0x50f657=!![],_0x5b3a9e=0x2710){const _0x218c82=_0x3d1541,_0x1b2bba={'gmtTr':function(_0x5d7333,_0x18e8fd){return _0x5d7333>_0x18e8fd;},'FeAYX':_0x218c82(0x111),'vnGDg':function(_0x3c2d7d,_0x1f6d4f){return _0x3c2d7d(_0x1f6d4f);},'anOii':function(_0x12b17b,_0x5931af){return _0x12b17b===_0x5931af;},'wqgdr':function(_0x7f73e8){return _0x7f73e8();},'mrRVB':function(_0x2d992b,_0x2063f2,_0x245aa6){return _0x2d992b(_0x2063f2,_0x245aa6);}},_0x2d2f61=_0x4aac21[_0x218c82(0x112)];let _0x561653=0x0;const _0x4d7777=async()=>{const _0x48980e=_0x218c82;if(_0x1b2bba[_0x48980e(0x118)](_0x561653,_0x5b3a9e))throw _0x1b2bba[_0x48980e(0x145)];const _0x250f8f=sendMessagePool[_0x4aac21['peerUid']];if(_0x250f8f)return await _0x1b2bba['vnGDg'](sleep,0x1f4),_0x561653+=0x1f4,await _0x4d7777();else return;};return await _0x1b2bba[_0x218c82(0x116)](_0x4d7777),new Promise((_0x1bf98d,_0x40f693)=>{const _0x57fe1b=_0x218c82;let _0x252e02=![],_0x3e3f9e=null;const _0x5e5d36=_0x1b2bba[_0x57fe1b(0x116)](randomUUID);sendSuccessCBMap[_0x5e5d36]=_0x4e3036=>{const _0x46f6e8=_0x57fe1b;if(_0x1b2bba['anOii'](_0x4e3036[_0x46f6e8(0x14b)],_0x3e3f9e?.['msgId'])){if(_0x4e3036[_0x46f6e8(0x146)]===0x2)return delete sendSuccessCBMap[_0x5e5d36],_0x252e02=!![],_0x1b2bba[_0x46f6e8(0x151)](_0x1bf98d,_0x4e3036),!![];return![];}return![];},sendMessagePool[_0x2d2f61]=async _0x47733c=>{delete sendMessagePool[_0x2d2f61],_0x3e3f9e=_0x47733c;},_0x1b2bba[_0x57fe1b(0x142)](setTimeout,()=>{const _0x411c87=_0x57fe1b;if(_0x252e02)return;delete sendMessagePool[_0x2d2f61],delete sendSuccessCBMap[_0x5e5d36],_0x1b2bba[_0x411c87(0x151)](_0x40f693,_0x411c87(0x111));},_0x5b3a9e);const _0x3d8551=napCatCore['session']['getMsgService']()[_0x57fe1b(0x13a)]('0',_0x4aac21,_0xc81c03,new Map());});}static async['forwardMsg'](_0x2c9be2,_0x5d8bac,_0x253731){const _0x590e33=_0x3d1541;return napCatCore[_0x590e33(0x13c)][_0x590e33(0x14c)]()[_0x590e33(0x13e)](_0x253731,_0x2c9be2,[_0x5d8bac],new Map());}static async[_0x3d1541(0x14a)](_0x2e68f2,_0xf62f94,_0xea18ab){const _0x557fa9=_0x3d1541,_0x1043a8={'RuXfV':function(_0x405591,_0x5eb9c4){return _0x405591!=_0x5eb9c4;},'aWLHn':_0x557fa9(0x150),'ntsZw':function(_0x3758e1,_0x8b18e5){return _0x3758e1==_0x8b18e5;},'tYLhu':function(_0xa59eb5,_0x173e3b){return _0xa59eb5(_0x173e3b);},'dQiLl':function(_0x5e1b5b,_0x28f75f){return _0x5e1b5b(_0x28f75f);},'ygPkW':function(_0x20b6c){return _0x20b6c();},'Vxoch':function(_0x88e298,_0x26d5c4,_0x12e402){return _0x88e298(_0x26d5c4,_0x12e402);}},_0x4a7085=_0xea18ab[_0x557fa9(0x10f)](_0x47878e=>{const _0xc3e8e9=_0x557fa9;return{'msgId':_0x47878e,'senderShowName':selfInfo[_0xc3e8e9(0x11c)]};});return new Promise((_0x590201,_0x2df969)=>{const _0x2a51d6=_0x557fa9;let _0x415f15=![];const _0x1d70e8=_0xf7dfff=>{const _0x399f4e=_0x4921,_0x142905=_0xf7dfff[_0x399f4e(0x122)]['find'](_0x2ddd2b=>_0x2ddd2b[_0x399f4e(0x14e)]);if(!_0x142905)return;const _0x599eb7=JSON[_0x399f4e(0x135)](_0x142905['arkElement'][_0x399f4e(0x10c)]);if(_0x1043a8['RuXfV'](_0x599eb7[_0x399f4e(0x149)],_0x1043a8[_0x399f4e(0x131)]))return;_0xf7dfff[_0x399f4e(0x112)]==_0xf62f94[_0x399f4e(0x112)]&&_0x1043a8[_0x399f4e(0x148)](_0xf7dfff[_0x399f4e(0x110)],selfInfo[_0x399f4e(0x14f)])&&(_0x415f15=!![],_0x1043a8[_0x399f4e(0x132)](_0x590201,_0xf7dfff));};sentMsgTasks[_0x2a51d6(0x125)](_0x1043a8[_0x2a51d6(0x127)](randomUUID),_0x1d70e8),_0x1043a8[_0x2a51d6(0x12c)](setTimeout,()=>{const _0x31b903=_0x2a51d6;!_0x415f15&&_0x1043a8[_0x31b903(0x10b)](_0x2df969,_0x31b903(0x133));},0x1388),napCatCore[_0x2a51d6(0x13c)]['getMsgService']()[_0x2a51d6(0x121)](_0x4a7085,_0x2e68f2,_0xf62f94,[],new Map());});}}