const _0xf3bc69=_0x5213;function _0x564c(){const _0x1a1b10=['HMADX','GQKeR','parse','gMHZn','getMsgService','转发消息超时','getMultiMsg','addListener','getMsgsIncludeSelf','fcoZb','map','pOJad','elements','getMsgsByMsgId','bAfUG','msgId','senderUid','delete','3744wFBLqL','iUGUu','VRzKc','activateChat','getMsgsBySeqAndCount','1121650ktDmTL','activateChatAndGetHistory','32479gNqwTW','setMsgRead','6oYuxkq','app','arkElement','recallMsg','8827YTRsnr','com.tencent.multimsg','forwardMsg','set','2776326piCZBw','QYJmr','onLoginSuccess','发送超时','forEach','sendMsg','sendStatus','chatType','length','catch','KFznr','bytesData','wfWvg','767144qodJoJ','WcrRj','tFZAa','peerUid','session','onMsgInfoListUpdate','nick','mqLMy','223366lIyNLf','toString','jajAU','setMsgEmojiLikes','getMsgHistory','fetchRecentContact','then','OvGOY','oPEBg','GbykS','klDHN','7648416HLoBLt'];_0x564c=function(){return _0x1a1b10;};return _0x564c();}(function(_0x75e5ac,_0x187fba){const _0x55f306=_0x5213,_0x29c820=_0x75e5ac();while(!![]){try{const _0x444f6a=-parseInt(_0x55f306(0xd3))/0x1+-parseInt(_0x55f306(0xf2))/0x2*(parseInt(_0x55f306(0xd5))/0x3)+-parseInt(_0x55f306(0xea))/0x4+-parseInt(_0x55f306(0xd1))/0x5+-parseInt(_0x55f306(0xdd))/0x6+-parseInt(_0x55f306(0xd9))/0x7*(-parseInt(_0x55f306(0xcc))/0x8)+parseInt(_0x55f306(0xb9))/0x9;if(_0x444f6a===_0x187fba)break;else _0x29c820['push'](_0x29c820['shift']());}catch(_0x306183){_0x29c820['push'](_0x29c820['shift']());}}}(_0x564c,0x4a88a));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';function _0x5213(_0x18d469,_0x204c8f){const _0x564c21=_0x564c();return _0x5213=function(_0x5213a0,_0x30d580){_0x5213a0=_0x5213a0-0xb6;let _0x55beaa=_0x564c21[_0x5213a0];return _0x55beaa;},_0x5213(_0x18d469,_0x204c8f);}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onAddSendMsg']=_0x168dd3=>{const _0x338641=_0x5213,_0x1fade7={'glxWl':function(_0x6a7ae8,_0x5795a1){return _0x6a7ae8(_0x5795a1);},'wfWvg':function(_0x558e73,_0x59b355){return _0x558e73 instanceof _0x59b355;}};for(const [_0x1354ed,_0x28a591]of sentMsgTasks){_0x1fade7['glxWl'](_0x28a591,_0x168dd3),sentMsgTasks[_0x338641(0xcb)](_0x1354ed);}if(sendMessagePool[_0x168dd3['peerUid']]){const _0x29b9c6=sendMessagePool[_0x168dd3[_0x338641(0xed)]]?.(_0x168dd3);_0x1fade7[_0x338641(0xe9)](_0x29b9c6,Promise)&&_0x29b9c6[_0x338641(0xf8)]()[_0x338641(0xe6)](logError);}},msgListener[_0xf3bc69(0xef)]=_0x108bfa=>{const _0x5436e0=_0xf3bc69,_0x30764e={'sPsnf':function(_0x49aefc,_0x3ca2f2){return _0x49aefc(_0x3ca2f2);}};_0x108bfa[_0x5436e0(0xe1)](_0xbfbdc9=>{const _0x215111=_0x5436e0,_0x266366={'psomE':function(_0x8cd6d6,_0x414d65){return _0x8cd6d6(_0x414d65);},'mqLMy':function(_0x53ae56,_0x653934){return _0x53ae56 instanceof _0x653934;},'aAsDV':function(_0xba773f,_0x441037){return _0x30764e['sPsnf'](_0xba773f,_0x441037);}};new Promise((_0x33c519,_0x134930)=>{const _0x5d4dda=_0x5213;for(const _0x2862dc in sendSuccessCBMap){const _0x155a27=sendSuccessCBMap[_0x2862dc],_0x56370f=_0x266366['psomE'](_0x155a27,_0xbfbdc9),_0x4a3bb0=_0x89a2ea=>{_0x89a2ea&&delete sendSuccessCBMap[_0x2862dc];};_0x266366[_0x5d4dda(0xf1)](_0x56370f,Promise)?_0x56370f[_0x5d4dda(0xf8)](_0x4a3bb0):_0x266366['aAsDV'](_0x4a3bb0,_0x56370f);}})['then']()[_0x215111(0xe6)](log);});},setTimeout(()=>{const _0x444c64=_0xf3bc69;napCatCore[_0x444c64(0xdf)](()=>{const _0x5481e8=_0x444c64;napCatCore[_0x5481e8(0xc1)](msgListener);});},0x64);export class NTQQMsgApi{static async['setEmojiLike'](_0x41c036,_0x1171cf,_0x2df937,_0x5f7d94=!![]){const _0x4244ef=_0xf3bc69;return _0x2df937=_0x2df937[_0x4244ef(0xf3)](),napCatCore[_0x4244ef(0xee)]['getMsgService']()[_0x4244ef(0xf5)](_0x41c036,_0x1171cf,_0x2df937,_0x2df937[_0x4244ef(0xe5)]>0x3?'2':'1',_0x5f7d94);}static async[_0xf3bc69(0xc0)](_0x42f9e4,_0x1df48a,_0x1538e2){const _0x24a07e=_0xf3bc69;return napCatCore[_0x24a07e(0xee)][_0x24a07e(0xbe)]()[_0x24a07e(0xc0)](_0x42f9e4,_0x1df48a,_0x1538e2);}static async[_0xf3bc69(0xc7)](_0x5c4600,_0x5d3648){const _0x25edd4=_0xf3bc69;return await napCatCore[_0x25edd4(0xee)][_0x25edd4(0xbe)]()[_0x25edd4(0xc7)](_0x5c4600,_0x5d3648);}static async[_0xf3bc69(0xd0)](_0x50271f,_0x42e70c,_0x297b7b,_0xa026fa,_0x454a83){const _0x3a4f0e=_0xf3bc69;return await napCatCore[_0x3a4f0e(0xee)][_0x3a4f0e(0xbe)]()[_0x3a4f0e(0xd0)](_0x50271f,_0x42e70c,_0x297b7b,_0xa026fa,_0x454a83);}static async[_0xf3bc69(0xcf)](_0x425682){}static async[_0xf3bc69(0xd2)](_0x26020b){}static async[_0xf3bc69(0xd4)](_0x126804){const _0x2a07ab=_0xf3bc69;return napCatCore['session'][_0x2a07ab(0xbe)]()['setMsgRead'](_0x126804);}static async[_0xf3bc69(0xf6)](_0x1fe37b,_0x1f0195,_0x3557f4){const _0x36d995=_0xf3bc69;return napCatCore[_0x36d995(0xee)][_0x36d995(0xbe)]()[_0x36d995(0xc2)](_0x1fe37b,_0x1f0195,_0x3557f4,!![]);}static async[_0xf3bc69(0xf7)](){}static async[_0xf3bc69(0xd8)](_0x461237,_0x108fad){const _0x10a1eb=_0xf3bc69;await napCatCore[_0x10a1eb(0xee)][_0x10a1eb(0xbe)]()['recallMsg']({'chatType':_0x461237[_0x10a1eb(0xe4)],'peerUid':_0x461237[_0x10a1eb(0xed)]},_0x108fad);}static async[_0xf3bc69(0xe2)](_0x2d1a0f,_0x3b2303,_0x1a7bb8=!![],_0x1f9457=0x2710){const _0x11f128=_0xf3bc69,_0x377f96={'GQKeR':function(_0x57bb49,_0x49f2ac){return _0x57bb49>_0x49f2ac;},'mplfn':'发送超时','QYJmr':function(_0x302460,_0x569ecf){return _0x302460(_0x569ecf);},'fcoZb':function(_0x23039a){return _0x23039a();},'iUGUu':function(_0x17d1e6,_0x387eee){return _0x17d1e6===_0x387eee;},'jajAU':function(_0x42f504,_0x42033b){return _0x42f504===_0x42033b;},'pOJad':function(_0x186b74,_0x41bcb5){return _0x186b74(_0x41bcb5);},'tFZAa':function(_0xedf1f2){return _0xedf1f2();},'klDHN':function(_0x16363a,_0x2b20e2,_0x16ac69){return _0x16363a(_0x2b20e2,_0x16ac69);}},_0x1a9baf=_0x2d1a0f[_0x11f128(0xed)];let _0x37707a=0x0;const _0x42f9b1=async()=>{const _0x20f164=_0x11f128;if(_0x377f96[_0x20f164(0xbb)](_0x37707a,_0x1f9457))throw _0x377f96['mplfn'];const _0x389802=sendMessagePool[_0x2d1a0f[_0x20f164(0xed)]];if(_0x389802)return await _0x377f96[_0x20f164(0xde)](sleep,0x1f4),_0x37707a+=0x1f4,await _0x377f96[_0x20f164(0xc3)](_0x42f9b1);else return;};return await _0x377f96['fcoZb'](_0x42f9b1),new Promise((_0x39d096,_0x2d674e)=>{const _0x5f293e=_0x11f128,_0xe5fb63={'OvGOY':function(_0x18e2e7,_0x295a79){const _0x50b54f=_0x5213;return _0x377f96[_0x50b54f(0xcd)](_0x18e2e7,_0x295a79);},'WcrRj':function(_0x500ec7,_0x55fabc){const _0xc83bd9=_0x5213;return _0x377f96[_0xc83bd9(0xf4)](_0x500ec7,_0x55fabc);},'OAhut':function(_0x5cfdcc,_0x2fab1b){const _0x4d60c5=_0x5213;return _0x377f96[_0x4d60c5(0xc5)](_0x5cfdcc,_0x2fab1b);},'GbykS':function(_0x2e0c7c,_0x525176){return _0x2e0c7c(_0x525176);}};let _0x2df903=![],_0x464b79=null;const _0x4585f9=_0x377f96[_0x5f293e(0xec)](randomUUID);sendSuccessCBMap[_0x4585f9]=_0xe15546=>{const _0x26f6d8=_0x5f293e;if(_0xe5fb63[_0x26f6d8(0xf9)](_0xe15546[_0x26f6d8(0xc9)],_0x464b79?.[_0x26f6d8(0xc9)])){if(_0xe5fb63[_0x26f6d8(0xeb)](_0xe15546[_0x26f6d8(0xe3)],0x2))return delete sendSuccessCBMap[_0x4585f9],_0x2df903=!![],_0xe5fb63['OAhut'](_0x39d096,_0xe15546),!![];return![];}return![];},sendMessagePool[_0x1a9baf]=async _0x58e63c=>{delete sendMessagePool[_0x1a9baf],_0x464b79=_0x58e63c;},_0x377f96[_0x5f293e(0xb8)](setTimeout,()=>{const _0xfb07be=_0x5f293e;if(_0x2df903)return;delete sendMessagePool[_0x1a9baf],delete sendSuccessCBMap[_0x4585f9],_0xe5fb63[_0xfb07be(0xb7)](_0x2d674e,_0xfb07be(0xe0));},_0x1f9457);const _0x231b97=napCatCore[_0x5f293e(0xee)][_0x5f293e(0xbe)]()[_0x5f293e(0xe2)]('0',_0x2d1a0f,_0x3b2303,new Map());});}static async[_0xf3bc69(0xdb)](_0x493cd0,_0x49538c,_0x27c89d){const _0x2f1e29=_0xf3bc69;return napCatCore[_0x2f1e29(0xee)][_0x2f1e29(0xbe)]()[_0x2f1e29(0xdb)](_0x27c89d,_0x493cd0,[_0x49538c],new Map());}static async['multiForwardMsg'](_0x5bbed9,_0x407b3c,_0x2e08b9){const _0x39a831=_0xf3bc69,_0x41a996={'gMHZn':_0x39a831(0xda),'KFznr':function(_0x33910f,_0xf52c21){return _0x33910f==_0xf52c21;},'HMADX':function(_0x51f96d,_0x53fb73){return _0x51f96d==_0x53fb73;},'bAfUG':function(_0x45f217,_0x4ed8a1){return _0x45f217(_0x4ed8a1);},'gxfWd':function(_0x51c451,_0x2acb7f){return _0x51c451(_0x2acb7f);},'oPEBg':_0x39a831(0xbf),'ptdOd':function(_0xe2cfed){return _0xe2cfed();}},_0x29f0b1=_0x2e08b9[_0x39a831(0xc4)](_0x547028=>{const _0x3abd9f=_0x39a831;return{'msgId':_0x547028,'senderShowName':selfInfo[_0x3abd9f(0xf0)]};});return new Promise((_0x1b80e6,_0x4afb6b)=>{const _0xac0549=_0x39a831,_0x51e3e={'KqXMS':function(_0x11b697,_0x39b213){return _0x41a996['gxfWd'](_0x11b697,_0x39b213);},'VRzKc':_0x41a996[_0xac0549(0xb6)]};let _0x449e59=![];const _0x4b0174=_0x3e7fa8=>{const _0x589622=_0xac0549,_0xda1179=_0x3e7fa8[_0x589622(0xc6)]['find'](_0x6784a5=>_0x6784a5[_0x589622(0xd7)]);if(!_0xda1179)return;const _0x21fc7c=JSON[_0x589622(0xbc)](_0xda1179['arkElement'][_0x589622(0xe8)]);if(_0x21fc7c[_0x589622(0xd6)]!=_0x41a996[_0x589622(0xbd)])return;_0x41a996[_0x589622(0xe7)](_0x3e7fa8[_0x589622(0xed)],_0x407b3c[_0x589622(0xed)])&&_0x41a996[_0x589622(0xba)](_0x3e7fa8[_0x589622(0xca)],selfInfo['uid'])&&(_0x449e59=!![],_0x41a996[_0x589622(0xc8)](_0x1b80e6,_0x3e7fa8));};sentMsgTasks[_0xac0549(0xdc)](_0x41a996['ptdOd'](randomUUID),_0x4b0174),setTimeout(()=>{const _0x4eec74=_0xac0549;!_0x449e59&&_0x51e3e['KqXMS'](_0x4afb6b,_0x51e3e[_0x4eec74(0xce)]);},0x1388),napCatCore['session'][_0xac0549(0xbe)]()['multiForwardMsgWithComment'](_0x29f0b1,_0x5bbed9,_0x407b3c,[],new Map());});}}