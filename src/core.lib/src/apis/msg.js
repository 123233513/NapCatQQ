const _0x26c0be=_0x672c;(function(_0x9abe06,_0xd30482){const _0x232107=_0x672c,_0xf5e063=_0x9abe06();while(!![]){try{const _0x479a65=parseInt(_0x232107(0x94))/0x1*(parseInt(_0x232107(0x93))/0x2)+-parseInt(_0x232107(0x7f))/0x3*(-parseInt(_0x232107(0xa0))/0x4)+parseInt(_0x232107(0x99))/0x5+parseInt(_0x232107(0x73))/0x6+parseInt(_0x232107(0x7c))/0x7+parseInt(_0x232107(0x83))/0x8*(parseInt(_0x232107(0x9a))/0x9)+-parseInt(_0x232107(0x77))/0xa;if(_0x479a65===_0xd30482)break;else _0xf5e063['push'](_0xf5e063['shift']());}catch(_0xc9f86b){_0xf5e063['push'](_0xf5e063['shift']());}}}(_0x31a8,0xd748c));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';function _0x672c(_0x3a8898,_0x292fd9){const _0x31a8a7=_0x31a8();return _0x672c=function(_0x672c83,_0x199ca1){_0x672c83=_0x672c83-0x70;let _0x23e4a3=_0x31a8a7[_0x672c83];return _0x23e4a3;},_0x672c(_0x3a8898,_0x292fd9);}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();function _0x31a8(){const _0x450196=['nick','elements','转发消息超时','2963825JyxxmZ','3573OJIjap','fetchRecentContact','sendStatus','chatType','com.tencent.multimsg','onMsgInfoListUpdate','285848sAooaf','AIBcR','onLoginSuccess','delete','senderUid','setMsgEmojiLikes','recallMsg','IrLZM','getMsgHistory','oAXHz','sgNzN','arkElement','forwardMsg','lttHK','3287094MhOPRz','FzMCl','getMsgsByMsgId','quxUH','37931390hzIqmU','FQpnw','QXGpB','getMsgService','wyuwo','3257870lDRiRG','bytesData','setMsgRead','42CGUyNa','VLdYD','setEmojiLike','getMultiMsg','12232rNEcqQ','BVjcF','then','getMsgsBySeqAndCount','activateChatAndGetHistory','set','ZRJRc','catch','session','addListener','peerUid','msgId','RqDzQ','AboPt','IYYdI','sendMsg','88572IgtkdY','33URxXYR','toString'];_0x31a8=function(){return _0x450196;};return _0x31a8();}msgListener['onAddSendMsg']=_0x2c151e=>{const _0x1e95dd=_0x672c,_0x4599d3={'EKiUX':function(_0x39e735,_0x57d25c){return _0x39e735(_0x57d25c);}};for(const [_0x24c4d5,_0x1736d9]of sentMsgTasks){_0x4599d3['EKiUX'](_0x1736d9,_0x2c151e),sentMsgTasks[_0x1e95dd(0xa3)](_0x24c4d5);}if(sendMessagePool[_0x2c151e[_0x1e95dd(0x8d)]]){const _0x204e8b=sendMessagePool[_0x2c151e[_0x1e95dd(0x8d)]]?.(_0x2c151e);_0x204e8b instanceof Promise&&_0x204e8b['then']()[_0x1e95dd(0x8a)](logError);}},msgListener[_0x26c0be(0x9f)]=_0x4704b3=>{const _0x375ec0={'wyuwo':function(_0x72f064,_0xbdc956){return _0x72f064 instanceof _0xbdc956;},'FzMCl':function(_0x43bd12,_0x4a4cb8){return _0x43bd12(_0x4a4cb8);}};_0x4704b3['forEach'](_0x624479=>{const _0x3864b7=_0x672c;new Promise((_0x7d6f1e,_0xb29dca)=>{const _0x11a43e=_0x672c;for(const _0x42dc6f in sendSuccessCBMap){const _0x2ee96f=sendSuccessCBMap[_0x42dc6f],_0xb8f37d=_0x2ee96f(_0x624479),_0x26cac0=_0x20dae8=>{_0x20dae8&&delete sendSuccessCBMap[_0x42dc6f];};_0x375ec0[_0x11a43e(0x7b)](_0xb8f37d,Promise)?_0xb8f37d[_0x11a43e(0x85)](_0x26cac0):_0x375ec0[_0x11a43e(0x74)](_0x26cac0,_0xb8f37d);}})[_0x3864b7(0x85)]()[_0x3864b7(0x8a)](log);});},setTimeout(()=>{const _0x375ce2=_0x26c0be;napCatCore[_0x375ce2(0xa2)](()=>{const _0x3ccba8=_0x375ce2;napCatCore[_0x3ccba8(0x8c)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x26c0be(0x81)](_0x34a67f,_0x351652,_0x1c959d,_0x16b4b3=!![]){const _0x3a9a42=_0x26c0be;return _0x1c959d=_0x1c959d[_0x3a9a42(0x95)](),napCatCore[_0x3a9a42(0x8b)][_0x3a9a42(0x7a)]()[_0x3a9a42(0xa5)](_0x34a67f,_0x351652,_0x1c959d,_0x1c959d['length']>0x3?'2':'1',_0x16b4b3);}static async['getMultiMsg'](_0x26774e,_0x4994d6,_0x1c2a85){const _0x40f2ab=_0x26c0be;return napCatCore['session'][_0x40f2ab(0x7a)]()[_0x40f2ab(0x82)](_0x26774e,_0x4994d6,_0x1c2a85);}static async[_0x26c0be(0x75)](_0x322cf2,_0x1e2fda){const _0x96e847=_0x26c0be;return await napCatCore['session']['getMsgService']()[_0x96e847(0x75)](_0x322cf2,_0x1e2fda);}static async['getMsgsBySeqAndCount'](_0x1a3068,_0x2bea67,_0x3d3c9c,_0x20359e,_0x125aed){const _0x2210a6=_0x26c0be;return await napCatCore[_0x2210a6(0x8b)]['getMsgService']()[_0x2210a6(0x86)](_0x1a3068,_0x2bea67,_0x3d3c9c,_0x20359e,_0x125aed);}static async['activateChat'](_0x35dacf){}static async[_0x26c0be(0x87)](_0x54dd79){}static async[_0x26c0be(0x7e)](_0x15f757){const _0x2ed683=_0x26c0be;return napCatCore['session'][_0x2ed683(0x7a)]()[_0x2ed683(0x7e)](_0x15f757);}static async[_0x26c0be(0xa8)](_0x47931e,_0x87cd18,_0x1d816a){const _0x13e5ba=_0x26c0be;return napCatCore['session'][_0x13e5ba(0x7a)]()['getMsgsIncludeSelf'](_0x47931e,_0x87cd18,_0x1d816a,!![]);}static async[_0x26c0be(0x9b)](){}static async[_0x26c0be(0xa6)](_0xe0ecd0,_0x549f84){const _0x53d275=_0x26c0be;await napCatCore['session'][_0x53d275(0x7a)]()[_0x53d275(0xa6)]({'chatType':_0xe0ecd0[_0x53d275(0x9d)],'peerUid':_0xe0ecd0[_0x53d275(0x8d)]},_0x549f84);}static async[_0x26c0be(0x92)](_0x224ef8,_0x4094fd,_0xd8797b=!![],_0x4a7f9c=0x2710){const _0x49205f=_0x26c0be,_0x3865a5={'FQpnw':'发送超时','IrLZM':function(_0x1fdcb3,_0x5b75e3){return _0x1fdcb3(_0x5b75e3);},'AIBcR':function(_0x2b2048){return _0x2b2048();},'sgNzN':function(_0x581413,_0x2c6219){return _0x581413===_0x2c6219;},'QXGpB':function(_0x7262b4,_0x872340,_0x5dee17){return _0x7262b4(_0x872340,_0x5dee17);},'ZRJRc':function(_0x200eaf){return _0x200eaf();}},_0x1dc478=_0x224ef8['peerUid'];let _0x4e91ad=0x0;const _0x3cb063=async()=>{const _0x4594c4=_0x672c;if(_0x4e91ad>_0x4a7f9c)throw _0x3865a5['FQpnw'];const _0x51528e=sendMessagePool[_0x224ef8[_0x4594c4(0x8d)]];if(_0x51528e)return await _0x3865a5[_0x4594c4(0xa7)](sleep,0x1f4),_0x4e91ad+=0x1f4,await _0x3865a5['AIBcR'](_0x3cb063);else return;};return await _0x3865a5[_0x49205f(0x89)](_0x3cb063),new Promise((_0x2ec394,_0x30dbcc)=>{const _0x1e997a=_0x49205f,_0x21eef={'fkEzV':function(_0x46a05c,_0x337ffa){const _0x324094=_0x672c;return _0x3865a5[_0x324094(0xaa)](_0x46a05c,_0x337ffa);},'IYYdI':function(_0x1ceee9,_0x4f3305){return _0x1ceee9(_0x4f3305);}};let _0x5d838c=![],_0x40f283=null;const _0x48d799=_0x3865a5[_0x1e997a(0xa1)](randomUUID);sendSuccessCBMap[_0x48d799]=_0x10f517=>{const _0x3bc8c5=_0x1e997a;if(_0x21eef['fkEzV'](_0x10f517[_0x3bc8c5(0x8e)],_0x40f283?.['msgId'])){if(_0x10f517[_0x3bc8c5(0x9c)]===0x2)return delete sendSuccessCBMap[_0x48d799],_0x5d838c=!![],_0x21eef[_0x3bc8c5(0x91)](_0x2ec394,_0x10f517),!![];return![];}return![];},sendMessagePool[_0x1dc478]=async _0x5ce37f=>{delete sendMessagePool[_0x1dc478],_0x40f283=_0x5ce37f;},_0x3865a5[_0x1e997a(0x79)](setTimeout,()=>{const _0x442424=_0x1e997a;if(_0x5d838c)return;delete sendMessagePool[_0x1dc478],delete sendSuccessCBMap[_0x48d799],_0x3865a5[_0x442424(0xa7)](_0x30dbcc,_0x3865a5[_0x442424(0x78)]);},_0x4a7f9c);const _0x24b292=napCatCore[_0x1e997a(0x8b)][_0x1e997a(0x7a)]()[_0x1e997a(0x92)]('0',_0x224ef8,_0x4094fd,new Map());});}static async[_0x26c0be(0x71)](_0x5c23a7,_0x368e10,_0x1ef42e){const _0x17a289=_0x26c0be;return napCatCore[_0x17a289(0x8b)][_0x17a289(0x7a)]()['forwardMsg'](_0x1ef42e,_0x5c23a7,[_0x368e10],new Map());}static async['multiForwardMsg'](_0x550352,_0x4721a4,_0x2455aa){const _0x15f3b7=_0x26c0be,_0x217165={'oAXHz':function(_0x5b3f15,_0x3df4e6){return _0x5b3f15!=_0x3df4e6;},'AboPt':_0x15f3b7(0x9e),'lttHK':function(_0x213b88,_0x391d47){return _0x213b88==_0x391d47;},'BVjcF':function(_0x103011,_0x31af13){return _0x103011==_0x31af13;},'OLhUY':function(_0xbac1cc,_0xddcfb){return _0xbac1cc(_0xddcfb);},'qqwWA':_0x15f3b7(0x98),'VLdYD':function(_0x24a3f9){return _0x24a3f9();},'RqDzQ':function(_0x26a8dd,_0x2d7afa,_0x42c206){return _0x26a8dd(_0x2d7afa,_0x42c206);}},_0x5eed83=_0x2455aa['map'](_0x4b683a=>{const _0x232bc6=_0x15f3b7;return{'msgId':_0x4b683a,'senderShowName':selfInfo[_0x232bc6(0x96)]};});return new Promise((_0x26844,_0x278910)=>{const _0x1466e9=_0x15f3b7,_0x45db1a={'quxUH':function(_0x42f876,_0x56463e){return _0x42f876(_0x56463e);},'JwXxC':_0x217165['qqwWA']};let _0x3b1f34=![];const _0x5e44ae=_0x23ae72=>{const _0x1570ad=_0x672c,_0x185a49=_0x23ae72[_0x1570ad(0x97)]['find'](_0x5627bd=>_0x5627bd['arkElement']);if(!_0x185a49)return;const _0x42e0d9=JSON['parse'](_0x185a49[_0x1570ad(0x70)][_0x1570ad(0x7d)]);if(_0x217165[_0x1570ad(0xa9)](_0x42e0d9['app'],_0x217165[_0x1570ad(0x90)]))return;_0x217165[_0x1570ad(0x72)](_0x23ae72[_0x1570ad(0x8d)],_0x4721a4[_0x1570ad(0x8d)])&&_0x217165[_0x1570ad(0x84)](_0x23ae72[_0x1570ad(0xa4)],selfInfo['uid'])&&(_0x3b1f34=!![],_0x217165['OLhUY'](_0x26844,_0x23ae72));};sentMsgTasks[_0x1466e9(0x88)](_0x217165[_0x1466e9(0x80)](randomUUID),_0x5e44ae),_0x217165[_0x1466e9(0x8f)](setTimeout,()=>{const _0x543979=_0x1466e9;!_0x3b1f34&&_0x45db1a[_0x543979(0x76)](_0x278910,_0x45db1a['JwXxC']);},0x1388),napCatCore[_0x1466e9(0x8b)][_0x1466e9(0x7a)]()['multiForwardMsgWithComment'](_0x5eed83,_0x550352,_0x4721a4,[],new Map());});}}