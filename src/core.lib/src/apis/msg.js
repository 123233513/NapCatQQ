const _0x1cb803=_0x43ce;function _0x43ce(_0x45dc6f,_0x28a70c){const _0x371a93=_0x371a();return _0x43ce=function(_0x43cea6,_0x5b820f){_0x43cea6=_0x43cea6-0x1ad;let _0x574faf=_0x371a93[_0x43cea6];return _0x574faf;},_0x43ce(_0x45dc6f,_0x28a70c);}(function(_0x54076b,_0x5690ba){const _0x38a33a=_0x43ce,_0x4126bd=_0x54076b();while(!![]){try{const _0xf5bd1e=-parseInt(_0x38a33a(0x1d5))/0x1*(parseInt(_0x38a33a(0x1af))/0x2)+parseInt(_0x38a33a(0x1ce))/0x3*(parseInt(_0x38a33a(0x1c1))/0x4)+-parseInt(_0x38a33a(0x1e5))/0x5+-parseInt(_0x38a33a(0x1e4))/0x6+-parseInt(_0x38a33a(0x1ea))/0x7+parseInt(_0x38a33a(0x1eb))/0x8+parseInt(_0x38a33a(0x1df))/0x9*(parseInt(_0x38a33a(0x1d7))/0xa);if(_0xf5bd1e===_0x5690ba)break;else _0x4126bd['push'](_0x4126bd['shift']());}catch(_0x4b9524){_0x4126bd['push'](_0x4126bd['shift']());}}}(_0x371a,0xe5862));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();function _0x371a(){const _0x26eefa=['recallMsg','3fLRssZ','KbxIU','com.tencent.multimsg','peerUid','multiForwardMsgWithComment','then','dOjHI','24551ofjNqv','bytesData','39860kPnglU','chatType','KMjDm','GWYSR','catch','getMsgsIncludeSelf','sendMsg','forEach','7083YeXaSR','Fiycp','sendStatus','hrsGQ','SzrFa','5051658kWEvqc','6225470MRttUm','app','getMsgHistory','fetchRecentContact','setMsgRead','9993823sckFTx','3598136CYUiXr','activateChatAndGetHistory','aFKQc','42LlgZMy','eZOMI','delete','getMsgService','getMultiMsg','multiForwardMsg','uid','getMsgsByMsgId','parse','McsAs','forwardMsg','onMsgInfoListUpdate','msgId','sWLEI','OvnxQ','addListener','转发消息超时','setEmojiLike','5534712TBCykY','getMsgsBySeqAndCount','find','length','bXbMZ','wSung','jpktL','activateChat','session','iCdvg','发送超时','setMsgEmojiLikes'];_0x371a=function(){return _0x26eefa;};return _0x371a();}msgListener['onAddSendMsg']=_0xf7df8=>{const _0x3aec66=_0x43ce,_0x2857c9={'eZOMI':function(_0x2cdfdb,_0x3ce180){return _0x2cdfdb(_0x3ce180);},'McsAs':function(_0x5c277a,_0x9fcb59){return _0x5c277a instanceof _0x9fcb59;}};for(const [_0x1c4b99,_0x3d2f2f]of sentMsgTasks){_0x2857c9[_0x3aec66(0x1b0)](_0x3d2f2f,_0xf7df8),sentMsgTasks[_0x3aec66(0x1b1)](_0x1c4b99);}if(sendMessagePool[_0xf7df8[_0x3aec66(0x1d1)]]){const _0x5626a0=sendMessagePool[_0xf7df8[_0x3aec66(0x1d1)]]?.(_0xf7df8);_0x2857c9[_0x3aec66(0x1b8)](_0x5626a0,Promise)&&_0x5626a0[_0x3aec66(0x1d3)]()[_0x3aec66(0x1db)](logError);}},msgListener[_0x1cb803(0x1ba)]=_0x19f3a9=>{const _0x28d5df=_0x1cb803,_0x216be3={'kxeTf':function(_0x47f4f0,_0xa4d213){return _0x47f4f0(_0xa4d213);},'bXbMZ':function(_0x4547fe,_0xb73316){return _0x4547fe instanceof _0xb73316;}};_0x19f3a9[_0x28d5df(0x1de)](_0x5a7505=>{const _0x5e11ad=_0x28d5df;new Promise((_0x3112de,_0xe321b9)=>{const _0x1eecc5=_0x43ce;for(const _0x4ef6e2 in sendSuccessCBMap){const _0x2d2f9e=sendSuccessCBMap[_0x4ef6e2],_0x8f1a5b=_0x216be3['kxeTf'](_0x2d2f9e,_0x5a7505),_0x317998=_0x2c413c=>{_0x2c413c&&delete sendSuccessCBMap[_0x4ef6e2];};_0x216be3[_0x1eecc5(0x1c5)](_0x8f1a5b,Promise)?_0x8f1a5b['then'](_0x317998):_0x317998(_0x8f1a5b);}})[_0x5e11ad(0x1d3)]()[_0x5e11ad(0x1db)](log);});},setTimeout(()=>{napCatCore['onLoginSuccess'](()=>{const _0x1c6d2f=_0x43ce;napCatCore[_0x1c6d2f(0x1be)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x1cb803(0x1c0)](_0x3cbfdd,_0x169487,_0x348f6c,_0x26b59b=!![]){const _0x256ec6=_0x1cb803;return _0x348f6c=_0x348f6c['toString'](),napCatCore[_0x256ec6(0x1c9)][_0x256ec6(0x1b2)]()[_0x256ec6(0x1cc)](_0x3cbfdd,_0x169487,_0x348f6c,_0x348f6c[_0x256ec6(0x1c4)]>0x3?'2':'1',_0x26b59b);}static async['getMultiMsg'](_0xdb3cfa,_0x18a906,_0x4b31eb){const _0x521793=_0x1cb803;return napCatCore[_0x521793(0x1c9)][_0x521793(0x1b2)]()[_0x521793(0x1b3)](_0xdb3cfa,_0x18a906,_0x4b31eb);}static async['getMsgsByMsgId'](_0x192b67,_0x10d54c){const _0x56ace3=_0x1cb803;return await napCatCore[_0x56ace3(0x1c9)][_0x56ace3(0x1b2)]()[_0x56ace3(0x1b6)](_0x192b67,_0x10d54c);}static async[_0x1cb803(0x1c2)](_0x24397b,_0x42ce23,_0x1724cf,_0x419c46,_0x1b569d){const _0x3ffa2b=_0x1cb803;return await napCatCore[_0x3ffa2b(0x1c9)][_0x3ffa2b(0x1b2)]()[_0x3ffa2b(0x1c2)](_0x24397b,_0x42ce23,_0x1724cf,_0x419c46,_0x1b569d);}static async[_0x1cb803(0x1c8)](_0x3d7113){}static async[_0x1cb803(0x1ad)](_0x31c7e5){}static async[_0x1cb803(0x1e9)](_0x1815b7){const _0x10e803=_0x1cb803;return napCatCore[_0x10e803(0x1c9)][_0x10e803(0x1b2)]()[_0x10e803(0x1e9)](_0x1815b7);}static async[_0x1cb803(0x1e7)](_0x2dc9a1,_0x40648f,_0x4d3521){const _0x11f54d=_0x1cb803;return napCatCore[_0x11f54d(0x1c9)]['getMsgService']()[_0x11f54d(0x1dc)](_0x2dc9a1,_0x40648f,_0x4d3521,!![]);}static async[_0x1cb803(0x1e8)](){}static async[_0x1cb803(0x1cd)](_0x129f4a,_0x474ec4){const _0x4abe65=_0x1cb803;await napCatCore[_0x4abe65(0x1c9)][_0x4abe65(0x1b2)]()[_0x4abe65(0x1cd)]({'chatType':_0x129f4a[_0x4abe65(0x1d8)],'peerUid':_0x129f4a[_0x4abe65(0x1d1)]},_0x474ec4);}static async[_0x1cb803(0x1dd)](_0x46c7b6,_0x593a4a,_0xe2ac0f=!![],_0xf6d3ec=0x2710){const _0x1f8e6f=_0x1cb803,_0x93046={'GWYSR':function(_0x110684,_0x7df369){return _0x110684>_0x7df369;},'hMimd':_0x1f8e6f(0x1cb),'KMjDm':function(_0x4f9c6f,_0x551c15){return _0x4f9c6f(_0x551c15);},'OvnxQ':function(_0x3824b0){return _0x3824b0();},'iCdvg':function(_0x32e3b2){return _0x32e3b2();},'sWLEI':function(_0x5ea8d7,_0x4de7e9,_0x5825c3){return _0x5ea8d7(_0x4de7e9,_0x5825c3);},'hrsGQ':function(_0x18a3e1){return _0x18a3e1();}},_0x105982=_0x46c7b6['peerUid'];let _0x3596bd=0x0;const _0x3d8e5f=async()=>{const _0x28009d=_0x1f8e6f;if(_0x93046[_0x28009d(0x1da)](_0x3596bd,_0xf6d3ec))throw _0x93046['hMimd'];const _0x1cc4c3=sendMessagePool[_0x46c7b6[_0x28009d(0x1d1)]];if(_0x1cc4c3)return await _0x93046[_0x28009d(0x1d9)](sleep,0x1f4),_0x3596bd+=0x1f4,await _0x93046[_0x28009d(0x1bd)](_0x3d8e5f);else return;};return await _0x93046[_0x1f8e6f(0x1e2)](_0x3d8e5f),new Promise((_0x30bb83,_0x30562a)=>{const _0x1f9e80=_0x1f8e6f,_0x6d7567={'KbxIU':function(_0x1296fc,_0x4aee48){return _0x1296fc===_0x4aee48;},'PyiJi':function(_0x5b9de9,_0x4fd46c){const _0x46c372=_0x43ce;return _0x93046[_0x46c372(0x1d9)](_0x5b9de9,_0x4fd46c);}};let _0x43e900=![],_0x44c541=null;const _0x143e49=_0x93046[_0x1f9e80(0x1ca)](randomUUID);sendSuccessCBMap[_0x143e49]=_0x5046b5=>{const _0x522ce5=_0x1f9e80;if(_0x6d7567[_0x522ce5(0x1cf)](_0x5046b5['msgId'],_0x44c541?.[_0x522ce5(0x1bb)])){if(_0x6d7567[_0x522ce5(0x1cf)](_0x5046b5[_0x522ce5(0x1e1)],0x2))return delete sendSuccessCBMap[_0x143e49],_0x43e900=!![],_0x6d7567['PyiJi'](_0x30bb83,_0x5046b5),!![];return![];}return![];},sendMessagePool[_0x105982]=async _0x1c4f50=>{delete sendMessagePool[_0x105982],_0x44c541=_0x1c4f50;},_0x93046[_0x1f9e80(0x1bc)](setTimeout,()=>{const _0x5414bd=_0x1f9e80;if(_0x43e900)return;delete sendMessagePool[_0x105982],delete sendSuccessCBMap[_0x143e49],_0x6d7567['PyiJi'](_0x30562a,_0x5414bd(0x1cb));},_0xf6d3ec);const _0x1200d5=napCatCore[_0x1f9e80(0x1c9)]['getMsgService']()[_0x1f9e80(0x1dd)]('0',_0x46c7b6,_0x593a4a,new Map());});}static async['forwardMsg'](_0x3e92c2,_0x511560,_0x2cdd06){const _0x3c694a=_0x1cb803;return napCatCore[_0x3c694a(0x1c9)][_0x3c694a(0x1b2)]()[_0x3c694a(0x1b9)](_0x2cdd06,_0x3e92c2,[_0x511560],new Map());}static async[_0x1cb803(0x1b4)](_0x366459,_0x208bb4,_0x3f30b1){const _0x2e8891=_0x1cb803,_0x2722e2={'dOjHI':function(_0x23f3b6,_0x2dbea1){return _0x23f3b6!=_0x2dbea1;},'Fiycp':_0x2e8891(0x1d0),'tyQKT':function(_0x2b0798,_0x526f7c){return _0x2b0798==_0x526f7c;},'QXXju':function(_0x1642ac,_0x3d6435){return _0x1642ac(_0x3d6435);},'SzrFa':_0x2e8891(0x1bf),'aFKQc':function(_0x3087f6,_0x328253,_0x126d3d){return _0x3087f6(_0x328253,_0x126d3d);}},_0x56a033=_0x3f30b1['map'](_0x4c9107=>{return{'msgId':_0x4c9107,'senderShowName':selfInfo['nick']};});return new Promise((_0x942684,_0x461b27)=>{const _0x1e19a8=_0x2e8891,_0x378eb2={'wSung':function(_0x43954d,_0x181574){return _0x43954d(_0x181574);},'jpktL':_0x2722e2[_0x1e19a8(0x1e3)]};let _0x2ecaa8=![];const _0x59082d=_0x1a1d0e=>{const _0x4515aa=_0x1e19a8,_0x43ce3e=_0x1a1d0e['elements'][_0x4515aa(0x1c3)](_0x9900fd=>_0x9900fd['arkElement']);if(!_0x43ce3e)return;const _0x718512=JSON[_0x4515aa(0x1b7)](_0x43ce3e['arkElement'][_0x4515aa(0x1d6)]);if(_0x2722e2[_0x4515aa(0x1d4)](_0x718512[_0x4515aa(0x1e6)],_0x2722e2[_0x4515aa(0x1e0)]))return;_0x1a1d0e[_0x4515aa(0x1d1)]==_0x208bb4[_0x4515aa(0x1d1)]&&_0x2722e2['tyQKT'](_0x1a1d0e['senderUid'],selfInfo[_0x4515aa(0x1b5)])&&(_0x2ecaa8=!![],_0x2722e2['QXXju'](_0x942684,_0x1a1d0e));};sentMsgTasks['set'](randomUUID(),_0x59082d),_0x2722e2[_0x1e19a8(0x1ae)](setTimeout,()=>{const _0x1aad71=_0x1e19a8;!_0x2ecaa8&&_0x378eb2[_0x1aad71(0x1c6)](_0x461b27,_0x378eb2[_0x1aad71(0x1c7)]);},0x1388),napCatCore[_0x1e19a8(0x1c9)]['getMsgService']()[_0x1e19a8(0x1d2)](_0x56a033,_0x366459,_0x208bb4,[],new Map());});}}