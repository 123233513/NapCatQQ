const _0x2e9d65=_0x3102;(function(_0x11f441,_0x48573f){const _0x535b31=_0x3102,_0x521051=_0x11f441();while(!![]){try{const _0xd864af=parseInt(_0x535b31(0x130))/0x1+-parseInt(_0x535b31(0x12b))/0x2+parseInt(_0x535b31(0x114))/0x3+-parseInt(_0x535b31(0x112))/0x4+parseInt(_0x535b31(0x136))/0x5*(parseInt(_0x535b31(0x115))/0x6)+-parseInt(_0x535b31(0x109))/0x7*(parseInt(_0x535b31(0x135))/0x8)+parseInt(_0x535b31(0x125))/0x9;if(_0xd864af===_0x48573f)break;else _0x521051['push'](_0x521051['shift']());}catch(_0x26fde1){_0x521051['push'](_0x521051['shift']());}}}(_0x3ef9,0x2b0d8));function _0x3102(_0x408cb3,_0x2d3efb){const _0x3ef901=_0x3ef9();return _0x3102=function(_0x3102a6,_0x26062e){_0x3102a6=_0x3102a6-0x105;let _0x363c59=_0x3ef901[_0x3102a6];return _0x363c59;},_0x3102(_0x408cb3,_0x2d3efb);}import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';function _0x3ef9(){const _0xe47ca=['multiForwardMsg','arkElement','yTURY','forEach','发送超时','elements','forwardMsg','mvAoj','getMsgsBySeqAndCount','转发消息超时','getMsgsIncludeSelf','toString','NuwDl','epniU','setEmojiLike','1761246MhQpQv','parse','getMsgHistory','catch','length','xSrgJ','106244BVlFaY','fetchRecentContact','onMsgInfoListUpdate','delete','paxSs','163630RiAFJG','app','addListener','JOIbI','chatType','8TvVmbF','269745FyzKbA','find','setMsgRead','setMsgEmojiLikes','MfSXq','then','onAddSendMsg','recallMsg','multiForwardMsgWithComment','sendMsg','bytesData','session','activateChatAndGetHistory','cWCzX','getMultiMsg','mcOdb','activateChat','set','NWhYk','536270gxRwKH','getMsgService','nick','onLoginSuccess','ePdcB','peerUid','getMsgsByMsgId','map','senderUid','978932tzENgL','msgId','412608ESPWOD','6MosYJD'];_0x3ef9=function(){return _0xe47ca;};return _0x3ef9();}import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x2e9d65(0x13c)]=_0x38c0e0=>{const _0x4e0be8=_0x2e9d65,_0x4ae544={'MfSXq':function(_0x2e2219,_0x4958ed){return _0x2e2219(_0x4958ed);}};for(const [_0x41a0e5,_0xa372c5]of sentMsgTasks){_0x4ae544[_0x4e0be8(0x13a)](_0xa372c5,_0x38c0e0),sentMsgTasks[_0x4e0be8(0x12e)](_0x41a0e5);}if(sendMessagePool[_0x38c0e0[_0x4e0be8(0x10e)]]){const _0x569194=sendMessagePool[_0x38c0e0['peerUid']]?.(_0x38c0e0);_0x569194 instanceof Promise&&_0x569194[_0x4e0be8(0x13b)]()[_0x4e0be8(0x128)](logError);}},msgListener[_0x2e9d65(0x12d)]=_0x5ad43a=>{const _0x300e78=_0x2e9d65,_0x59482f={'lbyKg':function(_0x44cc49,_0x18e7b7){return _0x44cc49(_0x18e7b7);},'paxSs':function(_0x264895,_0x2bad14){return _0x264895 instanceof _0x2bad14;},'fRtCJ':function(_0x14bbfc,_0x127274){return _0x14bbfc(_0x127274);}};_0x5ad43a[_0x300e78(0x119)](_0x203a59=>{const _0x24a581=_0x300e78;new Promise((_0x5de525,_0x5a1c2c)=>{const _0x5aa473=_0x3102;for(const _0x26355d in sendSuccessCBMap){const _0x2c8a07=sendSuccessCBMap[_0x26355d],_0x405e42=_0x59482f['lbyKg'](_0x2c8a07,_0x203a59),_0x56f76a=_0x352c9b=>{_0x352c9b&&delete sendSuccessCBMap[_0x26355d];};_0x59482f[_0x5aa473(0x12f)](_0x405e42,Promise)?_0x405e42[_0x5aa473(0x13b)](_0x56f76a):_0x59482f['fRtCJ'](_0x56f76a,_0x405e42);}})['then']()[_0x24a581(0x128)](log);});},setTimeout(()=>{const _0x3e1072=_0x2e9d65;napCatCore[_0x3e1072(0x10c)](()=>{const _0x375ee8=_0x3e1072;napCatCore[_0x375ee8(0x132)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x2e9d65(0x124)](_0x7dd64f,_0x176619,_0x369a89,_0x1ddabc=!![]){const _0x35628e=_0x2e9d65,_0x4a19da={'mcOdb':function(_0x29384d,_0x18a86c){return _0x29384d>_0x18a86c;}};return _0x369a89=_0x369a89[_0x35628e(0x121)](),napCatCore[_0x35628e(0x141)]['getMsgService']()[_0x35628e(0x139)](_0x7dd64f,_0x176619,_0x369a89,_0x4a19da[_0x35628e(0x105)](_0x369a89[_0x35628e(0x129)],0x3)?'2':'1',_0x1ddabc);}static async[_0x2e9d65(0x144)](_0x1871c5,_0x1681c0,_0xe4711d){const _0x660106=_0x2e9d65;return napCatCore[_0x660106(0x141)]['getMsgService']()[_0x660106(0x144)](_0x1871c5,_0x1681c0,_0xe4711d);}static async[_0x2e9d65(0x10f)](_0x2fd946,_0xbb9f90){const _0xb40d9e=_0x2e9d65;return await napCatCore[_0xb40d9e(0x141)]['getMsgService']()[_0xb40d9e(0x10f)](_0x2fd946,_0xbb9f90);}static async['getMsgsBySeqAndCount'](_0x4e4c3d,_0x2d7307,_0x55f3ae,_0x142129,_0x376206){const _0x10c166=_0x2e9d65;return await napCatCore[_0x10c166(0x141)][_0x10c166(0x10a)]()[_0x10c166(0x11e)](_0x4e4c3d,_0x2d7307,_0x55f3ae,_0x142129,_0x376206);}static async[_0x2e9d65(0x106)](_0xb72484){}static async[_0x2e9d65(0x142)](_0x5a755b){}static async[_0x2e9d65(0x138)](_0x343265){const _0xd7302=_0x2e9d65;return napCatCore['session'][_0xd7302(0x10a)]()[_0xd7302(0x138)](_0x343265);}static async[_0x2e9d65(0x127)](_0x235278,_0x40e24f,_0x86d39e){const _0x12fe39=_0x2e9d65;return napCatCore[_0x12fe39(0x141)][_0x12fe39(0x10a)]()[_0x12fe39(0x120)](_0x235278,_0x40e24f,_0x86d39e,!![]);}static async[_0x2e9d65(0x12c)](){}static async[_0x2e9d65(0x13d)](_0x189662,_0x16c966){const _0x17e55c=_0x2e9d65;await napCatCore[_0x17e55c(0x141)][_0x17e55c(0x10a)]()[_0x17e55c(0x13d)]({'chatType':_0x189662[_0x17e55c(0x134)],'peerUid':_0x189662[_0x17e55c(0x10e)]},_0x16c966);}static async[_0x2e9d65(0x13f)](_0x912a58,_0x1358be,_0x479059=!![],_0x54f8f4=0x2710){const _0x44c258=_0x2e9d65,_0x16a3a4={'oazsZ':function(_0x164d00,_0x4c3225){return _0x164d00>_0x4c3225;},'NuwDl':_0x44c258(0x11a),'ePdcB':function(_0x1f00bf,_0x120ff5){return _0x1f00bf(_0x120ff5);},'NWhYk':function(_0x17af05,_0x2dd5d2){return _0x17af05===_0x2dd5d2;},'yRKtH':function(_0x1811d9,_0x128c40){return _0x1811d9===_0x128c40;},'epniU':function(_0x16f971,_0x5c12a8,_0x576f42){return _0x16f971(_0x5c12a8,_0x576f42);},'nJXjB':function(_0x499e70){return _0x499e70();}},_0x309d00=_0x912a58[_0x44c258(0x10e)];let _0x2eb064=0x0;const _0x137e35=async()=>{const _0xb63d40=_0x44c258;if(_0x16a3a4['oazsZ'](_0x2eb064,_0x54f8f4))throw _0x16a3a4[_0xb63d40(0x122)];const _0x3c035a=sendMessagePool[_0x912a58[_0xb63d40(0x10e)]];if(_0x3c035a)return await _0x16a3a4['ePdcB'](sleep,0x1f4),_0x2eb064+=0x1f4,await _0x137e35();else return;};return await _0x16a3a4['nJXjB'](_0x137e35),new Promise((_0x29a270,_0x2787b3)=>{const _0x6124ad=_0x44c258;let _0x2a3eb9=![],_0x4a5def=null;const _0x5a7a22=randomUUID();sendSuccessCBMap[_0x5a7a22]=_0x115bff=>{const _0x5789c8=_0x3102;if(_0x16a3a4[_0x5789c8(0x108)](_0x115bff['msgId'],_0x4a5def?.[_0x5789c8(0x113)])){if(_0x16a3a4['yRKtH'](_0x115bff['sendStatus'],0x2))return delete sendSuccessCBMap[_0x5a7a22],_0x2a3eb9=!![],_0x16a3a4[_0x5789c8(0x10d)](_0x29a270,_0x115bff),!![];return![];}return![];},sendMessagePool[_0x309d00]=async _0x21dd32=>{delete sendMessagePool[_0x309d00],_0x4a5def=_0x21dd32;},_0x16a3a4[_0x6124ad(0x123)](setTimeout,()=>{const _0x2c595e=_0x6124ad;if(_0x2a3eb9)return;delete sendMessagePool[_0x309d00],delete sendSuccessCBMap[_0x5a7a22],_0x2787b3(_0x16a3a4[_0x2c595e(0x122)]);},_0x54f8f4);const _0x2588aa=napCatCore[_0x6124ad(0x141)][_0x6124ad(0x10a)]()[_0x6124ad(0x13f)]('0',_0x912a58,_0x1358be,new Map());});}static async['forwardMsg'](_0x5c5077,_0x4deff6,_0x5e7e53){const _0x336662=_0x2e9d65;return napCatCore[_0x336662(0x141)][_0x336662(0x10a)]()[_0x336662(0x11c)](_0x5e7e53,_0x5c5077,[_0x4deff6],new Map());}static async[_0x2e9d65(0x116)](_0x445ef0,_0x3a5f46,_0x452e7b){const _0x289a2b=_0x2e9d65,_0x15e7ca={'XgMbk':_0x289a2b(0x11f),'xSrgJ':function(_0x356d86){return _0x356d86();},'cWCzX':function(_0x2f0424,_0x2165e8,_0x1eff2c){return _0x2f0424(_0x2165e8,_0x1eff2c);}},_0x1bbd98=_0x452e7b[_0x289a2b(0x110)](_0x3e6521=>{const _0x227b3b=_0x289a2b;return{'msgId':_0x3e6521,'senderShowName':selfInfo[_0x227b3b(0x10b)]};});return new Promise((_0x44805e,_0x485a92)=>{const _0x303e14=_0x289a2b,_0x2be8b8={'mvAoj':'com.tencent.multimsg','JOIbI':function(_0x2262bb,_0x44b555){return _0x2262bb==_0x44b555;},'NVOpb':function(_0x199c59,_0x273062){return _0x199c59==_0x273062;},'yTURY':function(_0x5922fe,_0x3df2a5){return _0x5922fe(_0x3df2a5);},'XnMgL':_0x15e7ca['XgMbk']};let _0x27a313=![];const _0x40021d=_0x436daa=>{const _0x13776b=_0x3102,_0xaff38f=_0x436daa[_0x13776b(0x11b)][_0x13776b(0x137)](_0x342c80=>_0x342c80[_0x13776b(0x117)]);if(!_0xaff38f)return;const _0x3bd073=JSON[_0x13776b(0x126)](_0xaff38f[_0x13776b(0x117)][_0x13776b(0x140)]);if(_0x3bd073[_0x13776b(0x131)]!=_0x2be8b8[_0x13776b(0x11d)])return;_0x2be8b8[_0x13776b(0x133)](_0x436daa['peerUid'],_0x3a5f46['peerUid'])&&_0x2be8b8['NVOpb'](_0x436daa[_0x13776b(0x111)],selfInfo['uid'])&&(_0x27a313=!![],_0x2be8b8[_0x13776b(0x118)](_0x44805e,_0x436daa));};sentMsgTasks[_0x303e14(0x107)](_0x15e7ca[_0x303e14(0x12a)](randomUUID),_0x40021d),_0x15e7ca[_0x303e14(0x143)](setTimeout,()=>{!_0x27a313&&_0x2be8b8['yTURY'](_0x485a92,_0x2be8b8['XnMgL']);},0x1388),napCatCore[_0x303e14(0x141)]['getMsgService']()[_0x303e14(0x13e)](_0x1bbd98,_0x445ef0,_0x3a5f46,[],new Map());});}}