const _0x484e3e=_0x5b28;(function(_0x1c82dc,_0x3d75cb){const _0x320a63=_0x5b28,_0x42f0ff=_0x1c82dc();while(!![]){try{const _0x50c10c=-parseInt(_0x320a63(0x199))/0x1+-parseInt(_0x320a63(0x1ae))/0x2*(parseInt(_0x320a63(0x188))/0x3)+-parseInt(_0x320a63(0x182))/0x4*(-parseInt(_0x320a63(0x18e))/0x5)+-parseInt(_0x320a63(0x1a0))/0x6+-parseInt(_0x320a63(0x19c))/0x7*(parseInt(_0x320a63(0x1b4))/0x8)+-parseInt(_0x320a63(0x1ba))/0x9+parseInt(_0x320a63(0x184))/0xa;if(_0x50c10c===_0x3d75cb)break;else _0x42f0ff['push'](_0x42f0ff['shift']());}catch(_0x3c1828){_0x42f0ff['push'](_0x42f0ff['shift']());}}}(_0x1720,0x8b859));function _0x5b28(_0x2e6740,_0x36c511){const _0x1720a9=_0x1720();return _0x5b28=function(_0x5b2816,_0x2ac5e1){_0x5b2816=_0x5b2816-0x182;let _0x5001d4=_0x1720a9[_0x5b2816];return _0x5001d4;},_0x5b28(_0x2e6740,_0x36c511);}import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';function _0x1720(){const _0x12fd4f=['43857MOFiLs','ThgCE','set','getMsgService','toString','ZCfyf','5ulPbpo','sendStatus','FDdKf','getMultiMsg','app','getMsgHistory','find','euhsg','arkElement','activateChatAndGetHistory','TycAT','336733yNGlEK','session','addListener','413tvHnrH','guildId','multiForwardMsg','ZTRlN','4135716sFczhG','iByvV','map','PvAvL','uid','COain','then','setEmojiLike','getMsgsByMsgId','cbVsY','onLoginSuccess','msgId','forwardMsg','OzMjd','116flFZdT','转发消息超时','senderUid','CHKFp','chatType','setMsgEmojiLikes','5296mheevH','EiOeR','recallMsg','length','HJzmB','onMsgInfoListUpdate','4559409VyykUZ','fbXHd','multiForwardMsgWithComment','fetchRecentContact','setMsgRead','sendMsg','getMsgsBySeqAndCount','3898276ZCKFBM','peerUid','20164920Cpjhzk','mzZET','bytesData','Cwoxk'];_0x1720=function(){return _0x12fd4f;};return _0x1720();}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onAddSendMsg']=_0x151b3e=>{const _0x835477=_0x5b28,_0x562cef={'HJzmB':function(_0x37090c,_0x347432){return _0x37090c(_0x347432);},'PvAvL':function(_0x3758c9,_0x4d5e73){return _0x3758c9 instanceof _0x4d5e73;}};for(const [_0xa37b0f,_0x4d9e94]of sentMsgTasks){_0x562cef[_0x835477(0x1b8)](_0x4d9e94,_0x151b3e),sentMsgTasks['delete'](_0xa37b0f);}if(sendMessagePool[_0x151b3e[_0x835477(0x183)]]){const _0x2185b8=sendMessagePool[_0x151b3e['peerUid']]?.(_0x151b3e);_0x562cef[_0x835477(0x1a3)](_0x2185b8,Promise)&&_0x2185b8[_0x835477(0x1a6)]()['catch'](logError);}},msgListener[_0x484e3e(0x1b9)]=_0x7fb6bd=>{const _0x2e5865={'VHKAu':function(_0xc42bf9,_0x2ba880){return _0xc42bf9(_0x2ba880);},'COain':function(_0x348818,_0x1c24d1){return _0x348818 instanceof _0x1c24d1;},'euhsg':function(_0x44ef86,_0x34e9b7){return _0x44ef86(_0x34e9b7);}};_0x7fb6bd['forEach'](_0x5c4da3=>{const _0x246017=_0x5b28;new Promise((_0x2d22f1,_0x19d97b)=>{const _0x2dcc7c=_0x5b28;for(const _0x440d71 in sendSuccessCBMap){const _0x50b07d=sendSuccessCBMap[_0x440d71],_0x14a162=_0x2e5865['VHKAu'](_0x50b07d,_0x5c4da3),_0x558f75=_0x1e3e09=>{_0x1e3e09&&delete sendSuccessCBMap[_0x440d71];};_0x2e5865[_0x2dcc7c(0x1a5)](_0x14a162,Promise)?_0x14a162['then'](_0x558f75):_0x2e5865[_0x2dcc7c(0x195)](_0x558f75,_0x14a162);}})[_0x246017(0x1a6)]()['catch'](log);});},setTimeout(()=>{const _0x249cf8=_0x484e3e;napCatCore[_0x249cf8(0x1aa)](()=>{const _0x1c5580=_0x249cf8;napCatCore[_0x1c5580(0x19b)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x484e3e(0x1a7)](_0x5283f4,_0x399649,_0x542980,_0x33762d=!![]){const _0x5cda7b=_0x484e3e,_0x594548={'srRqz':function(_0x4ff5ba,_0x504f40){return _0x4ff5ba>_0x504f40;}};return _0x542980=_0x542980[_0x5cda7b(0x18c)](),napCatCore[_0x5cda7b(0x19a)][_0x5cda7b(0x18b)]()[_0x5cda7b(0x1b3)](_0x5283f4,_0x399649,_0x542980,_0x594548['srRqz'](_0x542980[_0x5cda7b(0x1b7)],0x3)?'2':'1',_0x33762d);}static async[_0x484e3e(0x191)](_0x5b0c13,_0x279264,_0x197061){const _0x52ff30=_0x484e3e;return napCatCore['session'][_0x52ff30(0x18b)]()[_0x52ff30(0x191)](_0x5b0c13,_0x279264,_0x197061);}static async[_0x484e3e(0x1a8)](_0x83c47c,_0x3d251d){const _0xa7b248=_0x484e3e;return await napCatCore['session']['getMsgService']()[_0xa7b248(0x1a8)](_0x83c47c,_0x3d251d);}static async[_0x484e3e(0x1c0)](_0x24efc7,_0x383ea8,_0x341c2f,_0x203548,_0x4b9641){const _0x2dc3b1=_0x484e3e;return await napCatCore['session'][_0x2dc3b1(0x18b)]()['getMsgsBySeqAndCount'](_0x24efc7,_0x383ea8,_0x341c2f,_0x203548,_0x4b9641);}static async['activateChat'](_0x1ca8e5){}static async[_0x484e3e(0x197)](_0x51fff3){}static async['setMsgRead'](_0xb61164){const _0x47d806=_0x484e3e;return napCatCore['session']['getMsgService']()[_0x47d806(0x1be)](_0xb61164['chatType'],_0xb61164[_0x47d806(0x183)],_0xb61164[_0x47d806(0x19d)]);}static async[_0x484e3e(0x193)](_0x3fd9a4,_0x27ab91,_0x2ae709){const _0x117239=_0x484e3e;return napCatCore[_0x117239(0x19a)][_0x117239(0x18b)]()['getMsgsIncludeSelf'](_0x3fd9a4,_0x27ab91,_0x2ae709,!![]);}static async[_0x484e3e(0x1bd)](){}static async[_0x484e3e(0x1b6)](_0x19eb2f,_0x282dd6){const _0x357ed5=_0x484e3e;await napCatCore[_0x357ed5(0x19a)][_0x357ed5(0x18b)]()['recallMsg']({'chatType':_0x19eb2f[_0x357ed5(0x1b2)],'peerUid':_0x19eb2f['peerUid']},_0x282dd6);}static async[_0x484e3e(0x1bf)](_0x4290a7,_0x3da8e6,_0x36db75=!![],_0x37356b=0x2710){const _0x500068=_0x484e3e,_0x2eb0fa={'mRgHV':function(_0x3a561f,_0x530e07){return _0x3a561f>_0x530e07;},'gSndY':'发送超时','CHKFp':function(_0x2e4fc8){return _0x2e4fc8();},'FDdKf':function(_0x455ccb,_0x53b230){return _0x455ccb===_0x53b230;},'GgqHi':function(_0x4d06f0,_0x2c4617){return _0x4d06f0(_0x2c4617);},'fQMOY':function(_0x522296){return _0x522296();},'mzZET':function(_0x2ce1d1){return _0x2ce1d1();}},_0x5a1e87=_0x4290a7[_0x500068(0x183)];let _0x5a2d11=0x0;const _0x21e427=async()=>{const _0x1e4c2e=_0x500068;if(_0x2eb0fa['mRgHV'](_0x5a2d11,_0x37356b))throw _0x2eb0fa['gSndY'];const _0x548154=sendMessagePool[_0x4290a7[_0x1e4c2e(0x183)]];if(_0x548154)return await sleep(0x1f4),_0x5a2d11+=0x1f4,await _0x2eb0fa[_0x1e4c2e(0x1b1)](_0x21e427);else return;};return await _0x2eb0fa[_0x500068(0x185)](_0x21e427),new Promise((_0x4c550b,_0x290242)=>{const _0x5189e6=_0x500068,_0x137960={'Cwoxk':function(_0x4ea584,_0x2282d4){const _0x1f106b=_0x5b28;return _0x2eb0fa[_0x1f106b(0x190)](_0x4ea584,_0x2282d4);},'EiOeR':function(_0x5138fa,_0x8b7d01){return _0x2eb0fa['GgqHi'](_0x5138fa,_0x8b7d01);},'ObbtG':_0x2eb0fa['gSndY']};let _0x508270=![],_0xee5469=null;const _0x318b1b=_0x2eb0fa['fQMOY'](randomUUID);sendSuccessCBMap[_0x318b1b]=_0x49eb26=>{const _0xe274bc=_0x5b28;if(_0x49eb26[_0xe274bc(0x1ab)]===_0xee5469?.['msgId']){if(_0x137960[_0xe274bc(0x187)](_0x49eb26[_0xe274bc(0x18f)],0x2))return delete sendSuccessCBMap[_0x318b1b],_0x508270=!![],_0x137960[_0xe274bc(0x1b5)](_0x4c550b,_0x49eb26),!![];return![];}return![];},sendMessagePool[_0x5a1e87]=async _0x3622ef=>{delete sendMessagePool[_0x5a1e87],_0xee5469=_0x3622ef;},setTimeout(()=>{if(_0x508270)return;delete sendMessagePool[_0x5a1e87],delete sendSuccessCBMap[_0x318b1b],_0x137960['EiOeR'](_0x290242,_0x137960['ObbtG']);},_0x37356b);const _0x4362f8=napCatCore[_0x5189e6(0x19a)]['getMsgService']()[_0x5189e6(0x1bf)]('0',_0x4290a7,_0x3da8e6,new Map());});}static async[_0x484e3e(0x1ac)](_0x351edb,_0x3d788c,_0x4623f4){const _0x36cde5=_0x484e3e;return napCatCore[_0x36cde5(0x19a)]['getMsgService']()['forwardMsg'](_0x4623f4,_0x351edb,[_0x3d788c],new Map());}static async[_0x484e3e(0x19e)](_0x3858c3,_0x4aaad6,_0x57c049){const _0xaafda5=_0x484e3e,_0x21ed49={'fbXHd':function(_0x52c8b7,_0x5e76f9){return _0x52c8b7(_0x5e76f9);},'ZCfyf':_0xaafda5(0x1af),'NWtfN':'com.tencent.multimsg','OzMjd':function(_0x59270c,_0x9a831){return _0x59270c(_0x9a831);},'TycAT':function(_0x4782a7){return _0x4782a7();},'EMGOX':function(_0x517fd8,_0x247f7b,_0x28f4cd){return _0x517fd8(_0x247f7b,_0x28f4cd);}},_0xb70ad4=_0x57c049[_0xaafda5(0x1a2)](_0x196610=>{return{'msgId':_0x196610,'senderShowName':selfInfo['nick']};});return new Promise((_0x115610,_0x2e03cd)=>{const _0x50651d=_0xaafda5,_0x2428e3={'iByvV':function(_0x54b958,_0x1c279e){return _0x54b958!=_0x1c279e;},'cbVsY':_0x21ed49['NWtfN'],'ThgCE':function(_0x46ce2f,_0x368a6e){return _0x46ce2f==_0x368a6e;},'ZTRlN':function(_0x46bb36,_0x437cbc){const _0x3e8c8e=_0x5b28;return _0x21ed49[_0x3e8c8e(0x1ad)](_0x46bb36,_0x437cbc);}};let _0x11d78d=![];const _0x31867c=_0x239e41=>{const _0x2ecab0=_0x5b28,_0x1bb761=_0x239e41['elements'][_0x2ecab0(0x194)](_0x1b7ad0=>_0x1b7ad0['arkElement']);if(!_0x1bb761)return;const _0x36287b=JSON['parse'](_0x1bb761[_0x2ecab0(0x196)][_0x2ecab0(0x186)]);if(_0x2428e3[_0x2ecab0(0x1a1)](_0x36287b[_0x2ecab0(0x192)],_0x2428e3[_0x2ecab0(0x1a9)]))return;_0x239e41[_0x2ecab0(0x183)]==_0x4aaad6[_0x2ecab0(0x183)]&&_0x2428e3[_0x2ecab0(0x189)](_0x239e41[_0x2ecab0(0x1b0)],selfInfo[_0x2ecab0(0x1a4)])&&(_0x11d78d=!![],_0x2428e3[_0x2ecab0(0x19f)](_0x115610,_0x239e41));};sentMsgTasks[_0x50651d(0x18a)](_0x21ed49[_0x50651d(0x198)](randomUUID),_0x31867c),_0x21ed49['EMGOX'](setTimeout,()=>{const _0x85be21=_0x50651d;!_0x11d78d&&_0x21ed49[_0x85be21(0x1bb)](_0x2e03cd,_0x21ed49[_0x85be21(0x18d)]);},0x1388),napCatCore[_0x50651d(0x19a)][_0x50651d(0x18b)]()[_0x50651d(0x1bc)](_0xb70ad4,_0x3858c3,_0x4aaad6,[],new Map());});}}