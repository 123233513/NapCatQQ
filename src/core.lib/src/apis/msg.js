const _0x55aabf=_0x21d8;(function(_0x1cca2c,_0x1ad6a2){const _0x32f4fa=_0x21d8,_0x2da407=_0x1cca2c();while(!![]){try{const _0x42c6d4=-parseInt(_0x32f4fa(0x1da))/0x1*(-parseInt(_0x32f4fa(0x1dd))/0x2)+parseInt(_0x32f4fa(0x1b0))/0x3+parseInt(_0x32f4fa(0x1a9))/0x4+parseInt(_0x32f4fa(0x1b7))/0x5*(-parseInt(_0x32f4fa(0x1af))/0x6)+-parseInt(_0x32f4fa(0x19c))/0x7+parseInt(_0x32f4fa(0x19f))/0x8+-parseInt(_0x32f4fa(0x1a2))/0x9*(-parseInt(_0x32f4fa(0x1ac))/0xa);if(_0x42c6d4===_0x1ad6a2)break;else _0x2da407['push'](_0x2da407['shift']());}catch(_0x4ea31c){_0x2da407['push'](_0x2da407['shift']());}}}(_0x210b,0x6fed5));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';function _0x210b(){const _0x39a037=['session','37890MEXZSe','78981Bngeoz','fetchRecentContact','hOAfT','parse','com.tencent.multimsg','JiZIs','getMsgHistory','255RifQvs','tcKKY','getMultiMsg','sendStatus','map','peerUid','then','uid','onLoginSuccess','BUiUn','eAZCd','gqcil','chatType','multiForwardMsg','onAddSendMsg','sendMsg','activateChat','delete','jvCcm','nick','AvDsy','catch','getMsgsBySeqAndCount','XntIv','getMsgsByMsgId','senderUid','onMsgInfoListUpdate','ASceQ','发送超时','activateChatAndGetHistory','转发消息超时','msgId','elements','bytesData','QkaVN','1psqQxC','setMsgRead','set','35642ZFPdIQ','ZXWmf','getMsgService','ACVmT','forwardMsg','ClPzU','arkElement','2715356YdfVHX','getMsgsIncludeSelf','WFsRt','937384NDIgFc','RiQbv','PhQQy','1467JJsLIK','toString','DZmEm','wiYmd','SuwAj','recallMsg','EzNkq','274856tOCmJO','length','setEmojiLike','57570EaCgGT','forEach'];_0x210b=function(){return _0x39a037;};return _0x210b();}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';function _0x21d8(_0x1f0e9a,_0x287703){const _0x210b6f=_0x210b();return _0x21d8=function(_0x21d8e1,_0x19d99d){_0x21d8e1=_0x21d8e1-0x19c;let _0x39b068=_0x210b6f[_0x21d8e1];return _0x39b068;},_0x21d8(_0x1f0e9a,_0x287703);}import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x55aabf(0x1c5)]=_0x19d4fc=>{const _0xf1a36f=_0x55aabf,_0x3ad92c={'eAZCd':function(_0x51f75c,_0xe00f89){return _0x51f75c instanceof _0xe00f89;}};for(const [_0xff5c83,_0xa20ac0]of sentMsgTasks){_0xa20ac0(_0x19d4fc),sentMsgTasks[_0xf1a36f(0x1c8)](_0xff5c83);}if(sendMessagePool[_0x19d4fc['peerUid']]){const _0x1bd997=sendMessagePool[_0x19d4fc[_0xf1a36f(0x1bc)]]?.(_0x19d4fc);_0x3ad92c[_0xf1a36f(0x1c1)](_0x1bd997,Promise)&&_0x1bd997[_0xf1a36f(0x1bd)]()[_0xf1a36f(0x1cc)](logError);}},msgListener[_0x55aabf(0x1d1)]=_0x17a023=>{const _0x1de420=_0x55aabf,_0x30c6ec={'whrEG':function(_0x3ed1cd,_0x341906){return _0x3ed1cd(_0x341906);},'ZXWmf':function(_0x2c14e7,_0x2070f3){return _0x2c14e7 instanceof _0x2070f3;}};_0x17a023[_0x1de420(0x1ad)](_0x3e6a80=>{const _0x4d94ad=_0x1de420,_0x49969d={'BUiUn':function(_0x46f250,_0x3b43da){return _0x30c6ec['whrEG'](_0x46f250,_0x3b43da);},'tcKKY':function(_0x46c641,_0x3fb71e){const _0x30e5af=_0x21d8;return _0x30c6ec[_0x30e5af(0x1de)](_0x46c641,_0x3fb71e);},'ASceQ':function(_0x3aeb7e,_0x2f963e){return _0x3aeb7e(_0x2f963e);}};new Promise((_0x373184,_0x392f91)=>{const _0x68c7ae=_0x21d8;for(const _0x53b9ef in sendSuccessCBMap){const _0x503f2e=sendSuccessCBMap[_0x53b9ef],_0x1c067d=_0x49969d[_0x68c7ae(0x1c0)](_0x503f2e,_0x3e6a80),_0x23aea8=_0x1b75b3=>{_0x1b75b3&&delete sendSuccessCBMap[_0x53b9ef];};_0x49969d[_0x68c7ae(0x1b8)](_0x1c067d,Promise)?_0x1c067d[_0x68c7ae(0x1bd)](_0x23aea8):_0x49969d[_0x68c7ae(0x1d2)](_0x23aea8,_0x1c067d);}})[_0x4d94ad(0x1bd)]()['catch'](log);});},setTimeout(()=>{const _0x165e79=_0x55aabf;napCatCore[_0x165e79(0x1bf)](()=>{napCatCore['addListener'](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x55aabf(0x1ab)](_0x71aa1f,_0x6e8fb8,_0x523ece,_0x2dec91=!![]){const _0x1cfdb7=_0x55aabf,_0x4c516f={'ACVmT':function(_0x18a1ee,_0x429cf5){return _0x18a1ee>_0x429cf5;}};return _0x523ece=_0x523ece[_0x1cfdb7(0x1a3)](),napCatCore[_0x1cfdb7(0x1ae)][_0x1cfdb7(0x1df)]()['setMsgEmojiLikes'](_0x71aa1f,_0x6e8fb8,_0x523ece,_0x4c516f[_0x1cfdb7(0x1e0)](_0x523ece[_0x1cfdb7(0x1aa)],0x3)?'2':'1',_0x2dec91);}static async[_0x55aabf(0x1b9)](_0x23f460,_0x4c321b,_0x14d7e3){const _0x655f3b=_0x55aabf;return napCatCore['session'][_0x655f3b(0x1df)]()[_0x655f3b(0x1b9)](_0x23f460,_0x4c321b,_0x14d7e3);}static async[_0x55aabf(0x1cf)](_0x2b61e6,_0xa5e89c){const _0x384db7=_0x55aabf;return await napCatCore[_0x384db7(0x1ae)][_0x384db7(0x1df)]()[_0x384db7(0x1cf)](_0x2b61e6,_0xa5e89c);}static async[_0x55aabf(0x1cd)](_0x6b374a,_0xe38fb6,_0x2cdc24,_0x4677f1,_0x238c31){const _0x4911fa=_0x55aabf;return await napCatCore[_0x4911fa(0x1ae)][_0x4911fa(0x1df)]()[_0x4911fa(0x1cd)](_0x6b374a,_0xe38fb6,_0x2cdc24,_0x4677f1,_0x238c31);}static async[_0x55aabf(0x1c7)](_0x475d75){}static async[_0x55aabf(0x1d4)](_0x10883f){}static async[_0x55aabf(0x1db)](_0x510d10){const _0x54e161=_0x55aabf;return napCatCore[_0x54e161(0x1ae)][_0x54e161(0x1df)]()[_0x54e161(0x1db)](_0x510d10);}static async[_0x55aabf(0x1b6)](_0x1a4e6a,_0x4a4ee2,_0x5e1a6a){const _0x4bbcf9=_0x55aabf;return napCatCore[_0x4bbcf9(0x1ae)][_0x4bbcf9(0x1df)]()[_0x4bbcf9(0x19d)](_0x1a4e6a,_0x4a4ee2,_0x5e1a6a,!![]);}static async[_0x55aabf(0x1b1)](){}static async[_0x55aabf(0x1a7)](_0x11dd81,_0x104be8){const _0x38aa78=_0x55aabf;await napCatCore[_0x38aa78(0x1ae)][_0x38aa78(0x1df)]()[_0x38aa78(0x1a7)]({'chatType':_0x11dd81[_0x38aa78(0x1c3)],'peerUid':_0x11dd81[_0x38aa78(0x1bc)]},_0x104be8);}static async[_0x55aabf(0x1c6)](_0x52fbee,_0x2c6587,_0x55d4bf=!![],_0x4c5ceb=0x2710){const _0x3b97c4={'gqcil':function(_0x429a44,_0x338f39){return _0x429a44>_0x338f39;},'wiYmd':function(_0x5dece4,_0x360e8a){return _0x5dece4(_0x360e8a);},'PhQQy':function(_0x123ebe,_0x54d0ae){return _0x123ebe===_0x54d0ae;},'QkaVN':function(_0x29a74c,_0x2320ec){return _0x29a74c(_0x2320ec);},'ClPzU':'发送超时','DZmEm':function(_0x5252,_0x1fef63,_0x47baf7){return _0x5252(_0x1fef63,_0x47baf7);}},_0x112086=_0x52fbee['peerUid'];let _0x5e99e8=0x0;const _0x2a3fbf=async()=>{const _0x5e570a=_0x21d8;if(_0x3b97c4[_0x5e570a(0x1c2)](_0x5e99e8,_0x4c5ceb))throw _0x5e570a(0x1d3);const _0x23d60b=sendMessagePool[_0x52fbee[_0x5e570a(0x1bc)]];if(_0x23d60b)return await _0x3b97c4[_0x5e570a(0x1a5)](sleep,0x1f4),_0x5e99e8+=0x1f4,await _0x2a3fbf();else return;};return await _0x2a3fbf(),new Promise((_0x4d9ca0,_0x5e4198)=>{const _0x44faf8=_0x21d8;let _0x3204b2=![],_0xf82496=null;const _0x121132=randomUUID();sendSuccessCBMap[_0x121132]=_0x36c341=>{const _0x3626af=_0x21d8;if(_0x3b97c4[_0x3626af(0x1a1)](_0x36c341[_0x3626af(0x1d6)],_0xf82496?.[_0x3626af(0x1d6)])){if(_0x36c341[_0x3626af(0x1ba)]===0x2)return delete sendSuccessCBMap[_0x121132],_0x3204b2=!![],_0x3b97c4[_0x3626af(0x1d9)](_0x4d9ca0,_0x36c341),!![];return![];}return![];},sendMessagePool[_0x112086]=async _0x4475a2=>{delete sendMessagePool[_0x112086],_0xf82496=_0x4475a2;},_0x3b97c4[_0x44faf8(0x1a4)](setTimeout,()=>{const _0x15c9c4=_0x44faf8;if(_0x3204b2)return;delete sendMessagePool[_0x112086],delete sendSuccessCBMap[_0x121132],_0x5e4198(_0x3b97c4[_0x15c9c4(0x1e2)]);},_0x4c5ceb);const _0x5aa7c2=napCatCore[_0x44faf8(0x1ae)]['getMsgService']()[_0x44faf8(0x1c6)]('0',_0x52fbee,_0x2c6587,new Map());});}static async[_0x55aabf(0x1e1)](_0x1912fe,_0xd7fb75,_0x599d8a){const _0xbae72c=_0x55aabf;return napCatCore[_0xbae72c(0x1ae)][_0xbae72c(0x1df)]()['forwardMsg'](_0x599d8a,_0x1912fe,[_0xd7fb75],new Map());}static async[_0x55aabf(0x1c4)](_0x2ca7cc,_0x551754,_0x2f7fa1){const _0x5af828=_0x55aabf,_0x11813e={'WFsRt':function(_0x5d72e4,_0x551dca){return _0x5d72e4(_0x551dca);},'GRQTn':_0x5af828(0x1d5),'aziSK':function(_0x19f9f0,_0x519c90){return _0x19f9f0!=_0x519c90;},'SuwAj':_0x5af828(0x1b4),'AvDsy':function(_0x481ff2,_0x22f52b){return _0x481ff2==_0x22f52b;},'JiZIs':function(_0x305397,_0x44f5ac){return _0x305397==_0x44f5ac;},'dxETS':function(_0x4b057a){return _0x4b057a();}},_0x5a113f=_0x2f7fa1[_0x5af828(0x1bb)](_0x12dde4=>{const _0x36a7fd=_0x5af828;return{'msgId':_0x12dde4,'senderShowName':selfInfo[_0x36a7fd(0x1ca)]};});return new Promise((_0x32bf29,_0x2c410e)=>{const _0x31d4a9=_0x5af828,_0x36e009={'EzNkq':function(_0x467892,_0x103767){return _0x11813e['aziSK'](_0x467892,_0x103767);},'RiQbv':_0x11813e[_0x31d4a9(0x1a6)],'hOAfT':function(_0xff6a37,_0x5d29ab){const _0xd1c3dd=_0x31d4a9;return _0x11813e[_0xd1c3dd(0x1cb)](_0xff6a37,_0x5d29ab);},'jvCcm':function(_0x1b236d,_0x675e61){const _0x35e0ef=_0x31d4a9;return _0x11813e[_0x35e0ef(0x1b5)](_0x1b236d,_0x675e61);},'XntIv':function(_0x13ca99,_0x1b8189){const _0x244320=_0x31d4a9;return _0x11813e[_0x244320(0x19e)](_0x13ca99,_0x1b8189);}};let _0x374535=![];const _0x2f1953=_0x5b9f70=>{const _0x36cc04=_0x31d4a9,_0x5d8026=_0x5b9f70[_0x36cc04(0x1d7)]['find'](_0x5f0849=>_0x5f0849[_0x36cc04(0x1e3)]);if(!_0x5d8026)return;const _0xea0a12=JSON[_0x36cc04(0x1b3)](_0x5d8026[_0x36cc04(0x1e3)][_0x36cc04(0x1d8)]);if(_0x36e009[_0x36cc04(0x1a8)](_0xea0a12['app'],_0x36e009[_0x36cc04(0x1a0)]))return;_0x36e009[_0x36cc04(0x1b2)](_0x5b9f70['peerUid'],_0x551754[_0x36cc04(0x1bc)])&&_0x36e009[_0x36cc04(0x1c9)](_0x5b9f70[_0x36cc04(0x1d0)],selfInfo[_0x36cc04(0x1be)])&&(_0x374535=!![],_0x36e009[_0x36cc04(0x1ce)](_0x32bf29,_0x5b9f70));};sentMsgTasks[_0x31d4a9(0x1dc)](_0x11813e['dxETS'](randomUUID),_0x2f1953),setTimeout(()=>{!_0x374535&&_0x11813e['WFsRt'](_0x2c410e,_0x11813e['GRQTn']);},0x1388),napCatCore[_0x31d4a9(0x1ae)][_0x31d4a9(0x1df)]()['multiForwardMsgWithComment'](_0x5a113f,_0x2ca7cc,_0x551754,[],new Map());});}}