const _0x151e22=_0xe344;(function(_0x54083f,_0x49a260){const _0x1811bd=_0xe344,_0xcc4f=_0x54083f();while(!![]){try{const _0x2a64d4=parseInt(_0x1811bd(0x1ec))/0x1+parseInt(_0x1811bd(0x1cd))/0x2*(-parseInt(_0x1811bd(0x1da))/0x3)+-parseInt(_0x1811bd(0x1d2))/0x4*(parseInt(_0x1811bd(0x20c))/0x5)+parseInt(_0x1811bd(0x203))/0x6+-parseInt(_0x1811bd(0x1dd))/0x7*(-parseInt(_0x1811bd(0x1e8))/0x8)+parseInt(_0x1811bd(0x1f4))/0x9+parseInt(_0x1811bd(0x20f))/0xa*(parseInt(_0x1811bd(0x210))/0xb);if(_0x2a64d4===_0x49a260)break;else _0xcc4f['push'](_0xcc4f['shift']());}catch(_0x166ad4){_0xcc4f['push'](_0xcc4f['shift']());}}}(_0x268b,0xb93ea));import{selfInfo}from'@/core/data';function _0x268b(){const _0x98d9a1=['nrWtv','889956eDdxdw','length','getMsgService','delete','bytesData','senderUid','发送超时','wxAVq','item','uid','ZenvN','getGroupFileList','获取群文件列表超时','dKjhe','krUvw','278490jJQEqH','catch','com.tencent.multimsg','map','elements','GpOqM','WwfLe','forwardMsg','LsBvN','531365tSsTcf','app','activateChatAndGetHistory','10PABKDc','3027651wbAIyX','msgId','getMsgHistory','JoJLi','arkElement','SMPjy','sendMsg','then','setMsgEmojiLikes','Sapzj','session','158686FmJoSN','JlBca','chatType','ijSWk','setMsgRead','8xKGowq','multiForwardMsg','SiNrF','recallMsg','getMsgsIncludeSelf','sendStatus','set','jHNhG','33qkAeXn','gIBuH','nick','50204oJwJcZ','peerUid','EjLKQ','tWCVk','转发消息超时','onLoginSuccess','getMsgsByMsgId','fetchRecentContact','AHUYl','onGroupFileInfoUpdate','getRichMediaService','1032lDefoe','KCOKv','parse','ercEV','498353mAnQpe','getMsgsBySeqAndCount','eeQQN','forEach','getMultiMsg','activateChat','onMsgInfoListUpdate'];_0x268b=function(){return _0x98d9a1;};return _0x268b();}import{log,logError}from'@/common/utils/log';function _0xe344(_0x31422c,_0x826d45){const _0x268b74=_0x268b();return _0xe344=function(_0xe3443d,_0x46722a){_0xe3443d=_0xe3443d-0x1c3;let _0x228f70=_0x268b74[_0xe3443d];return _0x228f70;},_0xe344(_0x31422c,_0x826d45);}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x151e22(0x1e6)]=_0x21b37d=>{const _0x218733=_0x151e22,_0x4832b3={'QmQNf':function(_0x40758,_0x5c85e2){return _0x40758(_0x5c85e2);}};for(const [_0x878360,_0x423e22]of GroupFileInfoUpdateTasks){_0x4832b3['QmQNf'](_0x423e22,_0x21b37d),GroupFileInfoUpdateTasks[_0x218733(0x1f7)](_0x878360);}},msgListener['onAddSendMsg']=_0x3dc450=>{const _0x1e819b=_0x151e22,_0xab98ce={'GpOqM':function(_0x2478b9,_0x5932bd){return _0x2478b9(_0x5932bd);},'pvkDb':function(_0x360fad,_0xbceaf4){return _0x360fad instanceof _0xbceaf4;}};for(const [_0x2a2b8a,_0x145872]of sentMsgTasks){_0xab98ce[_0x1e819b(0x208)](_0x145872,_0x3dc450),sentMsgTasks[_0x1e819b(0x1f7)](_0x2a2b8a);}if(sendMessagePool[_0x3dc450[_0x1e819b(0x1de)]]){const _0x2f1158=sendMessagePool[_0x3dc450[_0x1e819b(0x1de)]]?.(_0x3dc450);_0xab98ce['pvkDb'](_0x2f1158,Promise)&&_0x2f1158[_0x1e819b(0x1c9)]()[_0x1e819b(0x204)](logError);}},msgListener[_0x151e22(0x1f2)]=_0x4ee4c1=>{const _0x4e45f7=_0x151e22,_0x5022ec={'dKjhe':function(_0xdc9482,_0x34e8bc){return _0xdc9482(_0x34e8bc);},'wxAVq':function(_0x471a9a,_0x12e632){return _0x471a9a instanceof _0x12e632;}};_0x4ee4c1[_0x4e45f7(0x1ef)](_0x14de09=>{const _0x30051c=_0x4e45f7;new Promise((_0x34711c,_0x2b0898)=>{const _0x51c3ca=_0xe344;for(const _0x152839 in sendSuccessCBMap){const _0x2badd0=sendSuccessCBMap[_0x152839],_0x357b85=_0x5022ec[_0x51c3ca(0x201)](_0x2badd0,_0x14de09),_0x64c183=_0x1a32f6=>{_0x1a32f6&&delete sendSuccessCBMap[_0x152839];};_0x5022ec[_0x51c3ca(0x1fb)](_0x357b85,Promise)?_0x357b85[_0x51c3ca(0x1c9)](_0x64c183):_0x5022ec[_0x51c3ca(0x201)](_0x64c183,_0x357b85);}})[_0x30051c(0x1c9)]()['catch'](log);});},setTimeout(()=>{const _0xb5f867=_0x151e22;napCatCore[_0xb5f867(0x1e2)](()=>{napCatCore['addListener'](msgListener);});},0x64);export class NTQQMsgApi{static async['setEmojiLike'](_0x1f8ace,_0x2762b4,_0x5942ee,_0x2df22d=!![]){const _0x53655a=_0x151e22,_0x79325f={'SiNrF':function(_0x55d534,_0x58b975){return _0x55d534>_0x58b975;}};return _0x5942ee=_0x5942ee['toString'](),napCatCore[_0x53655a(0x1cc)][_0x53655a(0x1f6)]()[_0x53655a(0x1ca)](_0x1f8ace,_0x2762b4,_0x5942ee,_0x79325f[_0x53655a(0x1d4)](_0x5942ee[_0x53655a(0x1f5)],0x3)?'2':'1',_0x2df22d);}static async['getMultiMsg'](_0x40f252,_0x220939,_0xb9e530){const _0x27041b=_0x151e22;return napCatCore['session']['getMsgService']()[_0x27041b(0x1f0)](_0x40f252,_0x220939,_0xb9e530);}static async[_0x151e22(0x1e3)](_0x5bb70a,_0x5c5903){const _0x29128e=_0x151e22;return await napCatCore['session'][_0x29128e(0x1f6)]()[_0x29128e(0x1e3)](_0x5bb70a,_0x5c5903);}static async[_0x151e22(0x1ed)](_0x1fc372,_0x234663,_0x243f2e,_0x239ecf,_0x8473a5){const _0x384188=_0x151e22;return await napCatCore[_0x384188(0x1cc)]['getMsgService']()[_0x384188(0x1ed)](_0x1fc372,_0x234663,_0x243f2e,_0x239ecf,_0x8473a5);}static async[_0x151e22(0x1f1)](_0xd20315){}static async[_0x151e22(0x20e)](_0x38de9e){}static async[_0x151e22(0x1d1)](_0x1d9729){const _0x4b4038=_0x151e22;return napCatCore[_0x4b4038(0x1cc)][_0x4b4038(0x1f6)]()[_0x4b4038(0x1d1)](_0x1d9729);}static async[_0x151e22(0x1ff)](_0x3a1e5c,_0x18f2e7){const _0x2e5ac2=_0x151e22,_0x32fe9b={'jKrFv':_0x2e5ac2(0x200),'eeQQN':function(_0x3ea873,_0x2bbe8b){return _0x3ea873(_0x2bbe8b);}};return new Promise(async(_0x1051a4,_0xccff2)=>{const _0x4130b8=_0x2e5ac2,_0x121d69={'ercEV':function(_0x3c5b91,_0x41d6c6){const _0x351a29=_0xe344;return _0x32fe9b[_0x351a29(0x1ee)](_0x3c5b91,_0x41d6c6);}};let _0x4ad718=![];setTimeout(()=>{!_0x4ad718&&_0xccff2(_0x32fe9b['jKrFv']);},0x1388);const _0x4f3866=_0x2f1135=>{const _0xc6f57d=_0xe344;_0x4ad718=!![],_0x121d69[_0xc6f57d(0x1eb)](_0x1051a4,_0x2f1135[_0xc6f57d(0x1fc)]);};GroupFileInfoUpdateTasks[_0x4130b8(0x1d8)](randomUUID(),_0x4f3866),await napCatCore[_0x4130b8(0x1cc)][_0x4130b8(0x1e7)]()[_0x4130b8(0x1ff)](_0x3a1e5c,_0x18f2e7);});}static async[_0x151e22(0x1c4)](_0x271c42,_0x38b5f5,_0x9c2b0b){const _0x3de094=_0x151e22;return napCatCore[_0x3de094(0x1cc)]['getMsgService']()[_0x3de094(0x1d6)](_0x271c42,_0x38b5f5,_0x9c2b0b,!![]);}static async[_0x151e22(0x1e4)](){}static async[_0x151e22(0x1d5)](_0x5ac43c,_0x14a4e5){const _0x554849=_0x151e22;await napCatCore['session'][_0x554849(0x1f6)]()['recallMsg']({'chatType':_0x5ac43c[_0x554849(0x1cf)],'peerUid':_0x5ac43c[_0x554849(0x1de)]},_0x14a4e5);}static async[_0x151e22(0x1c8)](_0x3639f0,_0x479bcd,_0xd8f42d=!![],_0x4b6128=0x2710){const _0x1ecfca=_0x151e22,_0x4d7f98={'AHUYl':function(_0x132f44,_0x3a77a6){return _0x132f44>_0x3a77a6;},'JlBca':_0x1ecfca(0x1fa),'jHNhG':function(_0x1f97f0,_0x4c55ce){return _0x1f97f0(_0x4c55ce);},'ytQds':function(_0x308149){return _0x308149();},'WwfLe':function(_0x58b253,_0x95a195){return _0x58b253===_0x95a195;},'Sapzj':function(_0x158512){return _0x158512();},'JoJLi':function(_0x685bd9,_0x653ebf,_0x172599){return _0x685bd9(_0x653ebf,_0x172599);}},_0x379525=_0x3639f0['peerUid'];let _0x37cfc5=0x0;const _0x20d4ac=async()=>{const _0x59536f=_0x1ecfca;if(_0x4d7f98[_0x59536f(0x1e5)](_0x37cfc5,_0x4b6128))throw _0x4d7f98[_0x59536f(0x1ce)];const _0x4820ba=sendMessagePool[_0x3639f0[_0x59536f(0x1de)]];if(_0x4820ba)return await _0x4d7f98[_0x59536f(0x1d9)](sleep,0x1f4),_0x37cfc5+=0x1f4,await _0x4d7f98['ytQds'](_0x20d4ac);else return;};return await _0x20d4ac(),new Promise((_0x3822ba,_0x3ecf7f)=>{const _0x53660c=_0x1ecfca,_0x2c33b5={'SMPjy':function(_0xa20396,_0x1c6647){const _0x4d1aff=_0xe344;return _0x4d7f98[_0x4d1aff(0x209)](_0xa20396,_0x1c6647);},'tWCVk':function(_0xf808c7,_0x5461e9){const _0xe2b8bd=_0xe344;return _0x4d7f98[_0xe2b8bd(0x209)](_0xf808c7,_0x5461e9);},'EjLKQ':function(_0x39fe3a,_0x346eec){const _0x2ff426=_0xe344;return _0x4d7f98[_0x2ff426(0x1d9)](_0x39fe3a,_0x346eec);}};let _0xa08d6d=![],_0x1bc6e8=null;const _0x22c686=_0x4d7f98[_0x53660c(0x1cb)](randomUUID);sendSuccessCBMap[_0x22c686]=_0x913eed=>{const _0x20ee45=_0x53660c;if(_0x2c33b5[_0x20ee45(0x1c7)](_0x913eed[_0x20ee45(0x1c3)],_0x1bc6e8?.[_0x20ee45(0x1c3)])){if(_0x2c33b5[_0x20ee45(0x1e0)](_0x913eed[_0x20ee45(0x1d7)],0x2))return delete sendSuccessCBMap[_0x22c686],_0xa08d6d=!![],_0x2c33b5[_0x20ee45(0x1df)](_0x3822ba,_0x913eed),!![];return![];}return![];},sendMessagePool[_0x379525]=async _0x4db604=>{delete sendMessagePool[_0x379525],_0x1bc6e8=_0x4db604;},_0x4d7f98[_0x53660c(0x1c5)](setTimeout,()=>{const _0x2d713b=_0x53660c;if(_0xa08d6d)return;delete sendMessagePool[_0x379525],delete sendSuccessCBMap[_0x22c686],_0x3ecf7f(_0x4d7f98[_0x2d713b(0x1ce)]);},_0x4b6128);const _0x206240=napCatCore['session'][_0x53660c(0x1f6)]()['sendMsg']('0',_0x3639f0,_0x479bcd,new Map());});}static async[_0x151e22(0x20a)](_0x8fa1c4,_0x2b1da0,_0x2d5d7){const _0x4988b7=_0x151e22;return napCatCore[_0x4988b7(0x1cc)][_0x4988b7(0x1f6)]()['forwardMsg'](_0x2d5d7,_0x8fa1c4,[_0x2b1da0],new Map());}static async[_0x151e22(0x1d3)](_0x1f9141,_0x433224,_0x47418f){const _0x3946c4=_0x151e22,_0x9a836c={'gIBuH':function(_0x2374be,_0x4afc69){return _0x2374be(_0x4afc69);},'krUvw':function(_0x35afc0,_0x5b9af7){return _0x35afc0!=_0x5b9af7;},'LntVW':_0x3946c4(0x205),'nrWtv':function(_0x735e9,_0x4c3dff){return _0x735e9==_0x4c3dff;},'lbfKz':function(_0xf32c4c){return _0xf32c4c();},'LsBvN':function(_0x2bf36a,_0x43efaf,_0xee8aa3){return _0x2bf36a(_0x43efaf,_0xee8aa3);}},_0x1e719c=_0x47418f[_0x3946c4(0x206)](_0x3a65ce=>{const _0x436c33=_0x3946c4;return{'msgId':_0x3a65ce,'senderShowName':selfInfo[_0x436c33(0x1dc)]};});return new Promise((_0x408006,_0x1408d4)=>{const _0x3ceadd=_0x3946c4,_0x508ca8={'ZenvN':function(_0x1d7d4e,_0x3ca9e3){const _0x13746a=_0xe344;return _0x9a836c[_0x13746a(0x202)](_0x1d7d4e,_0x3ca9e3);},'ijSWk':_0x9a836c['LntVW'],'KCOKv':function(_0x209270,_0x34c2b9){const _0x2389fe=_0xe344;return _0x9a836c[_0x2389fe(0x1f3)](_0x209270,_0x34c2b9);},'Yuecn':function(_0x2d7a49,_0x532a88){const _0x90281b=_0xe344;return _0x9a836c[_0x90281b(0x1f3)](_0x2d7a49,_0x532a88);}};let _0x56cc13=![];const _0x57c0dd=_0x3ba452=>{const _0xafbd0d=_0xe344,_0x1b7cb5=_0x3ba452[_0xafbd0d(0x207)]['find'](_0x443a20=>_0x443a20[_0xafbd0d(0x1c6)]);if(!_0x1b7cb5)return;const _0x3ed4ea=JSON[_0xafbd0d(0x1ea)](_0x1b7cb5[_0xafbd0d(0x1c6)][_0xafbd0d(0x1f8)]);if(_0x508ca8[_0xafbd0d(0x1fe)](_0x3ed4ea[_0xafbd0d(0x20d)],_0x508ca8[_0xafbd0d(0x1d0)]))return;_0x508ca8[_0xafbd0d(0x1e9)](_0x3ba452['peerUid'],_0x433224[_0xafbd0d(0x1de)])&&_0x508ca8['Yuecn'](_0x3ba452[_0xafbd0d(0x1f9)],selfInfo[_0xafbd0d(0x1fd)])&&(_0x56cc13=!![],_0x408006(_0x3ba452));};sentMsgTasks[_0x3ceadd(0x1d8)](_0x9a836c['lbfKz'](randomUUID),_0x57c0dd),_0x9a836c[_0x3ceadd(0x20b)](setTimeout,()=>{const _0x2cbf58=_0x3ceadd;!_0x56cc13&&_0x9a836c[_0x2cbf58(0x1db)](_0x1408d4,_0x2cbf58(0x1e1));},0x1388),napCatCore['session'][_0x3ceadd(0x1f6)]()['multiForwardMsgWithComment'](_0x1e719c,_0x1f9141,_0x433224,[],new Map());});}}