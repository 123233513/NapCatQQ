const _0x33115c=_0x4c87;(function(_0x2d81f2,_0x11769e){const _0x50a2e7=_0x4c87,_0x381d41=_0x2d81f2();while(!![]){try{const _0x44e0d7=parseInt(_0x50a2e7(0x191))/0x1*(parseInt(_0x50a2e7(0x17e))/0x2)+parseInt(_0x50a2e7(0x17f))/0x3+parseInt(_0x50a2e7(0x156))/0x4+parseInt(_0x50a2e7(0x15e))/0x5*(-parseInt(_0x50a2e7(0x15d))/0x6)+-parseInt(_0x50a2e7(0x197))/0x7*(-parseInt(_0x50a2e7(0x167))/0x8)+parseInt(_0x50a2e7(0x181))/0x9*(-parseInt(_0x50a2e7(0x196))/0xa)+-parseInt(_0x50a2e7(0x198))/0xb*(parseInt(_0x50a2e7(0x189))/0xc);if(_0x44e0d7===_0x11769e)break;else _0x381d41['push'](_0x381d41['shift']());}catch(_0x19a26a){_0x381d41['push'](_0x381d41['shift']());}}}(_0x8b4d,0xb9eff));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();function _0x8b4d(){const _0x4cdf78=['activateChat','item','setMsgEmojiLikes','bytesData','app','delete','6006552UEsKfD','map','cAsjz','onGroupFileInfoUpdate','sbRCp','getMsgsByMsgId','VHqaF','7455606fptPNt','5ykmjgk','arkElement','Ulrrs','then','toString','epPZC','msgId','oGYCL','find','48lqZtaZ','getMsgsBySeqAndCount','onMsgInfoListUpdate','catch','FfzSs','uid','activateChatAndGetHistory','multiForwardMsg','length','PcmYV','sKUZX','转发消息超时','peerUid','getRichMediaService','forEach','获取群文件列表超时','yNybp','recallMsg','setEmojiLike','mSuIB','sendStatus','laKmv','WcvVF','51196lhffDr','3657060oOWuYK','getGroupFileList','10386YoTOTv','set','sendMsg','parse','com.tencent.multimsg','ssQHx','UhNuG','multiForwardMsgWithComment','10844712XCwupF','addListener','onAddSendMsg','elements','getMultiMsg','setMsgRead','klzcy','senderUid','15dcslfb','session','getMsgService','chatType','getMsgsIncludeSelf','4820CuCSrb','1473794AsVVfs','22RxXDxz','onLoginSuccess','MUWjt','forwardMsg'];_0x8b4d=function(){return _0x4cdf78;};return _0x8b4d();}function _0x4c87(_0x2e24e2,_0x1384f1){const _0x8b4d33=_0x8b4d();return _0x4c87=function(_0x4c87b8,_0x5ec52b){_0x4c87b8=_0x4c87b8-0x153;let _0x5b6246=_0x8b4d33[_0x4c87b8];return _0x5b6246;},_0x4c87(_0x2e24e2,_0x1384f1);}msgListener[_0x33115c(0x159)]=_0x3222c3=>{for(const [_0x3962ee,_0x424021]of GroupFileInfoUpdateTasks){_0x424021(_0x3222c3),GroupFileInfoUpdateTasks['delete'](_0x3962ee);}},msgListener[_0x33115c(0x18b)]=_0x1f90b7=>{const _0x8f6ed4=_0x33115c,_0x485098={'sKUZX':function(_0x312bef,_0x2dd516){return _0x312bef(_0x2dd516);}};for(const [_0x4aedab,_0x34c8c4]of sentMsgTasks){_0x485098[_0x8f6ed4(0x171)](_0x34c8c4,_0x1f90b7),sentMsgTasks[_0x8f6ed4(0x155)](_0x4aedab);}if(sendMessagePool[_0x1f90b7['peerUid']]){const _0x2431c1=sendMessagePool[_0x1f90b7[_0x8f6ed4(0x173)]]?.(_0x1f90b7);_0x2431c1 instanceof Promise&&_0x2431c1[_0x8f6ed4(0x161)]()['catch'](logError);}},msgListener[_0x33115c(0x169)]=_0x359a73=>{const _0x5cdfbc=_0x33115c,_0x3b9455={'VHqaF':function(_0x3c45ba,_0x15f65c){return _0x3c45ba(_0x15f65c);}};_0x359a73[_0x5cdfbc(0x175)](_0x3f6bbe=>{const _0x346726=_0x5cdfbc,_0x160d4b={'mSuIB':function(_0x11dd44,_0x5f03c8){const _0x3ef84c=_0x4c87;return _0x3b9455[_0x3ef84c(0x15c)](_0x11dd44,_0x5f03c8);}};new Promise((_0x8c8ba,_0xa1e084)=>{const _0x32424c=_0x4c87;for(const _0x53785a in sendSuccessCBMap){const _0x27313b=sendSuccessCBMap[_0x53785a],_0xd695af=_0x160d4b[_0x32424c(0x17a)](_0x27313b,_0x3f6bbe),_0x25ef9f=_0x4886e7=>{_0x4886e7&&delete sendSuccessCBMap[_0x53785a];};_0xd695af instanceof Promise?_0xd695af[_0x32424c(0x161)](_0x25ef9f):_0x160d4b[_0x32424c(0x17a)](_0x25ef9f,_0xd695af);}})[_0x346726(0x161)]()[_0x346726(0x16a)](log);});},setTimeout(()=>{const _0x49c31a=_0x33115c;napCatCore[_0x49c31a(0x199)](()=>{const _0x32f7fc=_0x49c31a;napCatCore[_0x32f7fc(0x18a)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x33115c(0x179)](_0x4220e7,_0x1d440b,_0x515f83,_0x2af00d=!![]){const _0x1b947e=_0x33115c,_0x2faa31={'sOGwP':function(_0x581b89,_0x307ec5){return _0x581b89>_0x307ec5;}};return _0x515f83=_0x515f83[_0x1b947e(0x162)](),napCatCore['session'][_0x1b947e(0x193)]()[_0x1b947e(0x19e)](_0x4220e7,_0x1d440b,_0x515f83,_0x2faa31['sOGwP'](_0x515f83[_0x1b947e(0x16f)],0x3)?'2':'1',_0x2af00d);}static async[_0x33115c(0x18d)](_0x43e5a3,_0x5cb3f4,_0x480346){const _0x1635cf=_0x33115c;return napCatCore['session']['getMsgService']()[_0x1635cf(0x18d)](_0x43e5a3,_0x5cb3f4,_0x480346);}static async[_0x33115c(0x15b)](_0x1a5ecb,_0x203077){const _0xd2b80a=_0x33115c;return await napCatCore['session'][_0xd2b80a(0x193)]()[_0xd2b80a(0x15b)](_0x1a5ecb,_0x203077);}static async[_0x33115c(0x168)](_0x398b3f,_0x578f24,_0x104787,_0x5577b2,_0x55da86){const _0x16437b=_0x33115c;return await napCatCore[_0x16437b(0x192)][_0x16437b(0x193)]()['getMsgsBySeqAndCount'](_0x398b3f,_0x578f24,_0x104787,_0x5577b2,_0x55da86);}static async[_0x33115c(0x19c)](_0xa0529d){}static async[_0x33115c(0x16d)](_0x4eb51b){}static async[_0x33115c(0x18e)](_0x512d91){const _0x39f67b=_0x33115c;return napCatCore['session']['getMsgService']()[_0x39f67b(0x18e)](_0x512d91);}static async[_0x33115c(0x180)](_0x1ed920,_0xee580f){const _0x4a1247=_0x33115c,_0x25c32e={'RcSsZ':function(_0xfe6b2e,_0x25cddf){return _0xfe6b2e(_0x25cddf);},'sbRCp':_0x4a1247(0x176),'laKmv':function(_0x5a8e47,_0x4ce424,_0x17547b){return _0x5a8e47(_0x4ce424,_0x17547b);},'MUWjt':function(_0x36f388){return _0x36f388();}};return new Promise(async(_0x24b027,_0x3526d6)=>{const _0x19e24c=_0x4a1247;let _0x3f3d2c=![];_0x25c32e[_0x19e24c(0x17c)](setTimeout,()=>{const _0x506bb0=_0x19e24c;!_0x3f3d2c&&_0x25c32e['RcSsZ'](_0x3526d6,_0x25c32e[_0x506bb0(0x15a)]);},0x1388);const _0x4db076=_0x15f6e2=>{const _0x5a9e94=_0x19e24c;_0x3f3d2c=!![],_0x24b027(_0x15f6e2[_0x5a9e94(0x19d)]);};GroupFileInfoUpdateTasks[_0x19e24c(0x182)](_0x25c32e[_0x19e24c(0x19a)](randomUUID),_0x4db076),await napCatCore[_0x19e24c(0x192)][_0x19e24c(0x174)]()[_0x19e24c(0x180)](_0x1ed920,_0xee580f);});}static async['getMsgHistory'](_0x3f8256,_0x56ecb3,_0x25f4a8){const _0xc9b2cc=_0x33115c;return napCatCore['session']['getMsgService']()[_0xc9b2cc(0x195)](_0x3f8256,_0x56ecb3,_0x25f4a8,!![]);}static async['fetchRecentContact'](){}static async[_0x33115c(0x178)](_0x48724e,_0x33402c){const _0x4a32ba=_0x33115c;await napCatCore[_0x4a32ba(0x192)][_0x4a32ba(0x193)]()[_0x4a32ba(0x178)]({'chatType':_0x48724e[_0x4a32ba(0x194)],'peerUid':_0x48724e[_0x4a32ba(0x173)]},_0x33402c);}static async[_0x33115c(0x183)](_0x545e23,_0x174420,_0x410852=!![],_0x186619=0x2710){const _0x3bbe04=_0x33115c,_0x57eac7={'UhNuG':function(_0xa822a0,_0x5d405a){return _0xa822a0>_0x5d405a;},'ssQHx':'发送超时','oGYCL':function(_0x547c1a){return _0x547c1a();},'cAsjz':function(_0x11ad5f,_0x25ded8){return _0x11ad5f===_0x25ded8;},'kOeWW':function(_0x44d6af,_0x31d15a,_0x214118){return _0x44d6af(_0x31d15a,_0x214118);}},_0x54667b=_0x545e23[_0x3bbe04(0x173)];let _0x4ca37e=0x0;const _0x2ba0f5=async()=>{const _0x1aeb51=_0x3bbe04;if(_0x57eac7[_0x1aeb51(0x187)](_0x4ca37e,_0x186619))throw _0x57eac7[_0x1aeb51(0x186)];const _0x5f1364=sendMessagePool[_0x545e23[_0x1aeb51(0x173)]];if(_0x5f1364)return await sleep(0x1f4),_0x4ca37e+=0x1f4,await _0x57eac7[_0x1aeb51(0x165)](_0x2ba0f5);else return;};return await _0x2ba0f5(),new Promise((_0x1a6613,_0x41b391)=>{const _0x85385d=_0x3bbe04;let _0x2621da=![],_0x505d5e=null;const _0x1a938d=randomUUID();sendSuccessCBMap[_0x1a938d]=_0x279802=>{const _0x8d7c14=_0x4c87;if(_0x57eac7[_0x8d7c14(0x158)](_0x279802['msgId'],_0x505d5e?.[_0x8d7c14(0x164)])){if(_0x57eac7[_0x8d7c14(0x158)](_0x279802[_0x8d7c14(0x17b)],0x2))return delete sendSuccessCBMap[_0x1a938d],_0x2621da=!![],_0x1a6613(_0x279802),!![];return![];}return![];},sendMessagePool[_0x54667b]=async _0x2844df=>{delete sendMessagePool[_0x54667b],_0x505d5e=_0x2844df;},_0x57eac7['kOeWW'](setTimeout,()=>{const _0x3a0457=_0x4c87;if(_0x2621da)return;delete sendMessagePool[_0x54667b],delete sendSuccessCBMap[_0x1a938d],_0x41b391(_0x57eac7[_0x3a0457(0x186)]);},_0x186619);const _0x5c32c8=napCatCore['session']['getMsgService']()[_0x85385d(0x183)]('0',_0x545e23,_0x174420,new Map());});}static async['forwardMsg'](_0x31d1c2,_0x89314f,_0x1b0b48){const _0x2ef6d9=_0x33115c;return napCatCore[_0x2ef6d9(0x192)]['getMsgService']()[_0x2ef6d9(0x19b)](_0x1b0b48,_0x31d1c2,[_0x89314f],new Map());}static async[_0x33115c(0x16e)](_0xc77c4e,_0x43c8c6,_0x76981a){const _0xf78952=_0x33115c,_0x495fd1={'dJHZi':_0xf78952(0x172),'FfzSs':function(_0x4605a4,_0x1f982e){return _0x4605a4!=_0x1f982e;},'Ulrrs':_0xf78952(0x185),'WcvVF':function(_0x52d925){return _0x52d925();},'PcmYV':function(_0x4c11fa,_0x2d2e36,_0x576953){return _0x4c11fa(_0x2d2e36,_0x576953);}},_0x2cb92b=_0x76981a[_0xf78952(0x157)](_0x2b33ad=>{return{'msgId':_0x2b33ad,'senderShowName':selfInfo['nick']};});return new Promise((_0x4801b0,_0x4a525d)=>{const _0x19fc35=_0xf78952,_0x4e2ce4={'yNybp':function(_0x5d6335,_0x391bac){const _0x5bd324=_0x4c87;return _0x495fd1[_0x5bd324(0x16b)](_0x5d6335,_0x391bac);},'klzcy':_0x495fd1[_0x19fc35(0x160)],'epPZC':function(_0x511c74,_0x5e747d){return _0x511c74==_0x5e747d;}};let _0x12dacf=![];const _0x2207bf=_0x231d7b=>{const _0x41672a=_0x19fc35,_0xdee648=_0x231d7b[_0x41672a(0x18c)][_0x41672a(0x166)](_0xda9a81=>_0xda9a81['arkElement']);if(!_0xdee648)return;const _0x5cc737=JSON[_0x41672a(0x184)](_0xdee648[_0x41672a(0x15f)][_0x41672a(0x153)]);if(_0x4e2ce4[_0x41672a(0x177)](_0x5cc737[_0x41672a(0x154)],_0x4e2ce4[_0x41672a(0x18f)]))return;_0x4e2ce4['epPZC'](_0x231d7b[_0x41672a(0x173)],_0x43c8c6[_0x41672a(0x173)])&&_0x4e2ce4[_0x41672a(0x163)](_0x231d7b[_0x41672a(0x190)],selfInfo[_0x41672a(0x16c)])&&(_0x12dacf=!![],_0x4801b0(_0x231d7b));};sentMsgTasks[_0x19fc35(0x182)](_0x495fd1[_0x19fc35(0x17d)](randomUUID),_0x2207bf),_0x495fd1[_0x19fc35(0x170)](setTimeout,()=>{!_0x12dacf&&_0x4a525d(_0x495fd1['dJHZi']);},0x1388),napCatCore[_0x19fc35(0x192)][_0x19fc35(0x193)]()[_0x19fc35(0x188)](_0x2cb92b,_0xc77c4e,_0x43c8c6,[],new Map());});}}