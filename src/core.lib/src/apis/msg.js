const _0x50694c=_0x553e;function _0x553e(_0x455715,_0x39b528){const _0x20115a=_0x2011();return _0x553e=function(_0x553ea8,_0x14ec00){_0x553ea8=_0x553ea8-0x7a;let _0x9f4fa0=_0x20115a[_0x553ea8];return _0x9f4fa0;},_0x553e(_0x455715,_0x39b528);}(function(_0x446bef,_0x523c60){const _0x1f6aa6=_0x553e,_0x16cff1=_0x446bef();while(!![]){try{const _0x59f032=-parseInt(_0x1f6aa6(0x9b))/0x1*(-parseInt(_0x1f6aa6(0xaa))/0x2)+parseInt(_0x1f6aa6(0x86))/0x3*(-parseInt(_0x1f6aa6(0xa7))/0x4)+-parseInt(_0x1f6aa6(0x92))/0x5+-parseInt(_0x1f6aa6(0x83))/0x6*(-parseInt(_0x1f6aa6(0x8b))/0x7)+parseInt(_0x1f6aa6(0xae))/0x8+-parseInt(_0x1f6aa6(0xb9))/0x9+-parseInt(_0x1f6aa6(0xb3))/0xa*(-parseInt(_0x1f6aa6(0x7a))/0xb);if(_0x59f032===_0x523c60)break;else _0x16cff1['push'](_0x16cff1['shift']());}catch(_0x1f57ae){_0x16cff1['push'](_0x16cff1['shift']());}}}(_0x2011,0x8fbef));function _0x2011(){const _0x266698=['getMsgHistory','QJegA','recallMsg','QlNWU','359880eDFRAw','getMsgsByMsgId','catch','ATYIp','onMsgInfoListUpdate','length','3180276QLfOkF','uwOXf','55dndekj','delete','vsAbc','getMsgService','fqIcg','uid','addListener','forwardMsg','fetchRecentContact','132QBQZyt','getMultiMsg','setMsgRead','491442UxxVSD','msgId','com.tencent.multimsg','getMsgsIncludeSelf','multiForwardMsgWithComment','316694LulgxK','MleMb','then','sendMsg','JuHuZ','QkUXI','MTJjW','491480rLAMwj','nick','IIghW','activateChatAndGetHistory','session','set','arkElement','chatType','HrouL','1hNHstg','setEmojiLike','peerUid','发送超时','lTqIQ','onLoginSuccess','KSFFC','forEach','AhuhI','nWZPe','BSQqP','getMsgsBySeqAndCount','16eVtIxR','setMsgEmojiLikes','elements','558582TkHyya','parse','MIRwH','转发消息超时','1929152OMzllx'];_0x2011=function(){return _0x266698;};return _0x2011();}import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onAddSendMsg']=_0x5ac849=>{const _0x44e705=_0x553e,_0x264f84={'QlNWU':function(_0x1c1b19,_0xd42c10){return _0x1c1b19(_0xd42c10);},'AhuhI':function(_0x4f03c2,_0x323861){return _0x4f03c2 instanceof _0x323861;}};for(const [_0x6b2cd0,_0x2a79b8]of sentMsgTasks){_0x264f84[_0x44e705(0xb2)](_0x2a79b8,_0x5ac849),sentMsgTasks[_0x44e705(0x7b)](_0x6b2cd0);}if(sendMessagePool[_0x5ac849['peerUid']]){const _0xc48de9=sendMessagePool[_0x5ac849[_0x44e705(0x9d)]]?.(_0x5ac849);_0x264f84[_0x44e705(0xa3)](_0xc48de9,Promise)&&_0xc48de9['then']()[_0x44e705(0xb5)](logError);}},msgListener[_0x50694c(0xb7)]=_0x359bc5=>{const _0x405c1b=_0x50694c,_0x3d277c={'KSFFC':function(_0x5e3cc5,_0x2e4ab5){return _0x5e3cc5(_0x2e4ab5);},'HrouL':function(_0x465f45,_0x1e9743){return _0x465f45 instanceof _0x1e9743;},'ATYIp':function(_0x2862c5,_0x4f23ef){return _0x2862c5(_0x4f23ef);}};_0x359bc5[_0x405c1b(0xa2)](_0x5b43e5=>{const _0x253824=_0x405c1b;new Promise((_0x48589a,_0x294bad)=>{const _0x4fa58e=_0x553e;for(const _0xb59e22 in sendSuccessCBMap){const _0x580ae5=sendSuccessCBMap[_0xb59e22],_0x1e8c5d=_0x3d277c[_0x4fa58e(0xa1)](_0x580ae5,_0x5b43e5),_0x28ef49=_0x966db0=>{_0x966db0&&delete sendSuccessCBMap[_0xb59e22];};_0x3d277c[_0x4fa58e(0x9a)](_0x1e8c5d,Promise)?_0x1e8c5d[_0x4fa58e(0x8d)](_0x28ef49):_0x3d277c[_0x4fa58e(0xb6)](_0x28ef49,_0x1e8c5d);}})[_0x253824(0x8d)]()[_0x253824(0xb5)](log);});},setTimeout(()=>{const _0x5f5a9b=_0x50694c;napCatCore[_0x5f5a9b(0xa0)](()=>{const _0x43e276=_0x5f5a9b;napCatCore[_0x43e276(0x80)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x50694c(0x9c)](_0x188005,_0x5c7d11,_0x378cdc,_0x3d8e85=!![]){const _0x1fd821=_0x50694c,_0x2958c5={'cDrBe':function(_0x1ee26a,_0x34b318){return _0x1ee26a>_0x34b318;}};return _0x378cdc=_0x378cdc['toString'](),napCatCore['session'][_0x1fd821(0x7d)]()[_0x1fd821(0xa8)](_0x188005,_0x5c7d11,_0x378cdc,_0x2958c5['cDrBe'](_0x378cdc[_0x1fd821(0xb8)],0x3)?'2':'1',_0x3d8e85);}static async[_0x50694c(0x84)](_0xf4a64d,_0x549aee,_0x5b7f8c){const _0x577986=_0x50694c;return napCatCore['session'][_0x577986(0x7d)]()[_0x577986(0x84)](_0xf4a64d,_0x549aee,_0x5b7f8c);}static async[_0x50694c(0xb4)](_0x169d88,_0x578db3){const _0x581910=_0x50694c;return await napCatCore[_0x581910(0x96)]['getMsgService']()['getMsgsByMsgId'](_0x169d88,_0x578db3);}static async[_0x50694c(0xa6)](_0x4fe4f8,_0x10f2a4,_0x10656d,_0x43f041,_0x2159e8){return await napCatCore['session']['getMsgService']()['getMsgsBySeqAndCount'](_0x4fe4f8,_0x10f2a4,_0x10656d,_0x43f041,_0x2159e8);}static async['activateChat'](_0x73e618){}static async[_0x50694c(0x95)](_0xcbf135){}static async['setMsgRead'](_0x31f2b1){const _0x4ea031=_0x50694c;return napCatCore[_0x4ea031(0x96)]['getMsgService']()[_0x4ea031(0x85)](_0x31f2b1);}static async[_0x50694c(0xaf)](_0xb4c0d7,_0x2c486f,_0x23c50d){const _0x2baafa=_0x50694c;return napCatCore['session'][_0x2baafa(0x7d)]()[_0x2baafa(0x89)](_0xb4c0d7,_0x2c486f,_0x23c50d,!![]);}static async[_0x50694c(0x82)](){}static async[_0x50694c(0xb1)](_0x307bbf,_0x4e671d){const _0xb4ba75=_0x50694c;await napCatCore[_0xb4ba75(0x96)][_0xb4ba75(0x7d)]()[_0xb4ba75(0xb1)]({'chatType':_0x307bbf[_0xb4ba75(0x99)],'peerUid':_0x307bbf[_0xb4ba75(0x9d)]},_0x4e671d);}static async[_0x50694c(0x8e)](_0x41b74b,_0x2e8741,_0x34058c=!![],_0x5a662e=0x2710){const _0x1c1e5f=_0x50694c,_0x54147e={'lTqIQ':function(_0x2df85a,_0x566535){return _0x2df85a(_0x566535);},'MleMb':function(_0x939bbf){return _0x939bbf();},'QkUXI':function(_0x17d5c9,_0x25071c){return _0x17d5c9===_0x25071c;},'fqIcg':function(_0x554575,_0x57de86){return _0x554575(_0x57de86);},'IIghW':_0x1c1e5f(0x9e),'BSQqP':function(_0x344654){return _0x344654();}},_0xbd31cd=_0x41b74b['peerUid'];let _0x314b87=0x0;const _0x4d5843=async()=>{const _0x5d395a=_0x1c1e5f;if(_0x314b87>_0x5a662e)throw _0x5d395a(0x9e);const _0x3eb299=sendMessagePool[_0x41b74b[_0x5d395a(0x9d)]];if(_0x3eb299)return await _0x54147e[_0x5d395a(0x9f)](sleep,0x1f4),_0x314b87+=0x1f4,await _0x54147e[_0x5d395a(0x8c)](_0x4d5843);else return;};return await _0x54147e[_0x1c1e5f(0xa5)](_0x4d5843),new Promise((_0x6b2062,_0x3ea2de)=>{const _0x58f3d7=_0x1c1e5f,_0x15595d={'uwOXf':_0x54147e[_0x58f3d7(0x94)]};let _0x31cdc9=![],_0x3e08ee=null;const _0x3e51a8=_0x54147e['BSQqP'](randomUUID);sendSuccessCBMap[_0x3e51a8]=_0x1380a4=>{const _0x15cd9e=_0x58f3d7;if(_0x1380a4[_0x15cd9e(0x87)]===_0x3e08ee?.[_0x15cd9e(0x87)]){if(_0x54147e[_0x15cd9e(0x90)](_0x1380a4['sendStatus'],0x2))return delete sendSuccessCBMap[_0x3e51a8],_0x31cdc9=!![],_0x54147e[_0x15cd9e(0x7e)](_0x6b2062,_0x1380a4),!![];return![];}return![];},sendMessagePool[_0xbd31cd]=async _0x174c23=>{delete sendMessagePool[_0xbd31cd],_0x3e08ee=_0x174c23;},setTimeout(()=>{const _0x4aa876=_0x58f3d7;if(_0x31cdc9)return;delete sendMessagePool[_0xbd31cd],delete sendSuccessCBMap[_0x3e51a8],_0x3ea2de(_0x15595d[_0x4aa876(0xba)]);},_0x5a662e);const _0x1c0fea=napCatCore[_0x58f3d7(0x96)][_0x58f3d7(0x7d)]()[_0x58f3d7(0x8e)]('0',_0x41b74b,_0x2e8741,new Map());});}static async[_0x50694c(0x81)](_0x2ce536,_0x2e1f86,_0x5cd82d){const _0x341ec2=_0x50694c;return napCatCore[_0x341ec2(0x96)][_0x341ec2(0x7d)]()['forwardMsg'](_0x5cd82d,_0x2ce536,[_0x2e1f86],new Map());}static async['multiForwardMsg'](_0x5b0f3e,_0x520f9e,_0x4bf817){const _0x470286=_0x50694c,_0x577643={'vsAbc':function(_0x27e268,_0x17f0de){return _0x27e268!=_0x17f0de;},'nWZPe':_0x470286(0x88),'TzDmY':function(_0xefb82a,_0x52a5f7){return _0xefb82a==_0x52a5f7;},'JuHuZ':function(_0x1a6168,_0x46f9ec){return _0x1a6168==_0x46f9ec;},'MTJjW':function(_0x42ba2f,_0x1e5ca3){return _0x42ba2f(_0x1e5ca3);},'QJegA':function(_0x13952c){return _0x13952c();},'MIRwH':function(_0x5a88c9,_0x22b314,_0x434d22){return _0x5a88c9(_0x22b314,_0x434d22);}},_0x13425c=_0x4bf817['map'](_0x59b6d2=>{const _0x527bee=_0x470286;return{'msgId':_0x59b6d2,'senderShowName':selfInfo[_0x527bee(0x93)]};});return new Promise((_0x5d1bfa,_0x2ed39d)=>{const _0x1d2631=_0x470286;let _0x2e9353=![];const _0x59f8a5=_0xdb4b3d=>{const _0xae33a1=_0x553e,_0x63d5de=_0xdb4b3d[_0xae33a1(0xa9)]['find'](_0x158559=>_0x158559[_0xae33a1(0x98)]);if(!_0x63d5de)return;const _0x5930ea=JSON[_0xae33a1(0xab)](_0x63d5de[_0xae33a1(0x98)]['bytesData']);if(_0x577643[_0xae33a1(0x7c)](_0x5930ea['app'],_0x577643[_0xae33a1(0xa4)]))return;_0x577643['TzDmY'](_0xdb4b3d[_0xae33a1(0x9d)],_0x520f9e[_0xae33a1(0x9d)])&&_0x577643[_0xae33a1(0x8f)](_0xdb4b3d['senderUid'],selfInfo[_0xae33a1(0x7f)])&&(_0x2e9353=!![],_0x577643[_0xae33a1(0x91)](_0x5d1bfa,_0xdb4b3d));};sentMsgTasks[_0x1d2631(0x97)](_0x577643[_0x1d2631(0xb0)](randomUUID),_0x59f8a5),_0x577643[_0x1d2631(0xac)](setTimeout,()=>{const _0x32daf8=_0x1d2631;!_0x2e9353&&_0x2ed39d(_0x32daf8(0xad));},0x1388),napCatCore[_0x1d2631(0x96)][_0x1d2631(0x7d)]()[_0x1d2631(0x8a)](_0x13425c,_0x5b0f3e,_0x520f9e,[],new Map());});}}