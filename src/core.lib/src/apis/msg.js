function _0x5cbf(_0x479eb1,_0x230623){const _0xf9fb1c=_0xf9fb();return _0x5cbf=function(_0x5cbf82,_0x8c450a){_0x5cbf82=_0x5cbf82-0x101;let _0x243436=_0xf9fb1c[_0x5cbf82];return _0x243436;},_0x5cbf(_0x479eb1,_0x230623);}const _0xed01a1=_0x5cbf;(function(_0x58aa53,_0x154c0d){const _0x268b1e=_0x5cbf,_0x1f9c40=_0x58aa53();while(!![]){try{const _0x7872ee=-parseInt(_0x268b1e(0x116))/0x1*(-parseInt(_0x268b1e(0x14b))/0x2)+parseInt(_0x268b1e(0x14f))/0x3*(-parseInt(_0x268b1e(0x147))/0x4)+parseInt(_0x268b1e(0x134))/0x5+parseInt(_0x268b1e(0x105))/0x6*(-parseInt(_0x268b1e(0x12e))/0x7)+parseInt(_0x268b1e(0x10e))/0x8+parseInt(_0x268b1e(0x141))/0x9+-parseInt(_0x268b1e(0x120))/0xa;if(_0x7872ee===_0x154c0d)break;else _0x1f9c40['push'](_0x1f9c40['shift']());}catch(_0x44871a){_0x1f9c40['push'](_0x1f9c40['shift']());}}}(_0xf9fb,0x1915f));import{selfInfo}from'@/core/data';function _0xf9fb(){const _0x44fdfb=['nick','280184dlryPH','catch','dxtzW','setMsgRead','msgId','peerUid','find','recallMsg','37duofnw','rnjZM','addListener','gjuKD','KFSMe','BmPSa','multiForwardMsg','app','getMsgsIncludeSelf','arkElement','951780UyKYcM','onMsgInfoListUpdate','ZBwRB','set','转发消息超时','uJweG','bytesData','UbrCp','setMsgEmojiLikes','getMsgService','map','qpTxN','DRndN','tMRWN','10871VEkDEO','MPLop','onGroupFileInfoUpdate','chatType','QVyVb','getMsgsBySeqAndCount','789305mMJuJw','activateChatAndGetHistory','jtodx','toString','yqWxw','item','getRichMediaService','elements','xECzv','fetchRecentContact','getMsgHistory','aNtcs','nNliq','1136142SxLXEn','com.tencent.multimsg','RWWuy','wQeIP','session','then','1316vshAlm','getMsgsByMsgId','forEach','activateChat','4574OzHukg','getMultiMsg','sendMsg','sendStatus','1551iqRerL','delete','hXtGO','forwardMsg','ioKKv','setEmojiLike','138jAjWaI','onAddSendMsg','ysVKI','onLoginSuccess','multiForwardMsgWithComment','XeuhO','tTvDb','getGroupFileList'];_0xf9fb=function(){return _0x44fdfb;};return _0xf9fb();}import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0xed01a1(0x130)]=_0x47fa6b=>{const _0xfbe6c0=_0xed01a1,_0x58336a={'MPLop':function(_0x371ad1,_0x4a803d){return _0x371ad1(_0x4a803d);}};for(const [_0x2c1218,_0x4a40d2]of GroupFileInfoUpdateTasks){_0x58336a[_0xfbe6c0(0x12f)](_0x4a40d2,_0x47fa6b),GroupFileInfoUpdateTasks[_0xfbe6c0(0x150)](_0x2c1218);}},msgListener[_0xed01a1(0x106)]=_0x3c2f94=>{const _0x10cc58=_0xed01a1,_0x356857={'BmPSa':function(_0x453d9c,_0x30855f){return _0x453d9c(_0x30855f);},'aNtcs':function(_0x11688e,_0x43de08){return _0x11688e instanceof _0x43de08;}};for(const [_0x38d2ea,_0x11aa32]of sentMsgTasks){_0x356857[_0x10cc58(0x11b)](_0x11aa32,_0x3c2f94),sentMsgTasks[_0x10cc58(0x150)](_0x38d2ea);}if(sendMessagePool[_0x3c2f94[_0x10cc58(0x113)]]){const _0x23a12a=sendMessagePool[_0x3c2f94[_0x10cc58(0x113)]]?.(_0x3c2f94);_0x356857[_0x10cc58(0x13f)](_0x23a12a,Promise)&&_0x23a12a[_0x10cc58(0x146)]()[_0x10cc58(0x10f)](logError);}},msgListener[_0xed01a1(0x121)]=_0x1552b3=>{const _0x534f01=_0xed01a1,_0x5e2c42={'xEyQS':function(_0x261cd1,_0xc0c62f){return _0x261cd1(_0xc0c62f);},'zLIoA':function(_0x4768a5,_0x464a1c){return _0x4768a5 instanceof _0x464a1c;}};_0x1552b3[_0x534f01(0x149)](_0x5cd26a=>{const _0x29ac8a=_0x534f01,_0x27ffcc={'tMRWN':function(_0xaa8654,_0x1e0322){return _0x5e2c42['xEyQS'](_0xaa8654,_0x1e0322);},'KFSMe':function(_0x498491,_0x135ceb){return _0x5e2c42['zLIoA'](_0x498491,_0x135ceb);}};new Promise((_0x386a06,_0x3fc9f2)=>{const _0x3359b1=_0x5cbf;for(const _0x281946 in sendSuccessCBMap){const _0x395bae=sendSuccessCBMap[_0x281946],_0x3833a4=_0x27ffcc[_0x3359b1(0x12d)](_0x395bae,_0x5cd26a),_0x43e208=_0x52a774=>{_0x52a774&&delete sendSuccessCBMap[_0x281946];};_0x27ffcc[_0x3359b1(0x11a)](_0x3833a4,Promise)?_0x3833a4[_0x3359b1(0x146)](_0x43e208):_0x43e208(_0x3833a4);}})[_0x29ac8a(0x146)]()[_0x29ac8a(0x10f)](log);});},setTimeout(()=>{const _0x31f950=_0xed01a1;napCatCore[_0x31f950(0x108)](()=>{const _0x4b2aa4=_0x31f950;napCatCore[_0x4b2aa4(0x118)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0xed01a1(0x104)](_0x59bc46,_0x3cc9cc,_0x395001,_0x4773a0=!![]){const _0x34826e=_0xed01a1,_0x45682f={'rnjZM':function(_0x20034b,_0x4798a5){return _0x20034b>_0x4798a5;}};return _0x395001=_0x395001[_0x34826e(0x137)](),napCatCore['session'][_0x34826e(0x129)]()[_0x34826e(0x128)](_0x59bc46,_0x3cc9cc,_0x395001,_0x45682f[_0x34826e(0x117)](_0x395001['length'],0x3)?'2':'1',_0x4773a0);}static async[_0xed01a1(0x14c)](_0x493def,_0x57e6d7,_0x3ce4fe){const _0x3276ce=_0xed01a1;return napCatCore[_0x3276ce(0x145)]['getMsgService']()[_0x3276ce(0x14c)](_0x493def,_0x57e6d7,_0x3ce4fe);}static async[_0xed01a1(0x148)](_0x526956,_0x2367d0){const _0x246b36=_0xed01a1;return await napCatCore['session'][_0x246b36(0x129)]()['getMsgsByMsgId'](_0x526956,_0x2367d0);}static async[_0xed01a1(0x133)](_0x7c2c02,_0x1327fa,_0x237830,_0x5c1bbf,_0x3b19b6){const _0xc988c9=_0xed01a1;return await napCatCore[_0xc988c9(0x145)][_0xc988c9(0x129)]()[_0xc988c9(0x133)](_0x7c2c02,_0x1327fa,_0x237830,_0x5c1bbf,_0x3b19b6);}static async[_0xed01a1(0x14a)](_0x15252d){}static async[_0xed01a1(0x135)](_0x56c122){}static async[_0xed01a1(0x111)](_0x442617){const _0x43fbbe=_0xed01a1;return napCatCore[_0x43fbbe(0x145)]['getMsgService']()[_0x43fbbe(0x111)](_0x442617);}static async[_0xed01a1(0x10c)](_0x294976,_0x4ea373){const _0x2405c9={'qpTxN':function(_0x3e91d4,_0x17bff4){return _0x3e91d4(_0x17bff4);},'wQeIP':'获取群文件列表超时','XeuhO':function(_0x55ff40,_0x50cf6e,_0x2db29d){return _0x55ff40(_0x50cf6e,_0x2db29d);},'ioKKv':function(_0x4ad79a){return _0x4ad79a();}};return new Promise(async(_0x36e28d,_0x101af0)=>{const _0x50f2fd=_0x5cbf,_0x47a2a6={'nNliq':_0x2405c9[_0x50f2fd(0x144)]};let _0x2c49b2=![];_0x2405c9[_0x50f2fd(0x10a)](setTimeout,()=>{const _0x12bf55=_0x50f2fd;!_0x2c49b2&&_0x101af0(_0x47a2a6[_0x12bf55(0x140)]);},0x1388);const _0x2e6785=_0x5edf4d=>{const _0x5468d8=_0x50f2fd;_0x2c49b2=!![],_0x2405c9[_0x5468d8(0x12b)](_0x36e28d,_0x5edf4d[_0x5468d8(0x139)]);};GroupFileInfoUpdateTasks[_0x50f2fd(0x123)](_0x2405c9[_0x50f2fd(0x103)](randomUUID),_0x2e6785),await napCatCore[_0x50f2fd(0x145)][_0x50f2fd(0x13a)]()[_0x50f2fd(0x10c)](_0x294976,_0x4ea373);});}static async[_0xed01a1(0x13e)](_0x5fc3c1,_0x5953ce,_0x1089d9){const _0xb96081=_0xed01a1;return napCatCore[_0xb96081(0x145)]['getMsgService']()[_0xb96081(0x11e)](_0x5fc3c1,_0x5953ce,_0x1089d9,!![]);}static async[_0xed01a1(0x13d)](){}static async[_0xed01a1(0x115)](_0x534e94,_0x9a526c){const _0x3750d6=_0xed01a1;await napCatCore['session'][_0x3750d6(0x129)]()[_0x3750d6(0x115)]({'chatType':_0x534e94[_0x3750d6(0x131)],'peerUid':_0x534e94[_0x3750d6(0x113)]},_0x9a526c);}static async[_0xed01a1(0x14d)](_0x5142a0,_0x487ae1,_0x472daa=!![],_0x289331=0x2710){const _0x4211c5=_0xed01a1,_0x5d3676={'ZBwRB':function(_0x6d18bc,_0x3d24a7){return _0x6d18bc>_0x3d24a7;},'tTvDb':'发送超时','UbrCp':function(_0x87c5f8,_0x1f6d6c){return _0x87c5f8(_0x1f6d6c);},'uJweG':function(_0x466a38){return _0x466a38();},'DRndN':function(_0x575b4b,_0x5b1652){return _0x575b4b===_0x5b1652;},'xECzv':function(_0x2de24e,_0x41ca48){return _0x2de24e(_0x41ca48);},'OVoRH':function(_0x5855a7,_0x4aaa45){return _0x5855a7(_0x4aaa45);},'hXtGO':function(_0x42265d){return _0x42265d();},'ysVKI':function(_0x34832a,_0x218e3b,_0x5ef1bf){return _0x34832a(_0x218e3b,_0x5ef1bf);}},_0x587e81=_0x5142a0[_0x4211c5(0x113)];let _0x13efed=0x0;const _0x37dd74=async()=>{const _0x1c65e6=_0x4211c5;if(_0x5d3676[_0x1c65e6(0x122)](_0x13efed,_0x289331))throw _0x5d3676[_0x1c65e6(0x10b)];const _0x14bb29=sendMessagePool[_0x5142a0[_0x1c65e6(0x113)]];if(_0x14bb29)return await _0x5d3676[_0x1c65e6(0x127)](sleep,0x1f4),_0x13efed+=0x1f4,await _0x5d3676[_0x1c65e6(0x125)](_0x37dd74);else return;};return await _0x37dd74(),new Promise((_0x472f12,_0x5286fe)=>{const _0x43b75b=_0x4211c5;let _0x566ba1=![],_0x1bded6=null;const _0x256ece=_0x5d3676[_0x43b75b(0x101)](randomUUID);sendSuccessCBMap[_0x256ece]=_0x499c48=>{const _0x3d36ca=_0x43b75b;if(_0x5d3676[_0x3d36ca(0x12c)](_0x499c48[_0x3d36ca(0x112)],_0x1bded6?.['msgId'])){if(_0x5d3676['DRndN'](_0x499c48[_0x3d36ca(0x14e)],0x2))return delete sendSuccessCBMap[_0x256ece],_0x566ba1=!![],_0x5d3676[_0x3d36ca(0x13c)](_0x472f12,_0x499c48),!![];return![];}return![];},sendMessagePool[_0x587e81]=async _0x2f0b67=>{delete sendMessagePool[_0x587e81],_0x1bded6=_0x2f0b67;},_0x5d3676[_0x43b75b(0x107)](setTimeout,()=>{if(_0x566ba1)return;delete sendMessagePool[_0x587e81],delete sendSuccessCBMap[_0x256ece],_0x5d3676['OVoRH'](_0x5286fe,_0x5d3676['tTvDb']);},_0x289331);const _0x7a710d=napCatCore[_0x43b75b(0x145)]['getMsgService']()[_0x43b75b(0x14d)]('0',_0x5142a0,_0x487ae1,new Map());});}static async[_0xed01a1(0x102)](_0xfa7efe,_0x25703e,_0x436dfe){const _0x45402e=_0xed01a1;return napCatCore['session'][_0x45402e(0x129)]()[_0x45402e(0x102)](_0x436dfe,_0xfa7efe,[_0x25703e],new Map());}static async[_0xed01a1(0x11c)](_0x6fd6fe,_0x12f5d8,_0x13da12){const _0x2305cd=_0xed01a1,_0x2752ea={'FfJnk':_0x2305cd(0x124),'SMFcq':_0x2305cd(0x142),'QVyVb':function(_0x4755c1,_0x36d629){return _0x4755c1==_0x36d629;},'gjuKD':function(_0x8d1e6a){return _0x8d1e6a();},'dxtzW':function(_0x24bd4f,_0x30f7be,_0x412d0f){return _0x24bd4f(_0x30f7be,_0x412d0f);}},_0x41642f=_0x13da12[_0x2305cd(0x12a)](_0x52bd16=>{const _0x93e46a=_0x2305cd;return{'msgId':_0x52bd16,'senderShowName':selfInfo[_0x93e46a(0x10d)]};});return new Promise((_0x1e0cc7,_0x466deb)=>{const _0x149b55=_0x2305cd,_0x120e8e={'yqWxw':function(_0x451c15,_0xc9c39){return _0x451c15!=_0xc9c39;},'jtodx':_0x2752ea['SMFcq'],'RWWuy':function(_0x59ac2f,_0x35c924){const _0x20daf7=_0x5cbf;return _0x2752ea[_0x20daf7(0x132)](_0x59ac2f,_0x35c924);}};let _0xce9c09=![];const _0xd5c8b5=_0x404b11=>{const _0x2b2dac=_0x5cbf,_0x67a52b=_0x404b11[_0x2b2dac(0x13b)][_0x2b2dac(0x114)](_0x518751=>_0x518751[_0x2b2dac(0x11f)]);if(!_0x67a52b)return;const _0x411ffe=JSON['parse'](_0x67a52b[_0x2b2dac(0x11f)][_0x2b2dac(0x126)]);if(_0x120e8e[_0x2b2dac(0x138)](_0x411ffe[_0x2b2dac(0x11d)],_0x120e8e[_0x2b2dac(0x136)]))return;_0x404b11[_0x2b2dac(0x113)]==_0x12f5d8[_0x2b2dac(0x113)]&&_0x120e8e[_0x2b2dac(0x143)](_0x404b11['senderUid'],selfInfo['uid'])&&(_0xce9c09=!![],_0x1e0cc7(_0x404b11));};sentMsgTasks['set'](_0x2752ea[_0x149b55(0x119)](randomUUID),_0xd5c8b5),_0x2752ea[_0x149b55(0x110)](setTimeout,()=>{!_0xce9c09&&_0x466deb(_0x2752ea['FfJnk']);},0x1388),napCatCore[_0x149b55(0x145)][_0x149b55(0x129)]()[_0x149b55(0x109)](_0x41642f,_0x6fd6fe,_0x12f5d8,[],new Map());});}}