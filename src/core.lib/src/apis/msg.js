const _0x4b0fcf=_0x2adc;(function(_0x1bf26e,_0x2f8c30){const _0x307e4a=_0x2adc,_0x809fbb=_0x1bf26e();while(!![]){try{const _0x89858=parseInt(_0x307e4a(0xb6))/0x1*(parseInt(_0x307e4a(0xa0))/0x2)+-parseInt(_0x307e4a(0xbd))/0x3+parseInt(_0x307e4a(0xca))/0x4+-parseInt(_0x307e4a(0xb0))/0x5*(parseInt(_0x307e4a(0xc3))/0x6)+parseInt(_0x307e4a(0x9b))/0x7*(parseInt(_0x307e4a(0xb2))/0x8)+parseInt(_0x307e4a(0xb1))/0x9+parseInt(_0x307e4a(0xb8))/0xa;if(_0x89858===_0x2f8c30)break;else _0x809fbb['push'](_0x809fbb['shift']());}catch(_0x54b78d){_0x809fbb['push'](_0x809fbb['shift']());}}}(_0xa5c3,0x18b52));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';function _0x2adc(_0x538546,_0x495680){const _0xa5c335=_0xa5c3();return _0x2adc=function(_0x2adc70,_0x5632d4){_0x2adc70=_0x2adc70-0x88;let _0x3eaa5b=_0xa5c335[_0x2adc70];return _0x3eaa5b;},_0x2adc(_0x538546,_0x495680);}function _0xa5c3(){const _0xc45952=['562BArTzA','getMsgService','onAddSendMsg','then','getMultiMsg','Zlils','recallMsg','VLKGI','gpQsG','getMsgsByMsgId','发送超时','msgId','peerUid','set','catch','cUZgG','451730xxsdOi','966114FyEnCH','80ErKrmG','delete','leEhn','session','193DiuzkV','forwardMsg','246450agkUMz','OqFUB','sjjOh','phPHn','HJlRM','496269hZzwPS','getMsgsIncludeSelf','getMsgsBySeqAndCount','setMsgEmojiLikes','setEmojiLike','com.tencent.multimsg','6CyvLjH','senderUid','eUrFZ','fetchRecentContact','chatType','转发消息超时','vHeOk','189348Skofqq','elements','nick','toString','activateChatAndGetHistory','VZxPx','jmqkA','bytesData','qRWnj','multiForwardMsg','iRWOK','app','kDanX','amsvl','sgbGm','getMsgHistory','onMsgInfoListUpdate','EWiHa','HDyjr','arkElement','find','IhYcW','length','map','addListener','activateChat','onLoginSuccess','86387EllYQM','setMsgRead','forEach','sendMsg','AMrLd'];_0xa5c3=function(){return _0xc45952;};return _0xa5c3();}import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x4b0fcf(0xa2)]=_0x291477=>{const _0x5970b5=_0x4b0fcf,_0x42799c={'KUFrk':function(_0x572d02,_0x461772){return _0x572d02(_0x461772);},'EWiHa':function(_0x495f39,_0x55223f){return _0x495f39 instanceof _0x55223f;}};for(const [_0x5d913f,_0x25e579]of sentMsgTasks){_0x42799c['KUFrk'](_0x25e579,_0x291477),sentMsgTasks[_0x5970b5(0xb3)](_0x5d913f);}if(sendMessagePool[_0x291477['peerUid']]){const _0x367df9=sendMessagePool[_0x291477['peerUid']]?.(_0x291477);_0x42799c[_0x5970b5(0x91)](_0x367df9,Promise)&&_0x367df9['then']()[_0x5970b5(0xae)](logError);}},msgListener[_0x4b0fcf(0x90)]=_0x15dbe9=>{const _0x445cd9=_0x4b0fcf,_0x2c6ee3={'cUZgG':function(_0x2996c7,_0x48ee68){return _0x2996c7(_0x48ee68);},'kDanX':function(_0x246373,_0x53d37c){return _0x246373 instanceof _0x53d37c;}};_0x15dbe9[_0x445cd9(0x9d)](_0x2573ba=>{const _0x41d4a1=_0x445cd9,_0x1e2f63={'IhYcW':function(_0x2f3082,_0x183cdc){const _0x476936=_0x2adc;return _0x2c6ee3[_0x476936(0xaf)](_0x2f3082,_0x183cdc);},'leEhn':function(_0x184a09,_0xa28c){const _0xb19d15=_0x2adc;return _0x2c6ee3[_0xb19d15(0x8c)](_0x184a09,_0xa28c);}};new Promise((_0xfbb497,_0x502181)=>{const _0x330ea1=_0x2adc;for(const _0x1581ab in sendSuccessCBMap){const _0x5a9786=sendSuccessCBMap[_0x1581ab],_0x4336e2=_0x1e2f63[_0x330ea1(0x95)](_0x5a9786,_0x2573ba),_0x494c1c=_0x13a019=>{_0x13a019&&delete sendSuccessCBMap[_0x1581ab];};_0x1e2f63[_0x330ea1(0xb4)](_0x4336e2,Promise)?_0x4336e2[_0x330ea1(0xa3)](_0x494c1c):_0x494c1c(_0x4336e2);}})[_0x41d4a1(0xa3)]()[_0x41d4a1(0xae)](log);});},setTimeout(()=>{const _0x5f0c7d=_0x4b0fcf;napCatCore[_0x5f0c7d(0x9a)](()=>{const _0x2db7e7=_0x5f0c7d;napCatCore[_0x2db7e7(0x98)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x4b0fcf(0xc1)](_0x37e539,_0x46ccab,_0x3a6048,_0x28acc9=!![]){const _0xb32e69=_0x4b0fcf;return _0x3a6048=_0x3a6048[_0xb32e69(0xcd)](),napCatCore[_0xb32e69(0xb5)]['getMsgService']()[_0xb32e69(0xc0)](_0x37e539,_0x46ccab,_0x3a6048,_0x3a6048[_0xb32e69(0x96)]>0x3?'2':'1',_0x28acc9);}static async[_0x4b0fcf(0xa4)](_0x2863c2,_0x431f15,_0x324ea2){const _0x5735fe=_0x4b0fcf;return napCatCore[_0x5735fe(0xb5)][_0x5735fe(0xa1)]()['getMultiMsg'](_0x2863c2,_0x431f15,_0x324ea2);}static async[_0x4b0fcf(0xa9)](_0x404559,_0x20b4e6){const _0x5cd0ab=_0x4b0fcf;return await napCatCore[_0x5cd0ab(0xb5)][_0x5cd0ab(0xa1)]()[_0x5cd0ab(0xa9)](_0x404559,_0x20b4e6);}static async[_0x4b0fcf(0xbf)](_0x5423af,_0x538193,_0xeb62d1,_0xed7855,_0x337fb1){const _0x4e071b=_0x4b0fcf;return await napCatCore['session'][_0x4e071b(0xa1)]()['getMsgsBySeqAndCount'](_0x5423af,_0x538193,_0xeb62d1,_0xed7855,_0x337fb1);}static async[_0x4b0fcf(0x99)](_0x26d3b3){}static async[_0x4b0fcf(0xce)](_0x37823f){}static async[_0x4b0fcf(0x9c)](_0x1bba71){const _0x2525b7=_0x4b0fcf;return napCatCore[_0x2525b7(0xb5)][_0x2525b7(0xa1)]()[_0x2525b7(0x9c)](_0x1bba71);}static async[_0x4b0fcf(0x8f)](_0x58c535,_0x2fb738,_0x1cc34e){const _0x4c1a1c=_0x4b0fcf;return napCatCore[_0x4c1a1c(0xb5)][_0x4c1a1c(0xa1)]()[_0x4c1a1c(0xbe)](_0x58c535,_0x2fb738,_0x1cc34e,!![]);}static async[_0x4b0fcf(0xc6)](){}static async[_0x4b0fcf(0xa6)](_0x30776d,_0x41d789){const _0x218769=_0x4b0fcf;await napCatCore[_0x218769(0xb5)][_0x218769(0xa1)]()[_0x218769(0xa6)]({'chatType':_0x30776d[_0x218769(0xc7)],'peerUid':_0x30776d['peerUid']},_0x41d789);}static async['sendMsg'](_0x489347,_0x1fe30e,_0x117979=!![],_0x524e1f=0x2710){const _0x29933c=_0x4b0fcf,_0x534560={'jmqkA':function(_0x1128c6,_0x12be10){return _0x1128c6>_0x12be10;},'phPHn':_0x29933c(0xaa),'gpQsG':function(_0x12c8ca,_0x40d33c){return _0x12c8ca(_0x40d33c);},'ioNXR':function(_0x44bbcd){return _0x44bbcd();},'vHeOk':function(_0x113868,_0xb54510){return _0x113868(_0xb54510);},'HDyjr':function(_0x1ad986){return _0x1ad986();},'amsvl':function(_0x3bcf78,_0x3f6cf4,_0x2798fb){return _0x3bcf78(_0x3f6cf4,_0x2798fb);}},_0xf504ff=_0x489347[_0x29933c(0xac)];let _0x4b77e7=0x0;const _0x49dc61=async()=>{const _0x5d92f8=_0x29933c;if(_0x534560[_0x5d92f8(0xd0)](_0x4b77e7,_0x524e1f))throw _0x534560[_0x5d92f8(0xbb)];const _0x3002bd=sendMessagePool[_0x489347[_0x5d92f8(0xac)]];if(_0x3002bd)return await _0x534560[_0x5d92f8(0xa8)](sleep,0x1f4),_0x4b77e7+=0x1f4,await _0x534560['ioNXR'](_0x49dc61);else return;};return await _0x534560[_0x29933c(0x92)](_0x49dc61),new Promise((_0x427343,_0x3059dc)=>{const _0x298867=_0x29933c,_0x19f313={'muiDH':function(_0x1d0e99,_0x28ea97){return _0x1d0e99===_0x28ea97;},'qRWnj':function(_0x1f0268,_0x2ddf4f){const _0x5767f4=_0x2adc;return _0x534560[_0x5767f4(0xc9)](_0x1f0268,_0x2ddf4f);},'fQJfl':function(_0x516504,_0x38199a){return _0x516504(_0x38199a);}};let _0x48461e=![],_0x5c7302=null;const _0x39c3f8=_0x534560[_0x298867(0x92)](randomUUID);sendSuccessCBMap[_0x39c3f8]=_0x3de598=>{const _0x14f975=_0x298867;if(_0x19f313['muiDH'](_0x3de598[_0x14f975(0xab)],_0x5c7302?.[_0x14f975(0xab)])){if(_0x19f313['muiDH'](_0x3de598['sendStatus'],0x2))return delete sendSuccessCBMap[_0x39c3f8],_0x48461e=!![],_0x19f313[_0x14f975(0x88)](_0x427343,_0x3de598),!![];return![];}return![];},sendMessagePool[_0xf504ff]=async _0x18045f=>{delete sendMessagePool[_0xf504ff],_0x5c7302=_0x18045f;},_0x534560[_0x298867(0x8d)](setTimeout,()=>{const _0x3d7aac=_0x298867;if(_0x48461e)return;delete sendMessagePool[_0xf504ff],delete sendSuccessCBMap[_0x39c3f8],_0x19f313['fQJfl'](_0x3059dc,_0x3d7aac(0xaa));},_0x524e1f);const _0x17ee5f=napCatCore[_0x298867(0xb5)][_0x298867(0xa1)]()[_0x298867(0x9e)]('0',_0x489347,_0x1fe30e,new Map());});}static async['forwardMsg'](_0x1dc00a,_0x229436,_0x475836){const _0x4eac4d=_0x4b0fcf;return napCatCore[_0x4eac4d(0xb5)][_0x4eac4d(0xa1)]()[_0x4eac4d(0xb7)](_0x475836,_0x1dc00a,[_0x229436],new Map());}static async[_0x4b0fcf(0x89)](_0x1ae8d8,_0x538601,_0x4f149a){const _0x2557cc=_0x4b0fcf,_0xde746b={'sjjOh':function(_0x136c3d,_0x1ec84f){return _0x136c3d!=_0x1ec84f;},'HJlRM':function(_0x48b406,_0x1a204f){return _0x48b406==_0x1a204f;},'eUrFZ':function(_0x4ed9c7,_0xd78795){return _0x4ed9c7(_0xd78795);},'VZxPx':_0x2557cc(0xc8),'iRWOK':function(_0x2e1dad){return _0x2e1dad();}},_0x56bb97=_0x4f149a[_0x2557cc(0x97)](_0x18e260=>{const _0xc8cdb8=_0x2557cc;return{'msgId':_0x18e260,'senderShowName':selfInfo[_0xc8cdb8(0xcc)]};});return new Promise((_0x3e46ee,_0x5ed025)=>{const _0x49cd4a=_0x2557cc,_0x4ebdbd={'VLKGI':function(_0x4d9de7,_0x95fdf2){const _0x3d1033=_0x2adc;return _0xde746b[_0x3d1033(0xba)](_0x4d9de7,_0x95fdf2);},'ZkCLq':_0x49cd4a(0xc2),'Zlils':function(_0x2feb24,_0x7a3875){const _0x4ad740=_0x49cd4a;return _0xde746b[_0x4ad740(0xbc)](_0x2feb24,_0x7a3875);},'OqFUB':function(_0x4a2252,_0x34fc50){const _0x227302=_0x49cd4a;return _0xde746b[_0x227302(0xc5)](_0x4a2252,_0x34fc50);},'sgbGm':function(_0x38f8e,_0x3a2fd6){const _0x5c4e67=_0x49cd4a;return _0xde746b[_0x5c4e67(0xc5)](_0x38f8e,_0x3a2fd6);},'AMrLd':_0xde746b[_0x49cd4a(0xcf)]};let _0x545941=![];const _0x3861d9=_0x4ad486=>{const _0x1d3e22=_0x49cd4a,_0x3046da=_0x4ad486[_0x1d3e22(0xcb)][_0x1d3e22(0x94)](_0x367337=>_0x367337[_0x1d3e22(0x93)]);if(!_0x3046da)return;const _0x307c4f=JSON['parse'](_0x3046da[_0x1d3e22(0x93)][_0x1d3e22(0xd1)]);if(_0x4ebdbd[_0x1d3e22(0xa7)](_0x307c4f[_0x1d3e22(0x8b)],_0x4ebdbd['ZkCLq']))return;_0x4ad486['peerUid']==_0x538601[_0x1d3e22(0xac)]&&_0x4ebdbd[_0x1d3e22(0xa5)](_0x4ad486[_0x1d3e22(0xc4)],selfInfo['uid'])&&(_0x545941=!![],_0x4ebdbd[_0x1d3e22(0xb9)](_0x3e46ee,_0x4ad486));};sentMsgTasks[_0x49cd4a(0xad)](_0xde746b[_0x49cd4a(0x8a)](randomUUID),_0x3861d9),setTimeout(()=>{const _0x1cc588=_0x49cd4a;!_0x545941&&_0x4ebdbd[_0x1cc588(0x8e)](_0x5ed025,_0x4ebdbd[_0x1cc588(0x9f)]);},0x1388),napCatCore[_0x49cd4a(0xb5)]['getMsgService']()['multiForwardMsgWithComment'](_0x56bb97,_0x1ae8d8,_0x538601,[],new Map());});}}