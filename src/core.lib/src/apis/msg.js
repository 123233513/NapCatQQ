function _0x476a(_0x1d9aae,_0x398756){const _0x5ed3e8=_0x5ed3();return _0x476a=function(_0x476a6b,_0x587b23){_0x476a6b=_0x476a6b-0x1f4;let _0x538730=_0x5ed3e8[_0x476a6b];return _0x538730;},_0x476a(_0x1d9aae,_0x398756);}const _0x34786a=_0x476a;(function(_0x4ac441,_0x205339){const _0x39dd50=_0x476a,_0xf23901=_0x4ac441();while(!![]){try{const _0x4bd89d=-parseInt(_0x39dd50(0x20b))/0x1+-parseInt(_0x39dd50(0x1f4))/0x2+-parseInt(_0x39dd50(0x21a))/0x3+-parseInt(_0x39dd50(0x207))/0x4*(parseInt(_0x39dd50(0x1f8))/0x5)+parseInt(_0x39dd50(0x233))/0x6*(-parseInt(_0x39dd50(0x1fc))/0x7)+-parseInt(_0x39dd50(0x225))/0x8+parseInt(_0x39dd50(0x237))/0x9*(parseInt(_0x39dd50(0x21c))/0xa);if(_0x4bd89d===_0x205339)break;else _0xf23901['push'](_0xf23901['shift']());}catch(_0x45cf15){_0xf23901['push'](_0xf23901['shift']());}}}(_0x5ed3,0xec24c));function _0x5ed3(){const _0xfd2dd0=['getMsgsBySeqAndCount','YLGRz','127060ZxGXSs','NmFpf','arkElement','CGRUe','1670318WoqELz','PFPFl','ZBaVh','forEach','发送超时','recallMsg','toString','HSxCd','WAObV','sendMsg','app','getMsgsByMsgId','parse','catch','activateChat','5708079LqjNtp','XobsP','46670kdqsLf','getGroupFileList','multiForwardMsgWithComment','UPniJ','转发消息超时','addListener','hujLg','length','getMsgHistory','5729360OlhPrY','getMultiMsg','getMsgService','map','session','jEqtO','chatType','activateChatAndGetHistory','delete','xFTDt','getRichMediaService','forwardMsg','then','setMsgEmojiLikes','335856qQVQag','sendStatus','IZeIc','YjCVT','15111JVQCQa','msgId','zldGj','plSMG','nick','2496490lPULpw','peerUid','bytesData','onLoginSuccess','95rtPnVR','YtucI','qSklf','uid','91XmPQpK','setEmojiLike','fetchRecentContact','获取群文件列表超时','TPMsH','setMsgRead','pEtzS','xsExU','set'];_0x5ed3=function(){return _0xfd2dd0;};return _0x5ed3();}import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener['onGroupFileInfoUpdate']=_0x321c1c=>{const _0x2b023c=_0x476a,_0x5e8992={'TPMsH':function(_0x2fe78d,_0x4c251a){return _0x2fe78d(_0x4c251a);}};for(const [_0x3acbbf,_0x24d602]of GroupFileInfoUpdateTasks){_0x5e8992[_0x2b023c(0x200)](_0x24d602,_0x321c1c),GroupFileInfoUpdateTasks[_0x2b023c(0x22d)](_0x3acbbf);}},msgListener['onAddSendMsg']=_0xbe64aa=>{const _0x42f39e=_0x476a,_0x1f2817={'PFPFl':function(_0x404224,_0x2a3a12){return _0x404224(_0x2a3a12);},'WAObV':function(_0x343310,_0x4ee4e1){return _0x343310 instanceof _0x4ee4e1;}};for(const [_0x378243,_0x2c888c]of sentMsgTasks){_0x1f2817[_0x42f39e(0x20c)](_0x2c888c,_0xbe64aa),sentMsgTasks['delete'](_0x378243);}if(sendMessagePool[_0xbe64aa[_0x42f39e(0x1f5)]]){const _0x3e0499=sendMessagePool[_0xbe64aa['peerUid']]?.(_0xbe64aa);_0x1f2817[_0x42f39e(0x213)](_0x3e0499,Promise)&&_0x3e0499['then']()[_0x42f39e(0x218)](logError);}},msgListener['onMsgInfoListUpdate']=_0x5f2bae=>{const _0x2a9fdd=_0x476a,_0x24f5ae={'czNLk':function(_0x238bcb,_0x3513d9){return _0x238bcb(_0x3513d9);}};_0x5f2bae[_0x2a9fdd(0x20e)](_0x2109bd=>{const _0x344cd8={'UPniJ':function(_0x5c84a0,_0x2f7762){return _0x24f5ae['czNLk'](_0x5c84a0,_0x2f7762);}};new Promise((_0x2be129,_0x2c5728)=>{const _0x3dcfb0=_0x476a;for(const _0x209c48 in sendSuccessCBMap){const _0x81d8c4=sendSuccessCBMap[_0x209c48],_0x3de375=_0x344cd8[_0x3dcfb0(0x21f)](_0x81d8c4,_0x2109bd),_0x58b349=_0x336fb5=>{_0x336fb5&&delete sendSuccessCBMap[_0x209c48];};_0x3de375 instanceof Promise?_0x3de375[_0x3dcfb0(0x231)](_0x58b349):_0x344cd8['UPniJ'](_0x58b349,_0x3de375);}})['then']()['catch'](log);});},setTimeout(()=>{const _0x5490e6=_0x476a;napCatCore[_0x5490e6(0x1f7)](()=>{const _0x57234=_0x5490e6;napCatCore[_0x57234(0x221)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x34786a(0x1fd)](_0x33389c,_0x39bec0,_0x7798ba,_0x3e3cff=!![]){const _0x3ebcab=_0x34786a;return _0x7798ba=_0x7798ba[_0x3ebcab(0x211)](),napCatCore[_0x3ebcab(0x229)][_0x3ebcab(0x227)]()[_0x3ebcab(0x232)](_0x33389c,_0x39bec0,_0x7798ba,_0x7798ba[_0x3ebcab(0x223)]>0x3?'2':'1',_0x3e3cff);}static async[_0x34786a(0x226)](_0x3a8548,_0x2a848e,_0x39eaaa){const _0x2d7a64=_0x34786a;return napCatCore[_0x2d7a64(0x229)][_0x2d7a64(0x227)]()[_0x2d7a64(0x226)](_0x3a8548,_0x2a848e,_0x39eaaa);}static async['getMsgsByMsgId'](_0x54ceed,_0x252ffe){const _0x4faf12=_0x34786a;return await napCatCore[_0x4faf12(0x229)][_0x4faf12(0x227)]()[_0x4faf12(0x216)](_0x54ceed,_0x252ffe);}static async[_0x34786a(0x205)](_0x5c2bf7,_0xa7b3a8,_0x3bdb32,_0x253d04,_0x4a1cbb){const _0x329d20=_0x34786a;return await napCatCore[_0x329d20(0x229)][_0x329d20(0x227)]()['getMsgsBySeqAndCount'](_0x5c2bf7,_0xa7b3a8,_0x3bdb32,_0x253d04,_0x4a1cbb);}static async[_0x34786a(0x219)](_0xb2f89a){}static async[_0x34786a(0x22c)](_0x5c502f){}static async[_0x34786a(0x201)](_0x4f9fe2){const _0x58435d=_0x34786a;return napCatCore[_0x58435d(0x229)]['getMsgService']()[_0x58435d(0x201)](_0x4f9fe2);}static async[_0x34786a(0x21d)](_0x52637e,_0x57e8fc){const _0x186f81=_0x34786a,_0x5617b7={'CGRUe':_0x186f81(0x1ff),'jqgHd':function(_0x1eb4b){return _0x1eb4b();}};return new Promise(async(_0x49e147,_0x17c6ac)=>{const _0x5905ff=_0x186f81,_0x533416={'ZBaVh':_0x5617b7[_0x5905ff(0x20a)]};let _0x4f7351=![];setTimeout(()=>{const _0x56beb7=_0x5905ff;!_0x4f7351&&_0x17c6ac(_0x533416[_0x56beb7(0x20d)]);},0x1388);const _0x209757=_0x4cf494=>{_0x4f7351=!![],_0x49e147(_0x4cf494['item']);};GroupFileInfoUpdateTasks[_0x5905ff(0x204)](_0x5617b7['jqgHd'](randomUUID),_0x209757),await napCatCore['session'][_0x5905ff(0x22f)]()[_0x5905ff(0x21d)](_0x52637e,_0x57e8fc);});}static async[_0x34786a(0x224)](_0x212345,_0x52fcfc,_0x582047){const _0x5ad3fa=_0x34786a;return napCatCore[_0x5ad3fa(0x229)][_0x5ad3fa(0x227)]()['getMsgsIncludeSelf'](_0x212345,_0x52fcfc,_0x582047,!![]);}static async[_0x34786a(0x1fe)](){}static async[_0x34786a(0x210)](_0x41b078,_0x30a8f7){const _0x5d0a51=_0x34786a;await napCatCore[_0x5d0a51(0x229)][_0x5d0a51(0x227)]()[_0x5d0a51(0x210)]({'chatType':_0x41b078[_0x5d0a51(0x22b)],'peerUid':_0x41b078['peerUid']},_0x30a8f7);}static async[_0x34786a(0x214)](_0x547ed7,_0x4ba764,_0x599852=!![],_0x5108f7=0x2710){const _0x18e14f=_0x34786a,_0x25146a={'hujLg':function(_0xd01449,_0x29d5e3){return _0xd01449>_0x29d5e3;},'HSxCd':function(_0x4faf48,_0x3eef88){return _0x4faf48(_0x3eef88);},'NmFpf':function(_0x302484){return _0x302484();},'YjCVT':function(_0x19eb3a,_0x4d8c2c){return _0x19eb3a===_0x4d8c2c;},'XobsP':function(_0x1e2309,_0x1d3459){return _0x1e2309(_0x1d3459);},'xFTDt':'发送超时','YtucI':function(_0x451003,_0x1e3d3f,_0x10479c){return _0x451003(_0x1e3d3f,_0x10479c);}},_0x58d916=_0x547ed7[_0x18e14f(0x1f5)];let _0x37f032=0x0;const _0x41c28b=async()=>{const _0x101b65=_0x18e14f;if(_0x25146a[_0x101b65(0x222)](_0x37f032,_0x5108f7))throw _0x101b65(0x20f);const _0x5c5dcf=sendMessagePool[_0x547ed7[_0x101b65(0x1f5)]];if(_0x5c5dcf)return await _0x25146a[_0x101b65(0x212)](sleep,0x1f4),_0x37f032+=0x1f4,await _0x25146a['NmFpf'](_0x41c28b);else return;};return await _0x25146a[_0x18e14f(0x208)](_0x41c28b),new Promise((_0x380734,_0x103572)=>{const _0x46d1dc=_0x18e14f;let _0xab1c9e=![],_0x19fdce=null;const _0x327d16=_0x25146a['NmFpf'](randomUUID);sendSuccessCBMap[_0x327d16]=_0x2d5f0e=>{const _0x76c880=_0x476a;if(_0x25146a[_0x76c880(0x236)](_0x2d5f0e[_0x76c880(0x238)],_0x19fdce?.[_0x76c880(0x238)])){if(_0x25146a['YjCVT'](_0x2d5f0e[_0x76c880(0x234)],0x2))return delete sendSuccessCBMap[_0x327d16],_0xab1c9e=!![],_0x380734(_0x2d5f0e),!![];return![];}return![];},sendMessagePool[_0x58d916]=async _0x1ed8df=>{delete sendMessagePool[_0x58d916],_0x19fdce=_0x1ed8df;},_0x25146a[_0x46d1dc(0x1f9)](setTimeout,()=>{const _0x3e1836=_0x46d1dc;if(_0xab1c9e)return;delete sendMessagePool[_0x58d916],delete sendSuccessCBMap[_0x327d16],_0x25146a[_0x3e1836(0x21b)](_0x103572,_0x25146a[_0x3e1836(0x22e)]);},_0x5108f7);const _0x295d5c=napCatCore[_0x46d1dc(0x229)][_0x46d1dc(0x227)]()[_0x46d1dc(0x214)]('0',_0x547ed7,_0x4ba764,new Map());});}static async[_0x34786a(0x230)](_0x2148ff,_0x59d46b,_0x408215){const _0x428675=_0x34786a;return napCatCore['session'][_0x428675(0x227)]()[_0x428675(0x230)](_0x408215,_0x2148ff,[_0x59d46b],new Map());}static async['multiForwardMsg'](_0x38899b,_0x50f5c6,_0x21eb86){const _0x3a0cb0=_0x34786a,_0x12af55={'plSMG':function(_0x4cf32c,_0x502993){return _0x4cf32c(_0x502993);},'YLGRz':_0x3a0cb0(0x220),'qSklf':function(_0xe3a4f7,_0x3c8cdc){return _0xe3a4f7!=_0x3c8cdc;},'xsExU':'com.tencent.multimsg','BHRSy':function(_0x53891,_0x301fe4){return _0x53891==_0x301fe4;},'jEqtO':function(_0x472ae3){return _0x472ae3();}},_0x530be3=_0x21eb86[_0x3a0cb0(0x228)](_0x266763=>{const _0x197a25=_0x3a0cb0;return{'msgId':_0x266763,'senderShowName':selfInfo[_0x197a25(0x23b)]};});return new Promise((_0x5c1e58,_0x3c3c19)=>{const _0x5558aa=_0x3a0cb0,_0x3cb617={'zldGj':function(_0xe68bb9,_0x5d58d0){const _0x1116a0=_0x476a;return _0x12af55[_0x1116a0(0x1fa)](_0xe68bb9,_0x5d58d0);},'IZeIc':_0x12af55[_0x5558aa(0x203)],'nJQJS':function(_0x43cfb4,_0x22dca8){return _0x12af55['BHRSy'](_0x43cfb4,_0x22dca8);},'pEtzS':function(_0x506dce,_0x443474){return _0x12af55['plSMG'](_0x506dce,_0x443474);}};let _0x5eafb9=![];const _0x2ba85f=_0x1089ee=>{const _0x101848=_0x5558aa,_0x533f22=_0x1089ee['elements']['find'](_0x90fc78=>_0x90fc78[_0x101848(0x209)]);if(!_0x533f22)return;const _0x5d7593=JSON[_0x101848(0x217)](_0x533f22[_0x101848(0x209)][_0x101848(0x1f6)]);if(_0x3cb617[_0x101848(0x239)](_0x5d7593[_0x101848(0x215)],_0x3cb617[_0x101848(0x235)]))return;_0x3cb617['nJQJS'](_0x1089ee['peerUid'],_0x50f5c6['peerUid'])&&_0x3cb617['nJQJS'](_0x1089ee['senderUid'],selfInfo[_0x101848(0x1fb)])&&(_0x5eafb9=!![],_0x3cb617[_0x101848(0x202)](_0x5c1e58,_0x1089ee));};sentMsgTasks[_0x5558aa(0x204)](_0x12af55[_0x5558aa(0x22a)](randomUUID),_0x2ba85f),setTimeout(()=>{const _0x128275=_0x5558aa;!_0x5eafb9&&_0x12af55[_0x128275(0x23a)](_0x3c3c19,_0x12af55[_0x128275(0x206)]);},0x1388),napCatCore[_0x5558aa(0x229)][_0x5558aa(0x227)]()[_0x5558aa(0x21e)](_0x530be3,_0x38899b,_0x50f5c6,[],new Map());});}}