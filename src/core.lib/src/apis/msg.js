const _0x475caa=_0x5b85;function _0x5b85(_0x3c3119,_0x2b04c9){const _0x3ae8a0=_0x3ae8();return _0x5b85=function(_0x5b8541,_0x3f94f4){_0x5b8541=_0x5b8541-0x152;let _0x3773d0=_0x3ae8a0[_0x5b8541];return _0x3773d0;},_0x5b85(_0x3c3119,_0x2b04c9);}(function(_0x4aa0e3,_0x377652){const _0x7c9620=_0x5b85,_0x37634b=_0x4aa0e3();while(!![]){try{const _0x3dc790=-parseInt(_0x7c9620(0x166))/0x1*(parseInt(_0x7c9620(0x181))/0x2)+-parseInt(_0x7c9620(0x156))/0x3+parseInt(_0x7c9620(0x189))/0x4*(parseInt(_0x7c9620(0x199))/0x5)+parseInt(_0x7c9620(0x157))/0x6+parseInt(_0x7c9620(0x178))/0x7+-parseInt(_0x7c9620(0x182))/0x8*(-parseInt(_0x7c9620(0x155))/0x9)+-parseInt(_0x7c9620(0x196))/0xa*(parseInt(_0x7c9620(0x174))/0xb);if(_0x3dc790===_0x377652)break;else _0x37634b['push'](_0x37634b['shift']());}catch(_0x223268){_0x37634b['push'](_0x37634b['shift']());}}}(_0x3ae8,0xd896f));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';function _0x3ae8(){const _0x2e4118=['setMsgRead','getMsgsBySeqAndCount','onAddSendMsg','bytesData','27687jXFXrE','获取群文件列表超时','FXBYp','sendMsg','9943612PMxCNU','sZzMF','getMsgsByMsgId','forwardMsg','fDJwy','WrFPk','activateChatAndGetHistory','msgId','uid','1701310aUoXJA','54952IdIfjM','com.tencent.multimsg','PUtSj','catch','recallMsg','zUbvK','delete','5947852fuGeBQ','onGroupFileInfoUpdate','arkElement','senderUid','XAZUu','BjRzk','MkLDy','set','map','peerUid','addListener','setEmojiLike','forEach','12170Utxjqw','HzZaH','getMultiMsg','5HrvYjq','mIvOh','chatType','then','eRsiy','setMsgEmojiLikes','1089WWGJJd','984480CuRRih','8343162yhcpLN','发送超时','onMsgInfoListUpdate','nick','session','ZRleZ','klQYg','hZvrV','转发消息超时','length','QzjMJ','QQzYb','onLoginSuccess','getMsgsIncludeSelf','sendStatus','1hjfApx','item','getRichMediaService','zQNDh','getMsgService','KFQeh','parse','app','find','imCPA'];_0x3ae8=function(){return _0x2e4118;};return _0x3ae8();}import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},GroupFileInfoUpdateTasks=new Map(),sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x475caa(0x18a)]=_0x3dd664=>{const _0x2e9a28=_0x475caa,_0x2b682f={'tbwku':function(_0x579b8b,_0x1fa9ac){return _0x579b8b(_0x1fa9ac);}};for(const [_0x1fa903,_0x392f96]of GroupFileInfoUpdateTasks){_0x2b682f['tbwku'](_0x392f96,_0x3dd664),GroupFileInfoUpdateTasks[_0x2e9a28(0x188)](_0x1fa903);}},msgListener[_0x475caa(0x172)]=_0x51ead3=>{const _0x31e6f9=_0x475caa,_0x4fa98c={'HzZaH':function(_0x44c240,_0x4ee37f){return _0x44c240(_0x4ee37f);},'sZzMF':function(_0x35d996,_0x2921c6){return _0x35d996 instanceof _0x2921c6;}};for(const [_0x2987d9,_0x27aff7]of sentMsgTasks){_0x4fa98c[_0x31e6f9(0x197)](_0x27aff7,_0x51ead3),sentMsgTasks[_0x31e6f9(0x188)](_0x2987d9);}if(sendMessagePool[_0x51ead3['peerUid']]){const _0x4ff20c=sendMessagePool[_0x51ead3[_0x31e6f9(0x192)]]?.(_0x51ead3);_0x4fa98c[_0x31e6f9(0x179)](_0x4ff20c,Promise)&&_0x4ff20c[_0x31e6f9(0x152)]()[_0x31e6f9(0x185)](logError);}},msgListener[_0x475caa(0x159)]=_0x58adce=>{const _0x693548=_0x475caa,_0x2f16ca={'fEIDj':function(_0x29b8f2,_0xfabe76){return _0x29b8f2 instanceof _0xfabe76;},'FXBYp':function(_0x49631b,_0x1d8985){return _0x49631b(_0x1d8985);}};_0x58adce[_0x693548(0x195)](_0x228b43=>{const _0x4616e8=_0x693548,_0x336a91={'imCPA':function(_0x375a8a,_0x13493e){return _0x2f16ca['fEIDj'](_0x375a8a,_0x13493e);},'PUtSj':function(_0x2094d9,_0x11efdd){const _0x10f9d3=_0x5b85;return _0x2f16ca[_0x10f9d3(0x176)](_0x2094d9,_0x11efdd);}};new Promise((_0x5ea6de,_0x114aec)=>{const _0x213b5c=_0x5b85;for(const _0x463924 in sendSuccessCBMap){const _0xe5cbad=sendSuccessCBMap[_0x463924],_0xc32e72=_0xe5cbad(_0x228b43),_0x367dec=_0x36cf6a=>{_0x36cf6a&&delete sendSuccessCBMap[_0x463924];};_0x336a91[_0x213b5c(0x16f)](_0xc32e72,Promise)?_0xc32e72['then'](_0x367dec):_0x336a91[_0x213b5c(0x184)](_0x367dec,_0xc32e72);}})[_0x4616e8(0x152)]()[_0x4616e8(0x185)](log);});},setTimeout(()=>{const _0x29cb62=_0x475caa;napCatCore[_0x29cb62(0x163)](()=>{const _0x155f9e=_0x29cb62;napCatCore[_0x155f9e(0x193)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x475caa(0x194)](_0x261ba0,_0x55a086,_0x4cd905,_0x26bc26=!![]){const _0xa9fa4f=_0x475caa,_0x3a6fff={'BjRzk':function(_0x5e23d9,_0x5ee533){return _0x5e23d9>_0x5ee533;}};return _0x4cd905=_0x4cd905['toString'](),napCatCore[_0xa9fa4f(0x15b)][_0xa9fa4f(0x16a)]()[_0xa9fa4f(0x154)](_0x261ba0,_0x55a086,_0x4cd905,_0x3a6fff[_0xa9fa4f(0x18e)](_0x4cd905[_0xa9fa4f(0x160)],0x3)?'2':'1',_0x26bc26);}static async[_0x475caa(0x198)](_0x299ea9,_0x1a1c07,_0x1c49b6){const _0x18cf59=_0x475caa;return napCatCore[_0x18cf59(0x15b)][_0x18cf59(0x16a)]()['getMultiMsg'](_0x299ea9,_0x1a1c07,_0x1c49b6);}static async[_0x475caa(0x17a)](_0xc2c9cd,_0x461552){const _0x2d00f5=_0x475caa;return await napCatCore[_0x2d00f5(0x15b)]['getMsgService']()[_0x2d00f5(0x17a)](_0xc2c9cd,_0x461552);}static async[_0x475caa(0x171)](_0x1f3ed8,_0x510922,_0x418a7f,_0x24a8c6,_0x2e596a){const _0x1dacfb=_0x475caa;return await napCatCore[_0x1dacfb(0x15b)]['getMsgService']()[_0x1dacfb(0x171)](_0x1f3ed8,_0x510922,_0x418a7f,_0x24a8c6,_0x2e596a);}static async['activateChat'](_0x2e6581){}static async[_0x475caa(0x17e)](_0x5d39d5){}static async[_0x475caa(0x170)](_0x5a86dc){const _0x173d74=_0x475caa;return napCatCore[_0x173d74(0x15b)][_0x173d74(0x16a)]()[_0x173d74(0x170)](_0x5a86dc);}static async['getGroupFileList'](_0x3f2d56,_0x2e1166){const _0x43251e={'mIvOh':function(_0x26a6be,_0x298326){return _0x26a6be(_0x298326);},'zQNDh':function(_0x598397,_0x909a93,_0x2a5453){return _0x598397(_0x909a93,_0x2a5453);},'QzjMJ':function(_0x1e0b71){return _0x1e0b71();}};return new Promise(async(_0x1aa04e,_0x24c452)=>{const _0x464136=_0x5b85,_0x46bd6d={'eRsiy':function(_0xf1153f,_0x6c6032){const _0x165585=_0x5b85;return _0x43251e[_0x165585(0x19a)](_0xf1153f,_0x6c6032);}};let _0x5898f5=![];_0x43251e[_0x464136(0x169)](setTimeout,()=>{const _0x4f6ccb=_0x464136;!_0x5898f5&&_0x46bd6d[_0x4f6ccb(0x153)](_0x24c452,_0x4f6ccb(0x175));},0x1388);const _0x3e537d=_0x4f4ea1=>{const _0x47edb9=_0x464136;_0x5898f5=!![],_0x1aa04e(_0x4f4ea1[_0x47edb9(0x167)]);};GroupFileInfoUpdateTasks[_0x464136(0x190)](_0x43251e[_0x464136(0x161)](randomUUID),_0x3e537d),await napCatCore['session'][_0x464136(0x168)]()['getGroupFileList'](_0x3f2d56,_0x2e1166);});}static async['getMsgHistory'](_0x483ee1,_0x4a105a,_0x4fe5e8){const _0x2ccdbf=_0x475caa;return napCatCore['session'][_0x2ccdbf(0x16a)]()[_0x2ccdbf(0x164)](_0x483ee1,_0x4a105a,_0x4fe5e8,!![]);}static async['fetchRecentContact'](){}static async[_0x475caa(0x186)](_0x2357d5,_0x46daf8){const _0x1d54c9=_0x475caa;await napCatCore[_0x1d54c9(0x15b)][_0x1d54c9(0x16a)]()['recallMsg']({'chatType':_0x2357d5[_0x1d54c9(0x19b)],'peerUid':_0x2357d5['peerUid']},_0x46daf8);}static async['sendMsg'](_0xfaeb0c,_0x170040,_0x24eebd=!![],_0x402f9f=0x2710){const _0x31f5a4=_0x475caa,_0x2e1c3e={'MkLDy':function(_0x324c16,_0x1d230b){return _0x324c16>_0x1d230b;},'ZRleZ':_0x31f5a4(0x158),'fDJwy':function(_0x1897ee,_0x2c4047){return _0x1897ee(_0x2c4047);},'BDABX':function(_0xf135f3,_0x5437c2){return _0xf135f3===_0x5437c2;},'nipYV':function(_0x2f818f,_0x2cd525){return _0x2f818f===_0x2cd525;},'WrFPk':function(_0x3e600a,_0x498d9e,_0x286c39){return _0x3e600a(_0x498d9e,_0x286c39);},'rOsZD':function(_0x5626fb){return _0x5626fb();}},_0x149a64=_0xfaeb0c[_0x31f5a4(0x192)];let _0x5397be=0x0;const _0x4201fe=async()=>{const _0x448e6e=_0x31f5a4;if(_0x2e1c3e[_0x448e6e(0x18f)](_0x5397be,_0x402f9f))throw _0x2e1c3e[_0x448e6e(0x15c)];const _0x14ff01=sendMessagePool[_0xfaeb0c['peerUid']];if(_0x14ff01)return await _0x2e1c3e[_0x448e6e(0x17c)](sleep,0x1f4),_0x5397be+=0x1f4,await _0x4201fe();else return;};return await _0x2e1c3e['rOsZD'](_0x4201fe),new Promise((_0x310725,_0x200da3)=>{const _0x26c72b=_0x31f5a4;let _0x932233=![],_0x3c3cfb=null;const _0x3c36a2=randomUUID();sendSuccessCBMap[_0x3c36a2]=_0x55fdb0=>{const _0xc74a2d=_0x5b85;if(_0x2e1c3e['BDABX'](_0x55fdb0[_0xc74a2d(0x17f)],_0x3c3cfb?.[_0xc74a2d(0x17f)])){if(_0x2e1c3e['nipYV'](_0x55fdb0[_0xc74a2d(0x165)],0x2))return delete sendSuccessCBMap[_0x3c36a2],_0x932233=!![],_0x2e1c3e[_0xc74a2d(0x17c)](_0x310725,_0x55fdb0),!![];return![];}return![];},sendMessagePool[_0x149a64]=async _0x166647=>{delete sendMessagePool[_0x149a64],_0x3c3cfb=_0x166647;},_0x2e1c3e[_0x26c72b(0x17d)](setTimeout,()=>{const _0x33bbc0=_0x26c72b;if(_0x932233)return;delete sendMessagePool[_0x149a64],delete sendSuccessCBMap[_0x3c36a2],_0x2e1c3e[_0x33bbc0(0x17c)](_0x200da3,_0x2e1c3e[_0x33bbc0(0x15c)]);},_0x402f9f);const _0x786b6f=napCatCore[_0x26c72b(0x15b)]['getMsgService']()[_0x26c72b(0x177)]('0',_0xfaeb0c,_0x170040,new Map());});}static async[_0x475caa(0x17b)](_0x24f0df,_0x2b9527,_0x135965){const _0x57310a=_0x475caa;return napCatCore['session'][_0x57310a(0x16a)]()[_0x57310a(0x17b)](_0x135965,_0x24f0df,[_0x2b9527],new Map());}static async['multiForwardMsg'](_0xe02576,_0xf48c1d,_0x4aa39d){const _0x2261a5=_0x475caa,_0x1947fc={'QQzYb':_0x2261a5(0x183),'MMIkB':function(_0x141494){return _0x141494();},'hfzQO':function(_0x11bf77,_0x23cfa9,_0x5a3771){return _0x11bf77(_0x23cfa9,_0x5a3771);}},_0x2618f6=_0x4aa39d[_0x2261a5(0x191)](_0x4c3fe7=>{const _0x160f67=_0x2261a5;return{'msgId':_0x4c3fe7,'senderShowName':selfInfo[_0x160f67(0x15a)]};});return new Promise((_0x273b28,_0x467408)=>{const _0x5ecefb=_0x2261a5,_0xb35baa={'XAZUu':_0x1947fc[_0x5ecefb(0x162)],'zUbvK':function(_0xff8d81,_0x567017){return _0xff8d81==_0x567017;},'hZvrV':function(_0x1a1321,_0xc8a568){return _0x1a1321(_0xc8a568);},'klQYg':function(_0x1d2a44,_0x34acec){return _0x1d2a44(_0x34acec);},'KFQeh':_0x5ecefb(0x15f)};let _0x39f2c1=![];const _0x16cf56=_0xcf9884=>{const _0x484469=_0x5ecefb,_0x36983e=_0xcf9884['elements'][_0x484469(0x16e)](_0x453dd5=>_0x453dd5[_0x484469(0x18b)]);if(!_0x36983e)return;const _0x43aa88=JSON[_0x484469(0x16c)](_0x36983e['arkElement'][_0x484469(0x173)]);if(_0x43aa88[_0x484469(0x16d)]!=_0xb35baa[_0x484469(0x18d)])return;_0xb35baa[_0x484469(0x187)](_0xcf9884['peerUid'],_0xf48c1d[_0x484469(0x192)])&&_0xcf9884[_0x484469(0x18c)]==selfInfo[_0x484469(0x180)]&&(_0x39f2c1=!![],_0xb35baa[_0x484469(0x15e)](_0x273b28,_0xcf9884));};sentMsgTasks[_0x5ecefb(0x190)](_0x1947fc['MMIkB'](randomUUID),_0x16cf56),_0x1947fc['hfzQO'](setTimeout,()=>{const _0x289952=_0x5ecefb;!_0x39f2c1&&_0xb35baa[_0x289952(0x15d)](_0x467408,_0xb35baa[_0x289952(0x16b)]);},0x1388),napCatCore['session'][_0x5ecefb(0x16a)]()['multiForwardMsgWithComment'](_0x2618f6,_0xe02576,_0xf48c1d,[],new Map());});}}