const _0x322d7d=_0x404f;(function(_0x90399f,_0x121444){const _0x5d420b=_0x404f,_0x14b994=_0x90399f();while(!![]){try{const _0x2753c6=-parseInt(_0x5d420b(0x9f))/0x1+parseInt(_0x5d420b(0x9e))/0x2+parseInt(_0x5d420b(0xa8))/0x3*(-parseInt(_0x5d420b(0xa6))/0x4)+-parseInt(_0x5d420b(0xb0))/0x5*(parseInt(_0x5d420b(0x80))/0x6)+-parseInt(_0x5d420b(0xaa))/0x7+-parseInt(_0x5d420b(0xb4))/0x8*(parseInt(_0x5d420b(0x90))/0x9)+parseInt(_0x5d420b(0xae))/0xa*(parseInt(_0x5d420b(0xb9))/0xb);if(_0x2753c6===_0x121444)break;else _0x14b994['push'](_0x14b994['shift']());}catch(_0x1971b3){_0x14b994['push'](_0x14b994['shift']());}}}(_0x3669,0xdaf17));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x322d7d(0xa2)]=_0x633f4f=>{const _0x323dc1=_0x322d7d,_0x55cdb3={'udsZI':function(_0x184e11,_0x42e1e0){return _0x184e11(_0x42e1e0);},'BpjIS':function(_0x2ca67a,_0x320ec0){return _0x2ca67a instanceof _0x320ec0;}};for(const [_0x660d85,_0x4a77f5]of sentMsgTasks){_0x55cdb3[_0x323dc1(0x8a)](_0x4a77f5,_0x633f4f),sentMsgTasks['delete'](_0x660d85);}if(sendMessagePool[_0x633f4f['peerUid']]){const _0x323716=sendMessagePool[_0x633f4f['peerUid']]?.(_0x633f4f);_0x55cdb3[_0x323dc1(0xbd)](_0x323716,Promise)&&_0x323716[_0x323dc1(0x98)]()['catch'](logError);}},msgListener[_0x322d7d(0x84)]=_0x198ab5=>{const _0x4b9310=_0x322d7d,_0x4882f5={'Eulxu':function(_0x4995ab,_0x283a99){return _0x4995ab instanceof _0x283a99;}};_0x198ab5[_0x4b9310(0xad)](_0x1ebb9a=>{const _0x1c7ea0=_0x4b9310,_0x550af8={'kIrlk':function(_0x1db1a8,_0x395618){const _0x573a30=_0x404f;return _0x4882f5[_0x573a30(0xbc)](_0x1db1a8,_0x395618);},'UMjFV':function(_0x3fc5db,_0x409aa4){return _0x3fc5db(_0x409aa4);}};new Promise((_0x4fc9e5,_0xc80d4c)=>{const _0x1ae492=_0x404f;for(const _0x15a95f in sendSuccessCBMap){const _0x5d9278=sendSuccessCBMap[_0x15a95f],_0x2659f7=_0x5d9278(_0x1ebb9a),_0x9fd5fa=_0x1319a4=>{_0x1319a4&&delete sendSuccessCBMap[_0x15a95f];};_0x550af8['kIrlk'](_0x2659f7,Promise)?_0x2659f7[_0x1ae492(0x98)](_0x9fd5fa):_0x550af8['UMjFV'](_0x9fd5fa,_0x2659f7);}})[_0x1c7ea0(0x98)]()['catch'](log);});},setTimeout(()=>{const _0xa041b4=_0x322d7d;napCatCore[_0xa041b4(0x8c)](()=>{const _0x3bf57c=_0xa041b4;napCatCore[_0x3bf57c(0x81)](msgListener);});},0x64);function _0x3669(){const _0x2040d9=['addListener','setMsgEmojiLikes','toString','onMsgInfoListUpdate','chatType','senderUid','elements','qjIoT','getMsgsBySeqAndCount','udsZI','RCYgH','onLoginSuccess','getMsgService','com.tencent.multimsg','parse','2585475BzXjUS','JmZKc','PjrxE','activateChatAndGetHistory','转发消息超时','setEmojiLike','set','uid','then','getMsgsByMsgId','getMultiMsg','hthKQ','multiForwardMsg','arkElement','310726uMUyqf','888080QBIRqY','nick','activateChat','onAddSendMsg','session','RMHDU','ECuFI','2804YvHSCs','EFmxq','4647hthXgV','setMsgRead','3819326urdNIy','app','HgtTR','forEach','10UOwARk','bbglX','1532585kMzrro','sendMsg','length','sendStatus','24CMzoGj','getMsgsIncludeSelf','forwardMsg','multiForwardMsgWithComment','msgId','62209235ZZSxwP','peerUid','find','Eulxu','BpjIS','otwFC','mxGbj','发送超时','PGGeY','30KtEqeQ'];_0x3669=function(){return _0x2040d9;};return _0x3669();}function _0x404f(_0x29bb16,_0x2a4668){const _0x3669b7=_0x3669();return _0x404f=function(_0x404f9c,_0x482aaf){_0x404f9c=_0x404f9c-0x7e;let _0xf3aa57=_0x3669b7[_0x404f9c];return _0xf3aa57;},_0x404f(_0x29bb16,_0x2a4668);}export class NTQQMsgApi{static async[_0x322d7d(0x95)](_0x40c995,_0x4a3c38,_0x42a6ce,_0x53b946=!![]){const _0x6dc208=_0x322d7d;return _0x42a6ce=_0x42a6ce[_0x6dc208(0x83)](),napCatCore['session']['getMsgService']()[_0x6dc208(0x82)](_0x40c995,_0x4a3c38,_0x42a6ce,_0x42a6ce[_0x6dc208(0xb2)]>0x3?'2':'1',_0x53b946);}static async[_0x322d7d(0x9a)](_0x129ff0,_0x5f22cc,_0x557cd0){return napCatCore['session']['getMsgService']()['getMultiMsg'](_0x129ff0,_0x5f22cc,_0x557cd0);}static async['getMsgsByMsgId'](_0x5e68b8,_0x262bc1){const _0x3ae136=_0x322d7d;return await napCatCore[_0x3ae136(0xa3)][_0x3ae136(0x8d)]()[_0x3ae136(0x99)](_0x5e68b8,_0x262bc1);}static async[_0x322d7d(0x89)](_0xfdeb71,_0x35f264,_0x2516e9,_0xa5ccc8,_0x2bb4d0){const _0x34fca7=_0x322d7d;return await napCatCore['session']['getMsgService']()[_0x34fca7(0x89)](_0xfdeb71,_0x35f264,_0x2516e9,_0xa5ccc8,_0x2bb4d0);}static async[_0x322d7d(0xa1)](_0x386229){}static async[_0x322d7d(0x93)](_0x19b2fa){}static async[_0x322d7d(0xa9)](_0x90bc2a){const _0x533e75=_0x322d7d;return napCatCore[_0x533e75(0xa3)][_0x533e75(0x8d)]()[_0x533e75(0xa9)](_0x90bc2a);}static async['getMsgHistory'](_0x11d0fd,_0x3a991,_0x3c26a8){const _0x6f0112=_0x322d7d;return napCatCore[_0x6f0112(0xa3)][_0x6f0112(0x8d)]()[_0x6f0112(0xb5)](_0x11d0fd,_0x3a991,_0x3c26a8,!![]);}static async['fetchRecentContact'](){}static async['recallMsg'](_0x30d351,_0x4d550c){const _0x1978a2=_0x322d7d;await napCatCore[_0x1978a2(0xa3)][_0x1978a2(0x8d)]()['recallMsg']({'chatType':_0x30d351[_0x1978a2(0x85)],'peerUid':_0x30d351['peerUid']},_0x4d550c);}static async[_0x322d7d(0xb1)](_0x19259f,_0x42573,_0x46f597=!![],_0x3f606e=0x2710){const _0x56c8bd=_0x322d7d,_0x4e7dd1={'bbglX':function(_0x2b80f1,_0x49f728){return _0x2b80f1>_0x49f728;},'TAfWo':_0x56c8bd(0x7e),'JmZKc':function(_0x4ea942,_0x59f202){return _0x4ea942(_0x59f202);},'qjIoT':function(_0x1a5f7f){return _0x1a5f7f();},'HcBZr':function(_0x3ca8b1,_0x284cc9){return _0x3ca8b1===_0x284cc9;},'RMHDU':function(_0x6afa4f){return _0x6afa4f();},'iDySm':function(_0x155c10){return _0x155c10();}},_0x438d28=_0x19259f[_0x56c8bd(0xba)];let _0x28f85c=0x0;const _0x4bf2f9=async()=>{const _0xdb4b1c=_0x56c8bd;if(_0x4e7dd1[_0xdb4b1c(0xaf)](_0x28f85c,_0x3f606e))throw _0x4e7dd1['TAfWo'];const _0x2f66d4=sendMessagePool[_0x19259f[_0xdb4b1c(0xba)]];if(_0x2f66d4)return await _0x4e7dd1[_0xdb4b1c(0x91)](sleep,0x1f4),_0x28f85c+=0x1f4,await _0x4e7dd1[_0xdb4b1c(0x88)](_0x4bf2f9);else return;};return await _0x4e7dd1['iDySm'](_0x4bf2f9),new Promise((_0x556f2f,_0x3365b5)=>{const _0x576941=_0x56c8bd,_0x432f54={'ECuFI':function(_0x521657,_0x25a7dd){return _0x521657===_0x25a7dd;},'PGGeY':function(_0x47a0ef,_0x24068f){return _0x4e7dd1['HcBZr'](_0x47a0ef,_0x24068f);},'otwFC':function(_0x244798,_0x3b7356){const _0x2df2ac=_0x404f;return _0x4e7dd1[_0x2df2ac(0x91)](_0x244798,_0x3b7356);},'hthKQ':function(_0x23fd2d,_0x25f557){const _0x42542c=_0x404f;return _0x4e7dd1[_0x42542c(0x91)](_0x23fd2d,_0x25f557);}};let _0x448578=![],_0x3477a4=null;const _0x2efb8e=_0x4e7dd1[_0x576941(0xa4)](randomUUID);sendSuccessCBMap[_0x2efb8e]=_0x4df10b=>{const _0x48a200=_0x576941;if(_0x432f54[_0x48a200(0xa5)](_0x4df10b[_0x48a200(0xb8)],_0x3477a4?.[_0x48a200(0xb8)])){if(_0x432f54[_0x48a200(0x7f)](_0x4df10b[_0x48a200(0xb3)],0x2))return delete sendSuccessCBMap[_0x2efb8e],_0x448578=!![],_0x432f54[_0x48a200(0xbe)](_0x556f2f,_0x4df10b),!![];return![];}return![];},sendMessagePool[_0x438d28]=async _0x2128fd=>{delete sendMessagePool[_0x438d28],_0x3477a4=_0x2128fd;},setTimeout(()=>{const _0x566bf9=_0x576941;if(_0x448578)return;delete sendMessagePool[_0x438d28],delete sendSuccessCBMap[_0x2efb8e],_0x432f54[_0x566bf9(0x9b)](_0x3365b5,'发送超时');},_0x3f606e);const _0x3b1067=napCatCore[_0x576941(0xa3)][_0x576941(0x8d)]()[_0x576941(0xb1)]('0',_0x19259f,_0x42573,new Map());});}static async[_0x322d7d(0xb6)](_0x49b924,_0x1dad38,_0x53d932){const _0x365720=_0x322d7d;return napCatCore['session']['getMsgService']()[_0x365720(0xb6)](_0x53d932,_0x49b924,[_0x1dad38],new Map());}static async[_0x322d7d(0x9c)](_0x3653fe,_0x3b376b,_0x7eeee9){const _0x42e0fe=_0x322d7d,_0xfccd1={'HgtTR':function(_0x5b08f5,_0x4ab8c5){return _0x5b08f5!=_0x4ab8c5;},'mxGbj':_0x42e0fe(0x8e),'LYvwn':function(_0x4e0f39,_0x317161){return _0x4e0f39==_0x317161;},'ZeNRh':function(_0x2171db,_0x348674){return _0x2171db(_0x348674);},'EFmxq':function(_0x411092,_0x299187){return _0x411092(_0x299187);},'RCYgH':_0x42e0fe(0x94),'PjrxE':function(_0x5823d4){return _0x5823d4();}},_0x547540=_0x7eeee9['map'](_0x5755c2=>{const _0x6f0f10=_0x42e0fe;return{'msgId':_0x5755c2,'senderShowName':selfInfo[_0x6f0f10(0xa0)]};});return new Promise((_0x1bad9d,_0x24fcfc)=>{const _0xa4d4f8=_0x42e0fe;let _0x18089a=![];const _0x8095df=_0x59afd5=>{const _0x48689d=_0x404f,_0x47cc75=_0x59afd5[_0x48689d(0x87)][_0x48689d(0xbb)](_0x403948=>_0x403948[_0x48689d(0x9d)]);if(!_0x47cc75)return;const _0x3617e2=JSON[_0x48689d(0x8f)](_0x47cc75[_0x48689d(0x9d)]['bytesData']);if(_0xfccd1[_0x48689d(0xac)](_0x3617e2[_0x48689d(0xab)],_0xfccd1[_0x48689d(0xbf)]))return;_0x59afd5['peerUid']==_0x3b376b[_0x48689d(0xba)]&&_0xfccd1['LYvwn'](_0x59afd5[_0x48689d(0x86)],selfInfo[_0x48689d(0x97)])&&(_0x18089a=!![],_0xfccd1['ZeNRh'](_0x1bad9d,_0x59afd5));};sentMsgTasks[_0xa4d4f8(0x96)](_0xfccd1[_0xa4d4f8(0x92)](randomUUID),_0x8095df),setTimeout(()=>{const _0x1276e4=_0xa4d4f8;!_0x18089a&&_0xfccd1[_0x1276e4(0xa7)](_0x24fcfc,_0xfccd1[_0x1276e4(0x8b)]);},0x1388),napCatCore[_0xa4d4f8(0xa3)][_0xa4d4f8(0x8d)]()[_0xa4d4f8(0xb7)](_0x547540,_0x3653fe,_0x3b376b,[],new Map());});}}