const _0x25038c=_0x3f0a;(function(_0x4586d6,_0x9f4ed1){const _0x333af3=_0x3f0a,_0x2b40d3=_0x4586d6();while(!![]){try{const _0xf7f291=parseInt(_0x333af3(0x10d))/0x1+parseInt(_0x333af3(0x134))/0x2+parseInt(_0x333af3(0x129))/0x3+parseInt(_0x333af3(0x136))/0x4*(parseInt(_0x333af3(0x145))/0x5)+parseInt(_0x333af3(0x142))/0x6+-parseInt(_0x333af3(0x10b))/0x7*(-parseInt(_0x333af3(0x13d))/0x8)+-parseInt(_0x333af3(0x112))/0x9*(parseInt(_0x333af3(0x13a))/0xa);if(_0xf7f291===_0x9f4ed1)break;else _0x2b40d3['push'](_0x2b40d3['shift']());}catch(_0x35e3f2){_0x2b40d3['push'](_0x2b40d3['shift']());}}}(_0x2eb0,0xe9a3c));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';function _0x2eb0(){const _0xf69743=['getMsgsBySeqAndCount','891944BAOmLQ','NtcNO','bytesData','msgId','getMsgsByMsgId','3384588EMlHnw','peerUid','senderUid','7460305TGMsbZ','delete','getMsgService','onAddSendMsg','elements','zasmj','addListener','labYg','getMultiMsg','sendMsg','28SEBQbb','app','1123473NpnAHs','activateChat','bccsg','NLBdM','setEmojiLike','8257707XAycAx','XOFQk','forwardMsg','toString','find','ocMZn','发送超时','onLoginSuccess','nscqF','multiForwardMsg','multiForwardMsgWithComment','recallMsg','kFOuT','then','tAFvr','qQwRM','qpEac','onMsgInfoListUpdate','ZECul','arkElement','getMsgsIncludeSelf','ToDnc','zEevP','4781637EGkYiu','setMsgRead','session','catch','chatType','map','nick','转发消息超时','sendStatus','length','com.tencent.multimsg','650240zsRUeo','QeebU','4thjaAw','AsAVP','setMsgEmojiLikes','parse','50xnBQpC','fetchRecentContact'];_0x2eb0=function(){return _0xf69743;};return _0x2eb0();}import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';function _0x3f0a(_0x3fb503,_0x4532dc){const _0x2eb060=_0x2eb0();return _0x3f0a=function(_0x3f0aba,_0x55b984){_0x3f0aba=_0x3f0aba-0x106;let _0xe4f1d3=_0x2eb060[_0x3f0aba];return _0xe4f1d3;},_0x3f0a(_0x3fb503,_0x4532dc);}const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x25038c(0x148)]=_0x869b10=>{const _0x204096=_0x25038c,_0x2189b5={'bccsg':function(_0x533bca,_0x3b96a8){return _0x533bca(_0x3b96a8);},'QeebU':function(_0x45b1de,_0x1f5dc7){return _0x45b1de instanceof _0x1f5dc7;}};for(const [_0x393bbe,_0x47e468]of sentMsgTasks){_0x2189b5[_0x204096(0x10f)](_0x47e468,_0x869b10),sentMsgTasks[_0x204096(0x146)](_0x393bbe);}if(sendMessagePool[_0x869b10[_0x204096(0x143)]]){const _0x449994=sendMessagePool[_0x869b10[_0x204096(0x143)]]?.(_0x869b10);_0x2189b5[_0x204096(0x135)](_0x449994,Promise)&&_0x449994[_0x204096(0x11f)]()['catch'](logError);}},msgListener[_0x25038c(0x123)]=_0x45435e=>{_0x45435e['forEach'](_0x2b8974=>{const _0xba0963=_0x3f0a;new Promise((_0x13f8b8,_0x504f91)=>{for(const _0x487509 in sendSuccessCBMap){const _0xf75c52=sendSuccessCBMap[_0x487509],_0x591573=_0xf75c52(_0x2b8974),_0x3e2fb2=_0x17f59f=>{_0x17f59f&&delete sendSuccessCBMap[_0x487509];};_0x591573 instanceof Promise?_0x591573['then'](_0x3e2fb2):_0x3e2fb2(_0x591573);}})[_0xba0963(0x11f)]()[_0xba0963(0x12c)](log);});},setTimeout(()=>{const _0x19da24=_0x25038c;napCatCore[_0x19da24(0x119)](()=>{const _0x26062e=_0x19da24;napCatCore[_0x26062e(0x107)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x25038c(0x111)](_0xef5b54,_0x3a51c0,_0x4b572c,_0x3c548b=!![]){const _0x4311b3=_0x25038c,_0xb6efe7={'kFOuT':function(_0x1e5efb,_0x38e32b){return _0x1e5efb>_0x38e32b;}};return _0x4b572c=_0x4b572c[_0x4311b3(0x115)](),napCatCore[_0x4311b3(0x12b)]['getMsgService']()[_0x4311b3(0x138)](_0xef5b54,_0x3a51c0,_0x4b572c,_0xb6efe7[_0x4311b3(0x11e)](_0x4b572c[_0x4311b3(0x132)],0x3)?'2':'1',_0x3c548b);}static async[_0x25038c(0x109)](_0x3f6ed9,_0x30bf34,_0x147a24){const _0xd90254=_0x25038c;return napCatCore['session'][_0xd90254(0x147)]()['getMultiMsg'](_0x3f6ed9,_0x30bf34,_0x147a24);}static async['getMsgsByMsgId'](_0x4b8c65,_0x45f455){const _0x422a19=_0x25038c;return await napCatCore[_0x422a19(0x12b)]['getMsgService']()[_0x422a19(0x141)](_0x4b8c65,_0x45f455);}static async[_0x25038c(0x13c)](_0x2d6fc8,_0x714d8f,_0x504389,_0x236045,_0x24e123){const _0x47d5aa=_0x25038c;return await napCatCore['session'][_0x47d5aa(0x147)]()[_0x47d5aa(0x13c)](_0x2d6fc8,_0x714d8f,_0x504389,_0x236045,_0x24e123);}static async[_0x25038c(0x10e)](_0x514fdc){}static async['activateChatAndGetHistory'](_0x1e3aaa){}static async[_0x25038c(0x12a)](_0x599539){const _0x2e149e=_0x25038c;return napCatCore[_0x2e149e(0x12b)]['getMsgService']()['setMsgRead'](_0x599539);}static async['getMsgHistory'](_0x28ef95,_0x1d7c04,_0x2e33df){const _0x1a7ecb=_0x25038c;return napCatCore[_0x1a7ecb(0x12b)][_0x1a7ecb(0x147)]()[_0x1a7ecb(0x126)](_0x28ef95,_0x1d7c04,_0x2e33df,!![]);}static async[_0x25038c(0x13b)](){}static async[_0x25038c(0x11d)](_0x720ab5,_0x4de888){const _0x32032d=_0x25038c;await napCatCore[_0x32032d(0x12b)][_0x32032d(0x147)]()[_0x32032d(0x11d)]({'chatType':_0x720ab5[_0x32032d(0x12d)],'peerUid':_0x720ab5['peerUid']},_0x4de888);}static async[_0x25038c(0x10a)](_0x23e974,_0xe7b5aa,_0x1f29df=!![],_0x46da3f=0x2710){const _0x470bc8=_0x25038c,_0x1befc1={'zEevP':function(_0x3611d9,_0x5c35ea){return _0x3611d9>_0x5c35ea;},'XOFQk':function(_0x25ed3c,_0x287120){return _0x25ed3c(_0x287120);},'vCyAk':function(_0x577c14){return _0x577c14();},'Pvyte':function(_0x570859,_0x57c274){return _0x570859(_0x57c274);},'PNVbh':function(_0xcdb75,_0x5aa58e){return _0xcdb75===_0x5aa58e;},'zasmj':function(_0x27f12b){return _0x27f12b();},'HbLxn':function(_0x4fa0c3,_0x1edf46,_0xdfa70f){return _0x4fa0c3(_0x1edf46,_0xdfa70f);},'tAFvr':function(_0x10ffcf){return _0x10ffcf();}},_0x1411b7=_0x23e974[_0x470bc8(0x143)];let _0x2d41e5=0x0;const _0xa8c4c5=async()=>{const _0x3828fa=_0x470bc8;if(_0x1befc1[_0x3828fa(0x128)](_0x2d41e5,_0x46da3f))throw _0x3828fa(0x118);const _0x33ff94=sendMessagePool[_0x23e974[_0x3828fa(0x143)]];if(_0x33ff94)return await _0x1befc1[_0x3828fa(0x113)](sleep,0x1f4),_0x2d41e5+=0x1f4,await _0x1befc1['vCyAk'](_0xa8c4c5);else return;};return await _0x1befc1[_0x470bc8(0x120)](_0xa8c4c5),new Promise((_0x3fcd4e,_0xd99460)=>{const _0x546f1a=_0x470bc8,_0x3307f9={'NLBdM':function(_0x1b1252,_0x4c5fd7){return _0x1b1252===_0x4c5fd7;},'AsAVP':function(_0x4606c8,_0x52412c){return _0x1befc1['PNVbh'](_0x4606c8,_0x52412c);}};let _0x1a042c=![],_0x38e5e0=null;const _0x417465=_0x1befc1[_0x546f1a(0x106)](randomUUID);sendSuccessCBMap[_0x417465]=_0x327c9b=>{const _0x580f69=_0x546f1a;if(_0x3307f9[_0x580f69(0x110)](_0x327c9b['msgId'],_0x38e5e0?.[_0x580f69(0x140)])){if(_0x3307f9[_0x580f69(0x137)](_0x327c9b[_0x580f69(0x131)],0x2))return delete sendSuccessCBMap[_0x417465],_0x1a042c=!![],_0x3fcd4e(_0x327c9b),!![];return![];}return![];},sendMessagePool[_0x1411b7]=async _0x54ecbc=>{delete sendMessagePool[_0x1411b7],_0x38e5e0=_0x54ecbc;},_0x1befc1['HbLxn'](setTimeout,()=>{if(_0x1a042c)return;delete sendMessagePool[_0x1411b7],delete sendSuccessCBMap[_0x417465],_0x1befc1['Pvyte'](_0xd99460,'发送超时');},_0x46da3f);const _0x1c4689=napCatCore[_0x546f1a(0x12b)][_0x546f1a(0x147)]()['sendMsg']('0',_0x23e974,_0xe7b5aa,new Map());});}static async[_0x25038c(0x114)](_0x1de0c2,_0x814f89,_0x5ec616){const _0x109c84=_0x25038c;return napCatCore[_0x109c84(0x12b)][_0x109c84(0x147)]()[_0x109c84(0x114)](_0x5ec616,_0x1de0c2,[_0x814f89],new Map());}static async[_0x25038c(0x11b)](_0x1f15ba,_0x4d6252,_0x1c5b05){const _0x2ce5ba=_0x25038c,_0x1d90ca={'qpEac':function(_0x3c52c8,_0x5832c0){return _0x3c52c8!=_0x5832c0;},'NtcNO':_0x2ce5ba(0x133),'labYg':function(_0xe94149,_0x537489){return _0xe94149==_0x537489;},'ocMZn':function(_0x3c5c1c,_0x3bbd84){return _0x3c5c1c==_0x3bbd84;},'ToDnc':function(_0x344e02,_0x4258e0){return _0x344e02(_0x4258e0);},'nscqF':function(_0x1c2c02,_0x3f34f9){return _0x1c2c02(_0x3f34f9);},'nwtwH':_0x2ce5ba(0x130),'ZECul':function(_0x1bc5a8){return _0x1bc5a8();},'qQwRM':function(_0xde3d40,_0x272e0f,_0x45cb07){return _0xde3d40(_0x272e0f,_0x45cb07);}},_0x2569b0=_0x1c5b05[_0x2ce5ba(0x12e)](_0x32172e=>{const _0x180a4d=_0x2ce5ba;return{'msgId':_0x32172e,'senderShowName':selfInfo[_0x180a4d(0x12f)]};});return new Promise((_0x18b3ba,_0x8773a2)=>{const _0x5b507b=_0x2ce5ba;let _0x51c64b=![];const _0x192a2f=_0x4044ed=>{const _0x3e41f6=_0x3f0a,_0xed08d5=_0x4044ed[_0x3e41f6(0x149)][_0x3e41f6(0x116)](_0x3aacb9=>_0x3aacb9[_0x3e41f6(0x125)]);if(!_0xed08d5)return;const _0x238097=JSON[_0x3e41f6(0x139)](_0xed08d5['arkElement'][_0x3e41f6(0x13f)]);if(_0x1d90ca[_0x3e41f6(0x122)](_0x238097[_0x3e41f6(0x10c)],_0x1d90ca[_0x3e41f6(0x13e)]))return;_0x1d90ca[_0x3e41f6(0x108)](_0x4044ed[_0x3e41f6(0x143)],_0x4d6252[_0x3e41f6(0x143)])&&_0x1d90ca[_0x3e41f6(0x117)](_0x4044ed[_0x3e41f6(0x144)],selfInfo['uid'])&&(_0x51c64b=!![],_0x1d90ca[_0x3e41f6(0x127)](_0x18b3ba,_0x4044ed));};sentMsgTasks['set'](_0x1d90ca[_0x5b507b(0x124)](randomUUID),_0x192a2f),_0x1d90ca[_0x5b507b(0x121)](setTimeout,()=>{const _0x12443f=_0x5b507b;!_0x51c64b&&_0x1d90ca[_0x12443f(0x11a)](_0x8773a2,_0x1d90ca['nwtwH']);},0x1388),napCatCore[_0x5b507b(0x12b)][_0x5b507b(0x147)]()[_0x5b507b(0x11c)](_0x2569b0,_0x1f15ba,_0x4d6252,[],new Map());});}}