const _0x5bac7f=_0x31d1;function _0x31d1(_0x5f5cbf,_0x366566){const _0xc08493=_0xc084();return _0x31d1=function(_0x31d1fc,_0x1e41fc){_0x31d1fc=_0x31d1fc-0x10d;let _0x2dbd46=_0xc08493[_0x31d1fc];return _0x2dbd46;},_0x31d1(_0x5f5cbf,_0x366566);}(function(_0x1c6e21,_0x5b0de7){const _0x4cb410=_0x31d1,_0x5afdca=_0x1c6e21();while(!![]){try{const _0x5d4a26=parseInt(_0x4cb410(0x111))/0x1+-parseInt(_0x4cb410(0x11f))/0x2*(-parseInt(_0x4cb410(0x113))/0x3)+-parseInt(_0x4cb410(0x123))/0x4+parseInt(_0x4cb410(0x143))/0x5*(-parseInt(_0x4cb410(0x13f))/0x6)+parseInt(_0x4cb410(0x11d))/0x7+-parseInt(_0x4cb410(0x10f))/0x8+parseInt(_0x4cb410(0x12b))/0x9;if(_0x5d4a26===_0x5b0de7)break;else _0x5afdca['push'](_0x5afdca['shift']());}catch(_0x10ce67){_0x5afdca['push'](_0x5afdca['shift']());}}}(_0xc084,0x2ce59));import{selfInfo}from'@/core/data';import{log,logError}from'@/common/utils/log';import{sleep}from'@/common/utils/helper';import{napCatCore}from'@/core';import{MsgListener}from'@/core/listeners';import{randomUUID}from'crypto';function _0xc084(){const _0x4f960f=['map','83590gwXBQC','getMsgsByMsgId','forwardMsg','364728URBogs','KsONx','193157toocgM','getMsgsBySeqAndCount','95661AJZbOa','multiForwardMsg','xMXZa','com.tencent.multimsg','find','bytesData','setMsgRead','getMsgsIncludeSelf','WXOXE','session','976192guLGPo','RIMUJ','10yupeYh','setEmojiLike','getMsgService','recallMsg','21292PMtRXv','sendMsg','peerUid','YhhTU','app','nick','chatType','arkElement','543645zhspeH','chOoL','fetchRecentContact','multiForwardMsgWithComment','msgId','jRKxa','onLoginSuccess','IGgTl','delete','DKvrg','sendStatus','then','SxGZQ','activateChat','catch','XnZbZ','onMsgInfoListUpdate','addListener','PCThX','forEach','114FcjUjk','onAddSendMsg','getMsgHistory'];_0xc084=function(){return _0x4f960f;};return _0xc084();}const sendMessagePool={},sendSuccessCBMap={},sentMsgTasks=new Map(),msgListener=new MsgListener();msgListener[_0x5bac7f(0x140)]=_0x3714be=>{const _0x4f5bd2=_0x5bac7f;for(const [_0x41a6a2,_0x46ccec]of sentMsgTasks){_0x46ccec(_0x3714be),sentMsgTasks[_0x4f5bd2(0x133)](_0x41a6a2);}if(sendMessagePool[_0x3714be[_0x4f5bd2(0x125)]]){const _0x42b1a6=sendMessagePool[_0x3714be['peerUid']]?.(_0x3714be);_0x42b1a6 instanceof Promise&&_0x42b1a6[_0x4f5bd2(0x136)]()[_0x4f5bd2(0x139)](logError);}},msgListener[_0x5bac7f(0x13b)]=_0x466ae2=>{const _0x33773b=_0x5bac7f,_0x5bf7a9={'UuFuP':function(_0x29a5f9,_0x3e4dd3){return _0x29a5f9 instanceof _0x3e4dd3;},'IGgTl':function(_0x46eee5,_0x3c7a7e){return _0x46eee5(_0x3c7a7e);}};_0x466ae2[_0x33773b(0x13e)](_0x1f9387=>{const _0x2f896a=_0x33773b,_0xac9822={'SxGZQ':function(_0x1f0c81,_0x3d4682){return _0x5bf7a9['UuFuP'](_0x1f0c81,_0x3d4682);},'DKvrg':function(_0x518041,_0x48a319){const _0xcfe14a=_0x31d1;return _0x5bf7a9[_0xcfe14a(0x132)](_0x518041,_0x48a319);}};new Promise((_0x1fd9b2,_0x67ee72)=>{const _0x277e1f=_0x31d1;for(const _0x546a3b in sendSuccessCBMap){const _0x261738=sendSuccessCBMap[_0x546a3b],_0x2cecfd=_0x261738(_0x1f9387),_0x4c3adc=_0x4ecbbc=>{_0x4ecbbc&&delete sendSuccessCBMap[_0x546a3b];};_0xac9822[_0x277e1f(0x137)](_0x2cecfd,Promise)?_0x2cecfd[_0x277e1f(0x136)](_0x4c3adc):_0xac9822[_0x277e1f(0x134)](_0x4c3adc,_0x2cecfd);}})[_0x2f896a(0x136)]()[_0x2f896a(0x139)](log);});},setTimeout(()=>{const _0x338427=_0x5bac7f;napCatCore[_0x338427(0x131)](()=>{const _0x24db68=_0x338427;napCatCore[_0x24db68(0x13c)](msgListener);});},0x64);export class NTQQMsgApi{static async[_0x5bac7f(0x120)](_0x4682c3,_0x534e7a,_0x5eef8c,_0x5c294c=!![]){const _0x25682a=_0x5bac7f,_0x28a497={'KsONx':function(_0x12b68a,_0x5657a9){return _0x12b68a>_0x5657a9;}};return _0x5eef8c=_0x5eef8c['toString'](),napCatCore[_0x25682a(0x11c)][_0x25682a(0x121)]()['setMsgEmojiLikes'](_0x4682c3,_0x534e7a,_0x5eef8c,_0x28a497[_0x25682a(0x110)](_0x5eef8c['length'],0x3)?'2':'1',_0x5c294c);}static async['getMultiMsg'](_0x525191,_0x32163d,_0x80928a){const _0x57f7e3=_0x5bac7f;return napCatCore['session'][_0x57f7e3(0x121)]()['getMultiMsg'](_0x525191,_0x32163d,_0x80928a);}static async['getMsgsByMsgId'](_0x522d29,_0x22b9e6){const _0x27bc5d=_0x5bac7f;return await napCatCore[_0x27bc5d(0x11c)][_0x27bc5d(0x121)]()[_0x27bc5d(0x10d)](_0x522d29,_0x22b9e6);}static async[_0x5bac7f(0x112)](_0xbfc3e9,_0x47013e,_0x58cca4,_0x105e6d,_0x11bd7e){const _0x3093f0=_0x5bac7f;return await napCatCore[_0x3093f0(0x11c)][_0x3093f0(0x121)]()['getMsgsBySeqAndCount'](_0xbfc3e9,_0x47013e,_0x58cca4,_0x105e6d,_0x11bd7e);}static async[_0x5bac7f(0x138)](_0x5a974d){}static async['activateChatAndGetHistory'](_0x107143){}static async[_0x5bac7f(0x119)](_0x2c9252){const _0x145b0b=_0x5bac7f;return napCatCore[_0x145b0b(0x11c)][_0x145b0b(0x121)]()[_0x145b0b(0x119)](_0x2c9252);}static async[_0x5bac7f(0x141)](_0x292b68,_0x52d699,_0x308329){const _0x5ec9e5=_0x5bac7f;return napCatCore['session'][_0x5ec9e5(0x121)]()[_0x5ec9e5(0x11a)](_0x292b68,_0x52d699,_0x308329,!![]);}static async[_0x5bac7f(0x12d)](){}static async['recallMsg'](_0x252dcf,_0x21ac7c){const _0x106c8c=_0x5bac7f;await napCatCore['session'][_0x106c8c(0x121)]()[_0x106c8c(0x122)]({'chatType':_0x252dcf[_0x106c8c(0x129)],'peerUid':_0x252dcf['peerUid']},_0x21ac7c);}static async[_0x5bac7f(0x124)](_0x393690,_0x179003,_0x564d3c=!![],_0x1437a7=0x2710){const _0x57f082=_0x5bac7f,_0x5ad8ff={'chOoL':function(_0x1e66dd,_0xbe399a){return _0x1e66dd>_0xbe399a;},'RIMUJ':'发送超时','WXOXE':function(_0x27e283,_0x32e1d9){return _0x27e283(_0x32e1d9);},'jRKxa':function(_0x2b6249){return _0x2b6249();},'YhhTU':function(_0x230546,_0x3edca0){return _0x230546===_0x3edca0;},'XnZbZ':function(_0x1f3a9e){return _0x1f3a9e();},'uPKpc':function(_0x47a67c,_0x5a04ea,_0x2121c8){return _0x47a67c(_0x5a04ea,_0x2121c8);}},_0x3261d9=_0x393690[_0x57f082(0x125)];let _0x29916d=0x0;const _0x4754b7=async()=>{const _0x32e776=_0x57f082;if(_0x5ad8ff[_0x32e776(0x12c)](_0x29916d,_0x1437a7))throw _0x5ad8ff[_0x32e776(0x11e)];const _0x1e6696=sendMessagePool[_0x393690['peerUid']];if(_0x1e6696)return await _0x5ad8ff[_0x32e776(0x11b)](sleep,0x1f4),_0x29916d+=0x1f4,await _0x5ad8ff[_0x32e776(0x130)](_0x4754b7);else return;};return await _0x4754b7(),new Promise((_0x5177d6,_0xbaa2c9)=>{const _0x22f87a=_0x57f082;let _0x5f2473=![],_0x36fb65=null;const _0x212718=_0x5ad8ff[_0x22f87a(0x13a)](randomUUID);sendSuccessCBMap[_0x212718]=_0x385204=>{const _0x1cd0e9=_0x22f87a;if(_0x385204[_0x1cd0e9(0x12f)]===_0x36fb65?.[_0x1cd0e9(0x12f)]){if(_0x5ad8ff[_0x1cd0e9(0x126)](_0x385204[_0x1cd0e9(0x135)],0x2))return delete sendSuccessCBMap[_0x212718],_0x5f2473=!![],_0x5ad8ff[_0x1cd0e9(0x11b)](_0x5177d6,_0x385204),!![];return![];}return![];},sendMessagePool[_0x3261d9]=async _0x218b2c=>{delete sendMessagePool[_0x3261d9],_0x36fb65=_0x218b2c;},_0x5ad8ff['uPKpc'](setTimeout,()=>{const _0xafde84=_0x22f87a;if(_0x5f2473)return;delete sendMessagePool[_0x3261d9],delete sendSuccessCBMap[_0x212718],_0x5ad8ff[_0xafde84(0x11b)](_0xbaa2c9,_0x5ad8ff[_0xafde84(0x11e)]);},_0x1437a7);const _0x337b2e=napCatCore['session'][_0x22f87a(0x121)]()[_0x22f87a(0x124)]('0',_0x393690,_0x179003,new Map());});}static async[_0x5bac7f(0x10e)](_0x30b87b,_0x310c01,_0x519b71){const _0x10be44=_0x5bac7f;return napCatCore[_0x10be44(0x11c)][_0x10be44(0x121)]()['forwardMsg'](_0x519b71,_0x30b87b,[_0x310c01],new Map());}static async[_0x5bac7f(0x114)](_0x4ba57e,_0x4275c0,_0x297385){const _0x4c7354=_0x5bac7f,_0x4de953={'TXDhC':function(_0xe25921,_0x188c31){return _0xe25921!=_0x188c31;},'PCThX':function(_0x14b851,_0x473a37){return _0x14b851==_0x473a37;},'xMXZa':function(_0x5a5992,_0xe83867){return _0x5a5992==_0xe83867;}},_0x3267b3=_0x297385[_0x4c7354(0x142)](_0x18e081=>{const _0x37a748=_0x4c7354;return{'msgId':_0x18e081,'senderShowName':selfInfo[_0x37a748(0x128)]};});return new Promise((_0x3ee664,_0xde4702)=>{const _0x42139f=_0x4c7354;let _0x5ca539=![];const _0x14cb98=_0x4d2073=>{const _0x334821=_0x31d1,_0x49177b=_0x4d2073['elements'][_0x334821(0x117)](_0x50a010=>_0x50a010[_0x334821(0x12a)]);if(!_0x49177b)return;const _0x352715=JSON['parse'](_0x49177b[_0x334821(0x12a)][_0x334821(0x118)]);if(_0x4de953['TXDhC'](_0x352715[_0x334821(0x127)],_0x334821(0x116)))return;_0x4de953[_0x334821(0x13d)](_0x4d2073['peerUid'],_0x4275c0[_0x334821(0x125)])&&_0x4de953[_0x334821(0x115)](_0x4d2073['senderUid'],selfInfo['uid'])&&(_0x5ca539=!![],_0x3ee664(_0x4d2073));};sentMsgTasks['set'](randomUUID(),_0x14cb98),setTimeout(()=>{!_0x5ca539&&_0xde4702('转发消息超时');},0x1388),napCatCore[_0x42139f(0x11c)]['getMsgService']()[_0x42139f(0x12e)](_0x3267b3,_0x4ba57e,_0x4275c0,[],new Map());});}}