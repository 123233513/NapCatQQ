const _0x2282e3=_0x891f;(function(_0x2e0dbe,_0x59382a){const _0x2e4cf1=_0x891f,_0x2afe42=_0x2e0dbe();while(!![]){try{const _0x1b7761=parseInt(_0x2e4cf1(0x13e))/0x1+-parseInt(_0x2e4cf1(0x134))/0x2*(parseInt(_0x2e4cf1(0x148))/0x3)+parseInt(_0x2e4cf1(0x12b))/0x4*(-parseInt(_0x2e4cf1(0x11f))/0x5)+-parseInt(_0x2e4cf1(0x164))/0x6+parseInt(_0x2e4cf1(0x131))/0x7+-parseInt(_0x2e4cf1(0x14f))/0x8*(-parseInt(_0x2e4cf1(0x126))/0x9)+-parseInt(_0x2e4cf1(0x141))/0xa*(-parseInt(_0x2e4cf1(0x15a))/0xb);if(_0x1b7761===_0x59382a)break;else _0x2afe42['push'](_0x2afe42['shift']());}catch(_0x45b398){_0x2afe42['push'](_0x2afe42['shift']());}}}(_0x5e41,0x23a13));import{Credentials,selfInfo,uid2UinMap}from'@/core/data';function _0x891f(_0x3be421,_0x4c9ba3){const _0x5e416e=_0x5e41();return _0x891f=function(_0x891f39,_0x4fe86a){_0x891f39=_0x891f39-0x11e;let _0x4b86ae=_0x5e416e[_0x891f39];return _0x4b86ae;},_0x891f(_0x3be421,_0x4c9ba3);}import{napCatCore}from'@/core';import{ProfileListener}from'@/core/listeners';import{randomUUID}from'crypto';import{RequestUtil}from'@/common/utils/request';import{logDebug,logError}from'@/common/utils/log';const userInfoCache={},profileListener=new ProfileListener(),userDetailHandlers=new Map();profileListener[_0x2282e3(0x128)]=_0x537105=>{const _0x8a8ef7=_0x2282e3;userInfoCache[_0x537105[_0x8a8ef7(0x125)]]=_0x537105,userDetailHandlers['forEach'](_0xdb5804=>_0xdb5804(_0x537105));},setTimeout(()=>{const _0x19b4f7=_0x2282e3;napCatCore[_0x19b4f7(0x120)](()=>{const _0x26f292=_0x19b4f7;napCatCore[_0x26f292(0x13c)](profileListener);});},0x64);function _0x5e41(){const _0x34ac18=['WIlNR','20856kfuWLB','getRobotUinRange','getSelfInfo','clientKey','getSkey','getTipOffService','set','FMXhA','entries','ulsJq','jcCtL','16126QUaoEg','setHeader','length','获取Pskey失败','PskeyTime','&u1=https%3A%2F%2Fh5.qzone.qq.com%2Fqqnt%2Fqzoneinpcqq%2Ffriend%3Frefresh%3D0%26clientuin%3D0%26darkMode%3D0&keyindex=','then','wMDSp','result','session','120660nWmZUN','ClientKey','WElOx','KSxLn','请求获取Cookies时失败','ZYCfh','setStatus','forceFetchClientKey','uin','Skey','fromEntries','https://ssl.ptlogin2.qq.com/jump?ptlang=1033&clientuin=','391775oyycCw','onLoginSuccess','jVPwt','getPSkey','errMsg','Ansbk','uid','189ZdgZnG','gDGCC','onProfileDetailInfoChanged','domainPskeyMap','KeyIndex','4AEzhUP','like','HttpsGetCookies','请求获取Skey时失败','getRobotService','get','1110326YIwGnF','keyIndex','XTvOp','226NUKPxW','getUserDetailInfo\x20timeout','push','&u1=https%3A%2F%2Fuser.qzone.qq.com%2F','iDgcR','oGdLz','getQzoneCookies','getPskey','addListener','iwYzs','266320IoAOdk','%2Finfocenter&keyindex=19%27','setQQAvatar','50ecHubh','response','getProfileService','now','xfVAB','getProfileLikeService','HBoLt','6441BvlHiF','setBuddyProfileLike','uwcqN','yOigq','setSelfOnlineStatus','CreatTime'];_0x5e41=function(){return _0x34ac18;};return _0x5e41();}export class NTQQUserApi{static async[_0x2282e3(0x14c)](_0x2b7eda,_0x3fcb86,_0x2728fe){const _0x6f0ed5=_0x2282e3;return napCatCore['session']['getMsgService']()[_0x6f0ed5(0x16a)]({'status':_0x2b7eda,'extStatus':_0x3fcb86,'batteryStatus':_0x2728fe});}static async[_0x2282e3(0x12c)](_0x505e58,_0x53b47e=0x1){const _0x52731d=_0x2282e3;return napCatCore[_0x52731d(0x163)][_0x52731d(0x146)]()[_0x52731d(0x149)]({'friendUid':_0x505e58,'sourceId':0x47,'doLikeCount':_0x53b47e,'doLikeTollCount':0x0});}static async[_0x2282e3(0x140)](_0x344ed1){const _0x470d0b=_0x2282e3,_0x322696=napCatCore['session'][_0x470d0b(0x143)]()[_0x470d0b(0x15b)](_0x344ed1);return{'result':_0x322696?.[_0x470d0b(0x162)],'errMsg':_0x322696?.[_0x470d0b(0x123)]};}static async[_0x2282e3(0x151)](){}static async['getUserInfo'](_0x244cf9){}static async['getUserDetailInfo'](_0x2e7997){const _0x588dba=_0x2282e3,_0x18f0d0={'yOigq':function(_0x50fd9c,_0x3463d9){return _0x50fd9c(_0x3463d9);},'KyfvQ':_0x588dba(0x135),'xfVAB':function(_0x4d95fc,_0x31662f){return _0x4d95fc===_0x31662f;},'hdZqu':function(_0x4f1b6e,_0x376392){return _0x4f1b6e(_0x376392);},'Ulhjm':function(_0x532d7d){return _0x532d7d();},'Ansbk':function(_0x2409ac,_0x30221a,_0xf4339d){return _0x2409ac(_0x30221a,_0xf4339d);}},_0x3e9dbe=napCatCore[_0x588dba(0x163)][_0x588dba(0x143)]();return new Promise((_0x6f0dfa,_0x1bb90c)=>{const _0x4fd24b=_0x588dba,_0x4e669f=_0x18f0d0['Ulhjm'](randomUUID);let _0x121f39=![],_0x4bd9c8=undefined,_0x2bd263=!![];_0x18f0d0[_0x4fd24b(0x124)](setTimeout,()=>{const _0x2718e0=_0x4fd24b;!_0x121f39&&(_0x4bd9c8?_0x6f0dfa(_0x4bd9c8):_0x18f0d0[_0x2718e0(0x14b)](_0x1bb90c,_0x18f0d0['KyfvQ'])),userDetailHandlers['delete'](_0x4e669f);},0x1388),userDetailHandlers[_0x4fd24b(0x155)](_0x4e669f,_0x406f12=>{const _0x2cf142=_0x4fd24b;_0x18f0d0[_0x2cf142(0x145)](_0x406f12[_0x2cf142(0x125)],_0x2e7997)&&(uid2UinMap[_0x2e7997]=_0x406f12['uin'],_0x2bd263?(_0x4bd9c8=_0x406f12,_0x2bd263=![]):(_0x121f39=!![],_0x18f0d0['hdZqu'](_0x6f0dfa,_0x406f12)));}),_0x3e9dbe['getUserDetailInfoWithBizInfo'](_0x2e7997,[0x0])[_0x4fd24b(0x160)](_0x21acfb=>{});});}static async[_0x2282e3(0x122)](_0x45cd1b,_0x14d7c8=!![]){const _0x43ecbd=_0x2282e3,_0x1a3efd={'uwcqN':function(_0x5db0d9,_0xb6475){return _0x5db0d9||_0xb6475;},'KijbO':function(_0x161b86,_0x58ad0e){return _0x161b86>_0x58ad0e;},'HBoLt':function(_0x573c2b,_0x1c4e06){return _0x573c2b-_0x1c4e06;},'WElOx':function(_0x28c85b,_0x1705dc){return _0x28c85b===_0x1705dc;},'ulsJq':function(_0x4825d1,_0x41a217,_0x981e0a){return _0x4825d1(_0x41a217,_0x981e0a);},'oGdLz':_0x43ecbd(0x15d)},_0x5d20d8=[],_0x961f10={};for(const _0x43f45e in _0x45cd1b){const _0x2eb9a4=Credentials['PskeyData'][_0x43ecbd(0x130)](_0x45cd1b[_0x43f45e]),_0x36773d=Credentials[_0x43ecbd(0x15e)]['get'](_0x45cd1b[_0x43f45e]);_0x1a3efd[_0x43ecbd(0x14a)](!_0x2eb9a4,!_0x36773d)||_0x1a3efd['KijbO'](_0x1a3efd[_0x43ecbd(0x147)](Date[_0x43ecbd(0x144)](),_0x36773d),0x708*0x3e8)||!_0x14d7c8?_0x5d20d8[_0x43ecbd(0x136)](_0x45cd1b[_0x43f45e]):_0x961f10[_0x45cd1b[_0x43f45e]]=_0x2eb9a4;}let _0x2912e3={'result':0x0,'errMsg':'','domainPskeyMap':new Map()};_0x1a3efd['KijbO'](_0x5d20d8[_0x43ecbd(0x15c)],0x0)&&(_0x2912e3=await napCatCore[_0x43ecbd(0x163)][_0x43ecbd(0x154)]()[_0x43ecbd(0x13b)](_0x5d20d8,!![]));const _0x5b91fe=_0x2912e3[_0x43ecbd(0x129)];for(const _0x3a3f2f of _0x5b91fe[_0x43ecbd(0x157)]()){Credentials['PskeyData'][_0x43ecbd(0x155)](_0x3a3f2f[0x0],_0x3a3f2f[0x1]),Credentials[_0x43ecbd(0x15e)][_0x43ecbd(0x155)](_0x3a3f2f[0x0],Date['now']());}const _0x334891=Object['assign'](Object[_0x43ecbd(0x16e)](_0x5b91fe),_0x961f10);if(_0x1a3efd[_0x43ecbd(0x166)](_0x2912e3[_0x43ecbd(0x162)],0x0))return _0x334891;else _0x1a3efd[_0x43ecbd(0x158)](logError,_0x1a3efd[_0x43ecbd(0x139)],_0x2912e3[_0x43ecbd(0x123)]);return{};}static async[_0x2282e3(0x150)](){const _0x36969f=_0x2282e3,_0x18f2e9=await napCatCore['session'][_0x36969f(0x12f)]()['getRobotUinRange']({'justFetchMsgConfig':'1','type':0x1,'version':0x0,'aioKeywordVersion':0x0});return _0x18f2e9?.[_0x36969f(0x142)]?.['robotUinRanges'];}static async[_0x2282e3(0x13a)](){const _0x4422c5=_0x2282e3,_0x207ef9={'KSxLn':function(_0x590451,_0x2efe7b){return _0x590451+_0x2efe7b;},'ZYCfh':_0x4422c5(0x11e),'TgbRl':_0x4422c5(0x137),'XWCRF':_0x4422c5(0x13f)},_0x1c7c00=_0x207ef9[_0x4422c5(0x167)](_0x207ef9[_0x4422c5(0x167)](_0x207ef9[_0x4422c5(0x169)],selfInfo['uin'])+'&clientkey='+Credentials[_0x4422c5(0x165)]+_0x207ef9['TgbRl']+selfInfo[_0x4422c5(0x16c)],_0x207ef9['XWCRF']);let _0x2cfab4={};try{_0x2cfab4=await RequestUtil['HttpsGetCookies'](_0x1c7c00);}catch(_0xad899){logDebug(_0x4422c5(0x168),_0xad899),_0x2cfab4={};}return _0x2cfab4;}static async[_0x2282e3(0x153)](_0x4b363a=!![]){const _0x27adc1=_0x2282e3,_0x51fb6d={'LvxCJ':function(_0x249223,_0x581f85){return _0x249223-_0x581f85;},'WIlNR':function(_0x481a9a,_0x32e011){return _0x481a9a*_0x32e011;},'hiNXL':function(_0x57b346,_0x578dd5){return _0x57b346!==_0x578dd5;},'gDGCC':function(_0x1c9317,_0x11b658){return _0x1c9317+_0x11b658;},'iwYzs':function(_0x193028,_0x43e05e){return _0x193028+_0x43e05e;},'jVPwt':function(_0x53eac5,_0x2f1854){return _0x53eac5+_0x2f1854;},'ZYOiT':_0x27adc1(0x11e),'iDgcR':'&clientkey=','wMDSp':_0x27adc1(0x15f),'jcCtL':function(_0x21f272,_0x58e7ac,_0x5e7e1e){return _0x21f272(_0x58e7ac,_0x5e7e1e);},'FMXhA':_0x27adc1(0x12e),'XTvOp':'skey'};try{if(Credentials['CreatTime']==0x0||_0x51fb6d['LvxCJ'](Date[_0x27adc1(0x144)](),Credentials[_0x27adc1(0x14d)])>_0x51fb6d[_0x27adc1(0x14e)](0x3e8,0xe10)||!_0x4b363a){const _0x43969f=await napCatCore[_0x27adc1(0x163)]['getTicketService']()[_0x27adc1(0x16b)]('');if(_0x51fb6d['hiNXL'](_0x43969f[_0x27adc1(0x162)],0x0))return'';const _0x4815ee=_0x43969f[_0x27adc1(0x152)],_0xf9c375=_0x43969f[_0x27adc1(0x132)],_0x529a9c=_0x51fb6d[_0x27adc1(0x127)](_0x51fb6d['gDGCC'](_0x51fb6d[_0x27adc1(0x13d)](_0x51fb6d[_0x27adc1(0x121)](_0x51fb6d[_0x27adc1(0x13d)](_0x51fb6d['ZYOiT'],selfInfo[_0x27adc1(0x16c)]),_0x51fb6d[_0x27adc1(0x138)]),_0x4815ee),_0x51fb6d[_0x27adc1(0x161)]),_0xf9c375);let _0x1edab9={};try{_0x1edab9=await RequestUtil[_0x27adc1(0x12d)](_0x529a9c);}catch(_0x299383){_0x51fb6d[_0x27adc1(0x159)](logDebug,_0x51fb6d[_0x27adc1(0x156)],_0x299383),_0x1edab9={};}const _0x5ee4f1=_0x1edab9[_0x51fb6d[_0x27adc1(0x133)]];if(!_0x5ee4f1)return'';return Credentials[_0x27adc1(0x165)]=_0x4815ee,Credentials[_0x27adc1(0x12a)]=_0xf9c375,Credentials[_0x27adc1(0x14d)]=Date[_0x27adc1(0x144)](),Credentials[_0x27adc1(0x16d)]=_0x5ee4f1,_0x5ee4f1;}return Credentials[_0x27adc1(0x16d)];}catch(_0x1f4f6b){}return undefined;}}