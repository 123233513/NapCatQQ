const _0x520b86=_0x203a;(function(_0x18b2ab,_0xcfa1bd){const _0x365cde=_0x203a,_0x5debd3=_0x18b2ab();while(!![]){try{const _0x2b020d=parseInt(_0x365cde(0x1bf))/0x1+parseInt(_0x365cde(0x1b8))/0x2+parseInt(_0x365cde(0x1b6))/0x3*(parseInt(_0x365cde(0x1d7))/0x4)+parseInt(_0x365cde(0x1dc))/0x5*(-parseInt(_0x365cde(0x1e9))/0x6)+parseInt(_0x365cde(0x1d2))/0x7+-parseInt(_0x365cde(0x1d8))/0x8+parseInt(_0x365cde(0x1c7))/0x9;if(_0x2b020d===_0xcfa1bd)break;else _0x5debd3['push'](_0x5debd3['shift']());}catch(_0x1a48ce){_0x5debd3['push'](_0x5debd3['shift']());}}}(_0x2d31,0x293de));function _0x203a(_0x33ebd9,_0x127604){const _0x2d31a8=_0x2d31();return _0x203a=function(_0x203ab1,_0x3febe9){_0x203ab1=_0x203ab1-0x1a3;let _0x589fda=_0x2d31a8[_0x203ab1];return _0x589fda;},_0x203a(_0x33ebd9,_0x127604);}import{Credentials,selfInfo,uid2UinMap}from'@/core/data';import{napCatCore}from'@/core';import{ProfileListener}from'@/core/listeners';import{randomUUID}from'crypto';import{RequestUtil}from'@/common/utils/request';import{logDebug,logError}from'@/common/utils/log';const userInfoCache={},profileListener=new ProfileListener(),userDetailHandlers=new Map();profileListener[_0x520b86(0x1ca)]=_0x24d8d8=>{const _0x48d7b6=_0x520b86;userInfoCache[_0x24d8d8[_0x48d7b6(0x1c3)]]=_0x24d8d8,userDetailHandlers['forEach'](_0x2a012b=>_0x2a012b(_0x24d8d8));},setTimeout(()=>{const _0x33cfef=_0x520b86;napCatCore[_0x33cfef(0x1be)](()=>{const _0x1d72e9=_0x33cfef;napCatCore[_0x1d72e9(0x1a9)](profileListener);});},0x64);export class NTQQUserApi{static async[_0x520b86(0x1d9)](_0x51e6c4,_0x417228,_0x39b727){const _0x2fac39=_0x520b86;return napCatCore['session'][_0x2fac39(0x1a4)]()['setStatus']({'status':_0x51e6c4,'extStatus':_0x417228,'batteryStatus':_0x39b727});}static async[_0x520b86(0x1dd)](_0x3eb0be,_0x2f39fd=0x1){const _0x2d3a20=_0x520b86;return napCatCore[_0x2d3a20(0x1de)]['getProfileLikeService']()[_0x2d3a20(0x1cf)]({'friendUid':_0x3eb0be,'sourceId':0x47,'doLikeCount':_0x2f39fd,'doLikeTollCount':0x0});}static async[_0x520b86(0x1a6)](_0x48db10){const _0x20849f=_0x520b86,_0x73c8d9=napCatCore['session'][_0x20849f(0x1ef)]()[_0x20849f(0x1e2)](_0x48db10);return{'result':_0x73c8d9?.[_0x20849f(0x1b0)],'errMsg':_0x73c8d9?.[_0x20849f(0x1e4)]};}static async[_0x520b86(0x1c0)](){}static async[_0x520b86(0x1cb)](_0x21ff60){}static async[_0x520b86(0x1c6)](_0x2f1cf7){const _0x1fb13a=_0x520b86,_0xfb4e06={'YVnjb':function(_0x11669c,_0x283675){return _0x11669c(_0x283675);},'TdVvg':function(_0x8fc488){return _0x8fc488();},'UryEE':function(_0x2ba739,_0x208e45,_0x489efc){return _0x2ba739(_0x208e45,_0x489efc);}},_0x3b914c=napCatCore[_0x1fb13a(0x1de)][_0x1fb13a(0x1ef)]();return new Promise((_0x4e94d3,_0x55ab16)=>{const _0x2569b6=_0x1fb13a,_0x232d57={'gOYTO':function(_0x2a5971,_0x146334){const _0x57cbf8=_0x203a;return _0xfb4e06[_0x57cbf8(0x1f0)](_0x2a5971,_0x146334);},'BIUZz':_0x2569b6(0x1ad)},_0x300b83=_0xfb4e06[_0x2569b6(0x1b9)](randomUUID);let _0x34c07a=![],_0x35a859=undefined,_0x560a6=!![];_0xfb4e06[_0x2569b6(0x1b2)](setTimeout,()=>{const _0xbf12d0=_0x2569b6;!_0x34c07a&&(_0x35a859?_0x232d57['gOYTO'](_0x4e94d3,_0x35a859):_0x55ab16(_0x232d57[_0xbf12d0(0x1cc)])),userDetailHandlers[_0xbf12d0(0x1f1)](_0x300b83);},0x1388),userDetailHandlers['set'](_0x300b83,_0x33ff7f=>{const _0x8e57db=_0x2569b6;_0x33ff7f[_0x8e57db(0x1c3)]===_0x2f1cf7&&(uid2UinMap[_0x2f1cf7]=_0x33ff7f['uin'],_0x560a6?(_0x35a859=_0x33ff7f,_0x560a6=![]):(_0x34c07a=!![],_0xfb4e06['YVnjb'](_0x4e94d3,_0x33ff7f)));}),_0x3b914c[_0x2569b6(0x1ba)](_0x2f1cf7,[0x0])[_0x2569b6(0x1df)](_0x46044f=>{});});}static async['getPSkey'](_0x1bcf61,_0x1c05e7=!![]){const _0x36acaf=_0x520b86,_0x2497ad={'kGJqo':function(_0x24d81d,_0x4c64c9){return _0x24d81d||_0x4c64c9;},'OJkaT':function(_0x4398a8,_0x28b7ca){return _0x4398a8>_0x28b7ca;},'Ujvvl':function(_0x2e8b61,_0x5e1598){return _0x2e8b61-_0x5e1598;},'jyYCq':function(_0x435429,_0x82951){return _0x435429*_0x82951;},'BXcHa':function(_0x202b28,_0x44efb6){return _0x202b28>_0x44efb6;},'uJvEM':function(_0x323a3b,_0x43e9bd,_0x362610){return _0x323a3b(_0x43e9bd,_0x362610);}},_0x5d04aa=[],_0x53525a={};for(const _0x24f657 in _0x1bcf61){const _0x4f0cb1=Credentials[_0x36acaf(0x1e7)]['get'](_0x1bcf61[_0x24f657]),_0x52ff46=Credentials[_0x36acaf(0x1a7)][_0x36acaf(0x1bb)](_0x1bcf61[_0x24f657]);_0x2497ad[_0x36acaf(0x1a3)](!_0x4f0cb1,!_0x52ff46)||_0x2497ad['OJkaT'](_0x2497ad[_0x36acaf(0x1e5)](Date['now'](),_0x52ff46),_0x2497ad[_0x36acaf(0x1c1)](0x708,0x3e8))||!_0x1c05e7?_0x5d04aa[_0x36acaf(0x1b3)](_0x1bcf61[_0x24f657]):_0x53525a[_0x1bcf61[_0x24f657]]=_0x4f0cb1;}let _0x335c80={'result':0x0,'errMsg':'','domainPskeyMap':new Map()};_0x2497ad[_0x36acaf(0x1aa)](_0x5d04aa[_0x36acaf(0x1a5)],0x0)&&(_0x335c80=await napCatCore['session'][_0x36acaf(0x1c8)]()['getPskey'](_0x5d04aa,!![]));const _0x1da7a6=_0x335c80[_0x36acaf(0x1cd)];for(const _0x1ebbc0 of _0x1da7a6[_0x36acaf(0x1ae)]()){Credentials[_0x36acaf(0x1e7)][_0x36acaf(0x1e0)](_0x1ebbc0[0x0],_0x1ebbc0[0x1]),Credentials[_0x36acaf(0x1a7)][_0x36acaf(0x1e0)](_0x1ebbc0[0x0],Date['now']());}const _0x1939a1=Object[_0x36acaf(0x1e3)](Object[_0x36acaf(0x1e6)](_0x1da7a6),_0x53525a);if(_0x335c80[_0x36acaf(0x1b0)]===0x0)return _0x1939a1;else _0x2497ad[_0x36acaf(0x1c4)](logError,_0x36acaf(0x1ab),_0x335c80[_0x36acaf(0x1e4)]);return{};}static async[_0x520b86(0x1c9)](){const _0x5edf5d=_0x520b86,_0x2f6f68=await napCatCore[_0x5edf5d(0x1de)][_0x5edf5d(0x1b7)]()['getRobotUinRange']({'justFetchMsgConfig':'1','type':0x1,'version':0x0,'aioKeywordVersion':0x0});return _0x2f6f68?.[_0x5edf5d(0x1c2)]?.[_0x5edf5d(0x1bd)];}static async[_0x520b86(0x1da)](){const _0x199e66=_0x520b86,_0x22ca24={'wbxFR':function(_0x2b5ed6,_0x134120){return _0x2b5ed6+_0x134120;},'cruiQ':_0x199e66(0x1d1),'THJuo':_0x199e66(0x1b4),'jJgfS':'请求获取Cookies时失败'},_0x4a007d=_0x22ca24[_0x199e66(0x1d3)](_0x22ca24[_0x199e66(0x1d3)](_0x199e66(0x1af)+selfInfo[_0x199e66(0x1db)],'&clientkey='),Credentials['ClientKey'])+_0x22ca24[_0x199e66(0x1d4)]+selfInfo[_0x199e66(0x1db)]+_0x22ca24[_0x199e66(0x1e8)];let _0x1cde33={};try{_0x1cde33=await RequestUtil['HttpsGetCookies'](_0x4a007d);}catch(_0x39ab41){logDebug(_0x22ca24[_0x199e66(0x1ec)],_0x39ab41),_0x1cde33={};}return _0x1cde33;}static async[_0x520b86(0x1ee)](_0x6771d2=!![]){const _0x9ba0d2=_0x520b86,_0xc9a955={'pRWND':function(_0x21759e,_0x9e5c24){return _0x21759e*_0x9e5c24;},'julWy':function(_0x2b1513,_0x220682){return _0x2b1513+_0x220682;},'ICoKs':function(_0x70dfe4,_0x44dcea){return _0x70dfe4+_0x44dcea;},'SycRg':_0x9ba0d2(0x1d0),'MJWHt':_0x9ba0d2(0x1ed),'zcqzh':function(_0x104449,_0x22a7e5,_0x2e3678){return _0x104449(_0x22a7e5,_0x2e3678);}};try{if(Credentials[_0x9ba0d2(0x1ac)]==0x0||Date[_0x9ba0d2(0x1c5)]()-Credentials[_0x9ba0d2(0x1ac)]>_0xc9a955['pRWND'](0x3e8,0xe10)||!_0x6771d2){const _0xd3b3a4=await napCatCore[_0x9ba0d2(0x1de)]['getTicketService']()[_0x9ba0d2(0x1ea)]('');if(_0xd3b3a4[_0x9ba0d2(0x1b0)]!==0x0)return'';const _0x25ea45=_0xd3b3a4[_0x9ba0d2(0x1b1)],_0x527924=_0xd3b3a4[_0x9ba0d2(0x1b5)],_0x532c83=_0xc9a955[_0x9ba0d2(0x1e1)](_0xc9a955[_0x9ba0d2(0x1eb)](_0x9ba0d2(0x1af),selfInfo['uin'])+_0xc9a955[_0x9ba0d2(0x1ce)],_0x25ea45)+_0xc9a955[_0x9ba0d2(0x1d5)]+_0x527924;let _0x30f314={};try{_0x30f314=await RequestUtil['HttpsGetCookies'](_0x532c83);}catch(_0xaa1fca){_0xc9a955['zcqzh'](logDebug,'请求获取Skey时失败',_0xaa1fca),_0x30f314={};}const _0x35ee37=_0x30f314[_0x9ba0d2(0x1d6)];if(!_0x35ee37)return'';return Credentials['ClientKey']=_0x25ea45,Credentials[_0x9ba0d2(0x1bc)]=_0x527924,Credentials[_0x9ba0d2(0x1ac)]=Date[_0x9ba0d2(0x1c5)](),Credentials['Skey']=_0x35ee37,_0x35ee37;}return Credentials[_0x9ba0d2(0x1a8)];}catch(_0x56a43f){}return undefined;}}function _0x2d31(){const _0x34d1d8=['onLoginSuccess','71650zhJEgW','getSelfInfo','jyYCq','response','uid','uJvEM','now','getUserDetailInfo','2479194HsrgPM','getTipOffService','getRobotUinRange','onProfileDetailInfoChanged','getUserInfo','BIUZz','domainPskeyMap','SycRg','setBuddyProfileLike','&clientkey=','&u1=https%3A%2F%2Fuser.qzone.qq.com%2F','507402lTjURP','wbxFR','cruiQ','MJWHt','skey','8ADZolx','2542272kkqfug','setSelfOnlineStatus','getQzoneCookies','uin','5Qtppex','like','session','then','set','julWy','setHeader','assign','errMsg','Ujvvl','fromEntries','PskeyData','THJuo','1334874CQqZGF','forceFetchClientKey','ICoKs','jJgfS','&u1=https%3A%2F%2Fh5.qzone.qq.com%2Fqqnt%2Fqzoneinpcqq%2Ffriend%3Frefresh%3D0%26clientuin%3D0%26darkMode%3D0&keyindex=','getSkey','getProfileService','YVnjb','delete','kGJqo','getMsgService','length','setQQAvatar','PskeyTime','Skey','addListener','BXcHa','获取Pskey失败','CreatTime','getUserDetailInfo\x20timeout','entries','https://ssl.ptlogin2.qq.com/jump?ptlang=1033&clientuin=','result','clientKey','UryEE','push','%2Finfocenter&keyindex=19%27','keyIndex','305124aIwrXf','getRobotService','172342efhOmb','TdVvg','getUserDetailInfoWithBizInfo','get','KeyIndex','robotUinRanges'];_0x2d31=function(){return _0x34d1d8;};return _0x2d31();}