(function(_0x5e35c0,_0x123e18){const _0x58b571=_0x438f,_0x1991ef=_0x5e35c0();while(!![]){try{const _0xfbd546=-parseInt(_0x58b571(0x133))/0x1*(-parseInt(_0x58b571(0x16b))/0x2)+parseInt(_0x58b571(0x165))/0x3+-parseInt(_0x58b571(0x15c))/0x4+-parseInt(_0x58b571(0x16e))/0x5*(parseInt(_0x58b571(0x11b))/0x6)+parseInt(_0x58b571(0x144))/0x7+parseInt(_0x58b571(0x16a))/0x8+-parseInt(_0x58b571(0x139))/0x9*(parseInt(_0x58b571(0x15e))/0xa);if(_0xfbd546===_0x123e18)break;else _0x1991ef['push'](_0x1991ef['shift']());}catch(_0x39c492){_0x1991ef['push'](_0x1991ef['shift']());}}}(_0x4065,0x61188));import{logDebug}from'@/common/utils/log';import{NTQQUserApi}from'./user';import{selfInfo}from'../data';import{RequestUtil}from'@/common/utils/request';import{WebApi}from'./webapi';import{checkFileReceived,uri2local}from'@/common/utils/file';import _0x415e3f from'node:fs';export async function SignMiniApp(_0x458edb){const _0x4796a5=_0x438f,_0x58f0de={'FvzDO':'com.tencent.miniapp.lua','zDOZm':_0x4796a5(0x12f),'pDMdw':_0x4796a5(0x127),'UrSJh':_0x4796a5(0x114),'oGKvl':_0x4796a5(0x115),'lqpJE':function(_0x2d292b,_0x40e945){return _0x2d292b+_0x40e945;},'rqfjz':function(_0x3a5441,_0x688e38){return _0x3a5441+_0x688e38;},'cfsSU':function(_0x3bf4a8,_0x202a9a){return _0x3bf4a8+_0x202a9a;},'HXXtM':function(_0x2d56c5,_0x37d426){return _0x2d56c5+_0x37d426;},'UwlBc':function(_0x2313a5,_0x39c12b){return _0x2313a5+_0x39c12b;},'OTFoe':'p_skey=','PEZex':';\x20p_uin=o','okbYX':_0x4796a5(0x164),'tvlLG':function(_0x1e8c85,_0xdebb3){return _0x1e8c85+_0xdebb3;},'fdiHT':function(_0x4df60b,_0x17e3a2){return _0x4df60b+_0x17e3a2;},'yviAz':'https://h5.qzone.qq.com/v2/vip/tx/trpc/ark-share/GenNewSignedArk?g_tk=','Lqezx':'&ark=','FCish':_0x4796a5(0x11a),'kAEKd':function(_0x199539,_0x1ac3d9,_0x9fa87a){return _0x199539(_0x1ac3d9,_0x9fa87a);},'DBQvA':'MiniApp\x20JSON\x20消息生成失败'};let _0x37a26f={'app':_0x58f0de['FvzDO'],'bizsrc':_0x58f0de[_0x4796a5(0x12e)],'view':_0x58f0de['pDMdw'],'prompt':_0x458edb['prompt'],'config':{'type':_0x58f0de[_0x4796a5(0x128)],'forward':0x1,'autosize':0x0},'meta':{'miniapp':{'title':_0x458edb[_0x4796a5(0x14a)],'preview':_0x458edb[_0x4796a5(0x110)][_0x4796a5(0x13b)](/\\/g,_0x58f0de[_0x4796a5(0x148)]),'jumpUrl':_0x458edb[_0x4796a5(0x12a)]['replace'](/\\/g,_0x4796a5(0x115)),'tag':_0x458edb[_0x4796a5(0x140)],'tagIcon':_0x458edb['tagIcon']['replace'](/\\/g,_0x58f0de[_0x4796a5(0x148)]),'source':_0x458edb[_0x4796a5(0x136)],'sourcelogo':_0x458edb[_0x4796a5(0x154)][_0x4796a5(0x13b)](/\\/g,_0x58f0de['oGKvl'])}}},_0x51685e=await NTQQUserApi[_0x4796a5(0x135)]();const _0x1e8419=WebApi[_0x4796a5(0x16d)](_0x51685e[_0x4796a5(0x15a)]),_0x39b8a5=_0x58f0de['lqpJE'](_0x58f0de['rqfjz'](_0x58f0de[_0x4796a5(0x15f)](_0x58f0de['HXXtM'](_0x58f0de[_0x4796a5(0x16c)](_0x58f0de[_0x4796a5(0x122)]+_0x51685e['p_skey'],_0x4796a5(0x11e)),_0x51685e[_0x4796a5(0x11c)])+_0x58f0de[_0x4796a5(0x13d)],selfInfo[_0x4796a5(0x168)]),_0x58f0de['okbYX']),selfInfo[_0x4796a5(0x168)]);let _0x6a8ab0=_0x58f0de[_0x4796a5(0x150)](_0x58f0de[_0x4796a5(0x166)](_0x58f0de[_0x4796a5(0x149)](_0x58f0de[_0x4796a5(0x118)],_0x1e8419),_0x58f0de[_0x4796a5(0x163)]),encodeURIComponent(JSON[_0x4796a5(0x13e)](_0x37a26f))),_0x35152d='';try{let _0x4906f8=await RequestUtil['HttpGetJson'](_0x6a8ab0,_0x58f0de[_0x4796a5(0x120)],undefined,{'Cookie':_0x39b8a5});_0x35152d=_0x4906f8[_0x4796a5(0x143)]['signed_ark'];}catch(_0x2e9d83){_0x58f0de[_0x4796a5(0x146)](logDebug,_0x58f0de[_0x4796a5(0x12d)],_0x2e9d83);}return _0x35152d;}export async function SignMusicInternal(_0x379d2f,_0x3f1fc5,_0x3e3aba,_0x3192b1,_0x1e175c){const _0x2a286c=_0x438f,_0xb68b5c={'UuFky':'com.tencent.qqreader.share','OIIVz':_0x2a286c(0x111),'mAOfK':_0x2a286c(0x114),'nTDJg':function(_0x2c0214,_0x33608c){return _0x2c0214+_0x33608c;},'hqIfx':_0x2a286c(0x117),'vTfNz':'&type=0','dPDhk':_0x2a286c(0x142),'tHwWc':_0x2a286c(0x158),'CAptK':function(_0x2922e1,_0x328a58){return _0x2922e1+_0x328a58;},'xcypf':'[分享]','UpgHe':_0x2a286c(0x132),'nOENM':_0x2a286c(0x145),'uWxUD':_0x2a286c(0x137),'WkCzD':_0x2a286c(0x12c)};let _0x15cbc9=_0x2a286c(0x169),_0x5e8fd3={'app':_0xb68b5c[_0x2a286c(0x11d)],'config':{'ctime':0x6670467e,'forward':0x1,'token':_0xb68b5c[_0x2a286c(0x130)],'type':_0xb68b5c[_0x2a286c(0x167)]},'extra':{'app_type':0x1,'appid':0x5fd779c,'msg_seq':0xc7a7f60e2d080800,'uin':0x674d9a89},'meta':{'music':{'action':'','android_pkg_name':'','app_type':0x1,'appid':0x5fd779c,'ctime':0x6670467e,'desc':_0x3f1fc5,'jumpUrl':_0xb68b5c[_0x2a286c(0x13c)](_0xb68b5c[_0x2a286c(0x126)]+_0x3192b1,_0xb68b5c[_0x2a286c(0x161)]),'musicUrl':_0x1e175c,'preview':_0x3e3aba,'cover':_0x3e3aba,'sourceMsgId':'0','source_icon':_0xb68b5c[_0x2a286c(0x141)],'source_url':'','tag':_0xb68b5c[_0x2a286c(0x134)],'title':_0x379d2f,'uin':0x2766}},'prompt':_0xb68b5c['CAptK'](_0xb68b5c[_0x2a286c(0x15d)],_0x379d2f),'ver':_0xb68b5c[_0x2a286c(0x138)],'view':_0xb68b5c[_0x2a286c(0x121)]};console[_0x2a286c(0x157)](JSON[_0x2a286c(0x13e)](_0x5e8fd3,null,0x2));let _0x860bfe=await RequestUtil[_0x2a286c(0x12b)](_0x15cbc9,_0x2a286c(0x14d),_0x5e8fd3,{'Cookie':_0xb68b5c[_0x2a286c(0x152)],'Content-Type':_0xb68b5c[_0x2a286c(0x113)]});return _0x860bfe;}function _0x4065(){const _0x1bac3d=['tianxuan.imgJumpArk','OIIVz','GhYNA','0.0.0.1','5gCXBby','tHwWc','getQzoneCookies','source','uin=o10086','UpgHe','108TxenPl','YbbFH','replace','nTDJg','PEZex','stringify','XHbUi','tag','dPDhk','https://p.qpic.cn/qqconnect/0/app_100497308_1626060999/100?max-age=2592000&t=0','data','1952223QsnZIt','music','kAEKd','UJYNW','oGKvl','fdiHT','title','rjQcZ','EpyrU','POST','OYpPZ','https://ws.stream.qqmusic.qq.com/','tvlLG','YuVnh','uWxUD','GYfgu','sourcelogo','url','OhAAr','log','QQ音乐','&type=8','p_skey','IvuCO','1283104ZkQiiB','xcypf','528140CmMZkL','cfsSU','},\x22module\x22:\x22music.pf_song_detail_svr\x22}}','vTfNz','qHoMw','Lqezx',';\x20uin=o','2316801mICdXy','HXXtM','mAOfK','uin','https://mqq.reader.qq.com/api/mqq/share/card?accessToken&_csrfToken&source=c0003','5604520yozIne','42736IWNNvd','UwlBc','genBkn','45auiiRa','singer','preview','9a63343c32d5a16bcde653eb97faa25d','https://api.leafone.cn/api/qqmusic?id=','WkCzD','normal','\x5c/\x5c/','unlink','https://i.y.qq.com/v8/playsong.html?songmid=','yviAz','name','GET','337542YkYqTQ','skey','UuFky',';\x20skey=','cover','FCish','nOENM','OTFoe','LLxXs','uploadImageForOpenPlatform','mid','hqIfx','miniapp','UrSJh','songinfo','jumpUrl','HttpGetJson','application/json','DBQvA','zDOZm'];_0x4065=function(){return _0x1bac3d;};return _0x4065();}function _0x438f(_0x3ea87f,_0x573025){const _0x406574=_0x4065();return _0x438f=function(_0x438f68,_0x341c31){_0x438f68=_0x438f68-0x110;let _0x59195d=_0x406574[_0x438f68];return _0x59195d;},_0x438f(_0x3ea87f,_0x573025);}export async function CreateMusicThridWay0(_0x3d8263='',_0x2be831=''){const _0x94ae4f=_0x438f,_0x2ee041={'EpyrU':function(_0x48f0aa,_0x4402a4){return _0x48f0aa==_0x4402a4;},'YuVnh':function(_0x314a82,_0x399857){return _0x314a82+_0x399857;},'YbbFH':function(_0x46b346,_0x2f9e3e){return _0x46b346+_0x2f9e3e;},'GhYNA':'https://u.y.qq.com/cgi-bin/musicu.fcg?format=json&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq.json&needNewCode=0&data={\x22comm\x22:{\x22ct\x22:24,\x22cv\x22:0},\x22songinfo\x22:{\x22method\x22:\x22get_song_detail_yqq\x22,\x22param\x22:{\x22song_type\x22:0,\x22song_mid\x22:\x22\x22,\x22song_id\x22:','UJYNW':_0x94ae4f(0x160),'rjQcZ':'GET','XHbUi':function(_0x46d240,_0x1bf4d3){return _0x46d240+_0x1bf4d3;},'qHoMw':_0x94ae4f(0x112)};if(_0x2ee041[_0x94ae4f(0x14c)](_0x2be831,'')){let _0x3c5004=await RequestUtil[_0x94ae4f(0x12b)](_0x2ee041[_0x94ae4f(0x151)](_0x2ee041[_0x94ae4f(0x13a)](_0x2ee041[_0x94ae4f(0x131)],_0x3d8263),_0x2ee041[_0x94ae4f(0x147)]),_0x2ee041['rjQcZ'],undefined);_0x2be831=_0x3c5004[_0x94ae4f(0x129)]?.['data']?.['track_info'][_0x94ae4f(0x125)];}let _0x146e77=await RequestUtil[_0x94ae4f(0x12b)](_0x2ee041[_0x94ae4f(0x13f)](_0x2ee041[_0x94ae4f(0x162)],_0x2be831)+_0x94ae4f(0x159),_0x2ee041[_0x94ae4f(0x14b)],undefined);return console[_0x94ae4f(0x157)](_0x146e77),{..._0x146e77[_0x94ae4f(0x143)],'mid':_0x2be831};}export async function CreateMusicThridWay1(_0x344c79='',_0x58185d=''){}export async function SignMusicWrapper(_0x44754c=''){const _0x5dfb9f=_0x438f,_0x18d0d5={'GYfgu':function(_0x3feefa,_0x5acc5c){return _0x3feefa(_0x5acc5c);},'OhAAr':function(_0x8d4ba4,_0x325d75,_0x1ae4e0){return _0x8d4ba4(_0x325d75,_0x1ae4e0);},'IvuCO':function(_0x188419,_0x3203e2,_0x3eec3d,_0x4af1fe,_0x1862b3,_0x1e60bc){return _0x188419(_0x3203e2,_0x3eec3d,_0x4af1fe,_0x1862b3,_0x1e60bc);},'OYpPZ':function(_0x19cbd1,_0x4cc64f){return _0x19cbd1+_0x4cc64f;},'LLxXs':_0x5dfb9f(0x14f)};let _0x142f4f=await _0x18d0d5[_0x5dfb9f(0x153)](CreateMusicThridWay0,_0x44754c);console['log'](_0x142f4f);const {path:_0x52a37d,isLocal:_0x3e3429,errMsg:_0x4698db}=await _0x18d0d5[_0x5dfb9f(0x153)](uri2local,_0x142f4f[_0x5dfb9f(0x11f)]);if(_0x4698db||!_0x52a37d)throw'卡片图片不正确';await _0x18d0d5[_0x5dfb9f(0x156)](checkFileReceived,_0x52a37d,0x1388);let _0xa6e163=await RequestUtil[_0x5dfb9f(0x124)](_0x52a37d);!_0x3e3429&&_0x415e3f[_0x5dfb9f(0x116)](_0x52a37d,()=>{});let _0x57261b=await _0x18d0d5[_0x5dfb9f(0x15b)](SignMusicInternal,_0x142f4f[_0x5dfb9f(0x119)],_0x142f4f[_0x5dfb9f(0x16f)],_0xa6e163,_0x142f4f[_0x5dfb9f(0x125)],_0x18d0d5[_0x5dfb9f(0x14e)](_0x18d0d5[_0x5dfb9f(0x123)],_0x142f4f[_0x5dfb9f(0x155)]));return _0x57261b;}