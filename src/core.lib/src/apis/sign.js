(function(_0x2adea,_0x1e8481){const _0x43d7eb=_0x11b2,_0x5ece13=_0x2adea();while(!![]){try{const _0x5bb758=parseInt(_0x43d7eb(0xfa))/0x1*(parseInt(_0x43d7eb(0xbf))/0x2)+parseInt(_0x43d7eb(0xae))/0x3*(parseInt(_0x43d7eb(0xe6))/0x4)+-parseInt(_0x43d7eb(0xdd))/0x5+-parseInt(_0x43d7eb(0xe1))/0x6+parseInt(_0x43d7eb(0xe2))/0x7+parseInt(_0x43d7eb(0xc6))/0x8+-parseInt(_0x43d7eb(0xd1))/0x9;if(_0x5bb758===_0x1e8481)break;else _0x5ece13['push'](_0x5ece13['shift']());}catch(_0x4682b7){_0x5ece13['push'](_0x5ece13['shift']());}}}(_0x4f61,0x28f10));import{logDebug}from'@/common/utils/log';import{NTQQUserApi}from'./user';import{selfInfo}from'../data';import{RequestUtil}from'@/common/utils/request';import{WebApi}from'./webapi';function _0x4f61(){const _0x7d7da3=['title','com.tencent.qqreader.share','normal','6cxVgAi','track_info','https://u.y.qq.com/cgi-bin/musicu.fcg?format=json&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq.json&needNewCode=0&data={\x22comm\x22:{\x22ct\x22:24,\x22cv\x22:0},\x22songinfo\x22:{\x22method\x22:\x22get_song_detail_yqq\x22,\x22param\x22:{\x22song_type\x22:0,\x22song_mid\x22:\x22\x22,\x22song_id\x22:','MiniApp\x20JSON\x20消息生成失败','fUSHm','卡片图片不正确','xIfUg','qTbvH','NDiKh','&type=0','QCDgK','mid','p_skey','uin','POST','https://p.qpic.cn/qqconnect/0/app_100497308_1626060999/100?max-age=2592000&t=0','p_skey=','2RrDizD','stringify','preview','&type=8','NCwvY','HttpGetJson','JDlUB','1818736kvyBqU','cover','TGphe','pnwiC','jumpUrl','},\x22module\x22:\x22music.pf_song_detail_svr\x22}}','oPBnd','singer','com.tencent.miniapp.lua','WODii','unlink','2885742aZVsTc','ZobIq','name','PqPjI','KZLbj',';\x20skey=','ursTv','ZQpCT','HhLei','yTSwL','application/json','0.0.0.1','232475UBsnhh','tagIcon','inFOF','tag','702324xQyngo','1736336fLyGBZ',';\x20uin=o','\x5c/\x5c/','ndyKE','101132MbnpGd','https://mqq.reader.qq.com/api/mqq/share/card?accessToken&_csrfToken&source=c0003','wayMB','sourcelogo','music','pcZzJ','liyFa','9a63343c32d5a16bcde653eb97faa25d','RDBWK','LTopH','ADgcX','https://h5.qzone.qq.com/v2/vip/tx/trpc/ark-share/GenNewSignedArk?g_tk=','prompt','tianxuan.imgJumpArk','KmUqj','uin=o10086','GET','YuxkP','dvKNK','InyhY','125927HfJtLV','replace','IwSQW','NxhKg'];_0x4f61=function(){return _0x7d7da3;};return _0x4f61();}import{checkFileReceived2,uri2local}from'@/common/utils/file';import _0x463dcc from'node:fs';export async function SignMiniApp(_0x905b49){const _0x4c9cc2=_0x11b2,_0x36b0e4={'pcZzJ':_0x4c9cc2(0xce),'KBSZS':_0x4c9cc2(0xf3),'NxhKg':'miniapp','xIfUg':_0x4c9cc2(0xe4),'IwSQW':function(_0x10cb16,_0x20cbfb){return _0x10cb16+_0x20cbfb;},'vFcua':function(_0x33a21f,_0x47e6bc){return _0x33a21f+_0x47e6bc;},'QCDgK':_0x4c9cc2(0xd6),'CxLuh':';\x20p_uin=o','yTSwL':_0x4c9cc2(0xe3),'KZLbj':function(_0x58472a,_0x9ea659){return _0x58472a+_0x9ea659;},'NCwvY':_0x4c9cc2(0xf1),'XOXlf':function(_0x10d4db,_0x1b5076){return _0x10d4db(_0x1b5076);},'HJgYK':'GET','LTopH':_0x4c9cc2(0xb1)};let _0xbe7d9d={'app':_0x36b0e4[_0x4c9cc2(0xeb)],'bizsrc':_0x36b0e4['KBSZS'],'view':_0x36b0e4[_0x4c9cc2(0xaa)],'prompt':_0x905b49[_0x4c9cc2(0xf2)],'config':{'type':'normal','forward':0x1,'autosize':0x0},'meta':{'miniapp':{'title':_0x905b49[_0x4c9cc2(0xab)],'preview':_0x905b49[_0x4c9cc2(0xc1)][_0x4c9cc2(0xfb)](/\\/g,_0x36b0e4[_0x4c9cc2(0xb4)]),'jumpUrl':_0x905b49[_0x4c9cc2(0xca)][_0x4c9cc2(0xfb)](/\\/g,_0x36b0e4['xIfUg']),'tag':_0x905b49[_0x4c9cc2(0xe0)],'tagIcon':_0x905b49[_0x4c9cc2(0xde)]['replace'](/\\/g,_0x36b0e4[_0x4c9cc2(0xb4)]),'source':_0x905b49['source'],'sourcelogo':_0x905b49[_0x4c9cc2(0xe9)][_0x4c9cc2(0xfb)](/\\/g,_0x36b0e4[_0x4c9cc2(0xb4)])}}},_0x4a9f82=await NTQQUserApi['getQzoneCookies']();const _0x2dba41=WebApi['genBkn'](_0x4a9f82['p_skey']),_0x49f886=_0x36b0e4[_0x4c9cc2(0xfc)](_0x36b0e4[_0x4c9cc2(0xfc)](_0x36b0e4['vFcua'](_0x4c9cc2(0xbe)+_0x4a9f82[_0x4c9cc2(0xba)]+_0x36b0e4[_0x4c9cc2(0xb8)],_0x4a9f82['skey']),_0x36b0e4['CxLuh'])+selfInfo[_0x4c9cc2(0xbb)]+_0x36b0e4[_0x4c9cc2(0xda)],selfInfo[_0x4c9cc2(0xbb)]);let _0x31b2fb=_0x36b0e4['KZLbj'](_0x36b0e4[_0x4c9cc2(0xd5)](_0x36b0e4[_0x4c9cc2(0xc3)],_0x2dba41)+'&ark=',_0x36b0e4['XOXlf'](encodeURIComponent,JSON[_0x4c9cc2(0xc0)](_0xbe7d9d))),_0x596fa8='';try{let _0x8daed3=await RequestUtil[_0x4c9cc2(0xc4)](_0x31b2fb,_0x36b0e4['HJgYK'],undefined,{'Cookie':_0x49f886});_0x596fa8=_0x8daed3['data']['signed_ark'];}catch(_0x540be8){logDebug(_0x36b0e4[_0x4c9cc2(0xef)],_0x540be8);}return _0x596fa8;}function _0x11b2(_0x2ca7c1,_0x411209){const _0x4f61f6=_0x4f61();return _0x11b2=function(_0x11b261,_0x12bdb9){_0x11b261=_0x11b261-0xaa;let _0x134664=_0x4f61f6[_0x11b261];return _0x134664;},_0x11b2(_0x2ca7c1,_0x411209);}export async function SignMusicInternal(_0x9a5a42,_0x45b2cb,_0x27c562,_0x569ab7,_0x2c735d){const _0xfb0e6=_0x11b2,_0x411dfe={'RDBWK':_0xfb0e6(0xac),'WODii':_0xfb0e6(0xed),'ZQpCT':_0xfb0e6(0xad),'ursTv':function(_0x138570,_0x5347ec){return _0x138570+_0x5347ec;},'NDiKh':'https://i.y.qq.com/v8/playsong.html?songmid=','HhLei':_0xfb0e6(0xb7),'ADgcX':_0xfb0e6(0xbd),'InyhY':'QQ音乐','dvKNK':'[分享]','TGphe':_0xfb0e6(0xdc),'ZobIq':_0xfb0e6(0xbc),'fUSHm':_0xfb0e6(0xf5),'tfQxE':_0xfb0e6(0xdb)};let _0x577123=_0xfb0e6(0xe7),_0x1ee3e7={'app':_0x411dfe[_0xfb0e6(0xee)],'config':{'ctime':0x6670467e,'forward':0x1,'token':_0x411dfe[_0xfb0e6(0xcf)],'type':_0x411dfe[_0xfb0e6(0xd8)]},'extra':{'app_type':0x1,'appid':0x5fd779c,'msg_seq':0xc7a7f60e2d080800,'uin':0x674d9a89},'meta':{'music':{'action':'','android_pkg_name':'','app_type':0x1,'appid':0x5fd779c,'ctime':0x6670467e,'desc':_0x45b2cb,'jumpUrl':_0x411dfe[_0xfb0e6(0xd7)](_0x411dfe[_0xfb0e6(0xb6)]+_0x569ab7,_0x411dfe[_0xfb0e6(0xd9)]),'musicUrl':_0x2c735d,'preview':_0x27c562,'cover':_0x27c562,'sourceMsgId':'0','source_icon':_0x411dfe[_0xfb0e6(0xf0)],'source_url':'','tag':_0x411dfe[_0xfb0e6(0xf9)],'title':_0x9a5a42,'uin':0x2766}},'prompt':_0x411dfe[_0xfb0e6(0xf8)]+_0x9a5a42,'ver':_0x411dfe[_0xfb0e6(0xc8)],'view':_0xfb0e6(0xea)},_0xc00afb=await RequestUtil['HttpGetJson'](_0x577123,_0x411dfe[_0xfb0e6(0xd2)],_0x1ee3e7,{'Cookie':_0x411dfe[_0xfb0e6(0xb2)],'Content-Type':_0x411dfe['tfQxE']});return _0xc00afb;}export async function CreateMusicThridWay0(_0x279485='',_0x5ce8dc=''){const _0x4ac138=_0x11b2,_0xe5abd2={'YuxkP':function(_0x2776a5,_0x154acb){return _0x2776a5+_0x154acb;},'inFOF':_0x4ac138(0xcb),'PqPjI':function(_0x288edc,_0x4ee0b7){return _0x288edc+_0x4ee0b7;},'ndyKE':function(_0x42f49f,_0x4ff9b6){return _0x42f49f+_0x4ff9b6;},'wayMB':'https://api.leafone.cn/api/qqmusic?id=','DvsKf':_0x4ac138(0xc2),'pnwiC':_0x4ac138(0xf6)};if(_0x5ce8dc==''){let _0x4a8938=await RequestUtil[_0x4ac138(0xc4)](_0xe5abd2[_0x4ac138(0xf7)](_0x4ac138(0xb0),_0x279485)+_0xe5abd2[_0x4ac138(0xdf)],_0x4ac138(0xf6),undefined);_0x5ce8dc=_0x4a8938['songinfo']?.['data']?.[_0x4ac138(0xaf)][_0x4ac138(0xb9)];}let _0x54a6b8=await RequestUtil[_0x4ac138(0xc4)](_0xe5abd2[_0x4ac138(0xd4)](_0xe5abd2[_0x4ac138(0xe5)](_0xe5abd2[_0x4ac138(0xe8)],_0x5ce8dc),_0xe5abd2['DvsKf']),_0xe5abd2[_0x4ac138(0xc9)],undefined);return{..._0x54a6b8['data'],'mid':_0x5ce8dc};}export async function CreateMusicThridWay1(_0x590c85='',_0x2c8c33=''){}export async function SignMusicWrapper(_0x240789=''){const _0x20596e=_0x11b2,_0x26cf06={'liyFa':function(_0x128746,_0x4e778d){return _0x128746(_0x4e778d);},'oPBnd':function(_0x4a71ba,_0x2e910f){return _0x4a71ba(_0x2e910f);},'JDlUB':function(_0x5d5a0c,_0xe825c4){return _0x5d5a0c||_0xe825c4;},'qTbvH':function(_0x5d86a3,_0x31f44c,_0x550370){return _0x5d86a3(_0x31f44c,_0x550370);},'pIsKP':function(_0x3c4f52,_0x3e911c){return _0x3c4f52+_0x3e911c;},'KmUqj':'https://ws.stream.qqmusic.qq.com/'};let _0x1242f6=await _0x26cf06[_0x20596e(0xec)](CreateMusicThridWay0,_0x240789);const {path:_0x52c9e6,isLocal:_0x35415e,errMsg:_0x1268e8}=await _0x26cf06[_0x20596e(0xcc)](uri2local,_0x1242f6[_0x20596e(0xc7)]);if(_0x26cf06[_0x20596e(0xc5)](_0x1268e8,!_0x52c9e6))throw _0x20596e(0xb3);await _0x26cf06[_0x20596e(0xb5)](checkFileReceived2,_0x52c9e6,0x1388);let _0x528b2b=await RequestUtil['uploadImageForOpenPlatform'](_0x52c9e6);!_0x35415e&&_0x463dcc[_0x20596e(0xd0)](_0x52c9e6,()=>{});let _0x2efd6a=await SignMusicInternal(_0x1242f6[_0x20596e(0xd3)],_0x1242f6[_0x20596e(0xcd)],_0x528b2b,_0x1242f6[_0x20596e(0xb9)],_0x26cf06['pIsKP'](_0x26cf06[_0x20596e(0xf4)],_0x1242f6['url']));return _0x2efd6a;}