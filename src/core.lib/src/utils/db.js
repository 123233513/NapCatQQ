const _0x28bd2f=_0x1eec;(function(_0x16c803,_0x37b0d0){const _0xb5ee82=_0x1eec,_0x5cb0b7=_0x16c803();while(!![]){try{const _0x12f12d=parseInt(_0xb5ee82(0xa2))/0x1+parseInt(_0xb5ee82(0xb6))/0x2*(parseInt(_0xb5ee82(0xef))/0x3)+-parseInt(_0xb5ee82(0x116))/0x4*(parseInt(_0xb5ee82(0x11e))/0x5)+parseInt(_0xb5ee82(0x12c))/0x6+parseInt(_0xb5ee82(0x12d))/0x7+parseInt(_0xb5ee82(0x122))/0x8*(-parseInt(_0xb5ee82(0xe8))/0x9)+parseInt(_0xb5ee82(0xa9))/0xa*(-parseInt(_0xb5ee82(0xa3))/0xb);if(_0x12f12d===_0x37b0d0)break;else _0x5cb0b7['push'](_0x5cb0b7['shift']());}catch(_0x331d1a){_0x5cb0b7['push'](_0x5cb0b7['shift']());}}}(_0xcd02,0x22733));function _0xcd02(){const _0x1fb751=['updateMsg\x20db\x20error','TuHtP','157035zxyHip','init','getMsgsByMsgId','chatType','2225128DmBTOa','getFileCacheByUuid','getFileCacheByName','get','msgTime','GAaXD','AHHYm','TgXMw','db\x20could\x20not\x20get\x20temp\x20uin\x20map','iKLtb','1640826ENdzgV','1176805oCSAxK','更新消息,\x20shortId:','addTempUin','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','清理消息缓存','getMsgBySeq','PSbuk','KyIss','sEILe','138384IBfZxZ','22xNGIth','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','xAVZD','now','384910pmDegN','uuid','YUdSD','XvxkT','GAXmy','eTPMC','kqAkG','KPwQo','db\x20could\x20not\x20update\x20file\x20cache','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','Lnpod','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','2eAtito','msgSeq','JNuMk','WJcEM','globalMsgShortId','all','MBsKB','FuQsF','MLbBB','CsPLk','size','Could\x20not\x20create\x20table\x20files','element','KdjXj','longId','getUidByTempUin','Method\x20not\x20implemented.','XwyoX','Could\x20not\x20create\x20table\x20msgs','zGTcg','eqWGG','onowA','nlLyG','db\x20could\x20not\x20add\x20file','GMXsX','yYQrE','toString','forEach','getMsgByLongId','pQtfI','parse','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','stringify','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','getFileCache','createTable','yOPei','set','nMaki','uaFEb','eopQn','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','scySS','XzRsY','peerUid','msgList','QVDoe','RjyqH','elementType','9vOGaax','maxId','ZWuBH','db\x20could\x20not\x20add\x20msg','getCurrentMaxShortId','getReceivedTempUinMap','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','31443wDkphM','updateFileCache','PVbbZ','ayfWn','db\x20getMsgByLongId\x20error','then','Could\x20not\x20connect\x20to\x20database','addMsg','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','url','FRjBV','eMHED',',\x20seq:\x20','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','eXLoo','close','ErRTT','Could\x20not\x20create\x20table\x20temp_uins','cntqQ','catch','VQmwc','updateMsg','db\x20could\x20not\x20add\x20temp\x20uin','msgId','getMsg','EAjSl','path','errno','nWVzY','uid','name',',\x20短id:\x20','JoYyr','OPEN_CREATE','Database','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?',',\x20msgId:\x20','aDDSr','phidS','12qfFAei','run','msgCache','EDCJR','prepare','Could\x20not\x20get\x20msg'];_0xcd02=function(){return _0x1fb751;};return _0xcd02();}import _0x41597f from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x28bd2f(0x11f)](_0x5c6360){const _0x4cb068={'XvxkT':function(_0x36e9bb,_0x558a5f,_0x338b96){return _0x36e9bb(_0x558a5f,_0x338b96);},'WouNp':function(_0xef1171,_0xeb4b14){return _0xef1171(_0xeb4b14);},'ximUJ':function(_0x2dab1e,_0x69c26d){return _0x2dab1e|_0x69c26d;}};if(this['db'])return;return new Promise((_0x4050ea,_0x5a8bac)=>{const _0x28dd75=_0x1eec;this['db']=new _0x41597f[(_0x28dd75(0x111))](_0x5c6360,_0x4cb068['ximUJ'](_0x41597f['OPEN_READWRITE'],_0x41597f[_0x28dd75(0x110)]),_0x1f64d9=>{const _0x4c9c0b=_0x28dd75;if(_0x1f64d9){_0x4cb068[_0x4c9c0b(0xac)](logError,_0x4c9c0b(0xf5),_0x1f64d9),_0x4cb068['WouNp'](_0x5a8bac,_0x1f64d9);return;}this['createTable'](),_0x4050ea();});});}[_0x28bd2f(0xda)](){const _0x39899d=_0x28bd2f,_0xd300ca={'JoYyr':_0x39899d(0xc6)};throw new Error(_0xd300ca[_0x39899d(0x10f)]);}['close'](){const _0x1df371=_0x28bd2f;this['db']?.[_0x1df371(0xfe)]();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();[_0x28bd2f(0xba)]=-0x7ffffff8;constructor(){const _0x14eb32=_0x28bd2f,_0x4e51f9={'sEILe':function(_0x2398e3,_0x3ed547){return _0x2398e3>_0x3ed547;},'eTPMC':function(_0x4ea408,_0x4dd340){return _0x4ea408(_0x4dd340);},'ZXMrl':function(_0x355727,_0x2ec51b){return _0x355727(_0x2ec51b);},'GMXsX':function(_0x28295d,_0x48f4b9){return _0x28295d*_0x48f4b9;},'PVbbZ':function(_0x3cf439,_0x2f8ef9,_0x1140d8){return _0x3cf439(_0x2f8ef9,_0x1140d8);}};super();const _0x41fe16=_0x4e51f9[_0x14eb32(0xce)](0x3e8*0x3c,0xa);_0x4e51f9[_0x14eb32(0xf1)](setInterval,()=>{const _0x2360f6=_0x14eb32;_0x4e51f9['ZXMrl'](logDebug,_0x2360f6(0x131)),this[_0x2360f6(0x118)][_0x2360f6(0xd1)]((_0x35daaa,_0x1e8443)=>{const _0x1d23b0=_0x2360f6;_0x4e51f9[_0x1d23b0(0xa1)](Date[_0x1d23b0(0xa8)]()-_0x4e51f9[_0x1d23b0(0xae)](parseInt,_0x35daaa[_0x1d23b0(0x126)])*0x3e8,_0x41fe16)&&this[_0x1d23b0(0x118)]['delete'](_0x1e8443);});},_0x41fe16);}async['init'](_0x28e8c8){const _0x53e50e=_0x28bd2f;await super[_0x53e50e(0x11f)](_0x28e8c8),this[_0x53e50e(0xba)]=await this[_0x53e50e(0xec)]();}[_0x28bd2f(0xda)](){const _0x51bd25=_0x28bd2f,_0xb33ee9={'uLXzb':function(_0x18caea,_0x3268fe,_0x324410){return _0x18caea(_0x3268fe,_0x324410);},'FYUoW':_0x51bd25(0xc8),'nMaki':function(_0x47aa6e,_0x25cb2f,_0x5e79d4){return _0x47aa6e(_0x25cb2f,_0x5e79d4);},'cntqQ':_0x51bd25(0xc1),'XcpVQ':_0x51bd25(0x100)},_0x45ec2c=_0x51bd25(0xd5);this['db'][_0x51bd25(0x117)](_0x45ec2c,function(_0x59b83f){_0x59b83f&&_0xb33ee9['uLXzb'](logError,_0xb33ee9['FYUoW'],_0x59b83f['stack']);});const _0x4b303f=_0x51bd25(0xb5);this['db']['run'](_0x4b303f,function(_0x45a4f8){const _0x12d3f2=_0x51bd25;_0x45a4f8&&_0xb33ee9[_0x12d3f2(0xdd)](logError,_0xb33ee9[_0x12d3f2(0x101)],_0x45a4f8);});const _0x2c841f=_0x51bd25(0xd8);this['db'][_0x51bd25(0x117)](_0x2c841f,function(_0x19a9b1){_0x19a9b1&&logError(_0xb33ee9['XcpVQ'],_0x19a9b1);});}async['getCurrentMaxShortId'](){const _0x315f74={'CsPLk':function(_0x165af2,_0x4e08c1,_0x4ae183){return _0x165af2(_0x4e08c1,_0x4ae183);},'MLbBB':function(_0x21f4c8,_0x6be945){return _0x21f4c8(_0x6be945);},'scySS':function(_0xb4802,_0xcf215,_0x2a4c72){return _0xb4802(_0xcf215,_0x2a4c72);},'VQmwc':'数据库中消息最大短id','FSnmy':'SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs'};return new Promise((_0x5bfd23,_0x505b83)=>{const _0x114566=_0x1eec,_0xd11029={'nlLyG':function(_0x26fd22,_0xbce66c,_0x4099da){const _0x178855=_0x1eec;return _0x315f74[_0x178855(0xbf)](_0x26fd22,_0xbce66c,_0x4099da);},'ThGYK':_0x114566(0xee),'eqWGG':function(_0x425f05,_0x4e4da7){const _0x25618a=_0x114566;return _0x315f74[_0x25618a(0xbe)](_0x425f05,_0x4e4da7);},'YUdSD':function(_0x24f0b0,_0x13e2d6,_0x4e20bb){const _0x40c8a4=_0x114566;return _0x315f74[_0x40c8a4(0xe1)](_0x24f0b0,_0x13e2d6,_0x4e20bb);},'aDDSr':_0x315f74[_0x114566(0x103)]};this['db'][_0x114566(0x125)](_0x315f74['FSnmy'],(_0x5cfcab,_0x3c8725)=>{const _0x4d4025=_0x114566;if(_0x5cfcab)return _0xd11029[_0x4d4025(0xcc)](logDebug,_0xd11029['ThGYK'],_0x5cfcab),_0xd11029[_0x4d4025(0xca)](_0x5bfd23,-0x7ffffff8);_0xd11029[_0x4d4025(0xab)](logDebug,_0xd11029[_0x4d4025(0x114)],_0x3c8725?.[_0x4d4025(0xe9)]),_0xd11029['eqWGG'](_0x5bfd23,_0x3c8725?.[_0x4d4025(0xe9)]??-0x7ffffff8);});});}async[_0x28bd2f(0x107)](_0x1e0b7b,_0x1f8d0c){const _0x1d0ee7=_0x28bd2f,_0x2f9144={'eopQn':function(_0x244fcf,_0x4e3e59){return _0x244fcf(_0x4e3e59);},'JNuMk':_0x1d0ee7(0x11b),'ErRTT':function(_0x4e67d2,_0x572bf3){return _0x4e67d2(_0x572bf3);}},_0x49f481=this['db'][_0x1d0ee7(0x11a)](_0x1e0b7b);return new Promise((_0x2f5019,_0x416442)=>{const _0x55cfbb=_0x1d0ee7,_0x46ad38={'MBsKB':function(_0x601eeb,_0x307953){const _0x172701=_0x1eec;return _0x2f9144[_0x172701(0xdf)](_0x601eeb,_0x307953);},'WJcEM':function(_0x56f1d9,_0x43d060,_0x5b47a7,_0xae358e,_0x1705ca){return _0x56f1d9(_0x43d060,_0x5b47a7,_0xae358e,_0x1705ca);},'KyIss':_0x2f9144[_0x55cfbb(0xb8)],'Lnpod':function(_0x5bdee6,_0x5b7de5){const _0x5b6065=_0x55cfbb;return _0x2f9144[_0x5b6065(0xff)](_0x5bdee6,_0x5b7de5);}};_0x49f481[_0x55cfbb(0x125)](..._0x1f8d0c,(_0x5d83e5,_0x597bc4)=>{const _0x1f583f=_0x55cfbb,_0x2674f0={'nWVzY':function(_0x4925ad,_0x63f542){const _0x4aa922=_0x1eec;return _0x46ad38[_0x4aa922(0xbc)](_0x4925ad,_0x63f542);}};if(_0x5d83e5)return _0x46ad38[_0x1f583f(0xb9)](logError,_0x46ad38[_0x1f583f(0x134)],_0x5d83e5,_0x1e0b7b,_0x1f8d0c),_0x46ad38[_0x1f583f(0xbc)](_0x2f5019,null);if(!_0x597bc4){_0x46ad38[_0x1f583f(0xb3)](_0x2f5019,null);return;}const _0x45d44a=_0x597bc4[_0x1f583f(0xc4)];NTQQMsgApi[_0x1f583f(0x120)]({'peerUid':_0x597bc4[_0x1f583f(0xe3)],'chatType':_0x597bc4['chatType']},[_0x45d44a])[_0x1f583f(0xf4)](_0x4af1ef=>{const _0x50bf1b=_0x1f583f,_0x2335ff=_0x4af1ef[_0x50bf1b(0xe4)][0x0];if(!_0x2335ff){_0x2674f0[_0x50bf1b(0x10b)](_0x2f5019,null);return;}_0x2335ff['id']=_0x597bc4['shortId'],_0x2674f0[_0x50bf1b(0x10b)](_0x2f5019,_0x2335ff);})[_0x1f583f(0x102)](_0x3769a4=>{const _0x13e3a0=_0x1f583f;_0x46ad38[_0x13e3a0(0xbc)](_0x2f5019,null);});});});}async['getMsgByShortId'](_0x306641){const _0x11ce91=_0x28bd2f,_0x4af219={'FRjBV':_0x11ce91(0x130)};if(this[_0x11ce91(0x118)]['has'](_0x306641))return this[_0x11ce91(0x118)]['get'](_0x306641);const _0x295d9a=_0x4af219[_0x11ce91(0xf9)];return this['getMsg'](_0x295d9a,[_0x306641]);}async[_0x28bd2f(0xd2)](_0x406655){const _0x4b9463=_0x28bd2f,_0x107992={'RjyqH':_0x4b9463(0xd6)};if(this['msgCache']['has'](_0x406655))return this['msgCache'][_0x4b9463(0x125)](_0x406655);return this[_0x4b9463(0x107)](_0x107992[_0x4b9463(0xe6)],[_0x406655]);}async[_0x28bd2f(0x132)](_0x328ad5,_0x5bf732){const _0x1d8c67=_0x28bd2f,_0x2021b1=_0x1d8c67(0xe0);return this['getMsg'](_0x2021b1,[_0x328ad5,_0x5bf732]);}async[_0x28bd2f(0xf6)](_0x5aa7a8,_0x578e05=!![]){const _0x4eabd8=_0x28bd2f,_0x2a3365={'TgXMw':function(_0x195fc7,_0x10f01d){return _0x195fc7===_0x10f01d;},'TuHtP':function(_0x5301d3,_0x549db5,_0xec281){return _0x5301d3(_0x549db5,_0xec281);},'yOPei':_0x4eabd8(0xeb),'kqAkG':function(_0x99c73c,_0x2d0c52){return _0x99c73c(_0x2d0c52);}},_0x3500bf=await this[_0x4eabd8(0xd2)](_0x5aa7a8['msgId']);if(_0x3500bf){if(_0x578e05)this['updateMsg'](_0x5aa7a8)['then']();return _0x3500bf['id'];}const _0x73d4e0=this['db'][_0x4eabd8(0x11a)]('INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)'),_0x3ce2c8=++this['globalMsgShortId'];return _0x5aa7a8['id']=_0x3ce2c8,_0x2a3365[_0x4eabd8(0xaf)](logDebug,'记录消息到数据库,\x20消息长id:\x20'+_0x5aa7a8[_0x4eabd8(0x106)]+_0x4eabd8(0x10e)+_0x5aa7a8['id']),this[_0x4eabd8(0x118)]['set'](_0x3ce2c8,_0x5aa7a8),this[_0x4eabd8(0x118)][_0x4eabd8(0xdc)](_0x5aa7a8[_0x4eabd8(0x106)],_0x5aa7a8),_0x73d4e0[_0x4eabd8(0x117)](this[_0x4eabd8(0xba)],_0x5aa7a8[_0x4eabd8(0x106)],_0x5aa7a8[_0x4eabd8(0xb7)][_0x4eabd8(0xd0)](),_0x5aa7a8[_0x4eabd8(0xe3)],_0x5aa7a8[_0x4eabd8(0x121)],_0x4c523c=>{const _0xc9602c=_0x4eabd8,_0x4769d1={'XwyoX':function(_0x42102b,_0x50fbc3,_0x55fcf0){return _0x42102b(_0x50fbc3,_0x55fcf0);}};_0x4c523c&&(_0x2a3365[_0xc9602c(0x129)](_0x4c523c[_0xc9602c(0x10a)],0x13)?this[_0xc9602c(0xd2)](_0x5aa7a8['msgId'])[_0xc9602c(0xf4)](_0x36f3ee=>{const _0x1dd289=_0xc9602c;_0x36f3ee?(this[_0x1dd289(0x118)][_0x1dd289(0xdc)](_0x3ce2c8,_0x36f3ee),this[_0x1dd289(0x118)][_0x1dd289(0xdc)](_0x36f3ee['msgId'],_0x36f3ee)):_0x4769d1[_0x1dd289(0xc7)](logError,_0x1dd289(0xfc),_0x4c523c);})[_0xc9602c(0x102)](_0x2f947d=>logError(_0xc9602c(0xf3),_0x2f947d)):_0x2a3365[_0xc9602c(0x11d)](logError,_0x2a3365[_0xc9602c(0xdb)],_0x4c523c));}),_0x3ce2c8;}async[_0x28bd2f(0x104)](_0x137cc6){const _0x247584=_0x28bd2f,_0x40653a={'AHHYm':_0x247584(0x11c),'uaFEb':_0x247584(0xa5)},_0x1fefbd=this['msgCache'][_0x247584(0x125)](_0x137cc6[_0x247584(0x106)]);_0x1fefbd&&Object['assign'](_0x1fefbd,_0x137cc6);logDebug(_0x247584(0x12e)+_0x137cc6['id']+_0x247584(0xfb)+_0x137cc6[_0x247584(0xb7)]+_0x247584(0x113)+_0x137cc6[_0x247584(0x106)]);const _0x1abf12=this['db'][_0x247584(0x11a)](_0x40653a[_0x247584(0xde)]);_0x1abf12[_0x247584(0x117)](_0x137cc6[_0x247584(0xb7)],_0x137cc6['msgId'],_0x17637a=>{const _0x55f0ca=_0x247584;_0x17637a&&logError(_0x40653a[_0x55f0ca(0x128)],_0x17637a);});}async['addFileCache'](_0x1eda82){const _0x46c8c6=_0x28bd2f,_0x3955e1={'eXLoo':function(_0x1bea1f,_0x45e3f0,_0x3a8444){return _0x1bea1f(_0x45e3f0,_0x3a8444);},'yYQrE':function(_0x119886,_0x264084){return _0x119886(_0x264084);},'zGTcg':_0x46c8c6(0xa4)},_0x581212=this['db'][_0x46c8c6(0x11a)](_0x3955e1[_0x46c8c6(0xc9)]);return new Promise((_0x514146,_0xcb7068)=>{const _0x9c816a=_0x46c8c6,_0x275f61={'GAXmy':function(_0x4ab9a7,_0x5e8e9f,_0x8351e){const _0x18074d=_0x1eec;return _0x3955e1[_0x18074d(0xfd)](_0x4ab9a7,_0x5e8e9f,_0x8351e);},'pQtfI':function(_0x230717,_0x5f2e7a){const _0x1ca48e=_0x1eec;return _0x3955e1[_0x1ca48e(0xcf)](_0x230717,_0x5f2e7a);},'ayfWn':function(_0xea1b3a,_0x2ef3ce){const _0x1871b3=_0x1eec;return _0x3955e1[_0x1871b3(0xcf)](_0xea1b3a,_0x2ef3ce);}};_0x581212[_0x9c816a(0x117)](_0x1eda82[_0x9c816a(0x10d)],_0x1eda82[_0x9c816a(0x109)],_0x1eda82[_0x9c816a(0xf8)],_0x1eda82[_0x9c816a(0xc0)],_0x1eda82[_0x9c816a(0xaa)],_0x1eda82[_0x9c816a(0xe7)],JSON[_0x9c816a(0xd7)](_0x1eda82['element']),_0x1eda82['elementId'],_0x1eda82[_0x9c816a(0x106)],function(_0x561fde){const _0x1530d8=_0x9c816a;_0x561fde&&(_0x275f61[_0x1530d8(0xad)](logError,_0x1530d8(0xcd),_0x561fde),_0x275f61[_0x1530d8(0xd3)](_0xcb7068,_0x561fde)),_0x275f61[_0x1530d8(0xf2)](_0x514146,null);});});}async['getFileCache'](_0x5752bd,_0x2d633d){const _0x53fd65=_0x28bd2f,_0x355984={'XzRsY':function(_0x3d20ef,_0x5848fe,_0x5d84fa){return _0x3d20ef(_0x5848fe,_0x5d84fa);}},_0x4f92c0=this['db'][_0x53fd65(0x11a)](_0x5752bd);return new Promise((_0x5b8ef4,_0x165a81)=>{const _0x1b226e={'pGvWV':function(_0x248845,_0x133b13,_0x320784){const _0x35ce74=_0x1eec;return _0x355984[_0x35ce74(0xe2)](_0x248845,_0x133b13,_0x320784);},'ZWuBH':'db\x20could\x20not\x20get\x20file\x20cache','KPwQo':function(_0x425b2c,_0x207907){return _0x425b2c(_0x207907);}};_0x4f92c0['get'](..._0x2d633d,(_0x162d3e,_0xb5c3dd)=>{const _0x307160=_0x1eec;_0x162d3e&&(_0x1b226e['pGvWV'](logError,_0x1b226e[_0x307160(0xea)],_0x162d3e),_0x1b226e[_0x307160(0xb0)](_0x165a81,_0x162d3e)),_0xb5c3dd&&(_0xb5c3dd[_0x307160(0xc2)]=JSON[_0x307160(0xd4)](_0xb5c3dd['element'])),_0x5b8ef4(_0xb5c3dd);});});}async[_0x28bd2f(0x124)](_0x5856ec){const _0x503271=_0x28bd2f;return this[_0x503271(0xd9)](_0x503271(0xb2),[_0x5856ec]);}async[_0x28bd2f(0x123)](_0x3ac8ad){const _0x1fb28f=_0x28bd2f;return this['getFileCache'](_0x1fb28f(0x112),[_0x3ac8ad]);}async[_0x28bd2f(0xf0)](_0x426485){const _0x4e4f65=_0x28bd2f,_0x2c946d={'onowA':_0x4e4f65(0xb1),'gHkfv':function(_0x15586a,_0x12cb0d){return _0x15586a(_0x12cb0d);},'eMHED':function(_0x1d67ff,_0x530524){return _0x1d67ff(_0x530524);},'phidS':_0x4e4f65(0xa6)},_0x2599cd=this['db']['prepare'](_0x2c946d[_0x4e4f65(0x115)]);return new Promise((_0x589625,_0x5ac910)=>{const _0x3f1a6f=_0x4e4f65;_0x2599cd['run'](_0x426485[_0x3f1a6f(0x109)],_0x426485['url'],_0x426485[_0x3f1a6f(0xaa)],function(_0x42c37c){const _0x3a98cd=_0x3f1a6f;_0x42c37c&&(logError(_0x2c946d[_0x3a98cd(0xcb)],_0x42c37c),_0x2c946d['gHkfv'](_0x5ac910,_0x42c37c)),_0x2c946d[_0x3a98cd(0xfa)](_0x589625,null);});});}async[_0x28bd2f(0xed)](){const _0x206a3b={'KdjXj':function(_0x4aff71,_0x8c6e9e,_0x15691c){return _0x4aff71(_0x8c6e9e,_0x15691c);},'EAjSl':function(_0x43d141,_0x1f3acc){return _0x43d141(_0x1f3acc);},'pUckY':function(_0x4db2e5,_0xff6401){return _0x4db2e5(_0xff6401);},'EbikO':'SELECT\x20*\x20FROM\x20temp_uins'},_0x4a543e=_0x206a3b['EbikO'];return new Promise((_0x4f41db,_0x4e454b)=>{const _0x2abe5c=_0x1eec;this['db'][_0x2abe5c(0xbb)](_0x4a543e,(_0x3afa08,_0x5186b7)=>{const _0x5009af=_0x2abe5c;_0x3afa08&&(_0x206a3b[_0x5009af(0xc3)](logError,_0x5009af(0x12a),_0x3afa08),_0x206a3b[_0x5009af(0x108)](_0x4e454b,_0x3afa08));const _0x1803db={};_0x5186b7[_0x5009af(0xd1)](_0x50988a=>{_0x1803db[_0x50988a['uin']]=_0x50988a['uid'];}),_0x206a3b['pUckY'](_0x4f41db,_0x1803db);});});}async[_0x28bd2f(0xc5)](_0x3e9871){const _0x311d2a=_0x28bd2f,_0x43d95b={'PSbuk':function(_0xc53816,_0x4bf11a,_0x3bd78d){return _0xc53816(_0x4bf11a,_0x3bd78d);},'FuQsF':function(_0x1fe26a,_0x3a7d0a){return _0x1fe26a(_0x3a7d0a);},'iKLtb':_0x311d2a(0xb4)},_0x15e294=_0x43d95b[_0x311d2a(0x12b)];return new Promise((_0x47a0ac,_0x8ebd9d)=>{this['db']['get'](_0x15e294,[_0x3e9871],(_0x56df6a,_0x31f3ac)=>{const _0xfda570=_0x1eec;_0x56df6a&&(_0x43d95b[_0xfda570(0x133)](logError,_0xfda570(0x12a),_0x56df6a),_0x8ebd9d(_0x56df6a)),_0x43d95b[_0xfda570(0xbd)](_0x47a0ac,_0x31f3ac?.[_0xfda570(0x10c)]);});});}async[_0x28bd2f(0x12f)](_0xbc3103,_0x7c98bc){const _0x49690a=_0x28bd2f,_0x47e9bd={'xAVZD':function(_0x188331,_0x58f0c8,_0x3cc655){return _0x188331(_0x58f0c8,_0x3cc655);},'EDCJR':_0x49690a(0x105),'GAaXD':function(_0xf51d48,_0x1167c6){return _0xf51d48(_0x1167c6);},'QVDoe':function(_0x202765,_0x11b7da){return _0x202765(_0x11b7da);},'pqrru':_0x49690a(0xf7)},_0x480c1b=await this[_0x49690a(0xc5)](_0xbc3103);if(!_0x480c1b){const _0x582a85=this['db'][_0x49690a(0x11a)](_0x47e9bd['pqrru']);return new Promise((_0x3f1bf4,_0x1aa619)=>{const _0x2b8bbd=_0x49690a;_0x582a85[_0x2b8bbd(0x117)](_0xbc3103,_0x7c98bc,function(_0x4856ed){const _0x504eee=_0x2b8bbd;_0x4856ed&&(_0x47e9bd[_0x504eee(0xa7)](logError,_0x47e9bd[_0x504eee(0x119)],_0x4856ed),_0x47e9bd[_0x504eee(0x127)](_0x1aa619,_0x4856ed)),_0x47e9bd[_0x504eee(0xe5)](_0x3f1bf4,null);});});}}}function _0x1eec(_0x43a1e6,_0x383e0b){const _0xcd0240=_0xcd02();return _0x1eec=function(_0x1eec44,_0x145c31){_0x1eec44=_0x1eec44-0xa1;let _0x53f63b=_0xcd0240[_0x1eec44];return _0x53f63b;},_0x1eec(_0x43a1e6,_0x383e0b);}export const dbUtil=new DBUtil();