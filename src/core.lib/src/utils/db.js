const _0x2283d8=_0x6b6b;(function(_0x3fba53,_0x703835){const _0x5e977b=_0x6b6b,_0x367483=_0x3fba53();while(!![]){try{const _0x4b7e22=parseInt(_0x5e977b(0x150))/0x1*(parseInt(_0x5e977b(0x128))/0x2)+-parseInt(_0x5e977b(0x11b))/0x3*(-parseInt(_0x5e977b(0x141))/0x4)+parseInt(_0x5e977b(0x166))/0x5*(parseInt(_0x5e977b(0x13c))/0x6)+-parseInt(_0x5e977b(0x140))/0x7+parseInt(_0x5e977b(0x130))/0x8+-parseInt(_0x5e977b(0x154))/0x9+-parseInt(_0x5e977b(0xff))/0xa;if(_0x4b7e22===_0x703835)break;else _0x367483['push'](_0x367483['shift']());}catch(_0x32bd3c){_0x367483['push'](_0x367483['shift']());}}}(_0x920c,0x6ef29));function _0x920c(){const _0x316817=['longId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','cuDLE','elementType','HJgwj','addTempUin','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','catch','PpxKg','jGhDK','uuid','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','addMsg','parse','peerUid','Could\x20not\x20create\x20table\x20temp_uins','uin','set','maxId','updateFileCache','db\x20could\x20not\x20add\x20temp\x20uin','bZWUE','SELECT\x20*\x20FROM\x20temp_uins','sulzj','init','DFJLR','33RDYMeg','getMsgByLongId','WZaKI','McwcR','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','OPEN_READWRITE','getFileCache','xwFET','BVmAr','getFileCacheByUuid','Could\x20not\x20create\x20table\x20msgs','shortId','db\x20could\x20not\x20get\x20temp\x20uin\x20map','2ZCHFcG','SCQFu','errno','RgJpD','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','getMsgByShortId','msgSeq','dvFYA','3742200zpqvXE','tjCHG','Could\x20not\x20connect\x20to\x20database','Yqkzh','更新消息,\x20shortId:','jFRnH','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','FhqhL','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','getMsgsByMsgId','msgList','145788fhtuMJ','tpBxQ','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','element','3108497vYcfth','276052gGLkJI','rnDld','delete','iSAHH',',\x20seq:\x20','assign','getUidByTempUin','Xliin','msgCache','Nktzr','Database','url','globalMsgShortId','rvEPS','db\x20could\x20not\x20update\x20file\x20cache','88954Wtyqii','db\x20could\x20not\x20add\x20file','WyfLu','uid','5389182dJiuDN','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','close','prepare','toString','Could\x20not\x20get\x20msg','Aufjp',',\x20短id:\x20','db\x20could\x20not\x20get\x20file\x20cache','updateMsg\x20db\x20error','oYdpH','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','清理消息缓存','uvfPC','kSBJf','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','HyeVJ','ytaVv','145IFgGsE','getMsg','yXQLo','then','now','AGLzK','msgId','GHEZu','ufzUf','elementId','run','updateMsg','PVWoo','eBvnz','OPEN_CREATE','forEach','getCurrentMaxShortId','zTMen','path','记录消息到数据库,\x20消息长id:\x20','db\x20getMsgByLongId\x20error','baFLB','AnTIs','getReceivedTempUinMap','has','JHcKr','get','createTable','raBCk','all','jhWht','chatType','5232040WMcIKh','nLbnw'];_0x920c=function(){return _0x316817;};return _0x920c();}import _0x414c19 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';function _0x6b6b(_0x5581c4,_0xf1add4){const _0x920c84=_0x920c();return _0x6b6b=function(_0x6b6bfe,_0x555a80){_0x6b6bfe=_0x6b6bfe-0xe6;let _0x177c55=_0x920c84[_0x6b6bfe];return _0x177c55;},_0x6b6b(_0x5581c4,_0xf1add4);}class DBUtilBase{['db'];async['init'](_0x1e14de){const _0x13951a={'FhqhL':function(_0x14406a,_0x41f987){return _0x14406a|_0x41f987;}};if(this['db'])return;return new Promise((_0x1106b2,_0x131391)=>{const _0x54680b=_0x6b6b,_0x37abc7={'jhWht':function(_0x562be9,_0x187310,_0x2dc488){return _0x562be9(_0x187310,_0x2dc488);}};this['db']=new _0x414c19[(_0x54680b(0x14b))](_0x1e14de,_0x13951a[_0x54680b(0x138)](_0x414c19[_0x54680b(0x120)],_0x414c19[_0x54680b(0xed)]),_0x3cea4c=>{const _0x514226=_0x54680b;if(_0x3cea4c){_0x37abc7[_0x514226(0xfd)](logError,_0x514226(0x132),_0x3cea4c),_0x131391(_0x3cea4c);return;}this['createTable'](),_0x1106b2();});});}[_0x2283d8(0xfa)](){const _0x5c0d3a={'kjjFn':'Method\x20not\x20implemented.'};throw new Error(_0x5c0d3a['kjjFn']);}[_0x2283d8(0x156)](){const _0x4a0fdc=_0x2283d8;this['db']?.[_0x4a0fdc(0x156)]();}}class DBUtil extends DBUtilBase{[_0x2283d8(0x149)]=new Map();[_0x2283d8(0x14d)]=-0x7ffffff8;constructor(){const _0x580c56=_0x2283d8,_0x461721={'rnDld':function(_0x172165,_0x48ce45){return _0x172165*_0x48ce45;},'bZWUE':function(_0x459733,_0x3af5a5){return _0x459733(_0x3af5a5);},'LbdfK':_0x580c56(0x160),'WZaKI':function(_0x322639,_0x58a64,_0x8203cf){return _0x322639(_0x58a64,_0x8203cf);}};super();const _0x5949b4=0x3e8*0x3c*0xa;_0x461721[_0x580c56(0x11d)](setInterval,()=>{const _0x1b0595=_0x580c56,_0x44f2aa={'tpBxQ':function(_0x5d608e,_0x4fdf67){return _0x5d608e>_0x4fdf67;},'jGhDK':function(_0x47bfd8,_0x129369){const _0x5e2dc5=_0x6b6b;return _0x461721[_0x5e2dc5(0x142)](_0x47bfd8,_0x129369);}};_0x461721[_0x1b0595(0x116)](logDebug,_0x461721['LbdfK']),this[_0x1b0595(0x149)][_0x1b0595(0xee)]((_0x4ec8fb,_0x4e62d8)=>{const _0x19e857=_0x1b0595;_0x44f2aa[_0x19e857(0x13d)](Date[_0x19e857(0x16a)]()-_0x44f2aa[_0x19e857(0x10a)](parseInt(_0x4ec8fb['msgTime']),0x3e8),_0x5949b4)&&this[_0x19e857(0x149)][_0x19e857(0x143)](_0x4e62d8);});},_0x5949b4);}async[_0x2283d8(0x119)](_0x25830d){const _0x51adda=_0x2283d8;await super[_0x51adda(0x119)](_0x25830d),this['globalMsgShortId']=await this[_0x51adda(0xef)]();}[_0x2283d8(0xfa)](){const _0x5215dd=_0x2283d8,_0x58a0a6={'PpxKg':function(_0x104501,_0xa01f35,_0x247758){return _0x104501(_0xa01f35,_0x247758);},'kSBJf':_0x5215dd(0x125),'AnTIs':'Could\x20not\x20create\x20table\x20files','Yqkzh':_0x5215dd(0x110)},_0x266901='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db']['run'](_0x266901,function(_0x40a89b){const _0x3aa6f4=_0x5215dd;_0x40a89b&&_0x58a0a6[_0x3aa6f4(0x109)](logError,_0x58a0a6[_0x3aa6f4(0x162)],_0x40a89b['stack']);});const _0xf5bdf9=_0x5215dd(0x102);this['db'][_0x5215dd(0xe9)](_0xf5bdf9,function(_0x3a345e){const _0x55ea5f=_0x5215dd;_0x3a345e&&logError(_0x58a0a6[_0x55ea5f(0xf5)],_0x3a345e);});const _0x68a220=_0x5215dd(0x12c);this['db'][_0x5215dd(0xe9)](_0x68a220,function(_0x3584e5){const _0x6d0d7=_0x5215dd;_0x3584e5&&logError(_0x58a0a6[_0x6d0d7(0x133)],_0x3584e5);});}async[_0x2283d8(0xef)](){const _0x4af036=_0x2283d8,_0x47afc9={'RgJpD':function(_0x104962,_0x3693f3,_0x257434){return _0x104962(_0x3693f3,_0x257434);},'nDUcl':_0x4af036(0x15f),'ERynm':'数据库中消息最大短id','dvFYA':function(_0x379fab,_0x385a64){return _0x379fab(_0x385a64);},'ytaVv':_0x4af036(0x163)};return new Promise((_0xe37135,_0x46bbb2)=>{const _0x467421=_0x4af036,_0x360e7e={'IDtiY':function(_0x36eb40,_0xc75ae8,_0x57e4a2){const _0x4428c5=_0x6b6b;return _0x47afc9[_0x4428c5(0x12b)](_0x36eb40,_0xc75ae8,_0x57e4a2);},'DADuE':_0x47afc9['nDUcl'],'WyfLu':function(_0x2c4d75,_0x2b1c7c){return _0x2c4d75(_0x2b1c7c);},'TDTvd':_0x47afc9['ERynm'],'iSAHH':function(_0x5cdd52,_0x5226a9){const _0x2a4aa5=_0x6b6b;return _0x47afc9[_0x2a4aa5(0x12f)](_0x5cdd52,_0x5226a9);}};this['db'][_0x467421(0xf9)](_0x47afc9[_0x467421(0x165)],(_0x166a69,_0x30fc34)=>{const _0x5497d0=_0x467421;if(_0x166a69)return _0x360e7e['IDtiY'](logDebug,_0x360e7e['DADuE'],_0x166a69),_0x360e7e[_0x5497d0(0x152)](_0xe37135,-0x7ffffff8);logDebug(_0x360e7e['TDTvd'],_0x30fc34?.[_0x5497d0(0x113)]),_0x360e7e[_0x5497d0(0x144)](_0xe37135,_0x30fc34?.[_0x5497d0(0x113)]??-0x7ffffff8);});});}async[_0x2283d8(0x167)](_0x21c692,_0x142e49){const _0x296d1e=_0x2283d8,_0x3ad5cf={'DFJLR':function(_0x2b7d19,_0x351673){return _0x2b7d19(_0x351673);},'zTMen':_0x296d1e(0x159)},_0x2f4a6f=this['db'][_0x296d1e(0x157)](_0x21c692);return new Promise((_0x58d43d,_0x2c54b0)=>{const _0x2cd01f=_0x296d1e,_0x4a561f={'cuDLE':function(_0x5559e2,_0x3485a){const _0x3a592d=_0x6b6b;return _0x3ad5cf[_0x3a592d(0x11a)](_0x5559e2,_0x3485a);},'AGLzK':_0x3ad5cf[_0x2cd01f(0xf0)]};_0x2f4a6f[_0x2cd01f(0xf9)](..._0x142e49,(_0x58f200,_0x7a824c)=>{const _0x151443=_0x2cd01f,_0x27c4ed={'xwFET':function(_0x204742,_0x423b20){return _0x204742(_0x423b20);}};if(_0x58f200)return logError(_0x4a561f[_0x151443(0x16b)],_0x58f200,_0x21c692,_0x142e49),_0x4a561f[_0x151443(0x103)](_0x58d43d,null);if(!_0x7a824c){_0x58d43d(null);return;}const _0x226b33=_0x7a824c[_0x151443(0x101)];NTQQMsgApi[_0x151443(0x13a)]({'peerUid':_0x7a824c[_0x151443(0x10f)],'chatType':_0x7a824c['chatType']},[_0x226b33])['then'](_0x44903a=>{const _0x275028=_0x151443,_0x2389fc=_0x44903a[_0x275028(0x13b)][0x0];if(!_0x2389fc){_0x4a561f['cuDLE'](_0x58d43d,null);return;}_0x2389fc['id']=_0x7a824c[_0x275028(0x126)],_0x4a561f['cuDLE'](_0x58d43d,_0x2389fc);})['catch'](_0x309af0=>{const _0xd2c83e=_0x151443;_0x27c4ed[_0xd2c83e(0x122)](_0x58d43d,null);});});});}async[_0x2283d8(0x12d)](_0x836018){const _0x84cf7c=_0x2283d8;if(this[_0x84cf7c(0x149)][_0x84cf7c(0xf7)](_0x836018))return this['msgCache']['get'](_0x836018);const _0x5c4f06=_0x84cf7c(0x11f);return this[_0x84cf7c(0x167)](_0x5c4f06,[_0x836018]);}async[_0x2283d8(0x11c)](_0x47fa80){const _0x2e88d9=_0x2283d8,_0x25811c={'oYdpH':_0x2e88d9(0x139)};if(this['msgCache'][_0x2e88d9(0xf7)](_0x47fa80))return this['msgCache'][_0x2e88d9(0xf9)](_0x47fa80);return this[_0x2e88d9(0x167)](_0x25811c[_0x2e88d9(0x15e)],[_0x47fa80]);}async['getMsgBySeq'](_0x4889da,_0x4df036){const _0x3d0f04=_0x2283d8,_0x3d6583=_0x3d0f04(0x107);return this[_0x3d0f04(0x167)](_0x3d6583,[_0x4889da,_0x4df036]);}async[_0x2283d8(0x10d)](_0x11a1ca,_0xba015c=!![]){const _0x4fb4b6=_0x2283d8,_0x27aa2b={'baFLB':function(_0x21fe44,_0x11f1cc,_0x1acc8e){return _0x21fe44(_0x11f1cc,_0x1acc8e);},'Xliin':_0x4fb4b6(0x13e),'McwcR':'db\x20could\x20not\x20add\x20msg'},_0x70d23e=await this[_0x4fb4b6(0x11c)](_0x11a1ca[_0x4fb4b6(0x16c)]);if(_0x70d23e){if(_0xba015c)this[_0x4fb4b6(0xea)](_0x11a1ca)[_0x4fb4b6(0x169)]();return _0x70d23e['id'];}const _0x2db098=this['db'][_0x4fb4b6(0x157)](_0x4fb4b6(0x10c)),_0x60ff48=++this['globalMsgShortId'];return _0x11a1ca['id']=_0x60ff48,logDebug(_0x4fb4b6(0xf2)+_0x11a1ca['msgId']+_0x4fb4b6(0x15b)+_0x11a1ca['id']),this[_0x4fb4b6(0x149)][_0x4fb4b6(0x112)](_0x60ff48,_0x11a1ca),this[_0x4fb4b6(0x149)][_0x4fb4b6(0x112)](_0x11a1ca['msgId'],_0x11a1ca),_0x2db098[_0x4fb4b6(0xe9)](this[_0x4fb4b6(0x14d)],_0x11a1ca[_0x4fb4b6(0x16c)],_0x11a1ca['msgSeq'][_0x4fb4b6(0x158)](),_0x11a1ca['peerUid'],_0x11a1ca[_0x4fb4b6(0xfe)],_0x4a5459=>{const _0x11e203=_0x4fb4b6,_0x37586b={'HJgwj':function(_0x184e93,_0x370b30,_0x2c0fcd){return _0x27aa2b['baFLB'](_0x184e93,_0x370b30,_0x2c0fcd);},'tjCHG':_0x27aa2b[_0x11e203(0x148)]};_0x4a5459&&(_0x4a5459[_0x11e203(0x12a)]===0x13?this[_0x11e203(0x11c)](_0x11a1ca[_0x11e203(0x16c)])[_0x11e203(0x169)](_0x48d9b1=>{const _0x145a28=_0x11e203;_0x48d9b1?(this[_0x145a28(0x149)][_0x145a28(0x112)](_0x60ff48,_0x48d9b1),this['msgCache'][_0x145a28(0x112)](_0x48d9b1[_0x145a28(0x16c)],_0x48d9b1)):_0x37586b[_0x145a28(0x105)](logError,_0x37586b[_0x145a28(0x131)],_0x4a5459);})[_0x11e203(0x108)](_0x315cf9=>logError(_0x11e203(0xf3),_0x315cf9)):_0x27aa2b[_0x11e203(0xf4)](logError,_0x27aa2b[_0x11e203(0x11e)],_0x4a5459));}),_0x60ff48;}async['updateMsg'](_0x40e3a5){const _0x4ea4a8=_0x2283d8,_0x3a53c3={'HyeVJ':_0x4ea4a8(0x15d),'xBxSH':function(_0x271a4a,_0x3a0087){return _0x271a4a(_0x3a0087);},'uvfPC':'UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?'},_0x41aa01=this[_0x4ea4a8(0x149)][_0x4ea4a8(0xf9)](_0x40e3a5['msgId']);_0x41aa01&&Object[_0x4ea4a8(0x146)](_0x41aa01,_0x40e3a5);_0x3a53c3['xBxSH'](logDebug,_0x4ea4a8(0x134)+_0x40e3a5['id']+_0x4ea4a8(0x145)+_0x40e3a5[_0x4ea4a8(0x12e)]+',\x20msgId:\x20'+_0x40e3a5[_0x4ea4a8(0x16c)]);const _0x5dd6d3=this['db'][_0x4ea4a8(0x157)](_0x3a53c3[_0x4ea4a8(0x161)]);_0x5dd6d3[_0x4ea4a8(0xe9)](_0x40e3a5[_0x4ea4a8(0x12e)],_0x40e3a5[_0x4ea4a8(0x16c)],_0x370e4b=>{const _0x22ba13=_0x4ea4a8;_0x370e4b&&logError(_0x3a53c3[_0x22ba13(0x164)],_0x370e4b);});}async['addFileCache'](_0x4d66a7){const _0x14d144=_0x2283d8,_0x1899c9={'Sbnkj':function(_0x3a0750,_0x2846f0,_0x7c5653){return _0x3a0750(_0x2846f0,_0x7c5653);},'Aufjp':function(_0x4433c9,_0x333ee7){return _0x4433c9(_0x333ee7);},'AVoUA':function(_0x3b74bd,_0x4a9374){return _0x3b74bd(_0x4a9374);}},_0x3d96bd=this['db'][_0x14d144(0x157)](_0x14d144(0x155));return new Promise((_0x1ad1d5,_0x3f3a63)=>{const _0x235d16=_0x14d144;_0x3d96bd[_0x235d16(0xe9)](_0x4d66a7['name'],_0x4d66a7[_0x235d16(0xf1)],_0x4d66a7['url'],_0x4d66a7['size'],_0x4d66a7[_0x235d16(0x10b)],_0x4d66a7[_0x235d16(0x104)],JSON['stringify'](_0x4d66a7[_0x235d16(0x13f)]),_0x4d66a7[_0x235d16(0xe8)],_0x4d66a7[_0x235d16(0x16c)],function(_0x51c86a){const _0x3b9b86=_0x235d16;_0x51c86a&&(_0x1899c9['Sbnkj'](logError,_0x3b9b86(0x151),_0x51c86a),_0x1899c9[_0x3b9b86(0x15a)](_0x3f3a63,_0x51c86a)),_0x1899c9['AVoUA'](_0x1ad1d5,null);});});}async[_0x2283d8(0x121)](_0x5ce990,_0x35c828){const _0x201ecf=_0x2283d8,_0xb348d5={'SCQFu':function(_0x22f79b,_0x5ee9f7,_0x412a60){return _0x22f79b(_0x5ee9f7,_0x412a60);},'dHBOc':_0x201ecf(0x15c)},_0x4e5afe=this['db']['prepare'](_0x5ce990);return new Promise((_0x7402e1,_0xa6ec33)=>{const _0x274e41={'PVWoo':function(_0x4ea793,_0x42f0c5,_0x5304c6){const _0x1f80e7=_0x6b6b;return _0xb348d5[_0x1f80e7(0x129)](_0x4ea793,_0x42f0c5,_0x5304c6);},'nLbnw':_0xb348d5['dHBOc']};_0x4e5afe['get'](..._0x35c828,(_0x221523,_0x5e78e5)=>{const _0x16dd7e=_0x6b6b;_0x221523&&(_0x274e41[_0x16dd7e(0xeb)](logError,_0x274e41[_0x16dd7e(0x100)],_0x221523),_0xa6ec33(_0x221523)),_0x5e78e5&&(_0x5e78e5[_0x16dd7e(0x13f)]=JSON[_0x16dd7e(0x10e)](_0x5e78e5['element'])),_0x7402e1(_0x5e78e5);});});}async['getFileCacheByName'](_0x48b378){const _0xc364ec=_0x2283d8;return this[_0xc364ec(0x121)]('SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?',[_0x48b378]);}async[_0x2283d8(0x124)](_0x124354){const _0x199719=_0x2283d8,_0x530411={'yXQLo':_0x199719(0x137)};return this[_0x199719(0x121)](_0x530411[_0x199719(0x168)],[_0x124354]);}async[_0x2283d8(0x114)](_0x2ea9c4){const _0x1d0e98=_0x2283d8,_0x19e970={'NwUZK':_0x1d0e98(0x14f),'Nktzr':_0x1d0e98(0x136)},_0x305b97=this['db'][_0x1d0e98(0x157)](_0x19e970[_0x1d0e98(0x14a)]);return new Promise((_0x45a352,_0x14e68c)=>{const _0x1f63ab=_0x1d0e98,_0x40ad07={'jFRnH':function(_0x597b64,_0x4eb6f0,_0x185b66){return _0x597b64(_0x4eb6f0,_0x185b66);},'sulzj':_0x19e970['NwUZK'],'gqpWY':function(_0xc49cc6,_0x57c500){return _0xc49cc6(_0x57c500);}};_0x305b97[_0x1f63ab(0xe9)](_0x2ea9c4['path'],_0x2ea9c4[_0x1f63ab(0x14c)],_0x2ea9c4[_0x1f63ab(0x10b)],function(_0x2de880){const _0x5d4116=_0x1f63ab;_0x2de880&&(_0x40ad07[_0x5d4116(0x135)](logError,_0x40ad07[_0x5d4116(0x118)],_0x2de880),_0x40ad07['gqpWY'](_0x14e68c,_0x2de880)),_0x40ad07['gqpWY'](_0x45a352,null);});});}async[_0x2283d8(0xf6)](){const _0x19cef1=_0x2283d8,_0xd4d307={'BVmAr':function(_0x5826f1,_0x53a5e){return _0x5826f1(_0x53a5e);},'ufzUf':_0x19cef1(0x117)},_0x30f7d7=_0xd4d307[_0x19cef1(0xe7)];return new Promise((_0x1de76e,_0x269b2d)=>{const _0x35d131=_0x19cef1,_0x5b3234={'raBCk':function(_0x1f785e,_0x861cdb){const _0x28a83f=_0x6b6b;return _0xd4d307[_0x28a83f(0x123)](_0x1f785e,_0x861cdb);}};this['db'][_0x35d131(0xfc)](_0x30f7d7,(_0x56ab7d,_0x5be4a7)=>{const _0x4717b0=_0x35d131;_0x56ab7d&&(logError(_0x4717b0(0x127),_0x56ab7d),_0x269b2d(_0x56ab7d));const _0x4d62f8={};_0x5be4a7[_0x4717b0(0xee)](_0x526ddb=>{const _0x2557f9=_0x4717b0;_0x4d62f8[_0x526ddb[_0x2557f9(0x111)]]=_0x526ddb[_0x2557f9(0x153)];}),_0x5b3234[_0x4717b0(0xfb)](_0x1de76e,_0x4d62f8);});});}async['getUidByTempUin'](_0x5c5f0e){const _0x30f88a=_0x2283d8,_0x16d1c2={'JHcKr':_0x30f88a(0x127),'GHEZu':function(_0x5bb9e9,_0x4cd822){return _0x5bb9e9(_0x4cd822);}},_0x563d0d='SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?';return new Promise((_0x3e9011,_0x2d55e7)=>{const _0x580d00=_0x30f88a;this['db'][_0x580d00(0xf9)](_0x563d0d,[_0x5c5f0e],(_0x49884c,_0x581511)=>{const _0x586f4b=_0x580d00;_0x49884c&&(logError(_0x16d1c2[_0x586f4b(0xf8)],_0x49884c),_0x16d1c2[_0x586f4b(0xe6)](_0x2d55e7,_0x49884c)),_0x3e9011(_0x581511?.[_0x586f4b(0x153)]);});});}async[_0x2283d8(0x106)](_0x253e17,_0x34d415){const _0x5d062c=_0x2283d8,_0x212dbb={'eBvnz':_0x5d062c(0x115),'rvEPS':function(_0x46cd31,_0x46e994){return _0x46cd31(_0x46e994);},'ZgeYW':'INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)'},_0x3d00ca=await this[_0x5d062c(0x147)](_0x253e17);if(!_0x3d00ca){const _0x53c187=this['db'][_0x5d062c(0x157)](_0x212dbb['ZgeYW']);return new Promise((_0x21309e,_0x5eb33f)=>{const _0x43795a=_0x5d062c;_0x53c187[_0x43795a(0xe9)](_0x253e17,_0x34d415,function(_0x4e29c9){const _0x360216=_0x43795a;_0x4e29c9&&(logError(_0x212dbb[_0x360216(0xec)],_0x4e29c9),_0x212dbb[_0x360216(0x14e)](_0x5eb33f,_0x4e29c9)),_0x21309e(null);});});}}}export const dbUtil=new DBUtil();