const _0x4a6949=_0x5dde;(function(_0x4f85c4,_0x25a1bd){const _0x3a978d=_0x5dde,_0x16a9c8=_0x4f85c4();while(!![]){try{const _0x332258=parseInt(_0x3a978d(0x1cf))/0x1+parseInt(_0x3a978d(0x1c6))/0x2+-parseInt(_0x3a978d(0x1f3))/0x3*(-parseInt(_0x3a978d(0x1e4))/0x4)+parseInt(_0x3a978d(0x1eb))/0x5+parseInt(_0x3a978d(0x234))/0x6*(-parseInt(_0x3a978d(0x1f2))/0x7)+parseInt(_0x3a978d(0x1ab))/0x8*(-parseInt(_0x3a978d(0x1dd))/0x9)+parseInt(_0x3a978d(0x226))/0xa;if(_0x332258===_0x25a1bd)break;else _0x16a9c8['push'](_0x16a9c8['shift']());}catch(_0x53c371){_0x16a9c8['push'](_0x16a9c8['shift']());}}}(_0x1b75,0x7b4df));function _0x5dde(_0x397ed2,_0x323826){const _0x1b750e=_0x1b75();return _0x5dde=function(_0x5dde9b,_0x5144bf){_0x5dde9b=_0x5dde9b-0x1a8;let _0x35eb1e=_0x1b750e[_0x5dde9b];return _0x35eb1e;},_0x5dde(_0x397ed2,_0x323826);}import _0x36a780 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';function _0x1b75(){const _0x1754fe=['globalMsgShortId','SKovb','SELECT\x20*\x20FROM\x20temp_uins','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','TBgqQ','hCrkF','getMsgsByMsgId','aXjeq','lpOxc','getFileCache','getUidByTempUin','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','36kNRVsl','lEUFt','run','KPrwy','msgTime','errno','uOhdU','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','eslzl','RJHwf','VlhBw','yrjFd','Could\x20not\x20get\x20msg','stringify','MLLxY','ZcHcZ','数据库中消息最大短id','db\x20could\x20not\x20add\x20msg','maxId','set','longId','1273736hJXgTt','WAoFS','KouMU','记录消息到数据库,\x20消息长id:\x20','KZtto','uid','BAKhN','has','path','addMsg','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','jRUIx','fWsPB','ddLwd','rwRZG','elementType','now','catch','Method\x20not\x20implemented.','init','db\x20could\x20not\x20update\x20file\x20cache','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','updateMsg\x20db\x20error','pgCxb','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','Vaazm','886112kriQuj','MjESV','wfdKQ',',\x20msgId:\x20','QsoBt','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','清理消息缓存','chatType','219431xRltGZ','forEach','zyKVP','peerUid','ANfcb','iDbMu','hHqoe','SqKbN','getFileCacheByName','size','TOKaZ','updateMsg','更新消息,\x20shortId:','url','54kibzHR','bwTFc','Database','MuNLc','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','getMsgByLongId','WRnuJ','63508TvRUgi','wIGsz','msgCache','UcquZ','Could\x20not\x20create\x20table\x20msgs','getMsg','kNPlI','1938350FFkfCW','CleNM','Could\x20not\x20connect\x20to\x20database','get','close','TVSyn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','653219ugWVxR','105GKcqLP','uuekX','db\x20getMsgByLongId\x20error','EoyJS','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','kaHyQ','shortId','uin','toString','vYYpE','getMsgBySeq','jVXpe','Could\x20not\x20create\x20table\x20temp_uins','delete','MZEUD','addTempUin','createTable','MYCVP','name','updateFileCache','nvFUR','qxVAT','elementId','then','mVOnq','cyIEv','prepare','addFileCache','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','db\x20could\x20not\x20get\x20file\x20cache','JUzNp','ysrau','all','nrnlH',',\x20短id:\x20','uuid','eLYzS','UvJge','CZAPy','yTlJP','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','nwMaU','dJMoK','uKAXm','msgId','EBcFa','msgSeq','NSQSZ','getReceivedTempUinMap','db\x20could\x20not\x20get\x20temp\x20uin\x20map','getCurrentMaxShortId','4144070KmFavV','element'];_0x1b75=function(){return _0x1754fe;};return _0x1b75();}class DBUtilBase{['db'];async[_0x4a6949(0x1be)](_0xf79a5f){const _0x55e5c1=_0x4a6949,_0x913222={'MjESV':function(_0x3c4b72,_0xeae7,_0x2b5514){return _0x3c4b72(_0xeae7,_0x2b5514);},'eslzl':_0x55e5c1(0x1ed),'ysrau':function(_0x42b052,_0x16f77d){return _0x42b052(_0x16f77d);},'EBcFa':function(_0x2edbf5){return _0x2edbf5();},'jVXpe':function(_0x366b5e,_0x1f3fab){return _0x366b5e|_0x1f3fab;}};if(this['db'])return;return new Promise((_0x4db9f5,_0x444a9c)=>{const _0x73fe80=_0x55e5c1,_0x478d89={'RJHwf':function(_0x144856,_0x2e2c87,_0x15208b){const _0x1493b2=_0x5dde;return _0x913222[_0x1493b2(0x1c7)](_0x144856,_0x2e2c87,_0x15208b);},'iDbMu':_0x913222[_0x73fe80(0x23c)],'zyKVP':function(_0x5649ac,_0x5ec652){const _0x58e7eb=_0x73fe80;return _0x913222[_0x58e7eb(0x212)](_0x5649ac,_0x5ec652);},'Vaazm':function(_0x357e9e){const _0x2b6ef2=_0x73fe80;return _0x913222[_0x2b6ef2(0x220)](_0x357e9e);}};this['db']=new _0x36a780[(_0x73fe80(0x1df))](_0xf79a5f,_0x913222[_0x73fe80(0x1fe)](_0x36a780['OPEN_READWRITE'],_0x36a780['OPEN_CREATE']),_0x2217ca=>{const _0x4866ea=_0x73fe80;if(_0x2217ca){_0x478d89[_0x4866ea(0x23d)](logError,_0x478d89[_0x4866ea(0x1d4)],_0x2217ca),_0x478d89[_0x4866ea(0x1d1)](_0x444a9c,_0x2217ca);return;}this['createTable'](),_0x478d89[_0x4866ea(0x1c5)](_0x4db9f5);});});}['createTable'](){const _0x298340=_0x4a6949,_0x53873f={'WRnuJ':_0x298340(0x1bd)};throw new Error(_0x53873f[_0x298340(0x1e3)]);}['close'](){const _0x42c7ee=_0x4a6949;this['db']?.[_0x42c7ee(0x1ef)]();}}class DBUtil extends DBUtilBase{[_0x4a6949(0x1e6)]=new Map();[_0x4a6949(0x228)]=-0x7ffffff8;constructor(){const _0x355d51=_0x4a6949,_0x246090={'SqKbN':function(_0x40d519,_0x39b128){return _0x40d519>_0x39b128;},'VlhBw':function(_0x3fceb5,_0x293c29){return _0x3fceb5-_0x293c29;},'ZcHcZ':function(_0x372677,_0x1d5959){return _0x372677*_0x1d5959;},'xaqdJ':function(_0xb9fad0,_0x3da56d){return _0xb9fad0(_0x3da56d);},'aXjeq':_0x355d51(0x1cd),'wIGsz':function(_0x15b01a,_0x59bed3){return _0x15b01a*_0x59bed3;},'ougIE':function(_0x2ef392,_0x5eb95e){return _0x2ef392*_0x5eb95e;},'lEUFt':function(_0x2d5d47,_0x249e27,_0x413327){return _0x2d5d47(_0x249e27,_0x413327);}};super();const _0x156a19=_0x246090[_0x355d51(0x1e5)](_0x246090['ougIE'](0x3e8,0x3c),0xa);_0x246090[_0x355d51(0x235)](setInterval,()=>{const _0xaf9f13=_0x355d51;_0x246090['xaqdJ'](logDebug,_0x246090[_0xaf9f13(0x22f)]),this[_0xaf9f13(0x1e6)][_0xaf9f13(0x1d0)]((_0x3cb2b7,_0x25037b)=>{const _0x125860=_0xaf9f13;_0x246090[_0x125860(0x1d6)](_0x246090[_0x125860(0x23e)](Date[_0x125860(0x1bb)](),_0x246090[_0x125860(0x243)](parseInt(_0x3cb2b7[_0x125860(0x238)]),0x3e8)),_0x156a19)&&this[_0x125860(0x1e6)][_0x125860(0x200)](_0x25037b);});},_0x156a19);}async[_0x4a6949(0x1be)](_0x363574){const _0x117f77=_0x4a6949;await super['init'](_0x363574),this[_0x117f77(0x228)]=await this[_0x117f77(0x225)]();}[_0x4a6949(0x203)](){const _0x5b0fb4=_0x4a6949,_0x5311ed={'cyIEv':_0x5b0fb4(0x1e8),'EoyJS':function(_0x33196b,_0x31529f,_0x4a71cc){return _0x33196b(_0x31529f,_0x4a71cc);},'RmesT':'Could\x20not\x20create\x20table\x20files','uKAXm':function(_0x7baf1e,_0x1ea892,_0x17a6af){return _0x7baf1e(_0x1ea892,_0x17a6af);},'ooHLs':_0x5b0fb4(0x1ff)},_0x2bccf6=_0x5b0fb4(0x20f);this['db'][_0x5b0fb4(0x236)](_0x2bccf6,function(_0x15164c){const _0x421254=_0x5b0fb4;_0x15164c&&logError(_0x5311ed[_0x421254(0x20c)],_0x15164c['stack']);});const _0x53e58e=_0x5b0fb4(0x1e1);this['db'][_0x5b0fb4(0x236)](_0x53e58e,function(_0x4135c5){const _0x5260e1=_0x5b0fb4;_0x4135c5&&_0x5311ed[_0x5260e1(0x1f6)](logError,_0x5311ed['RmesT'],_0x4135c5);});const _0x73c3e1=_0x5b0fb4(0x1f1);this['db'][_0x5b0fb4(0x236)](_0x73c3e1,function(_0x3ae236){const _0xc59dbd=_0x5b0fb4;_0x3ae236&&_0x5311ed[_0xc59dbd(0x21e)](logError,_0x5311ed['ooHLs'],_0x3ae236);});}async[_0x4a6949(0x225)](){const _0x462b5d=_0x4a6949,_0x154b4c={'kfIRC':function(_0x32292a,_0x5d1904,_0x134cda){return _0x32292a(_0x5d1904,_0x134cda);},'TBgqQ':_0x462b5d(0x1b5)};return new Promise((_0x593662,_0x22fbd5)=>{const _0x1f91d8=_0x462b5d,_0x5e9a04={'uuekX':_0x1f91d8(0x1cb),'kNPlI':function(_0x5f3a60,_0x45378e){return _0x5f3a60(_0x45378e);},'tzJyn':function(_0x265670,_0x5b89a6,_0x1e8c1c){return _0x154b4c['kfIRC'](_0x265670,_0x5b89a6,_0x1e8c1c);},'ZxXEj':_0x1f91d8(0x244)};this['db'][_0x1f91d8(0x1ee)](_0x154b4c[_0x1f91d8(0x22c)],(_0x427b80,_0x2f8f04)=>{const _0x193c3e=_0x1f91d8;if(_0x427b80)return logDebug(_0x5e9a04[_0x193c3e(0x1f4)],_0x427b80),_0x5e9a04['kNPlI'](_0x593662,-0x7ffffff8);_0x5e9a04['tzJyn'](logDebug,_0x5e9a04['ZxXEj'],_0x2f8f04?.['maxId']),_0x5e9a04[_0x193c3e(0x1ea)](_0x593662,_0x2f8f04?.[_0x193c3e(0x1a8)]??-0x7ffffff8);});});}async[_0x4a6949(0x1e9)](_0x9785f8,_0x3fe58a){const _0x20214a=_0x4a6949,_0x17c174={'vYYpE':function(_0x489276,_0x58116f){return _0x489276(_0x58116f);},'NSQSZ':function(_0x3032ff,_0x318d22,_0x2a7554,_0x1c1c00,_0x5646bd){return _0x3032ff(_0x318d22,_0x2a7554,_0x1c1c00,_0x5646bd);},'uOhdU':_0x20214a(0x240)},_0x31c3d3=this['db']['prepare'](_0x9785f8);return new Promise((_0x5657db,_0x2ab6ba)=>{const _0x301525=_0x20214a,_0xe9847c={'CZAPy':function(_0x46d1a9,_0x1b64ea){const _0x1d26a2=_0x5dde;return _0x17c174[_0x1d26a2(0x1fc)](_0x46d1a9,_0x1b64ea);},'MYCVP':function(_0x28a2c1,_0xc94848){const _0x2db94e=_0x5dde;return _0x17c174[_0x2db94e(0x1fc)](_0x28a2c1,_0xc94848);},'UvJge':function(_0x2715cb,_0x5e2497,_0x4fae8a,_0x1c079e,_0x2b5bb4){const _0x18cd52=_0x5dde;return _0x17c174[_0x18cd52(0x222)](_0x2715cb,_0x5e2497,_0x4fae8a,_0x1c079e,_0x2b5bb4);},'UcquZ':_0x17c174[_0x301525(0x23a)]};_0x31c3d3[_0x301525(0x1ee)](..._0x3fe58a,(_0x249326,_0x3b9a57)=>{const _0x2131b9=_0x301525,_0x119e55={'qxVAT':function(_0x556fd0,_0x53ae99){return _0xe9847c['MYCVP'](_0x556fd0,_0x53ae99);}};if(_0x249326)return _0xe9847c[_0x2131b9(0x218)](logError,_0xe9847c[_0x2131b9(0x1e7)],_0x249326,_0x9785f8,_0x3fe58a),_0xe9847c[_0x2131b9(0x219)](_0x5657db,null);if(!_0x3b9a57){_0xe9847c[_0x2131b9(0x204)](_0x5657db,null);return;}const _0x3af868=_0x3b9a57[_0x2131b9(0x1aa)];NTQQMsgApi[_0x2131b9(0x22e)]({'peerUid':_0x3b9a57['peerUid'],'chatType':_0x3b9a57[_0x2131b9(0x1ce)]},[_0x3af868])['then'](_0x165d84=>{const _0x3d4dd5=_0x2131b9,_0x32a40b=_0x165d84['msgList'][0x0];if(!_0x32a40b){_0x119e55[_0x3d4dd5(0x208)](_0x5657db,null);return;}_0x32a40b['id']=_0x3b9a57[_0x3d4dd5(0x1f9)],_0x119e55[_0x3d4dd5(0x208)](_0x5657db,_0x32a40b);})[_0x2131b9(0x1bc)](_0xc61b99=>{const _0x2393fa=_0x2131b9;_0xe9847c[_0x2393fa(0x219)](_0x5657db,null);});});});}async['getMsgByShortId'](_0x5760fb){const _0x451517=_0x4a6949,_0x53a149={'SXOYY':_0x451517(0x233)};if(this[_0x451517(0x1e6)][_0x451517(0x1b2)](_0x5760fb))return this['msgCache'][_0x451517(0x1ee)](_0x5760fb);const _0x1a310b=_0x53a149['SXOYY'];return this[_0x451517(0x1e9)](_0x1a310b,[_0x5760fb]);}async['getMsgByLongId'](_0x32887c){const _0x28a806=_0x4a6949;if(this['msgCache'][_0x28a806(0x1b2)](_0x32887c))return this[_0x28a806(0x1e6)][_0x28a806(0x1ee)](_0x32887c);return this[_0x28a806(0x1e9)]('SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?',[_0x32887c]);}async[_0x4a6949(0x1fd)](_0x44a043,_0x5d5759){const _0x39582f=_0x4a6949,_0x469c2c={'BAKhN':_0x39582f(0x21b)},_0x53b8cc=_0x469c2c[_0x39582f(0x1b1)];return this[_0x39582f(0x1e9)](_0x53b8cc,[_0x44a043,_0x5d5759]);}async[_0x4a6949(0x1b4)](_0x10d48b,_0x17e261=!![]){const _0x1fdfef=_0x4a6949,_0x3b5269={'dJMoK':function(_0x247707,_0x5100ec,_0x369981){return _0x247707(_0x5100ec,_0x369981);},'MKvbt':_0x1fdfef(0x245),'nvFUR':function(_0x54447f,_0x4b91ef){return _0x54447f(_0x4b91ef);}},_0x30280d=await this['getMsgByLongId'](_0x10d48b[_0x1fdfef(0x21f)]);if(_0x30280d){if(_0x17e261)this[_0x1fdfef(0x1da)](_0x10d48b)[_0x1fdfef(0x20a)]();return _0x30280d['id'];}const _0xc0164d=this['db'][_0x1fdfef(0x20d)](_0x1fdfef(0x23b)),_0x7061f5=++this[_0x1fdfef(0x228)];return _0x10d48b['id']=_0x7061f5,_0x3b5269[_0x1fdfef(0x207)](logDebug,_0x1fdfef(0x1ae)+_0x10d48b[_0x1fdfef(0x21f)]+_0x1fdfef(0x215)+_0x10d48b['id']),this['msgCache'][_0x1fdfef(0x1a9)](_0x7061f5,_0x10d48b),this[_0x1fdfef(0x1e6)]['set'](_0x10d48b[_0x1fdfef(0x21f)],_0x10d48b),_0xc0164d[_0x1fdfef(0x236)](this[_0x1fdfef(0x228)],_0x10d48b['msgId'],_0x10d48b[_0x1fdfef(0x221)][_0x1fdfef(0x1fb)](),_0x10d48b[_0x1fdfef(0x1d2)],_0x10d48b[_0x1fdfef(0x1ce)],_0x5c0bfe=>{const _0x27a128=_0x1fdfef,_0x5a3c37={'MLLxY':function(_0x45be73,_0xb0865d,_0x1dc527){const _0x4a5354=_0x5dde;return _0x3b5269[_0x4a5354(0x21d)](_0x45be73,_0xb0865d,_0x1dc527);}};_0x5c0bfe&&(_0x5c0bfe[_0x27a128(0x239)]===0x13?this[_0x27a128(0x1e2)](_0x10d48b['msgId'])[_0x27a128(0x20a)](_0x5035e2=>{const _0x5785f2=_0x27a128;_0x5035e2?(this[_0x5785f2(0x1e6)][_0x5785f2(0x1a9)](_0x7061f5,_0x5035e2),this['msgCache']['set'](_0x5035e2[_0x5785f2(0x21f)],_0x5035e2)):_0x5a3c37[_0x5785f2(0x242)](logError,_0x5785f2(0x1c0),_0x5c0bfe);})[_0x27a128(0x1bc)](_0xdfd6a9=>logError(_0x27a128(0x1f5),_0xdfd6a9)):_0x3b5269['dJMoK'](logError,_0x3b5269['MKvbt'],_0x5c0bfe));}),_0x7061f5;}async[_0x4a6949(0x1da)](_0x204d60){const _0x4eb01e=_0x4a6949,_0x4ddd55={'ddLwd':function(_0x42a931,_0x277da6,_0x34e9b3){return _0x42a931(_0x277da6,_0x34e9b3);},'FEyoE':_0x4eb01e(0x1c1),'mVOnq':function(_0x3a9803,_0x53ee4b){return _0x3a9803(_0x53ee4b);}},_0xb7868c=this['msgCache'][_0x4eb01e(0x1ee)](_0x204d60['msgId']);_0xb7868c&&Object['assign'](_0xb7868c,_0x204d60);_0x4ddd55[_0x4eb01e(0x20b)](logDebug,_0x4eb01e(0x1db)+_0x204d60['id']+',\x20seq:\x20'+_0x204d60['msgSeq']+_0x4eb01e(0x1c9)+_0x204d60[_0x4eb01e(0x21f)]);const _0x17cfc6=this['db'][_0x4eb01e(0x20d)](_0x4eb01e(0x1c3));_0x17cfc6[_0x4eb01e(0x236)](_0x204d60[_0x4eb01e(0x221)],_0x204d60[_0x4eb01e(0x21f)],_0x257b66=>{const _0x5699a5=_0x4eb01e;_0x257b66&&_0x4ddd55[_0x5699a5(0x1b8)](logError,_0x4ddd55['FEyoE'],_0x257b66);});}async[_0x4a6949(0x20e)](_0x39cc52){const _0x1549fd=_0x4a6949,_0x525396={'WAoFS':function(_0x4fc6ec,_0xb8ee18){return _0x4fc6ec(_0xb8ee18);},'nwMaU':function(_0x5cd487,_0x479a5b){return _0x5cd487(_0x479a5b);},'wfdKQ':_0x1549fd(0x1cc)},_0x38e59c=this['db'][_0x1549fd(0x20d)](_0x525396[_0x1549fd(0x1c8)]);return new Promise((_0xacc092,_0x1a299e)=>{const _0x3d8dc9=_0x1549fd;_0x38e59c[_0x3d8dc9(0x236)](_0x39cc52[_0x3d8dc9(0x205)],_0x39cc52[_0x3d8dc9(0x1b3)],_0x39cc52[_0x3d8dc9(0x1dc)],_0x39cc52[_0x3d8dc9(0x1d8)],_0x39cc52[_0x3d8dc9(0x216)],_0x39cc52[_0x3d8dc9(0x1ba)],JSON[_0x3d8dc9(0x241)](_0x39cc52['element']),_0x39cc52[_0x3d8dc9(0x209)],_0x39cc52[_0x3d8dc9(0x21f)],function(_0x128a36){const _0x1b790d=_0x3d8dc9;_0x128a36&&(logError('db\x20could\x20not\x20add\x20file',_0x128a36),_0x525396[_0x1b790d(0x1ac)](_0x1a299e,_0x128a36)),_0x525396[_0x1b790d(0x21c)](_0xacc092,null);});});}async['getFileCache'](_0xb105,_0x26dd00){const _0x54d032=_0x4a6949,_0xf78689={'yrjFd':function(_0x1ca85b,_0x353e0b,_0x281ff4){return _0x1ca85b(_0x353e0b,_0x281ff4);},'rwRZG':_0x54d032(0x210),'QsoBt':function(_0x42ffef,_0x49c41e){return _0x42ffef(_0x49c41e);},'CleNM':function(_0x41008e,_0x15acb4){return _0x41008e(_0x15acb4);}},_0x11129c=this['db'][_0x54d032(0x20d)](_0xb105);return new Promise((_0xea6900,_0xe56739)=>{const _0x4c3de=_0x54d032;_0x11129c[_0x4c3de(0x1ee)](..._0x26dd00,(_0x2fb42d,_0x441860)=>{const _0x30640d=_0x4c3de;_0x2fb42d&&(_0xf78689[_0x30640d(0x23f)](logError,_0xf78689[_0x30640d(0x1b9)],_0x2fb42d),_0xf78689[_0x30640d(0x1ca)](_0xe56739,_0x2fb42d)),_0x441860&&(_0x441860[_0x30640d(0x227)]=JSON['parse'](_0x441860[_0x30640d(0x227)])),_0xf78689[_0x30640d(0x1ec)](_0xea6900,_0x441860);});});}async[_0x4a6949(0x1d7)](_0x142e46){const _0x8f091e=_0x4a6949,_0x4ee7f0={'eLYzS':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?'};return this[_0x8f091e(0x231)](_0x4ee7f0[_0x8f091e(0x217)],[_0x142e46]);}async['getFileCacheByUuid'](_0x29f3a0){const _0x364b5a=_0x4a6949,_0x67cf3={'jRUIx':_0x364b5a(0x1c4)};return this[_0x364b5a(0x231)](_0x67cf3[_0x364b5a(0x1b6)],[_0x29f3a0]);}async[_0x4a6949(0x206)](_0x161e60){const _0x4829b8=_0x4a6949,_0xb49fa={'MZEUD':function(_0x22117c,_0x63ddf1,_0x390dc0){return _0x22117c(_0x63ddf1,_0x390dc0);},'pgCxb':_0x4829b8(0x1bf),'KPrwy':function(_0x173101,_0x133747){return _0x173101(_0x133747);},'MuNLc':function(_0x336746,_0x4c7178){return _0x336746(_0x4c7178);},'lpOxc':'UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?'},_0x100902=this['db']['prepare'](_0xb49fa[_0x4829b8(0x230)]);return new Promise((_0x4d45c7,_0x57dbba)=>{const _0x1ab1e0=_0x4829b8;_0x100902[_0x1ab1e0(0x236)](_0x161e60[_0x1ab1e0(0x1b3)],_0x161e60[_0x1ab1e0(0x1dc)],_0x161e60[_0x1ab1e0(0x216)],function(_0xe551b0){const _0x2abca7=_0x1ab1e0;_0xe551b0&&(_0xb49fa[_0x2abca7(0x201)](logError,_0xb49fa[_0x2abca7(0x1c2)],_0xe551b0),_0xb49fa[_0x2abca7(0x237)](_0x57dbba,_0xe551b0)),_0xb49fa[_0x2abca7(0x1e0)](_0x4d45c7,null);});});}async[_0x4a6949(0x223)](){const _0xd470a9=_0x4a6949,_0x14cb9c={'yTlJP':function(_0x4d84a3,_0x46f0de){return _0x4d84a3(_0x46f0de);}},_0x5e45eb=_0xd470a9(0x22a);return new Promise((_0x527a92,_0x414bc2)=>{const _0x47c437=_0xd470a9,_0x3640a3={'hHqoe':_0x47c437(0x224),'JUzNp':function(_0x5049bd,_0x2fe5c0){const _0x26672f=_0x47c437;return _0x14cb9c[_0x26672f(0x21a)](_0x5049bd,_0x2fe5c0);}};this['db'][_0x47c437(0x213)](_0x5e45eb,(_0x223bbe,_0x43d8ce)=>{const _0x1cce8d=_0x47c437;_0x223bbe&&(logError(_0x3640a3[_0x1cce8d(0x1d5)],_0x223bbe),_0x414bc2(_0x223bbe));const _0x2c9a20={};_0x43d8ce['forEach'](_0x226d96=>{const _0x1df457=_0x1cce8d;_0x2c9a20[_0x226d96[_0x1df457(0x1fa)]]=_0x226d96['uid'];}),_0x3640a3[_0x1cce8d(0x211)](_0x527a92,_0x2c9a20);});});}async[_0x4a6949(0x232)](_0x21e97e){const _0x5a0209=_0x4a6949,_0x5332a9={'KZtto':function(_0x47ef5e,_0x44d3d3,_0x226540){return _0x47ef5e(_0x44d3d3,_0x226540);},'kaHyQ':_0x5a0209(0x224),'TOKaZ':function(_0x56ed29,_0x11ba24){return _0x56ed29(_0x11ba24);},'nrnlH':_0x5a0209(0x22b)},_0x3f985d=_0x5332a9[_0x5a0209(0x214)];return new Promise((_0x1e67b1,_0xfdd3a7)=>{const _0x553083=_0x5a0209;this['db'][_0x553083(0x1ee)](_0x3f985d,[_0x21e97e],(_0xcbabf2,_0x27f0c7)=>{const _0x30f6f3=_0x553083;_0xcbabf2&&(_0x5332a9[_0x30f6f3(0x1af)](logError,_0x5332a9[_0x30f6f3(0x1f8)],_0xcbabf2),_0x5332a9[_0x30f6f3(0x1d9)](_0xfdd3a7,_0xcbabf2)),_0x1e67b1(_0x27f0c7?.[_0x30f6f3(0x1b0)]);});});}async[_0x4a6949(0x202)](_0x11b034,_0x3d574f){const _0x400057=_0x4a6949,_0x57a4e1={'vVfLV':'db\x20could\x20not\x20add\x20temp\x20uin','fWsPB':function(_0x5dc93a,_0x36f36b){return _0x5dc93a(_0x36f36b);},'SKovb':function(_0x57c64c,_0x338a95){return _0x57c64c(_0x338a95);},'ANfcb':_0x400057(0x1f7)},_0x5e70d0=await this[_0x400057(0x232)](_0x11b034);if(!_0x5e70d0){const _0x408d98=this['db'][_0x400057(0x20d)](_0x57a4e1[_0x400057(0x1d3)]);return new Promise((_0x1557d6,_0x1e1e90)=>{const _0x566e93=_0x400057,_0x28a1b6={'hCrkF':function(_0x3118df,_0x6a0313,_0x387ac8){return _0x3118df(_0x6a0313,_0x387ac8);},'bwTFc':_0x57a4e1['vVfLV'],'TVSyn':function(_0x31cf92,_0x3799ae){const _0x2abb22=_0x5dde;return _0x57a4e1[_0x2abb22(0x1b7)](_0x31cf92,_0x3799ae);},'KouMU':function(_0x2b870f,_0x2e5e21){const _0x170f74=_0x5dde;return _0x57a4e1[_0x170f74(0x229)](_0x2b870f,_0x2e5e21);}};_0x408d98[_0x566e93(0x236)](_0x11b034,_0x3d574f,function(_0x3d00ec){const _0x141def=_0x566e93;_0x3d00ec&&(_0x28a1b6[_0x141def(0x22d)](logError,_0x28a1b6[_0x141def(0x1de)],_0x3d00ec),_0x28a1b6[_0x141def(0x1f0)](_0x1e1e90,_0x3d00ec)),_0x28a1b6[_0x141def(0x1ad)](_0x1557d6,null);});});}}}export const dbUtil=new DBUtil();