const _0x2a0ac6=_0x4e43;(function(_0x56f6aa,_0x4c9eb7){const _0x1d1246=_0x4e43,_0x4cb41f=_0x56f6aa();while(!![]){try{const _0x279353=parseInt(_0x1d1246(0xa7))/0x1*(-parseInt(_0x1d1246(0xc3))/0x2)+-parseInt(_0x1d1246(0x105))/0x3+-parseInt(_0x1d1246(0xe8))/0x4*(-parseInt(_0x1d1246(0xa1))/0x5)+-parseInt(_0x1d1246(0x120))/0x6+-parseInt(_0x1d1246(0xbd))/0x7+parseInt(_0x1d1246(0xca))/0x8+parseInt(_0x1d1246(0xd5))/0x9;if(_0x279353===_0x4c9eb7)break;else _0x4cb41f['push'](_0x4cb41f['shift']());}catch(_0x18d75a){_0x4cb41f['push'](_0x4cb41f['shift']());}}}(_0x2ebe,0x75a92));import _0x3b1ef5 from'sqlite3';function _0x2ebe(){const _0x4dd961=['2559474VHfjzp','stringify','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','FZKPx','IZYco','OPgUP','VRgiq','stack','htKdu','elementId','189515gwRyuI','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','addMsg','fhpze','now','aSaha','1103hEQFLF','ltWIt','addTempUin','getCurrentMaxShortId','globalMsgShortId','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640',',\x20msgId:\x20','cgwQp','element','db\x20could\x20not\x20get\x20temp\x20uin\x20map','getFileCache','OPEN_CREATE','tFGPp','db\x20could\x20not\x20add\x20file','Could\x20not\x20create\x20table\x20temp_uins',',\x20短id:\x20','set','msgSeq','elementType','assign','Could\x20not\x20connect\x20to\x20database','MPJvY','771659Dxkoaf','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','errno','close','uid','MuIgF','794GSwAjb','LmcwZ','OMnOH','数据库中消息最大短id','msgCache','getMsgByLongId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','5748984DYHUar','LYkgE','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','db\x20could\x20not\x20update\x20file\x20cache','Database','jbXMr','YiboT','SELECT\x20*\x20FROM\x20temp_uins','toString',',\x20seq:\x20','CvBzF','5692185QyQZNP','has','db\x20getMsgByLongId\x20error','清理消息缓存','qMNHb','getFileCacheByName','FPIOG','lhwKr','uuid','VYsEZ','url','db\x20could\x20not\x20add\x20temp\x20uin','db\x20could\x20not\x20add\x20msg','init','BrEHe','getMsgsByMsgId','run','delete','path','36zTrEbr','all','RGrng','msgList','then','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','dzXOT','size','LvYrN','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','createTable','Could\x20not\x20get\x20msg','getFileCacheByUuid','longId','getUidByTempUin','lRUhS','NLayy','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','msgId','forEach','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','WCyYF','ZJrRE','chatType','yWLkr','MbwAO','peerUid','daKLV','706710zfJwZY','NUIRd','OPEN_READWRITE','parse','get','WQpbo','oWGCg','updateMsg','XTTrx','更新消息,\x20shortId:','updateFileCache','记录消息到数据库,\x20消息长id:\x20','prepare','AkfbO','updateMsg\x20db\x20error','IuVKZ','getMsgByShortId','dTPzl','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','WLFKI','yxAcp','Could\x20not\x20create\x20table\x20files','WHpCy','maxId','wroKa','getMsg','HfNLh'];_0x2ebe=function(){return _0x4dd961;};return _0x2ebe();}import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async['init'](_0x4936bc){const _0x5bb234={'jbXMr':function(_0x84ac5b,_0x41f73f){return _0x84ac5b(_0x41f73f);},'XvALB':function(_0x3de92d,_0x18b8fc){return _0x3de92d|_0x18b8fc;}};if(this['db'])return;return new Promise((_0x4f5bfc,_0x8b8af7)=>{const _0x4b581b=_0x4e43,_0x1da1dd={'mRlro':function(_0x3da9bf,_0x39c4f1,_0x2703b7){return _0x3da9bf(_0x39c4f1,_0x2703b7);},'NUIRd':function(_0x41c9dd,_0x587bc1){const _0xa92cf=_0x4e43;return _0x5bb234[_0xa92cf(0xcf)](_0x41c9dd,_0x587bc1);},'YiboT':function(_0x3665f6){return _0x3665f6();}};this['db']=new _0x3b1ef5[(_0x4b581b(0xce))](_0x4936bc,_0x5bb234['XvALB'](_0x3b1ef5[_0x4b581b(0x107)],_0x3b1ef5[_0x4b581b(0xb2)]),_0x55530c=>{const _0x78c63a=_0x4b581b;if(_0x55530c){_0x1da1dd['mRlro'](logError,_0x78c63a(0xbb),_0x55530c),_0x1da1dd[_0x78c63a(0x106)](_0x8b8af7,_0x55530c);return;}this['createTable'](),_0x1da1dd[_0x78c63a(0xd0)](_0x4f5bfc);});});}[_0x2a0ac6(0xf2)](){throw new Error('Method\x20not\x20implemented.');}['close'](){const _0x5aa7b8=_0x2a0ac6;this['db']?.[_0x5aa7b8(0xc0)]();}}function _0x4e43(_0x286555,_0x5d5359){const _0x2ebed0=_0x2ebe();return _0x4e43=function(_0x4e4321,_0x2c6c08){_0x4e4321=_0x4e4321-0x9b;let _0x113e55=_0x2ebed0[_0x4e4321];return _0x113e55;},_0x4e43(_0x286555,_0x5d5359);}class DBUtil extends DBUtilBase{[_0x2a0ac6(0xc7)]=new Map();[_0x2a0ac6(0xab)]=-0x7ffffff8;constructor(){const _0x551b24=_0x2a0ac6,_0x37160f={'qeOzc':function(_0x2321b6,_0x1d9b01){return _0x2321b6>_0x1d9b01;},'OPgUP':function(_0x5672c9,_0x5065bb){return _0x5672c9(_0x5065bb);},'XTTrx':_0x551b24(0xd8),'WHpCy':function(_0x220551,_0x487b64){return _0x220551*_0x487b64;}};super();const _0x1a60de=_0x37160f['WHpCy'](_0x37160f[_0x551b24(0x11b)](0x3e8,0x3c),0xa);setInterval(()=>{const _0x127a0f=_0x551b24;_0x37160f[_0x127a0f(0x9c)](logDebug,_0x37160f[_0x127a0f(0x10d)]),this[_0x127a0f(0xc7)]['forEach']((_0x3e8110,_0x58aec9)=>{const _0x2008a0=_0x127a0f;_0x37160f['qeOzc'](Date[_0x2008a0(0xa5)]()-_0x37160f[_0x2008a0(0x9c)](parseInt,_0x3e8110['msgTime'])*0x3e8,_0x1a60de)&&this[_0x2008a0(0xc7)][_0x2008a0(0xe6)](_0x58aec9);});},_0x1a60de);}async[_0x2a0ac6(0xe2)](_0x314340){const _0x492406=_0x2a0ac6;await super[_0x492406(0xe2)](_0x314340),this[_0x492406(0xab)]=await this[_0x492406(0xaa)]();}['createTable'](){const _0x512c6a=_0x2a0ac6,_0x25c530={'DEnSe':'Could\x20not\x20create\x20table\x20msgs','VYsEZ':function(_0x45ac14,_0x18df39,_0x598368){return _0x45ac14(_0x18df39,_0x598368);},'IZYco':_0x512c6a(0x11a)},_0x3e070b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db'][_0x512c6a(0xe5)](_0x3e070b,function(_0x578af8){const _0x23be7b=_0x512c6a;_0x578af8&&logError(_0x25c530['DEnSe'],_0x578af8[_0x23be7b(0x9e)]);});const _0x40e5b9=_0x512c6a(0xbe);this['db'][_0x512c6a(0xe5)](_0x40e5b9,function(_0x17216a){const _0xab0742=_0x512c6a;_0x17216a&&_0x25c530[_0xab0742(0xde)](logError,_0x25c530[_0xab0742(0x9b)],_0x17216a);});const _0x21ea82=_0x512c6a(0xc9);this['db']['run'](_0x21ea82,function(_0x392b83){const _0x1abfed=_0x512c6a;_0x392b83&&_0x25c530[_0x1abfed(0xde)](logError,_0x1abfed(0xb5),_0x392b83);});}async[_0x2a0ac6(0xaa)](){const _0x18681a=_0x2a0ac6,_0x105a88={'WQpbo':_0x18681a(0xac),'MPJvY':function(_0x4491c9,_0x4326da,_0x4ed91f){return _0x4491c9(_0x4326da,_0x4ed91f);},'lhwKr':_0x18681a(0xc6),'MuIgF':function(_0x4d0334,_0x2e3180){return _0x4d0334(_0x2e3180);},'yxAcp':_0x18681a(0xa2)};return new Promise((_0x5c059c,_0x267e74)=>{const _0xeaf3e9=_0x18681a;this['db'][_0xeaf3e9(0x109)](_0x105a88[_0xeaf3e9(0x119)],(_0x2f5c83,_0x10b1ff)=>{const _0x25339b=_0xeaf3e9;if(_0x2f5c83)return logDebug(_0x105a88[_0x25339b(0x10a)],_0x2f5c83),_0x5c059c(-0x7ffffff8);_0x105a88[_0x25339b(0xbc)](logDebug,_0x105a88[_0x25339b(0xdc)],_0x10b1ff?.[_0x25339b(0x11c)]),_0x105a88[_0x25339b(0xc2)](_0x5c059c,_0x10b1ff?.[_0x25339b(0x11c)]??-0x7ffffff8);});});}async[_0x2a0ac6(0x11e)](_0x19d6a7,_0x34ecd9){const _0x30cdfd=_0x2a0ac6,_0x13f485={'CvBzF':function(_0x264189,_0x328ae4,_0x61c20,_0x67a7ef,_0x1a7f95){return _0x264189(_0x328ae4,_0x61c20,_0x67a7ef,_0x1a7f95);},'uSTEX':_0x30cdfd(0xf3),'RGrng':function(_0x438093,_0xc7bf75){return _0x438093(_0xc7bf75);}},_0xfd6276=this['db'][_0x30cdfd(0x111)](_0x19d6a7);return new Promise((_0x42a986,_0x1af8d9)=>{const _0x4ab526={'wroKa':function(_0x592ae9,_0x207389){return _0x592ae9(_0x207389);},'IuVKZ':function(_0x2b540e,_0x3a08af){return _0x2b540e(_0x3a08af);},'hKwkm':function(_0x3b1958,_0x215d66,_0x4dc278,_0x48257f,_0x196eae){const _0x2fd46d=_0x4e43;return _0x13f485[_0x2fd46d(0xd4)](_0x3b1958,_0x215d66,_0x4dc278,_0x48257f,_0x196eae);},'fRWIL':_0x13f485['uSTEX'],'FPIOG':function(_0x5e0f63,_0x44bb01){const _0x39df1e=_0x4e43;return _0x13f485[_0x39df1e(0xea)](_0x5e0f63,_0x44bb01);}};_0xfd6276['get'](..._0x34ecd9,(_0x41938c,_0x361ecb)=>{const _0x3c0b95=_0x4e43;if(_0x41938c)return _0x4ab526['hKwkm'](logError,_0x4ab526['fRWIL'],_0x41938c,_0x19d6a7,_0x34ecd9),_0x4ab526[_0x3c0b95(0xdb)](_0x42a986,null);if(!_0x361ecb){_0x4ab526[_0x3c0b95(0x11d)](_0x42a986,null);return;}const _0x5c4ddc=_0x361ecb[_0x3c0b95(0xf5)];NTQQMsgApi[_0x3c0b95(0xe4)]({'peerUid':_0x361ecb[_0x3c0b95(0x103)],'chatType':_0x361ecb[_0x3c0b95(0x100)]},[_0x5c4ddc])[_0x3c0b95(0xec)](_0x55855a=>{const _0x5025f8=_0x3c0b95,_0x25d0b7=_0x55855a[_0x5025f8(0xeb)][0x0];if(!_0x25d0b7){_0x4ab526[_0x5025f8(0x11d)](_0x42a986,null);return;}_0x25d0b7['id']=_0x361ecb['shortId'],_0x4ab526[_0x5025f8(0x114)](_0x42a986,_0x25d0b7);})['catch'](_0x26f569=>{_0x4ab526['wroKa'](_0x42a986,null);});});});}async[_0x2a0ac6(0x115)](_0x56c3ce){const _0x34bab0=_0x2a0ac6,_0x569ace={'ojuMh':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?'};if(this['msgCache'][_0x34bab0(0xd6)](_0x56c3ce))return this[_0x34bab0(0xc7)][_0x34bab0(0x109)](_0x56c3ce);const _0x2b3fdd=_0x569ace['ojuMh'];return this[_0x34bab0(0x11e)](_0x2b3fdd,[_0x56c3ce]);}async[_0x2a0ac6(0xc8)](_0x31c007){const _0x47af00=_0x2a0ac6;if(this['msgCache'][_0x47af00(0xd6)](_0x31c007))return this[_0x47af00(0xc7)][_0x47af00(0x109)](_0x31c007);return this[_0x47af00(0x11e)](_0x47af00(0xcc),[_0x31c007]);}async['getMsgBySeq'](_0x4d652e,_0x470cac){const _0x6a903a=_0x2a0ac6,_0x2a5718={'yWLkr':_0x6a903a(0x122)},_0x1ca6bd=_0x2a5718[_0x6a903a(0x101)];return this['getMsg'](_0x1ca6bd,[_0x4d652e,_0x470cac]);}async[_0x2a0ac6(0xa3)](_0x1cb59e,_0x21907f=!![]){const _0x46cfe8=_0x2a0ac6,_0x1596f7={'ZJrRE':function(_0x38f13d,_0x12497c){return _0x38f13d===_0x12497c;},'htKdu':function(_0x4cbb55,_0xa28f77,_0x423aa6){return _0x4cbb55(_0xa28f77,_0x423aa6);},'LvYrN':_0x46cfe8(0xe1),'MbwAO':_0x46cfe8(0xed),'GNvLO':function(_0x3d555a,_0x493c19){return _0x3d555a(_0x493c19);}},_0xc7f8dc=await this['getMsgByLongId'](_0x1cb59e[_0x46cfe8(0xfa)]);if(_0xc7f8dc){if(_0x21907f)this['updateMsg'](_0x1cb59e)[_0x46cfe8(0xec)]();return _0xc7f8dc['id'];}const _0x495efd=this['db']['prepare'](_0x1596f7[_0x46cfe8(0x102)]),_0x24ddde=++this[_0x46cfe8(0xab)];return _0x1cb59e['id']=_0x24ddde,_0x1596f7['GNvLO'](logDebug,_0x46cfe8(0x110)+_0x1cb59e[_0x46cfe8(0xfa)]+_0x46cfe8(0xb6)+_0x1cb59e['id']),this[_0x46cfe8(0xc7)][_0x46cfe8(0xb7)](_0x24ddde,_0x1cb59e),this[_0x46cfe8(0xc7)][_0x46cfe8(0xb7)](_0x1cb59e['msgId'],_0x1cb59e),_0x495efd[_0x46cfe8(0xe5)](this[_0x46cfe8(0xab)],_0x1cb59e[_0x46cfe8(0xfa)],_0x1cb59e[_0x46cfe8(0xb8)][_0x46cfe8(0xd2)](),_0x1cb59e[_0x46cfe8(0x103)],_0x1cb59e[_0x46cfe8(0x100)],_0x458ebd=>{const _0x427884=_0x46cfe8,_0x1a81f4={'tFGPp':function(_0x344ac0,_0x161b45,_0x404493){return _0x344ac0(_0x161b45,_0x404493);}};_0x458ebd&&(_0x1596f7[_0x427884(0xff)](_0x458ebd[_0x427884(0xbf)],0x13)?this[_0x427884(0xc8)](_0x1cb59e[_0x427884(0xfa)])[_0x427884(0xec)](_0xdbd9d3=>{const _0x47bddf=_0x427884;_0xdbd9d3?(this[_0x47bddf(0xc7)][_0x47bddf(0xb7)](_0x24ddde,_0xdbd9d3),this['msgCache'][_0x47bddf(0xb7)](_0xdbd9d3[_0x47bddf(0xfa)],_0xdbd9d3)):_0x1a81f4[_0x47bddf(0xb3)](logError,_0x47bddf(0x117),_0x458ebd);})['catch'](_0x17f8ac=>logError(_0x427884(0xd7),_0x17f8ac)):_0x1596f7[_0x427884(0x9f)](logError,_0x1596f7[_0x427884(0xf0)],_0x458ebd));}),_0x24ddde;}async[_0x2a0ac6(0x10c)](_0x561bbc){const _0x317f26=_0x2a0ac6,_0x5b507d={'HfNLh':function(_0x41092f,_0x1f1b7b,_0x308422){return _0x41092f(_0x1f1b7b,_0x308422);},'oWGCg':function(_0x190ec1,_0x452e60){return _0x190ec1(_0x452e60);},'ltWIt':_0x317f26(0xfd)},_0x33bbb8=this['msgCache']['get'](_0x561bbc[_0x317f26(0xfa)]);_0x33bbb8&&Object[_0x317f26(0xba)](_0x33bbb8,_0x561bbc);_0x5b507d[_0x317f26(0x10b)](logDebug,_0x317f26(0x10e)+_0x561bbc['id']+_0x317f26(0xd3)+_0x561bbc[_0x317f26(0xb8)]+_0x317f26(0xad)+_0x561bbc[_0x317f26(0xfa)]);const _0x51e79c=this['db'][_0x317f26(0x111)](_0x5b507d[_0x317f26(0xa8)]);_0x51e79c[_0x317f26(0xe5)](_0x561bbc[_0x317f26(0xb8)],_0x561bbc[_0x317f26(0xfa)],_0x300a2c=>{const _0x452743=_0x317f26;_0x300a2c&&_0x5b507d[_0x452743(0x11f)](logError,_0x452743(0x113),_0x300a2c);});}async['addFileCache'](_0xce2ce0){const _0x54eb2e=_0x2a0ac6,_0x4858a8={'WLFKI':function(_0x4c4559,_0x12f3dd,_0x4dbce7){return _0x4c4559(_0x12f3dd,_0x4dbce7);},'lRUhS':function(_0x359bfb,_0x8fd507){return _0x359bfb(_0x8fd507);},'fhpze':_0x54eb2e(0xf9)},_0x2d0de5=this['db'][_0x54eb2e(0x111)](_0x4858a8[_0x54eb2e(0xa4)]);return new Promise((_0x4b58fe,_0x424650)=>{const _0x1383fe=_0x54eb2e,_0x3c5a3b={'qMNHb':function(_0x325cf2,_0x1e6c02,_0x51313d){const _0x1c302c=_0x4e43;return _0x4858a8[_0x1c302c(0x118)](_0x325cf2,_0x1e6c02,_0x51313d);},'dzXOT':function(_0x27e916,_0x59b26e){const _0x5d6f7b=_0x4e43;return _0x4858a8[_0x5d6f7b(0xf7)](_0x27e916,_0x59b26e);}};_0x2d0de5[_0x1383fe(0xe5)](_0xce2ce0['name'],_0xce2ce0[_0x1383fe(0xe7)],_0xce2ce0[_0x1383fe(0xdf)],_0xce2ce0[_0x1383fe(0xef)],_0xce2ce0['uuid'],_0xce2ce0[_0x1383fe(0xb9)],JSON[_0x1383fe(0x121)](_0xce2ce0[_0x1383fe(0xaf)]),_0xce2ce0[_0x1383fe(0xa0)],_0xce2ce0[_0x1383fe(0xfa)],function(_0x386e23){const _0x2a79c6=_0x1383fe;_0x386e23&&(_0x3c5a3b[_0x2a79c6(0xd9)](logError,_0x2a79c6(0xb4),_0x386e23),_0x424650(_0x386e23)),_0x3c5a3b[_0x2a79c6(0xee)](_0x4b58fe,null);});});}async['getFileCache'](_0xbb32a7,_0x2581b8){const _0x3aa017={'cgwQp':function(_0x2c29b1,_0xc28d5b){return _0x2c29b1(_0xc28d5b);}},_0x5c8ec0=this['db']['prepare'](_0xbb32a7);return new Promise((_0x5d9627,_0x35eb9d)=>{const _0x5df6af=_0x4e43;_0x5c8ec0[_0x5df6af(0x109)](..._0x2581b8,(_0x916393,_0x5bf938)=>{const _0x1069cc=_0x5df6af;_0x916393&&(logError('db\x20could\x20not\x20get\x20file\x20cache',_0x916393),_0x3aa017[_0x1069cc(0xae)](_0x35eb9d,_0x916393)),_0x5bf938&&(_0x5bf938[_0x1069cc(0xaf)]=JSON[_0x1069cc(0x108)](_0x5bf938['element'])),_0x5d9627(_0x5bf938);});});}async[_0x2a0ac6(0xda)](_0x4f3f14){const _0x5322e2=_0x2a0ac6,_0x8cf8f={'JTvpZ':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?'};return this[_0x5322e2(0xb1)](_0x8cf8f['JTvpZ'],[_0x4f3f14]);}async[_0x2a0ac6(0xf4)](_0x550a34){const _0x3c0c14=_0x2a0ac6,_0x3cf798={'hkZzi':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?'};return this[_0x3c0c14(0xb1)](_0x3cf798['hkZzi'],[_0x550a34]);}async[_0x2a0ac6(0x10f)](_0x44eb12){const _0x5239e3=_0x2a0ac6,_0xd19ae7={'sXrAT':function(_0x16ff56,_0x402323,_0x8b2c04){return _0x16ff56(_0x402323,_0x8b2c04);},'dTPzl':_0x5239e3(0xcd),'aSaha':function(_0x303b02,_0x4301f7){return _0x303b02(_0x4301f7);},'OMnOH':function(_0x3e7887,_0x3fe721){return _0x3e7887(_0x3fe721);},'wekzM':'UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?'},_0x2da5bc=this['db']['prepare'](_0xd19ae7['wekzM']);return new Promise((_0x7eb9bb,_0x28416f)=>{const _0x196796=_0x5239e3;_0x2da5bc['run'](_0x44eb12[_0x196796(0xe7)],_0x44eb12[_0x196796(0xdf)],_0x44eb12[_0x196796(0xdd)],function(_0x28909f){const _0x51cacc=_0x196796;_0x28909f&&(_0xd19ae7['sXrAT'](logError,_0xd19ae7[_0x51cacc(0x116)],_0x28909f),_0xd19ae7[_0x51cacc(0xa6)](_0x28416f,_0x28909f)),_0xd19ae7[_0x51cacc(0xc5)](_0x7eb9bb,null);});});}async['getReceivedTempUinMap'](){const _0x504a9a=_0x2a0ac6,_0x3ddf4b={'BrEHe':function(_0x305dec,_0x3556b1,_0x19983d){return _0x305dec(_0x3556b1,_0x19983d);},'CvkBK':_0x504a9a(0xb0),'NLayy':_0x504a9a(0xd1)},_0x507cd9=_0x3ddf4b[_0x504a9a(0xf8)];return new Promise((_0x5aefde,_0x4bf1b1)=>{const _0x1e231a=_0x504a9a,_0x1a0f7a={'LmcwZ':function(_0x48a435,_0x96df1,_0x322cef){const _0x14d49a=_0x4e43;return _0x3ddf4b[_0x14d49a(0xe3)](_0x48a435,_0x96df1,_0x322cef);},'WCyYF':_0x3ddf4b['CvkBK'],'fqUMF':function(_0x53f6f1,_0x59a899){return _0x53f6f1(_0x59a899);}};this['db'][_0x1e231a(0xe9)](_0x507cd9,(_0x367ecd,_0xbca3b3)=>{const _0x10fa06=_0x1e231a;_0x367ecd&&(_0x1a0f7a[_0x10fa06(0xc4)](logError,_0x1a0f7a[_0x10fa06(0xfe)],_0x367ecd),_0x4bf1b1(_0x367ecd));const _0x3433f6={};_0xbca3b3[_0x10fa06(0xfb)](_0x42c0ce=>{const _0x502403=_0x10fa06;_0x3433f6[_0x42c0ce['uin']]=_0x42c0ce[_0x502403(0xc1)];}),_0x1a0f7a['fqUMF'](_0x5aefde,_0x3433f6);});});}async[_0x2a0ac6(0xf6)](_0x5673d4){const _0x275258=_0x2a0ac6,_0x60bc6a={'QnFCq':function(_0x186a8f,_0x219e72,_0x44daf5){return _0x186a8f(_0x219e72,_0x44daf5);},'daKLV':function(_0x17f962,_0x119e1a){return _0x17f962(_0x119e1a);}},_0x37aac3=_0x275258(0xfc);return new Promise((_0x47d736,_0x3962fd)=>{this['db']['get'](_0x37aac3,[_0x5673d4],(_0xa5f569,_0x5c9f59)=>{const _0x1182f6=_0x4e43;_0xa5f569&&(_0x60bc6a['QnFCq'](logError,_0x1182f6(0xb0),_0xa5f569),_0x60bc6a[_0x1182f6(0x104)](_0x3962fd,_0xa5f569)),_0x47d736(_0x5c9f59?.[_0x1182f6(0xc1)]);});});}async[_0x2a0ac6(0xa9)](_0x560220,_0x4c85e3){const _0x49de3d=_0x2a0ac6,_0x461476={'VRgiq':function(_0x4ade6b,_0x47427a,_0x4a6c72){return _0x4ade6b(_0x47427a,_0x4a6c72);},'AkfbO':function(_0x4b7389,_0x42f22c){return _0x4b7389(_0x42f22c);}},_0x5da0d3=await this['getUidByTempUin'](_0x560220);if(!_0x5da0d3){const _0x54e15=this['db']['prepare'](_0x49de3d(0xf1));return new Promise((_0x2c7a89,_0x3e38b9)=>{const _0x43e5f1=_0x49de3d,_0x1bf8f={'LYkgE':function(_0x147af1,_0x22679c,_0x185a75){const _0x1280c3=_0x4e43;return _0x461476[_0x1280c3(0x9d)](_0x147af1,_0x22679c,_0x185a75);},'FZKPx':function(_0x415140,_0x1b0225){const _0x4bd638=_0x4e43;return _0x461476[_0x4bd638(0x112)](_0x415140,_0x1b0225);}};_0x54e15[_0x43e5f1(0xe5)](_0x560220,_0x4c85e3,function(_0x1abb38){const _0x484dfe=_0x43e5f1;_0x1abb38&&(_0x1bf8f[_0x484dfe(0xcb)](logError,_0x484dfe(0xe0),_0x1abb38),_0x1bf8f[_0x484dfe(0x123)](_0x3e38b9,_0x1abb38)),_0x2c7a89(null);});});}}}export const dbUtil=new DBUtil();