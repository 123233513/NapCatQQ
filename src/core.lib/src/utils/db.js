const _0x387bcb=_0x1ec1;(function(_0x3ce325,_0x1d16e9){const _0x11c937=_0x1ec1,_0x1f362f=_0x3ce325();while(!![]){try{const _0x1c1cd7=-parseInt(_0x11c937(0x16a))/0x1+-parseInt(_0x11c937(0x130))/0x2*(-parseInt(_0x11c937(0x14c))/0x3)+parseInt(_0x11c937(0x156))/0x4*(parseInt(_0x11c937(0x175))/0x5)+-parseInt(_0x11c937(0x188))/0x6+-parseInt(_0x11c937(0x19b))/0x7+parseInt(_0x11c937(0x117))/0x8*(-parseInt(_0x11c937(0x164))/0x9)+parseInt(_0x11c937(0x190))/0xa*(parseInt(_0x11c937(0x15e))/0xb);if(_0x1c1cd7===_0x1d16e9)break;else _0x1f362f['push'](_0x1f362f['shift']());}catch(_0x5db415){_0x1f362f['push'](_0x1f362f['shift']());}}}(_0x4d28,0x599f6));import _0x428939 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x387bcb(0x194)](_0x3a09b0){const _0x42630f=_0x387bcb,_0x5bb91f={'RIqEW':function(_0x224793,_0x4b8b35,_0x50774e){return _0x224793(_0x4b8b35,_0x50774e);},'KctTb':_0x42630f(0x157),'uqyaK':function(_0x9a1abd,_0x51d613){return _0x9a1abd(_0x51d613);},'ykftO':function(_0xea2315,_0x51dbbf){return _0xea2315|_0x51dbbf;}};if(this['db'])return;return new Promise((_0x2c4afd,_0x1c41ad)=>{const _0xece2fe=_0x42630f,_0x4337bf={'POtoz':function(_0x329c7b,_0xa67702,_0x408513){const _0x396825=_0x1ec1;return _0x5bb91f[_0x396825(0x184)](_0x329c7b,_0xa67702,_0x408513);},'rTQli':_0x5bb91f['KctTb'],'loXvl':function(_0x482aa5,_0x170fd9){const _0x5cb2cb=_0x1ec1;return _0x5bb91f[_0x5cb2cb(0x16c)](_0x482aa5,_0x170fd9);},'rkswz':function(_0x540309){return _0x540309();}};this['db']=new _0x428939[(_0xece2fe(0x142))](_0x3a09b0,_0x5bb91f[_0xece2fe(0x192)](_0x428939[_0xece2fe(0x134)],_0x428939[_0xece2fe(0x138)]),_0x2baf79=>{const _0x168e1e=_0xece2fe;if(_0x2baf79){_0x4337bf[_0x168e1e(0x151)](logError,_0x4337bf[_0x168e1e(0x144)],_0x2baf79),_0x4337bf[_0x168e1e(0x13c)](_0x1c41ad,_0x2baf79);return;}this[_0x168e1e(0x119)](),_0x4337bf[_0x168e1e(0x149)](_0x2c4afd);});});}['createTable'](){throw new Error('Method\x20not\x20implemented.');}[_0x387bcb(0x11c)](){const _0x3cf85c=_0x387bcb;this['db']?.[_0x3cf85c(0x11c)]();}}function _0x4d28(){const _0x5767dd=['uid',',\x20seq:\x20','zdGHr','RIqEW','getMsgByShortId','bxFUz','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','610068PwqHEh','db\x20getMsgByLongId\x20error','all','cTxWt','NZVSJ','WRqMo','updateMsg',',\x20msgId:\x20','5412630kRxmCm','updateMsg\x20db\x20error','ykftO','TVkDV','init','jooCv','set','getCurrentMaxShortId','hhosu','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','catch','923265Xqkmrb','chatType','BEQnr','getUidByTempUin','AwlJC','gMoDk','llbVy','16AJMdGM','globalMsgShortId','createTable','msgId','MfbsW','close','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','zFhtR','peerUid','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','getMsgByLongId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','gahRc','qULlA','SyNnE','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','YkUxZ','prepare','stringify','mqKgd','maxId','TrjOs','CzqOP','run','has','2aqdqMg','db\x20could\x20not\x20get\x20file\x20cache','HicAm','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','OPEN_READWRITE','path','aVtvJ','YfVmH','OPEN_CREATE','MovhM','addTempUin','getFileCache','loXvl','getReceivedTempUinMap','jEort','elementId','uuid','ebzaL','Database','eaFCP','rTQli','lWJZD','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','db\x20could\x20not\x20add\x20msg','msgCache','rkswz','elAPt','Could\x20not\x20get\x20msg','449571KMUiyg','db\x20could\x20not\x20update\x20file\x20cache','IgLqo','element','getMsgBySeq','POtoz','XUQQj','then','Could\x20not\x20create\x20table\x20files','getFileCacheByUuid','746480zdQeSK','Could\x20not\x20connect\x20to\x20database','getMsg','fyPWd','assign','JIjzi','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','url','11KcUZun','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','updateFileCache','now','get','elementType','106821TnsNqd','uin','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','delete','SELECT\x20*\x20FROM\x20temp_uins','msgSeq','253335PFApcc','DCVEA','uqyaK','db\x20could\x20not\x20get\x20temp\x20uin\x20map','stack','qSzBm','JuGlt','GQCKk','更新消息,\x20shortId:','forEach','addMsg','5gMmGPJ','size','清理消息缓存','数据库中消息最大短id','shortId','Could\x20not\x20create\x20table\x20temp_uins','gZPNf','OXMEa','longId',',\x20短id:\x20','msgList','db\x20could\x20not\x20add\x20temp\x20uin'];_0x4d28=function(){return _0x5767dd;};return _0x4d28();}class DBUtil extends DBUtilBase{['msgCache']=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x359fc3=_0x387bcb,_0x17362b={'QXAAz':function(_0x48651d,_0x151e15){return _0x48651d-_0x151e15;},'ctfDz':function(_0x57b58d,_0x4a000e){return _0x57b58d(_0x4a000e);},'NZVSJ':function(_0x2f4dbe,_0x244599){return _0x2f4dbe*_0x244599;},'jEort':function(_0xafae40,_0x43eaeb,_0x55b7c2){return _0xafae40(_0x43eaeb,_0x55b7c2);}};super();const _0x5eeb45=_0x17362b[_0x359fc3(0x18c)](_0x17362b[_0x359fc3(0x18c)](0x3e8,0x3c),0xa);_0x17362b[_0x359fc3(0x13e)](setInterval,()=>{const _0x4cf237=_0x359fc3;logDebug(_0x4cf237(0x177)),this[_0x4cf237(0x148)][_0x4cf237(0x173)]((_0x20c8e7,_0x143025)=>{const _0x1f1373=_0x4cf237;_0x17362b['QXAAz'](Date[_0x1f1373(0x161)](),_0x17362b['ctfDz'](parseInt,_0x20c8e7['msgTime'])*0x3e8)>_0x5eeb45&&this[_0x1f1373(0x148)][_0x1f1373(0x167)](_0x143025);});},_0x5eeb45);}async[_0x387bcb(0x194)](_0x36dd8e){const _0x22a516=_0x387bcb;await super[_0x22a516(0x194)](_0x36dd8e),this[_0x22a516(0x118)]=await this[_0x22a516(0x197)]();}[_0x387bcb(0x119)](){const _0x22f471=_0x387bcb,_0x314138={'CzqOP':'Could\x20not\x20create\x20table\x20msgs','YqlPz':function(_0x5391d6,_0x282ac8,_0x3b769c){return _0x5391d6(_0x282ac8,_0x3b769c);},'aVtvJ':_0x22f471(0x17a)},_0x18ce50=_0x22f471(0x11d);this['db'][_0x22f471(0x12e)](_0x18ce50,function(_0x1ec605){const _0x289fb9=_0x22f471;_0x1ec605&&logError(_0x314138[_0x289fb9(0x12d)],_0x1ec605[_0x289fb9(0x16e)]);});const _0x54ca1e=_0x22f471(0x199);this['db'][_0x22f471(0x12e)](_0x54ca1e,function(_0x328648){const _0x1c76ee=_0x22f471;_0x328648&&_0x314138['YqlPz'](logError,_0x1c76ee(0x154),_0x328648);});const _0x5f55fc=_0x22f471(0x122);this['db']['run'](_0x5f55fc,function(_0x41f87d){const _0x1dc658=_0x22f471;_0x41f87d&&logError(_0x314138[_0x1dc658(0x136)],_0x41f87d);});}async[_0x387bcb(0x197)](){const _0x49f167={'zMBwv':function(_0x2acfed,_0x51560d,_0x20f698){return _0x2acfed(_0x51560d,_0x20f698);}};return new Promise((_0x3362cc,_0x23ffc5)=>{const _0x284a88=_0x1ec1,_0x586117={'GQCKk':function(_0x253759,_0x20d757,_0x9e6222){return _0x253759(_0x20d757,_0x9e6222);},'YkUxZ':_0x284a88(0x166),'WRqMo':function(_0x26689b,_0x2022e7,_0x3276b2){return _0x49f167['zMBwv'](_0x26689b,_0x2022e7,_0x3276b2);},'yOOrc':_0x284a88(0x178)};this['db']['get'](_0x284a88(0x15c),(_0x4d79eb,_0x5b2d56)=>{const _0x104612=_0x284a88;if(_0x4d79eb)return _0x586117[_0x104612(0x171)](logDebug,_0x586117[_0x104612(0x127)],_0x4d79eb),_0x3362cc(-0x7ffffff8);_0x586117[_0x104612(0x18d)](logDebug,_0x586117['yOOrc'],_0x5b2d56?.['maxId']),_0x3362cc(_0x5b2d56?.[_0x104612(0x12b)]??-0x7ffffff8);});});}async['getMsg'](_0x1fd409,_0x36e615){const _0x5d17c8=_0x387bcb,_0x294bc9={'FgnLe':function(_0xa14079,_0x42a7a6){return _0xa14079(_0x42a7a6);},'FWWiK':function(_0x3142c0,_0x2fff0b){return _0x3142c0(_0x2fff0b);},'JuGlt':function(_0x2ad873,_0x477426,_0x40a579,_0x14015e,_0x38df87){return _0x2ad873(_0x477426,_0x40a579,_0x14015e,_0x38df87);},'MfbsW':_0x5d17c8(0x14b),'llbVy':function(_0x2d8b4e,_0xdf91a8){return _0x2d8b4e(_0xdf91a8);}},_0x4d32ed=this['db'][_0x5d17c8(0x128)](_0x1fd409);return new Promise((_0x104ab1,_0x375d3a)=>{const _0x18ead4=_0x5d17c8;_0x4d32ed[_0x18ead4(0x162)](..._0x36e615,(_0x21e7f1,_0x40bb87)=>{const _0x43e086=_0x18ead4,_0x42262c={'DCVEA':function(_0x140e6b,_0x5cfab7){return _0x294bc9['FgnLe'](_0x140e6b,_0x5cfab7);},'MovhM':function(_0x4c7e86,_0x4abd96){return _0x294bc9['FWWiK'](_0x4c7e86,_0x4abd96);}};if(_0x21e7f1)return _0x294bc9[_0x43e086(0x170)](logError,_0x294bc9[_0x43e086(0x11b)],_0x21e7f1,_0x1fd409,_0x36e615),_0x294bc9[_0x43e086(0x116)](_0x104ab1,null);if(!_0x40bb87){_0x104ab1(null);return;}const _0x4b625d=_0x40bb87[_0x43e086(0x17d)];NTQQMsgApi['getMsgsByMsgId']({'peerUid':_0x40bb87[_0x43e086(0x11f)],'chatType':_0x40bb87[_0x43e086(0x19c)]},[_0x4b625d])['then'](_0x51dcfd=>{const _0x336616=_0x43e086,_0x4ff297=_0x51dcfd[_0x336616(0x17f)][0x0];if(!_0x4ff297){_0x42262c[_0x336616(0x16b)](_0x104ab1,null);return;}_0x4ff297['id']=_0x40bb87[_0x336616(0x179)],_0x42262c[_0x336616(0x139)](_0x104ab1,_0x4ff297);})['catch'](_0xe00df3=>{_0x104ab1(null);});});});}async[_0x387bcb(0x185)](_0x46dcad){const _0x1dc33d=_0x387bcb,_0x38c96b={'gZPNf':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?'};if(this[_0x1dc33d(0x148)][_0x1dc33d(0x12f)](_0x46dcad))return this[_0x1dc33d(0x148)]['get'](_0x46dcad);const _0x2b54b4=_0x38c96b[_0x1dc33d(0x17b)];return this[_0x1dc33d(0x158)](_0x2b54b4,[_0x46dcad]);}async['getMsgByLongId'](_0x2cccb0){const _0x303b70=_0x387bcb,_0x2b3bb9={'mqKgd':_0x303b70(0x146)};if(this[_0x303b70(0x148)][_0x303b70(0x12f)](_0x2cccb0))return this[_0x303b70(0x148)]['get'](_0x2cccb0);return this[_0x303b70(0x158)](_0x2b3bb9[_0x303b70(0x12a)],[_0x2cccb0]);}async[_0x387bcb(0x150)](_0x3c4bf8,_0x4a0b85){const _0x1f5d2f=_0x387bcb,_0x376c42={'cTxWt':_0x1f5d2f(0x126)},_0x755b4b=_0x376c42[_0x1f5d2f(0x18b)];return this['getMsg'](_0x755b4b,[_0x3c4bf8,_0x4a0b85]);}async[_0x387bcb(0x174)](_0x29343b,_0x4cbaba=!![]){const _0x18d585=_0x387bcb,_0x2a117b={'AwlJC':function(_0x5c8d4e,_0x1df421,_0x174395){return _0x5c8d4e(_0x1df421,_0x174395);},'ebzaL':function(_0x4dde5f,_0x3420c7,_0x3473dc){return _0x4dde5f(_0x3420c7,_0x3473dc);},'TVkDV':_0x18d585(0x147),'tgjan':_0x18d585(0x133),'qSzBm':function(_0x16f40f,_0x43fd24){return _0x16f40f(_0x43fd24);}},_0xf1b5df=await this[_0x18d585(0x121)](_0x29343b['msgId']);if(_0xf1b5df){if(_0x4cbaba)this[_0x18d585(0x18e)](_0x29343b)[_0x18d585(0x153)]();return _0xf1b5df['id'];}const _0x3a0b4b=this['db'][_0x18d585(0x128)](_0x2a117b['tgjan']),_0x43a11d=++this[_0x18d585(0x118)];return _0x29343b['id']=_0x43a11d,_0x2a117b[_0x18d585(0x16f)](logDebug,'记录消息到数据库,\x20消息长id:\x20'+_0x29343b['msgId']+_0x18d585(0x17e)+_0x29343b['id']),this['msgCache'][_0x18d585(0x196)](_0x43a11d,_0x29343b),this[_0x18d585(0x148)][_0x18d585(0x196)](_0x29343b[_0x18d585(0x11a)],_0x29343b),_0x3a0b4b['run'](this[_0x18d585(0x118)],_0x29343b[_0x18d585(0x11a)],_0x29343b[_0x18d585(0x169)]['toString'](),_0x29343b[_0x18d585(0x11f)],_0x29343b[_0x18d585(0x19c)],_0x2faaa0=>{const _0x2edd0a=_0x18d585;_0x2faaa0&&(_0x2faaa0['errno']===0x13?this[_0x2edd0a(0x121)](_0x29343b[_0x2edd0a(0x11a)])[_0x2edd0a(0x153)](_0x45c354=>{const _0x2487f0=_0x2edd0a;_0x45c354?(this['msgCache'][_0x2487f0(0x196)](_0x43a11d,_0x45c354),this['msgCache'][_0x2487f0(0x196)](_0x45c354['msgId'],_0x45c354)):_0x2a117b[_0x2487f0(0x114)](logError,'db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id',_0x2faaa0);})[_0x2edd0a(0x19a)](_0x243f69=>logError(_0x2edd0a(0x189),_0x243f69)):_0x2a117b[_0x2edd0a(0x141)](logError,_0x2a117b[_0x2edd0a(0x193)],_0x2faaa0));}),_0x43a11d;}async[_0x387bcb(0x18e)](_0x2f5552){const _0x4a509f=_0x387bcb,_0x20bb32={'jooCv':function(_0x43836e,_0x3b684f,_0x703adb){return _0x43836e(_0x3b684f,_0x703adb);},'lWJZD':_0x4a509f(0x191),'Pzaqn':function(_0x29bcd0,_0x4c0faf){return _0x29bcd0(_0x4c0faf);},'qULlA':'UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?'},_0x54bae4=this[_0x4a509f(0x148)][_0x4a509f(0x162)](_0x2f5552['msgId']);_0x54bae4&&Object[_0x4a509f(0x15a)](_0x54bae4,_0x2f5552);_0x20bb32['Pzaqn'](logDebug,_0x4a509f(0x172)+_0x2f5552['id']+_0x4a509f(0x182)+_0x2f5552[_0x4a509f(0x169)]+_0x4a509f(0x18f)+_0x2f5552['msgId']);const _0x23233e=this['db'][_0x4a509f(0x128)](_0x20bb32[_0x4a509f(0x124)]);_0x23233e[_0x4a509f(0x12e)](_0x2f5552[_0x4a509f(0x169)],_0x2f5552[_0x4a509f(0x11a)],_0x238a1a=>{const _0x326160=_0x4a509f;_0x238a1a&&_0x20bb32[_0x326160(0x195)](logError,_0x20bb32[_0x326160(0x145)],_0x238a1a);});}async['addFileCache'](_0x179ef8){const _0x8f7731={'mveuj':function(_0x4f8255,_0x23f520,_0x2728ab){return _0x4f8255(_0x23f520,_0x2728ab);},'gMoDk':function(_0x4326d6,_0x248ab4){return _0x4326d6(_0x248ab4);}},_0x2146bc=this['db']['prepare']('INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)');return new Promise((_0x38cd0e,_0x2d4824)=>{const _0x26f56e=_0x1ec1;_0x2146bc[_0x26f56e(0x12e)](_0x179ef8['name'],_0x179ef8[_0x26f56e(0x135)],_0x179ef8[_0x26f56e(0x15d)],_0x179ef8[_0x26f56e(0x176)],_0x179ef8['uuid'],_0x179ef8[_0x26f56e(0x163)],JSON[_0x26f56e(0x129)](_0x179ef8[_0x26f56e(0x14f)]),_0x179ef8[_0x26f56e(0x13f)],_0x179ef8[_0x26f56e(0x11a)],function(_0x4ad4af){const _0x482266=_0x26f56e;_0x4ad4af&&(_0x8f7731['mveuj'](logError,'db\x20could\x20not\x20add\x20file',_0x4ad4af),_0x2d4824(_0x4ad4af)),_0x8f7731[_0x482266(0x115)](_0x38cd0e,null);});});}async['getFileCache'](_0x21ff6e,_0x4c42ad){const _0x1c8940=_0x387bcb,_0x28826c={'IgLqo':function(_0x341545,_0x43b242,_0x339a41){return _0x341545(_0x43b242,_0x339a41);},'SyNnE':function(_0x49c527,_0x3b5d8e){return _0x49c527(_0x3b5d8e);}},_0x3e89d0=this['db'][_0x1c8940(0x128)](_0x21ff6e);return new Promise((_0xcce37,_0x20a4d4)=>{const _0x25fe7d=_0x1c8940,_0x4044e5={'isvux':function(_0x2e2f4,_0x4fb96f,_0x38ad5e){const _0x27dbf4=_0x1ec1;return _0x28826c[_0x27dbf4(0x14e)](_0x2e2f4,_0x4fb96f,_0x38ad5e);},'fjmKh':_0x25fe7d(0x131),'XUQQj':function(_0x126fa0,_0x53c1fc){const _0x35ed25=_0x25fe7d;return _0x28826c[_0x35ed25(0x125)](_0x126fa0,_0x53c1fc);}};_0x3e89d0['get'](..._0x4c42ad,(_0xc45a71,_0x35f2f4)=>{const _0xef02cb=_0x25fe7d;_0xc45a71&&(_0x4044e5['isvux'](logError,_0x4044e5['fjmKh'],_0xc45a71),_0x4044e5[_0xef02cb(0x152)](_0x20a4d4,_0xc45a71)),_0x35f2f4&&(_0x35f2f4[_0xef02cb(0x14f)]=JSON['parse'](_0x35f2f4[_0xef02cb(0x14f)])),_0x4044e5[_0xef02cb(0x152)](_0xcce37,_0x35f2f4);});});}async['getFileCacheByName'](_0x58ec2e){const _0x166f25=_0x387bcb;return this[_0x166f25(0x13b)](_0x166f25(0x15f),[_0x58ec2e]);}async[_0x387bcb(0x155)](_0xa6e4b9){const _0x259427=_0x387bcb,_0x47a0d7={'BSAyR':_0x259427(0x187)};return this[_0x259427(0x13b)](_0x47a0d7['BSAyR'],[_0xa6e4b9]);}async[_0x387bcb(0x160)](_0x55e643){const _0x16e32f=_0x387bcb,_0x24f046={'fyPWd':_0x16e32f(0x14d),'zOcxp':function(_0x3a682f,_0x7c00e3){return _0x3a682f(_0x7c00e3);},'elAPt':function(_0x5a30e2,_0x27a41d){return _0x5a30e2(_0x27a41d);},'hhosu':'UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?'},_0x32d003=this['db']['prepare'](_0x24f046[_0x16e32f(0x198)]);return new Promise((_0x5d3327,_0x3990f5)=>{const _0x2c4531=_0x16e32f;_0x32d003['run'](_0x55e643[_0x2c4531(0x135)],_0x55e643[_0x2c4531(0x15d)],_0x55e643[_0x2c4531(0x140)],function(_0x3b798c){const _0x281ea2=_0x2c4531;_0x3b798c&&(logError(_0x24f046[_0x281ea2(0x159)],_0x3b798c),_0x24f046['zOcxp'](_0x3990f5,_0x3b798c)),_0x24f046[_0x281ea2(0x14a)](_0x5d3327,null);});});}async[_0x387bcb(0x13d)](){const _0x592416=_0x387bcb,_0x23e831={'zFhtR':function(_0xb4670c,_0x4dbe43,_0x2909a2){return _0xb4670c(_0x4dbe43,_0x2909a2);},'HicAm':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','cuChr':function(_0x31e509,_0x3b1931){return _0x31e509(_0x3b1931);},'OMJbc':_0x592416(0x168)},_0x440ac0=_0x23e831['OMJbc'];return new Promise((_0x266d80,_0x3fc1fc)=>{const _0x59606b=_0x592416;this['db'][_0x59606b(0x18a)](_0x440ac0,(_0x3851f2,_0x392f7a)=>{const _0x333583=_0x59606b;_0x3851f2&&(_0x23e831[_0x333583(0x11e)](logError,_0x23e831[_0x333583(0x132)],_0x3851f2),_0x3fc1fc(_0x3851f2));const _0x2c9e83={};_0x392f7a[_0x333583(0x173)](_0x189941=>{const _0x3f8642=_0x333583;_0x2c9e83[_0x189941[_0x3f8642(0x165)]]=_0x189941[_0x3f8642(0x181)];}),_0x23e831['cuChr'](_0x266d80,_0x2c9e83);});});}async[_0x387bcb(0x113)](_0x9fd9e9){const _0x147224=_0x387bcb,_0x57a0fa={'TrjOs':function(_0x51d741,_0x5c1a52,_0x351f01){return _0x51d741(_0x5c1a52,_0x351f01);},'YfVmH':function(_0x3a0a37,_0xec2260){return _0x3a0a37(_0xec2260);},'qIcXK':function(_0x35c70c,_0x1e2066){return _0x35c70c(_0x1e2066);},'JIjzi':'SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?'},_0x5c62e9=_0x57a0fa[_0x147224(0x15b)];return new Promise((_0x33390e,_0x5736ea)=>{const _0x5c0246=_0x147224,_0x3edd55={'OXMEa':function(_0x16b9ed,_0xdaad2a,_0x3e211d){const _0x51471f=_0x1ec1;return _0x57a0fa[_0x51471f(0x12c)](_0x16b9ed,_0xdaad2a,_0x3e211d);},'GruNh':_0x5c0246(0x16d),'gahRc':function(_0x25547e,_0x1e2d2c){const _0x5ccf2f=_0x5c0246;return _0x57a0fa[_0x5ccf2f(0x137)](_0x25547e,_0x1e2d2c);},'bxFUz':function(_0x2d985e,_0x4b3798){return _0x57a0fa['qIcXK'](_0x2d985e,_0x4b3798);}};this['db'][_0x5c0246(0x162)](_0x5c62e9,[_0x9fd9e9],(_0x5ecc73,_0x3639a3)=>{const _0x157e0b=_0x5c0246;_0x5ecc73&&(_0x3edd55[_0x157e0b(0x17c)](logError,_0x3edd55['GruNh'],_0x5ecc73),_0x3edd55[_0x157e0b(0x123)](_0x5736ea,_0x5ecc73)),_0x3edd55[_0x157e0b(0x186)](_0x33390e,_0x3639a3?.['uid']);});});}async[_0x387bcb(0x13a)](_0x2c17ab,_0x4a2bc7){const _0x58a043=_0x387bcb,_0x3a5781={'BEQnr':function(_0x341ef8,_0x43bb56,_0x24cdad){return _0x341ef8(_0x43bb56,_0x24cdad);},'zdGHr':_0x58a043(0x180),'eaFCP':_0x58a043(0x120)},_0x5c1002=await this[_0x58a043(0x113)](_0x2c17ab);if(!_0x5c1002){const _0x905c59=this['db'][_0x58a043(0x128)](_0x3a5781[_0x58a043(0x143)]);return new Promise((_0xbbb15d,_0x512cb2)=>{const _0x3fa4c8=_0x58a043;_0x905c59[_0x3fa4c8(0x12e)](_0x2c17ab,_0x4a2bc7,function(_0x2c4922){const _0x46f8c7=_0x3fa4c8;_0x2c4922&&(_0x3a5781[_0x46f8c7(0x19d)](logError,_0x3a5781[_0x46f8c7(0x183)],_0x2c4922),_0x512cb2(_0x2c4922)),_0xbbb15d(null);});});}}}function _0x1ec1(_0x258f3a,_0x31feb5){const _0x4d2819=_0x4d28();return _0x1ec1=function(_0x1ec1ed,_0x115cff){_0x1ec1ed=_0x1ec1ed-0x113;let _0x36b9eb=_0x4d2819[_0x1ec1ed];return _0x36b9eb;},_0x1ec1(_0x258f3a,_0x31feb5);}export const dbUtil=new DBUtil();