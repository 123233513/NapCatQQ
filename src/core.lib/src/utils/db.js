const _0x335f5a=_0x4a93;function _0x4a93(_0x405514,_0x252b30){const _0xf4d208=_0xf4d2();return _0x4a93=function(_0x4a9356,_0x2fdbdb){_0x4a9356=_0x4a9356-0x1e8;let _0x2adae6=_0xf4d208[_0x4a9356];return _0x2adae6;},_0x4a93(_0x405514,_0x252b30);}(function(_0x1bea9d,_0x43af5d){const _0x1b343b=_0x4a93,_0x54f706=_0x1bea9d();while(!![]){try{const _0x52bcd0=-parseInt(_0x1b343b(0x1f5))/0x1+-parseInt(_0x1b343b(0x24c))/0x2*(-parseInt(_0x1b343b(0x20c))/0x3)+parseInt(_0x1b343b(0x222))/0x4*(parseInt(_0x1b343b(0x1fa))/0x5)+parseInt(_0x1b343b(0x21f))/0x6*(-parseInt(_0x1b343b(0x1ef))/0x7)+-parseInt(_0x1b343b(0x201))/0x8+parseInt(_0x1b343b(0x26f))/0x9+parseInt(_0x1b343b(0x24e))/0xa*(parseInt(_0x1b343b(0x23f))/0xb);if(_0x52bcd0===_0x43af5d)break;else _0x54f706['push'](_0x54f706['shift']());}catch(_0x548fbd){_0x54f706['push'](_0x54f706['shift']());}}}(_0xf4d2,0x6be78));import _0x3c8a8f from'sqlite3';function _0xf4d2(){const _0x1c3079=['globalMsgShortId','kSUkU','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','then','Aphdh','zEYuD','ukEgf','WiVml','dsvTx',',\x20短id:\x20','getUidByTempUin',',\x20seq:\x20','msgTime','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','BaeRJ','path','wrVPH','307549TFAgaN','updateFileCache','errno','close','now','updateMsg','addTempUin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','forEach','Database','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','size','Could\x20not\x20connect\x20to\x20database','2344qeJCyi','TiDRM','70QArlvv','updateMsg\x20db\x20error','cLjhh','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','uid','createTable','name','prepare','SmXoR','RXOEc','db\x20could\x20not\x20update\x20file\x20cache','msgCache','CKYaB','bPZyx','addFileCache','Could\x20not\x20create\x20table\x20msgs','EniNj','addMsg','DufJX','getCurrentMaxShortId','tDcEo','MpEAP','清理消息缓存','all','OPEN_READWRITE','nCITy','getMsgByShortId','更新消息,\x20shortId:','stack','stringify','run','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','FcEIq','4734306MWhgII','init','uin','XjXmm','delete','getFileCacheByName','vZlxc','getFileCache','YRVkW','63rDamaz','catch','peerUid','getMsgByLongId','MgZYK','数据库中消息最大短id','105291QQGver','lrnmt','DoDdm','elementId','VWTgv','15gRPDJB','LQObb','Could\x20not\x20create\x20table\x20temp_uins','longId','uuid','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','hoWdA','4503376BPiObm','Method\x20not\x20implemented.','toString','has','DnNWy','element','记录消息到数据库,\x20消息长id:\x20','QCsUN','ZBJVS','elementType','pEZWG','1227VSpDIq','XRpVw','get','bjNzg','msgId','FtgyE','db\x20getMsgByLongId\x20error',',\x20msgId:\x20','db\x20could\x20not\x20get\x20file\x20cache','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','SELECT\x20*\x20FROM\x20temp_uins','db\x20could\x20not\x20get\x20temp\x20uin\x20map','GYLcy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','getMsgsByMsgId','NeLbl','shortId','107022ISXZls','WLyLF','parse','92836nbfeIR','RprkS','gfywj','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','koskh','url','getMsg','set','Could\x20not\x20create\x20table\x20files','YdOMQ','MrdIw','msgSeq'];_0xf4d2=function(){return _0x1c3079;};return _0xf4d2();}import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async['init'](_0x5820b9){const _0xd2324b=_0x4a93,_0x809716={'QCsUN':_0xd2324b(0x24b),'bjNzg':function(_0x3f0fdd,_0x515d78){return _0x3f0fdd(_0x515d78);},'koskh':function(_0x1cc75c,_0x1c7020){return _0x1cc75c|_0x1c7020;}};if(this['db'])return;return new Promise((_0x4b9aef,_0x653c46)=>{const _0x2fd85f=_0xd2324b,_0x1af1e6={'yORGl':function(_0x432988,_0x5714d4,_0x2a5810){return _0x432988(_0x5714d4,_0x2a5810);},'SmXoR':_0x809716[_0x2fd85f(0x208)],'MrdIw':function(_0x51bb1c,_0x5bb19a){const _0xc34b05=_0x2fd85f;return _0x809716[_0xc34b05(0x20f)](_0x51bb1c,_0x5bb19a);}};this['db']=new _0x3c8a8f[(_0x2fd85f(0x248))](_0x5820b9,_0x809716[_0x2fd85f(0x226)](_0x3c8a8f[_0x2fd85f(0x266)],_0x3c8a8f['OPEN_CREATE']),_0x2ba4ae=>{const _0x4cad9b=_0x2fd85f;if(_0x2ba4ae){_0x1af1e6['yORGl'](logError,_0x1af1e6[_0x4cad9b(0x256)],_0x2ba4ae),_0x1af1e6[_0x4cad9b(0x22c)](_0x653c46,_0x2ba4ae);return;}this[_0x4cad9b(0x253)](),_0x4b9aef();});});}[_0x335f5a(0x253)](){const _0x9f3f63=_0x335f5a,_0x36a650={'FcEIq':_0x9f3f63(0x202)};throw new Error(_0x36a650[_0x9f3f63(0x26e)]);}[_0x335f5a(0x242)](){this['db']?.['close']();}}class DBUtil extends DBUtilBase{[_0x335f5a(0x259)]=new Map();[_0x335f5a(0x22e)]=-0x7ffffff8;constructor(){const _0x56c8e7=_0x335f5a,_0xca8a78={'bPZyx':function(_0x2d4887,_0x2fb724){return _0x2d4887>_0x2fb724;},'TlQGj':function(_0xc8a56d,_0x16a3b9){return _0xc8a56d-_0x16a3b9;},'NeLbl':function(_0x50656c,_0x4242d5){return _0x50656c*_0x4242d5;},'DufJX':function(_0x3a25c0,_0x315a5e){return _0x3a25c0(_0x315a5e);},'hoWdA':_0x56c8e7(0x264),'wuNOr':function(_0x34a5fa,_0x4ff117){return _0x34a5fa*_0x4ff117;},'gfywj':function(_0x6bacd3,_0xb85ebb){return _0x6bacd3*_0xb85ebb;}};super();const _0x343997=_0xca8a78['wuNOr'](_0xca8a78[_0x56c8e7(0x224)](0x3e8,0x3c),0xa);setInterval(()=>{const _0x28042c=_0x56c8e7;logDebug(_0xca8a78[_0x28042c(0x200)]),this[_0x28042c(0x259)]['forEach']((_0x2b1494,_0x4eec82)=>{const _0x3eb963=_0x28042c;_0xca8a78[_0x3eb963(0x25b)](_0xca8a78['TlQGj'](Date[_0x3eb963(0x243)](),_0xca8a78[_0x3eb963(0x21d)](_0xca8a78[_0x3eb963(0x260)](parseInt,_0x2b1494[_0x3eb963(0x23a)]),0x3e8)),_0x343997)&&this[_0x3eb963(0x259)][_0x3eb963(0x1ea)](_0x4eec82);});},_0x343997);}async[_0x335f5a(0x270)](_0xb39b1a){const _0x548f2c=_0x335f5a;await super[_0x548f2c(0x270)](_0xb39b1a),this['globalMsgShortId']=await this[_0x548f2c(0x261)]();}[_0x335f5a(0x253)](){const _0xbc7b49=_0x335f5a,_0x292d49={'WLyLF':function(_0xe9059d,_0x5b3254,_0x1d570a){return _0xe9059d(_0x5b3254,_0x1d570a);},'pEZWG':function(_0x34c152,_0x29b9f8,_0x240fcc){return _0x34c152(_0x29b9f8,_0x240fcc);},'nCITy':_0xbc7b49(0x1fc)},_0x3a2bc4=_0xbc7b49(0x219);this['db']['run'](_0x3a2bc4,function(_0x353971){const _0x77d6dc=_0xbc7b49;_0x353971&&_0x292d49[_0x77d6dc(0x220)](logError,_0x77d6dc(0x25d),_0x353971[_0x77d6dc(0x26a)]);});const _0x471d35=_0xbc7b49(0x246);this['db'][_0xbc7b49(0x26c)](_0x471d35,function(_0x4a3a8f){const _0x5041ce=_0xbc7b49;_0x4a3a8f&&_0x292d49['WLyLF'](logError,_0x5041ce(0x22a),_0x4a3a8f);});const _0x4114ff=_0xbc7b49(0x23b);this['db']['run'](_0x4114ff,function(_0x578de5){const _0x3bd60d=_0xbc7b49;_0x578de5&&_0x292d49[_0x3bd60d(0x20b)](logError,_0x292d49[_0x3bd60d(0x267)],_0x578de5);});}async[_0x335f5a(0x261)](){const _0x3aead6=_0x335f5a,_0x2b3cc1={'YdOMQ':function(_0x463872,_0x29a056,_0x245c00){return _0x463872(_0x29a056,_0x245c00);},'ZBJVS':_0x3aead6(0x251),'VWTgv':function(_0x330520,_0x1bbf5a){return _0x330520(_0x1bbf5a);},'GDQan':_0x3aead6(0x1f4),'kSUkU':'SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs'};return new Promise((_0xb2af25,_0x325d51)=>{const _0x31221c=_0x3aead6,_0x23aa15={'vGwxj':function(_0x18a550,_0xa7ef10,_0x2190e4){const _0x1d4ebf=_0x4a93;return _0x2b3cc1[_0x1d4ebf(0x22b)](_0x18a550,_0xa7ef10,_0x2190e4);},'RprkS':_0x2b3cc1[_0x31221c(0x209)],'EeOHv':function(_0x2ae718,_0x1d6700){const _0x14d4f3=_0x31221c;return _0x2b3cc1[_0x14d4f3(0x1f9)](_0x2ae718,_0x1d6700);},'WiVml':_0x2b3cc1['GDQan']};this['db'][_0x31221c(0x20e)](_0x2b3cc1[_0x31221c(0x22f)],(_0x5af74e,_0x19578b)=>{const _0x573759=_0x31221c;if(_0x5af74e)return _0x23aa15['vGwxj'](logDebug,_0x23aa15[_0x573759(0x223)],_0x5af74e),_0x23aa15['EeOHv'](_0xb2af25,-0x7ffffff8);logDebug(_0x23aa15[_0x573759(0x235)],_0x19578b?.['maxId']),_0xb2af25(_0x19578b?.['maxId']??-0x7ffffff8);});});}async['getMsg'](_0x368117,_0xe89be9){const _0x5a6e02=_0x335f5a,_0x53fce6={'kcFSG':function(_0x2540ce,_0x279402){return _0x2540ce(_0x279402);},'zEYuD':function(_0x2f77a0,_0x223d9d,_0x2f4dbd,_0xcb7c49,_0x3d1ad1){return _0x2f77a0(_0x223d9d,_0x2f4dbd,_0xcb7c49,_0x3d1ad1);},'tjpBJ':'Could\x20not\x20get\x20msg','LQObb':function(_0x522b77,_0x16fa31){return _0x522b77(_0x16fa31);},'cLjhh':function(_0x3b666f,_0x2c883a){return _0x3b666f(_0x2c883a);}},_0x1bf715=this['db'][_0x5a6e02(0x255)](_0x368117);return new Promise((_0x16e240,_0x50dc4b)=>{const _0x453763=_0x5a6e02,_0x3d7d63={'Bvuqp':function(_0x1ce63a,_0x560355){const _0x522688=_0x4a93;return _0x53fce6[_0x522688(0x250)](_0x1ce63a,_0x560355);}};_0x1bf715[_0x453763(0x20e)](..._0xe89be9,(_0x26bc54,_0x3508de)=>{const _0x40903b=_0x453763,_0x2c9202={'nmJOM':function(_0x227d73,_0x356c50){return _0x53fce6['kcFSG'](_0x227d73,_0x356c50);}};if(_0x26bc54)return _0x53fce6[_0x40903b(0x233)](logError,_0x53fce6['tjpBJ'],_0x26bc54,_0x368117,_0xe89be9),_0x53fce6[_0x40903b(0x1fb)](_0x16e240,null);if(!_0x3508de){_0x53fce6['kcFSG'](_0x16e240,null);return;}const _0x5c24a9=_0x3508de[_0x40903b(0x1fd)];NTQQMsgApi[_0x40903b(0x21c)]({'peerUid':_0x3508de[_0x40903b(0x1f1)],'chatType':_0x3508de['chatType']},[_0x5c24a9])[_0x40903b(0x231)](_0x493a4c=>{const _0x1d9074=_0x40903b,_0x4ee3ba=_0x493a4c['msgList'][0x0];if(!_0x4ee3ba){_0x3d7d63['Bvuqp'](_0x16e240,null);return;}_0x4ee3ba['id']=_0x3508de[_0x1d9074(0x21e)],_0x16e240(_0x4ee3ba);})[_0x40903b(0x1f0)](_0x282c14=>{_0x2c9202['nmJOM'](_0x16e240,null);});});});}async[_0x335f5a(0x268)](_0x4de41d){const _0x5d24c3=_0x335f5a,_0x13e086={'tDcEo':_0x5d24c3(0x230)};if(this[_0x5d24c3(0x259)]['has'](_0x4de41d))return this[_0x5d24c3(0x259)][_0x5d24c3(0x20e)](_0x4de41d);const _0x47a621=_0x13e086[_0x5d24c3(0x262)];return this[_0x5d24c3(0x228)](_0x47a621,[_0x4de41d]);}async[_0x335f5a(0x1f2)](_0x1ca477){const _0x46094d=_0x335f5a,_0x5c9e6f={'wrVPH':_0x46094d(0x215)};if(this[_0x46094d(0x259)][_0x46094d(0x204)](_0x1ca477))return this[_0x46094d(0x259)][_0x46094d(0x20e)](_0x1ca477);return this[_0x46094d(0x228)](_0x5c9e6f[_0x46094d(0x23e)],[_0x1ca477]);}async['getMsgBySeq'](_0x2692b7,_0x10bfe5){const _0x4cd930=_0x335f5a,_0x436d0a=_0x4cd930(0x21a);return this[_0x4cd930(0x228)](_0x436d0a,[_0x2692b7,_0x10bfe5]);}async[_0x335f5a(0x25f)](_0x421ec4,_0xdf45=!![]){const _0x16da95=_0x335f5a,_0x15cfb5={'IbOoY':function(_0x4bf899,_0x2b258f,_0x22eeed){return _0x4bf899(_0x2b258f,_0x22eeed);},'mKime':'db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','RXOEc':function(_0x164384,_0x57d71d){return _0x164384(_0x57d71d);}},_0x5aff55=await this['getMsgByLongId'](_0x421ec4[_0x16da95(0x210)]);if(_0x5aff55){if(_0xdf45)this[_0x16da95(0x244)](_0x421ec4)[_0x16da95(0x231)]();return _0x5aff55['id'];}const _0x25f285=this['db']['prepare']('INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)'),_0x448d35=++this[_0x16da95(0x22e)];return _0x421ec4['id']=_0x448d35,_0x15cfb5[_0x16da95(0x257)](logDebug,_0x16da95(0x207)+_0x421ec4['msgId']+_0x16da95(0x237)+_0x421ec4['id']),this[_0x16da95(0x259)][_0x16da95(0x229)](_0x448d35,_0x421ec4),this[_0x16da95(0x259)]['set'](_0x421ec4[_0x16da95(0x210)],_0x421ec4),_0x25f285['run'](this[_0x16da95(0x22e)],_0x421ec4[_0x16da95(0x210)],_0x421ec4[_0x16da95(0x22d)][_0x16da95(0x203)](),_0x421ec4[_0x16da95(0x1f1)],_0x421ec4['chatType'],_0xb0547b=>{const _0x2b8f20=_0x16da95;_0xb0547b&&(_0xb0547b[_0x2b8f20(0x241)]===0x13?this[_0x2b8f20(0x1f2)](_0x421ec4[_0x2b8f20(0x210)])[_0x2b8f20(0x231)](_0x7db0c9=>{const _0x50bda4=_0x2b8f20;_0x7db0c9?(this[_0x50bda4(0x259)][_0x50bda4(0x229)](_0x448d35,_0x7db0c9),this[_0x50bda4(0x259)]['set'](_0x7db0c9[_0x50bda4(0x210)],_0x7db0c9)):_0x15cfb5['IbOoY'](logError,_0x15cfb5['mKime'],_0xb0547b);})[_0x2b8f20(0x1f0)](_0x36898f=>logError(_0x2b8f20(0x212),_0x36898f)):logError('db\x20could\x20not\x20add\x20msg',_0xb0547b));}),_0x448d35;}async['updateMsg'](_0x423532){const _0x357ac9=_0x335f5a,_0x592e18={'TiDRM':function(_0x2a83be,_0x2d045f,_0x2d908e){return _0x2a83be(_0x2d045f,_0x2d908e);},'BkbNU':function(_0xd0f046,_0x4b0017){return _0xd0f046(_0x4b0017);},'JYVas':'UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?'},_0x32a498=this['msgCache']['get'](_0x423532[_0x357ac9(0x210)]);_0x32a498&&Object['assign'](_0x32a498,_0x423532);_0x592e18['BkbNU'](logDebug,_0x357ac9(0x269)+_0x423532['id']+_0x357ac9(0x239)+_0x423532['msgSeq']+_0x357ac9(0x213)+_0x423532[_0x357ac9(0x210)]);const _0x3e6730=this['db'][_0x357ac9(0x255)](_0x592e18['JYVas']);_0x3e6730[_0x357ac9(0x26c)](_0x423532[_0x357ac9(0x22d)],_0x423532[_0x357ac9(0x210)],_0x50d4d3=>{const _0xe8f5eb=_0x357ac9;_0x50d4d3&&_0x592e18[_0xe8f5eb(0x24d)](logError,_0xe8f5eb(0x24f),_0x50d4d3);});}async[_0x335f5a(0x25c)](_0x1ed84e){const _0x844394=_0x335f5a,_0x3b12a4={'QsLtL':function(_0x564299,_0x278d46){return _0x564299(_0x278d46);},'GYLcy':function(_0x1e7b1b,_0x24a1e5){return _0x1e7b1b(_0x24a1e5);},'XFEeq':_0x844394(0x21b)},_0x212d8b=this['db'][_0x844394(0x255)](_0x3b12a4['XFEeq']);return new Promise((_0x1f35b9,_0x3769e5)=>{const _0x2b6b43=_0x844394;_0x212d8b[_0x2b6b43(0x26c)](_0x1ed84e[_0x2b6b43(0x254)],_0x1ed84e[_0x2b6b43(0x23d)],_0x1ed84e[_0x2b6b43(0x227)],_0x1ed84e[_0x2b6b43(0x24a)],_0x1ed84e[_0x2b6b43(0x1fe)],_0x1ed84e[_0x2b6b43(0x20a)],JSON[_0x2b6b43(0x26b)](_0x1ed84e['element']),_0x1ed84e[_0x2b6b43(0x1f8)],_0x1ed84e[_0x2b6b43(0x210)],function(_0x185906){const _0x4b1664=_0x2b6b43;_0x185906&&(logError('db\x20could\x20not\x20add\x20file',_0x185906),_0x3b12a4['QsLtL'](_0x3769e5,_0x185906)),_0x3b12a4[_0x4b1664(0x218)](_0x1f35b9,null);});});}async[_0x335f5a(0x1ed)](_0x2701df,_0x399985){const _0x2811e4=_0x335f5a,_0x1a5cb0={'XRpVw':_0x2811e4(0x214),'XjXmm':function(_0x53f911,_0x7c799e){return _0x53f911(_0x7c799e);}},_0x4d4378=this['db'][_0x2811e4(0x255)](_0x2701df);return new Promise((_0x90a203,_0x53f6e7)=>{const _0x125b15=_0x2811e4;_0x4d4378[_0x125b15(0x20e)](..._0x399985,(_0x45d966,_0x203ee1)=>{const _0x261dae=_0x125b15;_0x45d966&&(logError(_0x1a5cb0[_0x261dae(0x20d)],_0x45d966),_0x1a5cb0[_0x261dae(0x1e9)](_0x53f6e7,_0x45d966)),_0x203ee1&&(_0x203ee1[_0x261dae(0x206)]=JSON[_0x261dae(0x221)](_0x203ee1[_0x261dae(0x206)])),_0x1a5cb0['XjXmm'](_0x90a203,_0x203ee1);});});}async[_0x335f5a(0x1eb)](_0x42791c){const _0x4fe33b=_0x335f5a,_0x1aba8c={'lrnmt':_0x4fe33b(0x26d)};return this['getFileCache'](_0x1aba8c[_0x4fe33b(0x1f6)],[_0x42791c]);}async['getFileCacheByUuid'](_0x4c2671){const _0x1768e2=_0x335f5a,_0x11ff1a={'MgZYK':_0x1768e2(0x1ff)};return this[_0x1768e2(0x1ed)](_0x11ff1a[_0x1768e2(0x1f3)],[_0x4c2671]);}async[_0x335f5a(0x240)](_0x584677){const _0x56886d=_0x335f5a,_0x47d10c={'MpEAP':function(_0x59878d,_0x72bef7,_0x56799b){return _0x59878d(_0x72bef7,_0x56799b);},'CKYaB':_0x56886d(0x258),'vZlxc':_0x56886d(0x225)},_0x52c9b1=this['db'][_0x56886d(0x255)](_0x47d10c[_0x56886d(0x1ec)]);return new Promise((_0x241557,_0x49b1e4)=>{const _0x145b22=_0x56886d,_0x438517={'WfTxV':function(_0x3d3d1a,_0x3cbcc0,_0x1a7e76){const _0x1044de=_0x4a93;return _0x47d10c[_0x1044de(0x263)](_0x3d3d1a,_0x3cbcc0,_0x1a7e76);},'dsvTx':_0x47d10c[_0x145b22(0x25a)],'DoDdm':function(_0x39f9d9,_0x33ffed){return _0x39f9d9(_0x33ffed);}};_0x52c9b1[_0x145b22(0x26c)](_0x584677[_0x145b22(0x23d)],_0x584677[_0x145b22(0x227)],_0x584677[_0x145b22(0x1fe)],function(_0x2612b3){const _0x393134=_0x145b22;_0x2612b3&&(_0x438517['WfTxV'](logError,_0x438517[_0x393134(0x236)],_0x2612b3),_0x49b1e4(_0x2612b3)),_0x438517[_0x393134(0x1f7)](_0x241557,null);});});}async['getReceivedTempUinMap'](){const _0xe9a7d1=_0x335f5a,_0x116a54={'IPnpC':function(_0x43ff8d,_0x3660e7,_0x1d92eb){return _0x43ff8d(_0x3660e7,_0x1d92eb);},'Aphdh':_0xe9a7d1(0x217),'BaeRJ':function(_0x262a5f,_0x5b92fd){return _0x262a5f(_0x5b92fd);},'YRVkW':function(_0x4e20ce,_0x4ba6e0){return _0x4e20ce(_0x4ba6e0);},'noiMU':_0xe9a7d1(0x216)},_0x1a8320=_0x116a54['noiMU'];return new Promise((_0x2968bd,_0x3d820d)=>{const _0x156270=_0xe9a7d1;this['db'][_0x156270(0x265)](_0x1a8320,(_0x3663c2,_0x2d8f5a)=>{const _0xfdadef=_0x156270;_0x3663c2&&(_0x116a54['IPnpC'](logError,_0x116a54[_0xfdadef(0x232)],_0x3663c2),_0x116a54[_0xfdadef(0x23c)](_0x3d820d,_0x3663c2));const _0x1334ec={};_0x2d8f5a[_0xfdadef(0x247)](_0x2d2194=>{const _0x1b157f=_0xfdadef;_0x1334ec[_0x2d2194[_0x1b157f(0x1e8)]]=_0x2d2194[_0x1b157f(0x252)];}),_0x116a54[_0xfdadef(0x1ee)](_0x2968bd,_0x1334ec);});});}async[_0x335f5a(0x238)](_0x2157a4){const _0x347de5=_0x335f5a,_0x44e367={'EniNj':function(_0x1cb212,_0x5acc44,_0xb6782f){return _0x1cb212(_0x5acc44,_0xb6782f);},'FKPxV':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','NGuqh':function(_0x135f3c,_0x11059c){return _0x135f3c(_0x11059c);}},_0x1ec6ee=_0x347de5(0x249);return new Promise((_0x4e2dd4,_0x4888d5)=>{const _0x348ea6=_0x347de5;this['db'][_0x348ea6(0x20e)](_0x1ec6ee,[_0x2157a4],(_0x5d53d0,_0xf6925d)=>{const _0x7b1525=_0x348ea6;_0x5d53d0&&(_0x44e367[_0x7b1525(0x25e)](logError,_0x44e367['FKPxV'],_0x5d53d0),_0x4888d5(_0x5d53d0)),_0x44e367['NGuqh'](_0x4e2dd4,_0xf6925d?.[_0x7b1525(0x252)]);});});}async[_0x335f5a(0x245)](_0x3a7f07,_0x2248ee){const _0x4ada18=_0x335f5a,_0x5333c7={'FtgyE':'db\x20could\x20not\x20add\x20temp\x20uin','DnNWy':function(_0x36c5d2,_0x20f7f7){return _0x36c5d2(_0x20f7f7);},'UIcys':'INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)'},_0x2a9520=await this['getUidByTempUin'](_0x3a7f07);if(!_0x2a9520){const _0x5adcbd=this['db'][_0x4ada18(0x255)](_0x5333c7['UIcys']);return new Promise((_0x590770,_0x514047)=>{const _0x20400c=_0x4ada18,_0x44caa4={'ukEgf':_0x5333c7[_0x20400c(0x211)],'bZKRA':function(_0x5a2579,_0x40a389){const _0x26eace=_0x20400c;return _0x5333c7[_0x26eace(0x205)](_0x5a2579,_0x40a389);}};_0x5adcbd['run'](_0x3a7f07,_0x2248ee,function(_0x3fb206){const _0x24a01c=_0x20400c;_0x3fb206&&(logError(_0x44caa4[_0x24a01c(0x234)],_0x3fb206),_0x514047(_0x3fb206)),_0x44caa4['bZKRA'](_0x590770,null);});});}}}export const dbUtil=new DBUtil();