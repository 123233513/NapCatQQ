const _0x8b3eaf=_0x57e2;function _0x36c3(){const _0x1d02b4=['EBbiX','qMmsu','Could\x20not\x20create\x20table\x20msgs','forEach','14024iUCuUO','delete','lkkef','peerUid','PfVCJ','hivXF','toString','Database','feHsd','get','createTable','yeLjF','UMOwt','db\x20getMsgByLongId\x20error','15262lEhuZW','HSbyf','init','msgSeq','290440ZwOeWL','ffzOe','db\x20could\x20not\x20add\x20msg','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','PwRpq','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','msgTime','SRptl','prepare','Vgzck','set','getMsg','element','518991jbtcaK','SsGvE','getMsgByLongId','getMsgBySeq','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','22dyscjI','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','msgCache','uapmk','1117745BjGPNq','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','errno','21qyGUAA','kpmAd','addFileCache','all','msgList','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','mBgiP','updateMsg\x20db\x20error','bmJVN','catch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','lsGAZ','updateMsg','jTmmg','db\x20could\x20not\x20add\x20temp\x20uin','WZckF','cHTdV','OPEN_READWRITE','gdwlI','uuid','parse','run','OJtdW','4TCHIRs','清理消息缓存','brgHj','getUidByTempUin','19730scfnOk','Could\x20not\x20create\x20table\x20temp_uins','path','SSCJr','RhaHy','chatType','db\x20could\x20not\x20get\x20temp\x20uin\x20map','tpIPw','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','then','wKggL','msgId','vYpEB','maxId','72078hIVnUk','uin','xAzMt','xPPxl','getFileCacheByName','elementId','BsitP','jUcOC','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','tZDqG','db\x20could\x20not\x20add\x20file',',\x20seq:\x20','261vTXGWG','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','ohVXX','Method\x20not\x20implemented.','数据库中消息最大短id','SELECT\x20*\x20FROM\x20temp_uins','jRaNx','stringify','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','更新消息,\x20shortId:','Could\x20not\x20get\x20msg','oRORh','Could\x20not\x20connect\x20to\x20database','db\x20could\x20not\x20update\x20file\x20cache','addMsg','sgSpo','NEgBm','close','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','147PDBXjX','globalMsgShortId','yNxQd','addTempUin','eciqq','PbQqG','CzYQe','KiaTz',',\x20msgId:\x20','Could\x20not\x20create\x20table\x20files','getFileCache','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','urGkM','assign','longId','5748ThBMfw','name','FFmXM','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)',',\x20短id:\x20','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','ImBKV','gweth','getCurrentMaxShortId'];_0x36c3=function(){return _0x1d02b4;};return _0x36c3();}(function(_0x4343fd,_0xff074c){const _0x1595ef=_0x57e2,_0x2aa685=_0x4343fd();while(!![]){try{const _0x187825=parseInt(_0x1595ef(0xbe))/0x1*(parseInt(_0x1595ef(0xd9))/0x2)+parseInt(_0x1595ef(0xb1))/0x3+parseInt(_0x1595ef(0xd5))/0x4*(parseInt(_0x1595ef(0xba))/0x5)+parseInt(_0x1595ef(0xe7))/0x6*(parseInt(_0x1595ef(0x106))/0x7)+-parseInt(_0x1595ef(0x122))/0x8*(parseInt(_0x1595ef(0xf3))/0x9)+parseInt(_0x1595ef(0xa4))/0xa*(-parseInt(_0x1595ef(0xb6))/0xb)+parseInt(_0x1595ef(0x115))/0xc*(-parseInt(_0x1595ef(0x130))/0xd);if(_0x187825===_0xff074c)break;else _0x2aa685['push'](_0x2aa685['shift']());}catch(_0x22abc1){_0x2aa685['push'](_0x2aa685['shift']());}}}(_0x36c3,0x2d189));import _0x572174 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async['init'](_0x592273){const _0x316180={'BsitP':function(_0x57481b){return _0x57481b();},'eciqq':function(_0x1487a2,_0x36147e){return _0x1487a2|_0x36147e;}};if(this['db'])return;return new Promise((_0x453b7a,_0x25ae6b)=>{const _0x2d9547=_0x57e2;this['db']=new _0x572174[(_0x2d9547(0x129))](_0x592273,_0x316180[_0x2d9547(0x10a)](_0x572174[_0x2d9547(0xcf)],_0x572174['OPEN_CREATE']),_0x2cd0f8=>{const _0x15d60d=_0x2d9547;if(_0x2cd0f8){logError(_0x15d60d(0xff),_0x2cd0f8),_0x25ae6b(_0x2cd0f8);return;}this[_0x15d60d(0x12c)](),_0x316180[_0x15d60d(0xed)](_0x453b7a);});});}[_0x8b3eaf(0x12c)](){const _0x155cd0=_0x8b3eaf,_0x4317f0={'sgSpo':_0x155cd0(0xf6)};throw new Error(_0x4317f0[_0x155cd0(0x102)]);}['close'](){const _0x2e9e09=_0x8b3eaf;this['db']?.[_0x2e9e09(0x104)]();}}class DBUtil extends DBUtilBase{[_0x8b3eaf(0xb8)]=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x39417f=_0x8b3eaf,_0x2b22de={'kdXno':function(_0x305e3a,_0x582546){return _0x305e3a>_0x582546;},'tpIPw':function(_0x5a4ffa,_0x27c444){return _0x5a4ffa-_0x27c444;},'hochJ':function(_0x219a01,_0x79abae){return _0x219a01*_0x79abae;},'yNxQd':function(_0x59c5f3,_0x48cc11){return _0x59c5f3(_0x48cc11);},'eUlWT':function(_0xa482ff,_0x272526){return _0xa482ff(_0x272526);},'HSbyf':_0x39417f(0xd6),'yeLjF':function(_0x36d1b5,_0x3f4f5f){return _0x36d1b5*_0x3f4f5f;},'gweth':function(_0x351154,_0x225a38,_0x567a8a){return _0x351154(_0x225a38,_0x567a8a);}};super();const _0x255717=_0x2b22de[_0x39417f(0x12d)](0x3e8,0x3c)*0xa;_0x2b22de[_0x39417f(0x11c)](setInterval,()=>{const _0x31bda1=_0x39417f;_0x2b22de['eUlWT'](logDebug,_0x2b22de[_0x31bda1(0x131)]),this[_0x31bda1(0xb8)][_0x31bda1(0x121)]((_0x38d4a4,_0x40b704)=>{const _0x18444d=_0x31bda1;_0x2b22de['kdXno'](_0x2b22de[_0x18444d(0xe0)](Date['now'](),_0x2b22de['hochJ'](_0x2b22de[_0x18444d(0x108)](parseInt,_0x38d4a4[_0x18444d(0xaa)]),0x3e8)),_0x255717)&&this['msgCache'][_0x18444d(0x123)](_0x40b704);});},_0x255717);}async['init'](_0x1804f1){const _0x406d33=_0x8b3eaf;await super[_0x406d33(0x132)](_0x1804f1),this[_0x406d33(0x107)]=await this[_0x406d33(0x11d)]();}[_0x8b3eaf(0x12c)](){const _0x1164c8=_0x8b3eaf,_0x5eaa2c={'ffzOe':function(_0x365d89,_0x14b45f,_0x12f597){return _0x365d89(_0x14b45f,_0x12f597);},'UMOwt':_0x1164c8(0x120),'PfVCJ':_0x1164c8(0x10f),'jUcOC':_0x1164c8(0xda)},_0x2d4f99=_0x1164c8(0xe1);this['db']['run'](_0x2d4f99,function(_0x4c44d8){const _0x4ca0e1=_0x1164c8;_0x4c44d8&&_0x5eaa2c[_0x4ca0e1(0xa5)](logError,_0x5eaa2c[_0x4ca0e1(0x12e)],_0x4c44d8['stack']);});const _0x5cfbc6=_0x1164c8(0xb5);this['db'][_0x1164c8(0xd3)](_0x5cfbc6,function(_0xd2703e){const _0x5512b9=_0x1164c8;_0xd2703e&&_0x5eaa2c[_0x5512b9(0xa5)](logError,_0x5eaa2c[_0x5512b9(0x126)],_0xd2703e);});const _0xde1b0e=_0x1164c8(0xc8);this['db'][_0x1164c8(0xd3)](_0xde1b0e,function(_0x5190a2){const _0x161fa0=_0x1164c8;_0x5190a2&&_0x5eaa2c[_0x161fa0(0xa5)](logError,_0x5eaa2c[_0x161fa0(0xee)],_0x5190a2);});}async[_0x8b3eaf(0x11d)](){const _0x18f60b=_0x8b3eaf,_0x4d98d3={'RhaHy':function(_0x3469b7,_0x51ec2d,_0x72b6c9){return _0x3469b7(_0x51ec2d,_0x72b6c9);},'kpmAd':_0x18f60b(0xa9),'RHZoE':function(_0x5978b5,_0x3e6072){return _0x5978b5(_0x3e6072);},'hivXF':function(_0x2374d6,_0x57bc77,_0x4f0dff){return _0x2374d6(_0x57bc77,_0x4f0dff);},'Vgzck':_0x18f60b(0xf7),'oStla':_0x18f60b(0xf4)};return new Promise((_0x16e80e,_0x48e61d)=>{const _0x442de5=_0x18f60b;this['db'][_0x442de5(0x12b)](_0x4d98d3['oStla'],(_0x1630ec,_0x369b16)=>{const _0x9b0c13=_0x442de5;if(_0x1630ec)return _0x4d98d3[_0x9b0c13(0xdd)](logDebug,_0x4d98d3[_0x9b0c13(0xbf)],_0x1630ec),_0x4d98d3['RHZoE'](_0x16e80e,-0x7ffffff8);_0x4d98d3[_0x9b0c13(0x127)](logDebug,_0x4d98d3[_0x9b0c13(0xad)],_0x369b16?.[_0x9b0c13(0xe6)]),_0x16e80e(_0x369b16?.[_0x9b0c13(0xe6)]??-0x7ffffff8);});});}async['getMsg'](_0x5662d7,_0x5d2a5b){const _0x1fc012=_0x8b3eaf,_0x38b93a={'uapmk':function(_0xdeb563,_0x4d3a85){return _0xdeb563(_0x4d3a85);},'feHsd':_0x1fc012(0xfd)},_0x154055=this['db'][_0x1fc012(0xac)](_0x5662d7);return new Promise((_0x2918c8,_0x2429d4)=>{const _0x257edd=_0x1fc012,_0x1a2e87={'wKggL':function(_0x259d83,_0xea1195){const _0x1fdc7d=_0x57e2;return _0x38b93a[_0x1fdc7d(0xb9)](_0x259d83,_0xea1195);},'PbQqG':function(_0x4f5b97,_0x12916c,_0x1b8165,_0x338308,_0x8a17bb){return _0x4f5b97(_0x12916c,_0x1b8165,_0x338308,_0x8a17bb);},'NEgBm':_0x38b93a[_0x257edd(0x12a)]};_0x154055[_0x257edd(0x12b)](..._0x5d2a5b,(_0x3400a5,_0x285eaa)=>{const _0x502f0c=_0x257edd;if(_0x3400a5)return _0x1a2e87[_0x502f0c(0x10b)](logError,_0x1a2e87[_0x502f0c(0x103)],_0x3400a5,_0x5662d7,_0x5d2a5b),_0x1a2e87['wKggL'](_0x2918c8,null);if(!_0x285eaa){_0x1a2e87[_0x502f0c(0xe3)](_0x2918c8,null);return;}const _0xc897d8=_0x285eaa[_0x502f0c(0x114)];NTQQMsgApi['getMsgsByMsgId']({'peerUid':_0x285eaa['peerUid'],'chatType':_0x285eaa[_0x502f0c(0xde)]},[_0xc897d8])['then'](_0x42a228=>{const _0x5a4869=_0x502f0c,_0x415b52=_0x42a228[_0x5a4869(0xc2)][0x0];if(!_0x415b52){_0x1a2e87[_0x5a4869(0xe3)](_0x2918c8,null);return;}_0x415b52['id']=_0x285eaa['shortId'],_0x2918c8(_0x415b52);})[_0x502f0c(0xc7)](_0x58500e=>{_0x2918c8(null);});});});}async['getMsgByShortId'](_0x514bdd){const _0x5ad528=_0x8b3eaf,_0x393b8c={'SSCJr':_0x5ad528(0x105)};if(this[_0x5ad528(0xb8)]['has'](_0x514bdd))return this['msgCache'][_0x5ad528(0x12b)](_0x514bdd);const _0xd58a5a=_0x393b8c[_0x5ad528(0xdc)];return this[_0x5ad528(0xaf)](_0xd58a5a,[_0x514bdd]);}async[_0x8b3eaf(0xb3)](_0x4a0e2){const _0x58e88e=_0x8b3eaf,_0x20d465={'jRaNx':_0x58e88e(0xbb)};if(this['msgCache']['has'](_0x4a0e2))return this[_0x58e88e(0xb8)]['get'](_0x4a0e2);return this[_0x58e88e(0xaf)](_0x20d465[_0x58e88e(0xf9)],[_0x4a0e2]);}async[_0x8b3eaf(0xb4)](_0x2cf764,_0x55c396){const _0x35bfa1=_0x8b3eaf,_0x524b14=_0x35bfa1(0xbc);return this[_0x35bfa1(0xaf)](_0x524b14,[_0x2cf764,_0x55c396]);}async[_0x8b3eaf(0x101)](_0x51c46b,_0xc117b8=!![]){const _0x5f2345=_0x8b3eaf,_0x2f9bbb={'CzYQe':function(_0x329f49,_0x874686){return _0x329f49===_0x874686;},'ohVXX':_0x5f2345(0xa6),'ocBrU':_0x5f2345(0xa7)},_0x508f03=await this['getMsgByLongId'](_0x51c46b[_0x5f2345(0xe4)]);if(_0x508f03){if(_0xc117b8)this[_0x5f2345(0xca)](_0x51c46b)[_0x5f2345(0xe2)]();return _0x508f03['id'];}const _0x2fdf6e=this['db']['prepare'](_0x2f9bbb['ocBrU']),_0x31e5ac=++this[_0x5f2345(0x107)];return _0x51c46b['id']=_0x31e5ac,logDebug('记录消息到数据库,\x20消息长id:\x20'+_0x51c46b[_0x5f2345(0xe4)]+_0x5f2345(0x119)+_0x51c46b['id']),this['msgCache'][_0x5f2345(0xae)](_0x31e5ac,_0x51c46b),this[_0x5f2345(0xb8)][_0x5f2345(0xae)](_0x51c46b['msgId'],_0x51c46b),_0x2fdf6e[_0x5f2345(0xd3)](this[_0x5f2345(0x107)],_0x51c46b[_0x5f2345(0xe4)],_0x51c46b['msgSeq'][_0x5f2345(0x128)](),_0x51c46b[_0x5f2345(0x125)],_0x51c46b['chatType'],_0x5b4737=>{const _0x36ba60=_0x5f2345;_0x5b4737&&(_0x2f9bbb[_0x36ba60(0x10c)](_0x5b4737[_0x36ba60(0xbd)],0x13)?this[_0x36ba60(0xb3)](_0x51c46b[_0x36ba60(0xe4)])['then'](_0x543858=>{const _0xe9a579=_0x36ba60;_0x543858?(this[_0xe9a579(0xb8)][_0xe9a579(0xae)](_0x31e5ac,_0x543858),this['msgCache'][_0xe9a579(0xae)](_0x543858[_0xe9a579(0xe4)],_0x543858)):logError(_0xe9a579(0x11a),_0x5b4737);})[_0x36ba60(0xc7)](_0x52939e=>logError(_0x36ba60(0x12f),_0x52939e)):logError(_0x2f9bbb[_0x36ba60(0xf5)],_0x5b4737));}),_0x31e5ac;}async[_0x8b3eaf(0xca)](_0x416696){const _0x167683=_0x8b3eaf,_0x2fd8ba={'ycwQp':function(_0x268b7c,_0x205350,_0x43d0a8){return _0x268b7c(_0x205350,_0x43d0a8);},'urGkM':_0x167683(0xc5),'FFmXM':function(_0x359e20,_0x3cb1ef){return _0x359e20(_0x3cb1ef);},'bmJVN':_0x167683(0xef)},_0x3723b0=this['msgCache']['get'](_0x416696[_0x167683(0xe4)]);_0x3723b0&&Object[_0x167683(0x113)](_0x3723b0,_0x416696);_0x2fd8ba[_0x167683(0x117)](logDebug,_0x167683(0xfc)+_0x416696['id']+_0x167683(0xf2)+_0x416696[_0x167683(0x133)]+_0x167683(0x10e)+_0x416696['msgId']);const _0x127d57=this['db'][_0x167683(0xac)](_0x2fd8ba[_0x167683(0xc6)]);_0x127d57[_0x167683(0xd3)](_0x416696[_0x167683(0x133)],_0x416696[_0x167683(0xe4)],_0xbac90d=>{const _0xb2a2ff=_0x167683;_0xbac90d&&_0x2fd8ba['ycwQp'](logError,_0x2fd8ba[_0xb2a2ff(0x112)],_0xbac90d);});}async[_0x8b3eaf(0xc0)](_0x453328){const _0xfdb65a=_0x8b3eaf,_0x671d59={'lsGAZ':function(_0x548e26,_0x3228e3,_0x28d167){return _0x548e26(_0x3228e3,_0x28d167);},'zQuer':_0xfdb65a(0x118)},_0x3640aa=this['db'][_0xfdb65a(0xac)](_0x671d59['zQuer']);return new Promise((_0xbfa9b4,_0x4720f1)=>{const _0x1aa9af=_0xfdb65a,_0x2afee9={'gdwlI':function(_0x7c5ba,_0x4aa27e,_0x4e9b64){const _0xbca27f=_0x57e2;return _0x671d59[_0xbca27f(0xc9)](_0x7c5ba,_0x4aa27e,_0x4e9b64);},'vYpEB':function(_0x494708,_0x5014c7){return _0x494708(_0x5014c7);}};_0x3640aa[_0x1aa9af(0xd3)](_0x453328[_0x1aa9af(0x116)],_0x453328[_0x1aa9af(0xdb)],_0x453328['url'],_0x453328['size'],_0x453328[_0x1aa9af(0xd1)],_0x453328['elementType'],JSON[_0x1aa9af(0xfa)](_0x453328['element']),_0x453328[_0x1aa9af(0xec)],_0x453328[_0x1aa9af(0xe4)],function(_0x35bf8b){const _0x10c3be=_0x1aa9af;_0x35bf8b&&(_0x2afee9[_0x10c3be(0xd0)](logError,_0x10c3be(0xf1),_0x35bf8b),_0x4720f1(_0x35bf8b)),_0x2afee9[_0x10c3be(0xe5)](_0xbfa9b4,null);});});}async[_0x8b3eaf(0x110)](_0x3993cb,_0x2bcc50){const _0x4230e2={'xAzMt':'db\x20could\x20not\x20get\x20file\x20cache','lCTuk':function(_0x4aa945,_0x12daa8){return _0x4aa945(_0x12daa8);}},_0x3458c8=this['db']['prepare'](_0x3993cb);return new Promise((_0x37de5f,_0x2c37ea)=>{const _0x133ddb=_0x57e2,_0x51dec6={'ImBKV':_0x4230e2[_0x133ddb(0xe9)],'brgHj':function(_0x1721e8,_0x212d1e){return _0x4230e2['lCTuk'](_0x1721e8,_0x212d1e);},'SRptl':function(_0x4ca43e,_0x5987ea){return _0x4ca43e(_0x5987ea);}};_0x3458c8['get'](..._0x2bcc50,(_0x1751f7,_0x51ddc4)=>{const _0x26e2a8=_0x133ddb;_0x1751f7&&(logError(_0x51dec6[_0x26e2a8(0x11b)],_0x1751f7),_0x51dec6[_0x26e2a8(0xd7)](_0x2c37ea,_0x1751f7)),_0x51ddc4&&(_0x51ddc4[_0x26e2a8(0xb0)]=JSON[_0x26e2a8(0xd2)](_0x51ddc4['element'])),_0x51dec6[_0x26e2a8(0xab)](_0x37de5f,_0x51ddc4);});});}async[_0x8b3eaf(0xeb)](_0x52978a){const _0x8587dd=_0x8b3eaf,_0x5340ed={'lkkef':_0x8587dd(0xfb)};return this[_0x8587dd(0x110)](_0x5340ed[_0x8587dd(0x124)],[_0x52978a]);}async['getFileCacheByUuid'](_0x48e540){const _0x49043a=_0x8b3eaf;return this[_0x49043a(0x110)]('SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?',[_0x48e540]);}async['updateFileCache'](_0x80ca58){const _0x574b24=_0x8b3eaf,_0x4ccbda={'XdiXE':function(_0x1a3c1a,_0x5da923,_0x3d2ffd){return _0x1a3c1a(_0x5da923,_0x3d2ffd);},'jTmmg':function(_0x29ff3a,_0x314644){return _0x29ff3a(_0x314644);},'qMmsu':_0x574b24(0xb7)},_0x3d3293=this['db'][_0x574b24(0xac)](_0x4ccbda[_0x574b24(0x11f)]);return new Promise((_0x541971,_0x1e9912)=>{const _0x30432b=_0x574b24;_0x3d3293[_0x30432b(0xd3)](_0x80ca58['path'],_0x80ca58['url'],_0x80ca58[_0x30432b(0xd1)],function(_0x521a58){const _0x3d5d16=_0x30432b;_0x521a58&&(_0x4ccbda['XdiXE'](logError,_0x3d5d16(0x100),_0x521a58),_0x4ccbda[_0x3d5d16(0xcb)](_0x1e9912,_0x521a58)),_0x4ccbda['jTmmg'](_0x541971,null);});});}async['getReceivedTempUinMap'](){const _0x315bec=_0x8b3eaf,_0x1ffe44={'KiaTz':function(_0x2c17a6,_0x38af86,_0x3a06d6){return _0x2c17a6(_0x38af86,_0x3a06d6);},'EBbiX':function(_0x294dbe,_0x3a57e5){return _0x294dbe(_0x3a57e5);},'cHTdV':function(_0x3b2a7b,_0x1ac70c){return _0x3b2a7b(_0x1ac70c);}},_0x358d00=_0x315bec(0xf8);return new Promise((_0x47fa89,_0x697131)=>{const _0x5ba772=_0x315bec;this['db'][_0x5ba772(0xc1)](_0x358d00,(_0x549a04,_0x1cb179)=>{const _0x1366ac=_0x5ba772;_0x549a04&&(_0x1ffe44[_0x1366ac(0x10d)](logError,_0x1366ac(0xdf),_0x549a04),_0x1ffe44[_0x1366ac(0x11e)](_0x697131,_0x549a04));const _0x2add75={};_0x1cb179['forEach'](_0x5cc30e=>{const _0xdcec97=_0x1366ac;_0x2add75[_0x5cc30e[_0xdcec97(0xe8)]]=_0x5cc30e['uid'];}),_0x1ffe44[_0x1366ac(0xce)](_0x47fa89,_0x2add75);});});}async[_0x8b3eaf(0xd8)](_0x2abc04){const _0x385f04=_0x8b3eaf,_0x4082be={'PwRpq':function(_0x1960d1,_0x307305,_0x25780d){return _0x1960d1(_0x307305,_0x25780d);},'OJtdW':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','tZDqG':function(_0x51fb98,_0x2a91fe){return _0x51fb98(_0x2a91fe);},'xPPxl':_0x385f04(0xc3)},_0x5ba749=_0x4082be[_0x385f04(0xea)];return new Promise((_0x979ea6,_0x330855)=>{const _0x24c6f0=_0x385f04;this['db'][_0x24c6f0(0x12b)](_0x5ba749,[_0x2abc04],(_0x3b9bc2,_0x374438)=>{const _0x55638b=_0x24c6f0;_0x3b9bc2&&(_0x4082be[_0x55638b(0xa8)](logError,_0x4082be[_0x55638b(0xd4)],_0x3b9bc2),_0x4082be['tZDqG'](_0x330855,_0x3b9bc2)),_0x4082be[_0x55638b(0xf0)](_0x979ea6,_0x374438?.['uid']);});});}async[_0x8b3eaf(0x109)](_0x534bd1,_0x526078){const _0x64b795=_0x8b3eaf,_0xcfd4d2={'WZckF':function(_0x1311d0,_0x23757d,_0x59762e){return _0x1311d0(_0x23757d,_0x59762e);},'mBgiP':_0x64b795(0xcc),'SsGvE':function(_0x2e45bb,_0x4c267e){return _0x2e45bb(_0x4c267e);},'oRORh':_0x64b795(0x111)},_0xeedbc7=await this[_0x64b795(0xd8)](_0x534bd1);if(!_0xeedbc7){const _0xbf199=this['db'][_0x64b795(0xac)](_0xcfd4d2[_0x64b795(0xfe)]);return new Promise((_0xf2f4a2,_0x3d7bd4)=>{_0xbf199['run'](_0x534bd1,_0x526078,function(_0x146044){const _0x47fadb=_0x57e2;_0x146044&&(_0xcfd4d2[_0x47fadb(0xcd)](logError,_0xcfd4d2[_0x47fadb(0xc4)],_0x146044),_0xcfd4d2[_0x47fadb(0xb2)](_0x3d7bd4,_0x146044)),_0xcfd4d2[_0x47fadb(0xb2)](_0xf2f4a2,null);});});}}}function _0x57e2(_0x4e478c,_0x1fed25){const _0x36c381=_0x36c3();return _0x57e2=function(_0x57e24f,_0xdec2ae){_0x57e24f=_0x57e24f-0xa4;let _0xbabb8c=_0x36c381[_0x57e24f];return _0xbabb8c;},_0x57e2(_0x4e478c,_0x1fed25);}export const dbUtil=new DBUtil();