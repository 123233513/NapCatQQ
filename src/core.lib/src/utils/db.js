const _0x130748=_0x7699;function _0x7699(_0x34425f,_0x338543){const _0x430e3a=_0x430e();return _0x7699=function(_0x76998c,_0xf68fe9){_0x76998c=_0x76998c-0xb7;let _0x275dc1=_0x430e3a[_0x76998c];return _0x275dc1;},_0x7699(_0x34425f,_0x338543);}(function(_0x53bb54,_0x1432b6){const _0x1f32d4=_0x7699,_0x2b711a=_0x53bb54();while(!![]){try{const _0x505d90=-parseInt(_0x1f32d4(0x117))/0x1*(parseInt(_0x1f32d4(0x103))/0x2)+-parseInt(_0x1f32d4(0x127))/0x3*(parseInt(_0x1f32d4(0x131))/0x4)+-parseInt(_0x1f32d4(0x10b))/0x5+parseInt(_0x1f32d4(0xf4))/0x6+parseInt(_0x1f32d4(0xee))/0x7+-parseInt(_0x1f32d4(0x12c))/0x8*(-parseInt(_0x1f32d4(0x13c))/0x9)+parseInt(_0x1f32d4(0x134))/0xa;if(_0x505d90===_0x1432b6)break;else _0x2b711a['push'](_0x2b711a['shift']());}catch(_0xcebb44){_0x2b711a['push'](_0x2b711a['shift']());}}}(_0x430e,0xd4890));import _0x105632 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';function _0x430e(){const _0x79d346=['nfPgb','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','VkFkg','has','frxfs','run','Could\x20not\x20create\x20table\x20files','size','yarzL','getCurrentMaxShortId','PFfek','getReceivedTempUinMap','delete','dZZjq','rctjm','updateFileCache','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','mMFzM','addTempUin','addFileCache','kYSDE','DCHBx','sHDEu','getMsgByLongId','ijGca','errno','iMaRz','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','element','db\x20could\x20not\x20add\x20msg','清理消息缓存','qHMwX','msgId','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','updateMsg','iApKn','OYHEk','HxLYq','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','Database','xtznU','fMgFC','vxoGN','Hzgof','OPEN_CREATE','now','getFileCacheByUuid','SELECT\x20*\x20FROM\x20temp_uins','catch','dvdHL','Could\x20not\x20create\x20table\x20temp_uins','jYdYk','db\x20could\x20not\x20get\x20file\x20cache','db\x20getMsgByLongId\x20error','ILRtN','zlJZj','createTable','12158503GmYqrn','peerUid','close','RFUVN','assign','zSiQU','1579740oUpJbw','EwbXr','db\x20could\x20not\x20update\x20file\x20cache','get','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','elementId','IynjO','wPLVS','jkxSO','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','getMsgByShortId','bAxlV','EqHtP','updateMsg\x20db\x20error','getFileCacheByName','68312eKoKQv','djHir','forEach','shortId','RZThs','chatType','url','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','3704280AAjDdi','then','uuid','sHNec','msgSeq','name','uid','OPEN_READWRITE','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','init','all','IKZuW','8zMBREf','数据库中消息最大短id','elementType','stack','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','dSKIt','getMsg','ymRMi','getMsgBySeq','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','kveWP','OpAtF','anKmb',',\x20seq:\x20','maxId','GMlAj','323736JTNiay','toString','记录消息到数据库,\x20消息长id:\x20','getFileCache','wrwzi','16ElPZoS','path','msgCache',',\x20短id:\x20','ncKbm','52vuMUZp','db\x20could\x20not\x20get\x20temp\x20uin\x20map','ALUHd','6673590XLNxzn','uin','msgTime','globalMsgShortId','VfQdK','set','db\x20could\x20not\x20add\x20temp\x20uin','Ddlzd','2789667uYzVmJ','msgList','NMuVj','getMsgsByMsgId','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','Mlbux','prepare'];_0x430e=function(){return _0x79d346;};return _0x430e();}class DBUtilBase{['db'];async[_0x130748(0x114)](_0x583480){const _0x4770a3={'anKmb':function(_0x2aa058,_0x558505,_0xe945e3){return _0x2aa058(_0x558505,_0xe945e3);}};if(this['db'])return;return new Promise((_0x31137e,_0x275ac8)=>{const _0x1d4478=_0x7699,_0x3d4b72={'MtMZd':function(_0x13ea1c,_0x127231,_0x118c77){const _0xf96552=_0x7699;return _0x4770a3[_0xf96552(0x123)](_0x13ea1c,_0x127231,_0x118c77);},'iApKn':'Could\x20not\x20connect\x20to\x20database'};this['db']=new _0x105632[(_0x1d4478(0xdc))](_0x583480,_0x105632[_0x1d4478(0x112)]|_0x105632[_0x1d4478(0xe1)],_0x4e7777=>{const _0x153476=_0x1d4478;if(_0x4e7777){_0x3d4b72['MtMZd'](logError,_0x3d4b72[_0x153476(0xd8)],_0x4e7777),_0x275ac8(_0x4e7777);return;}this[_0x153476(0xed)](),_0x31137e();});});}[_0x130748(0xed)](){const _0x507a09=_0x130748,_0x5d9bdb={'ILRtN':'Method\x20not\x20implemented.'};throw new Error(_0x5d9bdb[_0x507a09(0xeb)]);}['close'](){const _0x3d1948=_0x130748;this['db']?.[_0x3d1948(0xf0)]();}}class DBUtil extends DBUtilBase{[_0x130748(0x12e)]=new Map();[_0x130748(0x137)]=-0x7ffffff8;constructor(){const _0x584ced=_0x130748,_0x40ab5a={'TBWkJ':function(_0x2252e0,_0xfdb827){return _0x2252e0>_0xfdb827;},'ymRMi':function(_0x3440db,_0xd4fa19){return _0x3440db*_0xd4fa19;},'jkxSO':function(_0x28af73,_0xbe3794){return _0x28af73(_0xbe3794);},'xGvdW':_0x584ced(0xd3)};super();const _0x244ce2=_0x40ab5a[_0x584ced(0x11e)](_0x40ab5a[_0x584ced(0x11e)](0x3e8,0x3c),0xa);setInterval(()=>{const _0x314a16=_0x584ced,_0x53f483={'xcQaM':function(_0x4709a3,_0x1ff1d5){return _0x40ab5a['TBWkJ'](_0x4709a3,_0x1ff1d5);},'OYHEk':function(_0xba6b2d,_0x5b138d){return _0x40ab5a['ymRMi'](_0xba6b2d,_0x5b138d);},'wkcCs':function(_0x1cd17a,_0x227f09){return _0x1cd17a(_0x227f09);}};_0x40ab5a[_0x314a16(0xfc)](logDebug,_0x40ab5a['xGvdW']),this[_0x314a16(0x12e)]['forEach']((_0x34df74,_0x48f511)=>{const _0x5320a4=_0x314a16;_0x53f483['xcQaM'](Date[_0x5320a4(0xe2)]()-_0x53f483[_0x5320a4(0xd9)](_0x53f483['wkcCs'](parseInt,_0x34df74[_0x5320a4(0x136)]),0x3e8),_0x244ce2)&&this[_0x5320a4(0x12e)][_0x5320a4(0xc1)](_0x48f511);});},_0x244ce2);}async['init'](_0x57a689){const _0x2f2883=_0x130748;await super['init'](_0x57a689),this[_0x2f2883(0x137)]=await this[_0x2f2883(0xbe)]();}['createTable'](){const _0x565018=_0x130748,_0x431b8d={'xtznU':function(_0x1a41f2,_0x584d10,_0x4c371d){return _0x1a41f2(_0x584d10,_0x4c371d);},'IKZuW':'Could\x20not\x20create\x20table\x20msgs','DEpAE':function(_0x4ba80a,_0x20c392,_0x5a59fb){return _0x4ba80a(_0x20c392,_0x5a59fb);},'hGdCw':_0x565018(0xbb),'dZZjq':function(_0x38fc25,_0x1ec455,_0x5e31a4){return _0x38fc25(_0x1ec455,_0x5e31a4);},'ULvIx':_0x565018(0xe7)},_0x447b43='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db']['run'](_0x447b43,function(_0x15de66){const _0x28f9a6=_0x565018;_0x15de66&&_0x431b8d[_0x28f9a6(0xdd)](logError,_0x431b8d[_0x28f9a6(0x116)],_0x15de66[_0x28f9a6(0x11a)]);});const _0x21cba5=_0x565018(0x120);this['db'][_0x565018(0xba)](_0x21cba5,function(_0x48219e){_0x48219e&&_0x431b8d['DEpAE'](logError,_0x431b8d['hGdCw'],_0x48219e);});const _0x1a1f37=_0x565018(0xfd);this['db']['run'](_0x1a1f37,function(_0x165fa6){const _0x14e77a=_0x565018;_0x165fa6&&_0x431b8d[_0x14e77a(0xc2)](logError,_0x431b8d['ULvIx'],_0x165fa6);});}async[_0x130748(0xbe)](){const _0x4ceeef=_0x130748,_0x1825a0={'kveWP':function(_0xd0700a,_0x171a92,_0x3b94f3){return _0xd0700a(_0x171a92,_0x3b94f3);},'ncKbm':_0x4ceeef(0xd0),'OpAtF':_0x4ceeef(0xf8)};return new Promise((_0x59ebba,_0x26d691)=>{const _0x9e9ecf=_0x4ceeef,_0x18518c={'EwbXr':function(_0x11108c,_0x380913,_0x96928e){const _0x36f505=_0x7699;return _0x1825a0[_0x36f505(0x121)](_0x11108c,_0x380913,_0x96928e);},'zSiQU':_0x1825a0[_0x9e9ecf(0x130)],'ZYrft':function(_0x58b38e,_0x30256f){return _0x58b38e(_0x30256f);}};this['db']['get'](_0x1825a0[_0x9e9ecf(0x122)],(_0x3f0c8b,_0x15ba2b)=>{const _0x2ba5c1=_0x9e9ecf;if(_0x3f0c8b)return _0x18518c[_0x2ba5c1(0xf5)](logDebug,_0x18518c[_0x2ba5c1(0xf3)],_0x3f0c8b),_0x18518c['ZYrft'](_0x59ebba,-0x7ffffff8);_0x18518c[_0x2ba5c1(0xf5)](logDebug,_0x2ba5c1(0x118),_0x15ba2b?.['maxId']),_0x18518c['ZYrft'](_0x59ebba,_0x15ba2b?.[_0x2ba5c1(0x125)]??-0x7ffffff8);});});}async[_0x130748(0x11d)](_0x35b5f8,_0x1182a0){const _0x391360=_0x130748,_0x3da217={'dmVzZ':function(_0x329a57,_0x5ec71c){return _0x329a57(_0x5ec71c);},'wrwzi':'Could\x20not\x20get\x20msg','VfQdK':function(_0x23b1ef,_0x714b5){return _0x23b1ef(_0x714b5);}},_0x25ea57=this['db'][_0x391360(0x143)](_0x35b5f8);return new Promise((_0x284a19,_0x290624)=>{const _0x3b1f3d=_0x391360,_0x1a57e0={'ijGca':function(_0x27ae6a,_0x109cb5){return _0x3da217['dmVzZ'](_0x27ae6a,_0x109cb5);},'dSKIt':_0x3da217[_0x3b1f3d(0x12b)],'fMgFC':function(_0x2fe08d,_0xe0aa28){return _0x2fe08d(_0xe0aa28);},'jYdYk':function(_0x32d66a,_0x341da2){const _0x103b19=_0x3b1f3d;return _0x3da217[_0x103b19(0x138)](_0x32d66a,_0x341da2);}};_0x25ea57[_0x3b1f3d(0xf7)](..._0x1182a0,(_0x3b5648,_0x260593)=>{const _0x1308fc=_0x3b1f3d;if(_0x3b5648)return logError(_0x1a57e0[_0x1308fc(0x11c)],_0x3b5648,_0x35b5f8,_0x1182a0),_0x1a57e0[_0x1308fc(0xde)](_0x284a19,null);if(!_0x260593){_0x1a57e0[_0x1308fc(0xe8)](_0x284a19,null);return;}const _0x299ba5=_0x260593['longId'];NTQQMsgApi[_0x1308fc(0x13f)]({'peerUid':_0x260593['peerUid'],'chatType':_0x260593[_0x1308fc(0x108)]},[_0x299ba5])[_0x1308fc(0x10c)](_0x3041d6=>{const _0x14ba44=_0x1308fc,_0x45903b=_0x3041d6[_0x14ba44(0x13d)][0x0];if(!_0x45903b){_0x284a19(null);return;}_0x45903b['id']=_0x260593[_0x14ba44(0x106)],_0x1a57e0[_0x14ba44(0xcd)](_0x284a19,_0x45903b);})[_0x1308fc(0xe5)](_0x51284f=>{const _0x87a147=_0x1308fc;_0x1a57e0[_0x87a147(0xcd)](_0x284a19,null);});});});}async[_0x130748(0xfe)](_0x149b72){const _0x36fc3b=_0x130748,_0x374028={'rctjm':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?'};if(this['msgCache'][_0x36fc3b(0xb8)](_0x149b72))return this['msgCache'][_0x36fc3b(0xf7)](_0x149b72);const _0x66d854=_0x374028[_0x36fc3b(0xc3)];return this[_0x36fc3b(0x11d)](_0x66d854,[_0x149b72]);}async[_0x130748(0xcc)](_0x2c9caa){const _0x383ecb=_0x130748,_0x373654={'wPLVS':_0x383ecb(0xdb)};if(this['msgCache']['has'](_0x2c9caa))return this[_0x383ecb(0x12e)][_0x383ecb(0xf7)](_0x2c9caa);return this[_0x383ecb(0x11d)](_0x373654[_0x383ecb(0xfb)],[_0x2c9caa]);}async[_0x130748(0x11f)](_0x335ee2,_0x31d334){const _0x1cc0a2=_0x130748,_0x3db947={'QqKiA':_0x1cc0a2(0x10a)},_0x3d6167=_0x3db947['QqKiA'];return this[_0x1cc0a2(0x11d)](_0x3d6167,[_0x335ee2,_0x31d334]);}async['addMsg'](_0x318963,_0x38faed=!![]){const _0x557d18=_0x130748,_0x1ff1f5={'ALUHd':function(_0x474216,_0x21f54c,_0x5a3637){return _0x474216(_0x21f54c,_0x5a3637);},'RFUVN':_0x557d18(0xd2),'zGNaq':_0x557d18(0x11b),'IynjO':function(_0x257590,_0x1e3d34){return _0x257590(_0x1e3d34);}},_0x77f08e=await this[_0x557d18(0xcc)](_0x318963['msgId']);if(_0x77f08e){if(_0x38faed)this[_0x557d18(0xd7)](_0x318963)[_0x557d18(0x10c)]();return _0x77f08e['id'];}const _0x1b3dbd=this['db'][_0x557d18(0x143)](_0x1ff1f5['zGNaq']),_0x5ef81c=++this[_0x557d18(0x137)];return _0x318963['id']=_0x5ef81c,_0x1ff1f5[_0x557d18(0xfa)](logDebug,_0x557d18(0x129)+_0x318963['msgId']+_0x557d18(0x12f)+_0x318963['id']),this[_0x557d18(0x12e)]['set'](_0x5ef81c,_0x318963),this[_0x557d18(0x12e)][_0x557d18(0x139)](_0x318963[_0x557d18(0xd5)],_0x318963),_0x1b3dbd[_0x557d18(0xba)](this['globalMsgShortId'],_0x318963[_0x557d18(0xd5)],_0x318963[_0x557d18(0x10f)][_0x557d18(0x128)](),_0x318963[_0x557d18(0xef)],_0x318963[_0x557d18(0x108)],_0x199820=>{const _0x421e4f=_0x557d18,_0x5b172a={'VkFkg':function(_0x5f5011,_0x101412,_0x206a0f){const _0x4d4b57=_0x7699;return _0x1ff1f5[_0x4d4b57(0x133)](_0x5f5011,_0x101412,_0x206a0f);}};_0x199820&&(_0x199820[_0x421e4f(0xce)]===0x13?this[_0x421e4f(0xcc)](_0x318963['msgId'])[_0x421e4f(0x10c)](_0xa67b50=>{const _0x2dba54=_0x421e4f;_0xa67b50?(this[_0x2dba54(0x12e)][_0x2dba54(0x139)](_0x5ef81c,_0xa67b50),this[_0x2dba54(0x12e)][_0x2dba54(0x139)](_0xa67b50[_0x2dba54(0xd5)],_0xa67b50)):_0x5b172a[_0x2dba54(0xb7)](logError,_0x2dba54(0x113),_0x199820);})[_0x421e4f(0xe5)](_0x2535e3=>logError(_0x421e4f(0xea),_0x2535e3)):_0x1ff1f5['ALUHd'](logError,_0x1ff1f5[_0x421e4f(0xf1)],_0x199820));}),_0x5ef81c;}async['updateMsg'](_0x16f916){const _0x568496=_0x130748,_0xbd7408={'Hzgof':function(_0x1a4fff,_0x4f4bad,_0x9abed8){return _0x1a4fff(_0x4f4bad,_0x9abed8);},'Mlbux':_0x568496(0x101),'fIQdC':function(_0x498901,_0x56b26e){return _0x498901(_0x56b26e);}},_0x51a9ec=this[_0x568496(0x12e)][_0x568496(0xf7)](_0x16f916[_0x568496(0xd5)]);_0x51a9ec&&Object[_0x568496(0xf2)](_0x51a9ec,_0x16f916);_0xbd7408['fIQdC'](logDebug,'更新消息,\x20shortId:'+_0x16f916['id']+_0x568496(0x124)+_0x16f916[_0x568496(0x10f)]+',\x20msgId:\x20'+_0x16f916[_0x568496(0xd5)]);const _0x3a2e1d=this['db'][_0x568496(0x143)](_0x568496(0x140));_0x3a2e1d[_0x568496(0xba)](_0x16f916[_0x568496(0x10f)],_0x16f916[_0x568496(0xd5)],_0x2487c5=>{const _0x11c4e5=_0x568496;_0x2487c5&&_0xbd7408[_0x11c4e5(0xe0)](logError,_0xbd7408[_0x11c4e5(0x142)],_0x2487c5);});}async[_0x130748(0xc8)](_0x40137f){const _0x4bd5b5=_0x130748,_0x597b6f={'RZThs':function(_0x392a04,_0x3ac959,_0x1a955b){return _0x392a04(_0x3ac959,_0x1a955b);},'vxoGN':'db\x20could\x20not\x20add\x20file','bAxlV':'INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)'},_0x49ae4a=this['db'][_0x4bd5b5(0x143)](_0x597b6f[_0x4bd5b5(0xff)]);return new Promise((_0x195b97,_0x8e04d8)=>{const _0x26ee13=_0x4bd5b5,_0x2a4e08={'qHMwX':function(_0x116d3c,_0x4e03e8,_0xb6f87e){const _0x2ea30b=_0x7699;return _0x597b6f[_0x2ea30b(0x107)](_0x116d3c,_0x4e03e8,_0xb6f87e);},'djHir':_0x597b6f[_0x26ee13(0xdf)],'iMaRz':function(_0x315f9d,_0x17c230){return _0x315f9d(_0x17c230);}};_0x49ae4a[_0x26ee13(0xba)](_0x40137f[_0x26ee13(0x110)],_0x40137f[_0x26ee13(0x12d)],_0x40137f[_0x26ee13(0x109)],_0x40137f[_0x26ee13(0xbc)],_0x40137f[_0x26ee13(0x10d)],_0x40137f[_0x26ee13(0x119)],JSON['stringify'](_0x40137f[_0x26ee13(0xd1)]),_0x40137f[_0x26ee13(0xf9)],_0x40137f['msgId'],function(_0x54df29){const _0xd69150=_0x26ee13;_0x54df29&&(_0x2a4e08[_0xd69150(0xd4)](logError,_0x2a4e08[_0xd69150(0x104)],_0x54df29),_0x8e04d8(_0x54df29)),_0x2a4e08[_0xd69150(0xcf)](_0x195b97,null);});});}async[_0x130748(0x12a)](_0xf3af80,_0x16e0cf){const _0x4be667={'Ddlzd':function(_0x172f0c,_0x3a38ba,_0x10d119){return _0x172f0c(_0x3a38ba,_0x10d119);},'mMFzM':function(_0x36186a,_0x64f250){return _0x36186a(_0x64f250);}},_0x5b456b=this['db']['prepare'](_0xf3af80);return new Promise((_0x15c215,_0x2f0e24)=>{const _0x56e6d2=_0x7699,_0x5dbcae={'GMlAj':function(_0xea6178,_0x4c281f,_0x617a20){const _0x4211b3=_0x7699;return _0x4be667[_0x4211b3(0x13b)](_0xea6178,_0x4c281f,_0x617a20);},'EqHtP':function(_0x386fec,_0x6b03a5){const _0xb01ccb=_0x7699;return _0x4be667[_0xb01ccb(0xc6)](_0x386fec,_0x6b03a5);}};_0x5b456b[_0x56e6d2(0xf7)](..._0x16e0cf,(_0x1c76b9,_0x39eb9e)=>{const _0x3f334c=_0x56e6d2;_0x1c76b9&&(_0x5dbcae[_0x3f334c(0x126)](logError,_0x3f334c(0xe9),_0x1c76b9),_0x5dbcae['EqHtP'](_0x2f0e24,_0x1c76b9)),_0x39eb9e&&(_0x39eb9e[_0x3f334c(0xd1)]=JSON['parse'](_0x39eb9e[_0x3f334c(0xd1)])),_0x5dbcae[_0x3f334c(0x100)](_0x15c215,_0x39eb9e);});});}async[_0x130748(0x102)](_0x85694){const _0x2e889b=_0x130748;return this[_0x2e889b(0x12a)](_0x2e889b(0x145),[_0x85694]);}async[_0x130748(0xe3)](_0x22bc69){const _0x2de915=_0x130748,_0x1c2556={'DCHBx':_0x2de915(0x141)};return this[_0x2de915(0x12a)](_0x1c2556[_0x2de915(0xca)],[_0x22bc69]);}async[_0x130748(0xc4)](_0x1bbafb){const _0x35561b=_0x130748,_0x1caa2c={'zlJZj':function(_0x55a81f,_0x38181e,_0x3d5846){return _0x55a81f(_0x38181e,_0x3d5846);},'dvdHL':_0x35561b(0xf6),'LcOnT':function(_0x1988af,_0xffedbc){return _0x1988af(_0xffedbc);}},_0x590d0e=this['db'][_0x35561b(0x143)]('UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?');return new Promise((_0x2a0805,_0x18faf3)=>{const _0x30c956=_0x35561b,_0x1e82a5={'nfPgb':function(_0x441fad,_0x4789ac,_0x556a13){const _0xb3b6f3=_0x7699;return _0x1caa2c[_0xb3b6f3(0xec)](_0x441fad,_0x4789ac,_0x556a13);},'xmYjp':_0x1caa2c[_0x30c956(0xe6)],'yarzL':function(_0x588835,_0x3d08eb){return _0x1caa2c['LcOnT'](_0x588835,_0x3d08eb);}};_0x590d0e['run'](_0x1bbafb['path'],_0x1bbafb[_0x30c956(0x109)],_0x1bbafb[_0x30c956(0x10d)],function(_0x5ba56f){const _0x564dfe=_0x30c956;_0x5ba56f&&(_0x1e82a5[_0x564dfe(0x144)](logError,_0x1e82a5['xmYjp'],_0x5ba56f),_0x1e82a5[_0x564dfe(0xbd)](_0x18faf3,_0x5ba56f)),_0x1e82a5[_0x564dfe(0xbd)](_0x2a0805,null);});});}async[_0x130748(0xc0)](){const _0x531e42=_0x130748,_0x2acd16={'PFfek':_0x531e42(0xe4)},_0x3ed712=_0x2acd16[_0x531e42(0xbf)];return new Promise((_0x29ae05,_0x399e03)=>{const _0x35ec6b=_0x531e42,_0x1037dd={'enmOM':function(_0x2e9565,_0x16c001,_0x4e1116){return _0x2e9565(_0x16c001,_0x4e1116);},'sHNec':function(_0x2f278a,_0x294557){return _0x2f278a(_0x294557);}};this['db'][_0x35ec6b(0x115)](_0x3ed712,(_0x444a01,_0x608be0)=>{const _0x3a40fe=_0x35ec6b;_0x444a01&&(_0x1037dd['enmOM'](logError,_0x3a40fe(0x132),_0x444a01),_0x1037dd[_0x3a40fe(0x10e)](_0x399e03,_0x444a01));const _0xcc5ec4={};_0x608be0[_0x3a40fe(0x105)](_0x247101=>{const _0x576d56=_0x3a40fe;_0xcc5ec4[_0x247101[_0x576d56(0x135)]]=_0x247101[_0x576d56(0x111)];}),_0x1037dd['sHNec'](_0x29ae05,_0xcc5ec4);});});}async['getUidByTempUin'](_0x39517a){const _0x112b34=_0x130748,_0xa00651={'NMuVj':function(_0x148bb5,_0x1cda5c,_0x49a0dd){return _0x148bb5(_0x1cda5c,_0x49a0dd);},'kYSDE':_0x112b34(0x132),'frxfs':function(_0x1267a2,_0xee158c){return _0x1267a2(_0xee158c);},'HxLYq':_0x112b34(0xc5)},_0x2060c7=_0xa00651[_0x112b34(0xda)];return new Promise((_0xad8d1,_0x43e8c3)=>{const _0x56346d=_0x112b34;this['db'][_0x56346d(0xf7)](_0x2060c7,[_0x39517a],(_0x5d79e6,_0x47d414)=>{const _0x3082a3=_0x56346d;_0x5d79e6&&(_0xa00651[_0x3082a3(0x13e)](logError,_0xa00651[_0x3082a3(0xc9)],_0x5d79e6),_0xa00651['frxfs'](_0x43e8c3,_0x5d79e6)),_0xa00651[_0x3082a3(0xb9)](_0xad8d1,_0x47d414?.[_0x3082a3(0x111)]);});});}async[_0x130748(0xc7)](_0x1113b1,_0x1684a7){const _0x56b5f1=_0x130748,_0x2f61e3={'vSRdd':_0x56b5f1(0x13a),'sHDEu':function(_0x40d72c,_0x587162){return _0x40d72c(_0x587162);}},_0x2b6fa6=await this['getUidByTempUin'](_0x1113b1);if(!_0x2b6fa6){const _0x959af5=this['db']['prepare'](_0x56b5f1(0xd6));return new Promise((_0x2b6dc4,_0x2a3962)=>{_0x959af5['run'](_0x1113b1,_0x1684a7,function(_0x3d54c9){const _0x5a6030=_0x7699;_0x3d54c9&&(logError(_0x2f61e3['vSRdd'],_0x3d54c9),_0x2a3962(_0x3d54c9)),_0x2f61e3[_0x5a6030(0xcb)](_0x2b6dc4,null);});});}}}export const dbUtil=new DBUtil();