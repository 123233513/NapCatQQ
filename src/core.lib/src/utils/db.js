const _0x106e81=_0x236b;(function(_0x4068e0,_0x4aa764){const _0x391cff=_0x236b,_0x30ee36=_0x4068e0();while(!![]){try{const _0x503289=-parseInt(_0x391cff(0x22b))/0x1*(parseInt(_0x391cff(0x276))/0x2)+-parseInt(_0x391cff(0x20e))/0x3*(parseInt(_0x391cff(0x22a))/0x4)+-parseInt(_0x391cff(0x282))/0x5*(-parseInt(_0x391cff(0x233))/0x6)+-parseInt(_0x391cff(0x206))/0x7*(-parseInt(_0x391cff(0x247))/0x8)+parseInt(_0x391cff(0x256))/0x9+-parseInt(_0x391cff(0x26c))/0xa*(-parseInt(_0x391cff(0x25b))/0xb)+parseInt(_0x391cff(0x22c))/0xc*(-parseInt(_0x391cff(0x227))/0xd);if(_0x503289===_0x4aa764)break;else _0x30ee36['push'](_0x30ee36['shift']());}catch(_0x2b6e09){_0x30ee36['push'](_0x30ee36['shift']());}}}(_0x1291,0xcdbb8));import _0x23b883 from'sqlite3';function _0x236b(_0x43a118,_0x3ddbe7){const _0x129156=_0x1291();return _0x236b=function(_0x236b34,_0x3b2d9f){_0x236b34=_0x236b34-0x1f0;let _0x4a5acf=_0x129156[_0x236b34];return _0x4a5acf;},_0x236b(_0x43a118,_0x3ddbe7);}import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x106e81(0x209)](_0x3be93b){const _0x776bdd={'zrsxZ':function(_0x2d34a5,_0x365126,_0xb1c6e8){return _0x2d34a5(_0x365126,_0xb1c6e8);},'LFjrM':function(_0x536523,_0x423a30){return _0x536523(_0x423a30);},'Vbrpm':function(_0x1ed2a9,_0xd28de){return _0x1ed2a9|_0xd28de;}};if(this['db'])return;return new Promise((_0x596b72,_0x56d1eb)=>{const _0x2a37f5=_0x236b,_0x34e55d={'QmIMM':function(_0x1bdfcb,_0x38e1e7,_0x42a439){const _0x44de01=_0x236b;return _0x776bdd[_0x44de01(0x21f)](_0x1bdfcb,_0x38e1e7,_0x42a439);},'GKuQh':function(_0x5171b7,_0x534b37){const _0x3ec554=_0x236b;return _0x776bdd[_0x3ec554(0x25e)](_0x5171b7,_0x534b37);}};this['db']=new _0x23b883[(_0x2a37f5(0x217))](_0x3be93b,_0x776bdd[_0x2a37f5(0x1fa)](_0x23b883[_0x2a37f5(0x226)],_0x23b883[_0x2a37f5(0x201)]),_0x3673ac=>{const _0x59f66e=_0x2a37f5;if(_0x3673ac){_0x34e55d[_0x59f66e(0x236)](logError,_0x59f66e(0x239),_0x3673ac),_0x34e55d[_0x59f66e(0x210)](_0x56d1eb,_0x3673ac);return;}this[_0x59f66e(0x215)](),_0x596b72();});});}[_0x106e81(0x215)](){throw new Error('Method\x20not\x20implemented.');}['close'](){const _0x27ce94=_0x106e81;this['db']?.[_0x27ce94(0x228)]();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();[_0x106e81(0x235)]=-0x7ffffff8;constructor(){const _0x427c4c=_0x106e81,_0x518d26={'EJXgB':function(_0x35240e,_0x263725){return _0x35240e-_0x263725;},'FuDBz':function(_0x3c679b,_0x93da95){return _0x3c679b*_0x93da95;},'jgcBb':function(_0x10e204,_0x565dbe){return _0x10e204(_0x565dbe);},'CwZrL':function(_0x59bb2f,_0x53ef58){return _0x59bb2f(_0x53ef58);},'VfeBX':function(_0x177a7d,_0x140f15){return _0x177a7d*_0x140f15;},'MGeTj':function(_0x1f9167,_0x58a201){return _0x1f9167*_0x58a201;},'mYrsx':function(_0x198cdf,_0x412e6e,_0x1d766a){return _0x198cdf(_0x412e6e,_0x1d766a);}};super();const _0x1960ad=_0x518d26[_0x427c4c(0x22e)](_0x518d26['MGeTj'](0x3e8,0x3c),0xa);_0x518d26[_0x427c4c(0x221)](setInterval,()=>{const _0x33ae36=_0x427c4c;_0x518d26['CwZrL'](logDebug,'清理消息缓存'),this[_0x33ae36(0x267)]['forEach']((_0x1c6f01,_0x15222e)=>{const _0x1c6526=_0x33ae36;_0x518d26[_0x1c6526(0x1f6)](Date[_0x1c6526(0x23a)](),_0x518d26[_0x1c6526(0x272)](_0x518d26['jgcBb'](parseInt,_0x1c6f01[_0x1c6526(0x20b)]),0x3e8))>_0x1960ad&&this[_0x1c6526(0x267)]['delete'](_0x15222e);});},_0x1960ad);}async['init'](_0xb51d07){const _0x102fdc=_0x106e81;await super[_0x102fdc(0x209)](_0xb51d07),this[_0x102fdc(0x235)]=await this['getCurrentMaxShortId']();}[_0x106e81(0x215)](){const _0x1f5f6d=_0x106e81,_0x1d747d={'mHqSz':function(_0x1689d4,_0x116d42,_0x4be9eb){return _0x1689d4(_0x116d42,_0x4be9eb);},'gfCQY':_0x1f5f6d(0x20a),'Andkf':function(_0x2462bb,_0x5677d5,_0x15b0b5){return _0x2462bb(_0x5677d5,_0x15b0b5);},'fbeLy':'Could\x20not\x20create\x20table\x20files','HqTmi':function(_0x5ae812,_0x4c2a7d,_0x5a3cc3){return _0x5ae812(_0x4c2a7d,_0x5a3cc3);},'ZRjxG':_0x1f5f6d(0x22d)},_0xe14b9b=_0x1f5f6d(0x20d);this['db'][_0x1f5f6d(0x1fd)](_0xe14b9b,function(_0x4b45aa){const _0x17300a=_0x1f5f6d;_0x4b45aa&&_0x1d747d['mHqSz'](logError,_0x1d747d[_0x17300a(0x264)],_0x4b45aa[_0x17300a(0x274)]);});const _0x3eacf7=_0x1f5f6d(0x229);this['db'][_0x1f5f6d(0x1fd)](_0x3eacf7,function(_0x464f1f){const _0x33160d=_0x1f5f6d;_0x464f1f&&_0x1d747d[_0x33160d(0x20c)](logError,_0x1d747d['fbeLy'],_0x464f1f);});const _0x5e3dd=_0x1f5f6d(0x204);this['db'][_0x1f5f6d(0x1fd)](_0x5e3dd,function(_0x1e184b){const _0xc68c71=_0x1f5f6d;_0x1e184b&&_0x1d747d[_0xc68c71(0x259)](logError,_0x1d747d['ZRjxG'],_0x1e184b);});}async[_0x106e81(0x21c)](){const _0xfa8362=_0x106e81,_0x2fd033={'xHvFG':function(_0x6ab263,_0x3b1219,_0x50d681){return _0x6ab263(_0x3b1219,_0x50d681);},'HZbwX':_0xfa8362(0x24f),'puBtY':function(_0x1dff37,_0x1e8272,_0x558c07){return _0x1dff37(_0x1e8272,_0x558c07);},'eimtI':_0xfa8362(0x277),'HtJqW':function(_0x5bbc80,_0x29c166){return _0x5bbc80(_0x29c166);},'qXbtb':'SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs'};return new Promise((_0x1b91ab,_0x3b0457)=>{const _0x16cdda=_0xfa8362,_0x2ac5e6={'sqDeO':function(_0x4b7d28,_0x46c405,_0x549c10){const _0xb4c9cf=_0x236b;return _0x2fd033[_0xb4c9cf(0x26d)](_0x4b7d28,_0x46c405,_0x549c10);},'maCRQ':_0x2fd033[_0x16cdda(0x22f)],'HOQgZ':function(_0x3c7c62,_0x258fcb,_0x529d50){const _0xa70044=_0x16cdda;return _0x2fd033[_0xa70044(0x24a)](_0x3c7c62,_0x258fcb,_0x529d50);},'XqAVd':_0x2fd033[_0x16cdda(0x243)],'ytyDB':function(_0x303f9d,_0x1e1787){return _0x2fd033['HtJqW'](_0x303f9d,_0x1e1787);}};this['db']['get'](_0x2fd033[_0x16cdda(0x25c)],(_0x2e61cb,_0xaf1ab9)=>{const _0x473d44=_0x16cdda;if(_0x2e61cb)return _0x2ac5e6[_0x473d44(0x230)](logDebug,_0x2ac5e6[_0x473d44(0x281)],_0x2e61cb),_0x1b91ab(-0x7ffffff8);_0x2ac5e6[_0x473d44(0x200)](logDebug,_0x2ac5e6[_0x473d44(0x23f)],_0xaf1ab9?.[_0x473d44(0x24d)]),_0x2ac5e6['ytyDB'](_0x1b91ab,_0xaf1ab9?.['maxId']??-0x7ffffff8);});});}async[_0x106e81(0x249)](_0x4105b9,_0xaefc6){const _0x5c05d2=_0x106e81,_0x1d6d55={'WeQVF':function(_0x16df40,_0x84dc75){return _0x16df40(_0x84dc75);},'iPoIR':function(_0x4c6574,_0x5339eb){return _0x4c6574(_0x5339eb);},'uskaw':_0x5c05d2(0x1f2)},_0x553715=this['db'][_0x5c05d2(0x208)](_0x4105b9);return new Promise((_0x13fcaf,_0x1283fa)=>{const _0x5d2266=_0x5c05d2,_0x2f5560={'VtTCp':function(_0x28eaa2,_0x147aa1){const _0xf5e49=_0x236b;return _0x1d6d55[_0xf5e49(0x27e)](_0x28eaa2,_0x147aa1);},'HPcNj':function(_0x1a9074,_0x280ac5){const _0x4fc94c=_0x236b;return _0x1d6d55[_0x4fc94c(0x254)](_0x1a9074,_0x280ac5);},'tFIkp':function(_0x17cad4,_0x3f8cab){const _0x20bc1d=_0x236b;return _0x1d6d55[_0x20bc1d(0x27e)](_0x17cad4,_0x3f8cab);},'LSVom':_0x1d6d55[_0x5d2266(0x26a)]};_0x553715[_0x5d2266(0x207)](..._0xaefc6,(_0x95bfb5,_0x19d95a)=>{const _0x404c78=_0x5d2266;if(_0x95bfb5)return logError(_0x2f5560[_0x404c78(0x20f)],_0x95bfb5,_0x4105b9,_0xaefc6),_0x13fcaf(null);if(!_0x19d95a){_0x2f5560[_0x404c78(0x278)](_0x13fcaf,null);return;}const _0x1de941=_0x19d95a[_0x404c78(0x245)];NTQQMsgApi[_0x404c78(0x248)]({'peerUid':_0x19d95a[_0x404c78(0x25d)],'chatType':_0x19d95a[_0x404c78(0x25a)]},[_0x1de941])[_0x404c78(0x27b)](_0x5185d4=>{const _0x10bfb3=_0x404c78,_0x35c651=_0x5185d4[_0x10bfb3(0x1f1)][0x0];if(!_0x35c651){_0x2f5560['VtTCp'](_0x13fcaf,null);return;}_0x35c651['id']=_0x19d95a[_0x10bfb3(0x1f5)],_0x2f5560[_0x10bfb3(0x278)](_0x13fcaf,_0x35c651);})[_0x404c78(0x1f3)](_0x180992=>{_0x2f5560['tFIkp'](_0x13fcaf,null);});});});}async['getMsgByShortId'](_0x4e8ba1){const _0x5f00ce=_0x106e81,_0x3c319d={'TofGZ':_0x5f00ce(0x23b)};if(this[_0x5f00ce(0x267)]['has'](_0x4e8ba1))return this[_0x5f00ce(0x267)][_0x5f00ce(0x207)](_0x4e8ba1);const _0x470a64=_0x3c319d['TofGZ'];return this['getMsg'](_0x470a64,[_0x4e8ba1]);}async[_0x106e81(0x27f)](_0x996f59){const _0x1d4c75=_0x106e81,_0x4a7a88={'OqBeI':_0x1d4c75(0x223)};if(this[_0x1d4c75(0x267)][_0x1d4c75(0x265)](_0x996f59))return this[_0x1d4c75(0x267)]['get'](_0x996f59);return this[_0x1d4c75(0x249)](_0x4a7a88[_0x1d4c75(0x234)],[_0x996f59]);}async[_0x106e81(0x26f)](_0x23d726,_0x1ad73d){const _0x41cf8b=_0x106e81,_0x56a235='SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?';return this[_0x41cf8b(0x249)](_0x56a235,[_0x23d726,_0x1ad73d]);}async[_0x106e81(0x275)](_0x298071,_0x319360=!![]){const _0x296b87=_0x106e81,_0x2c1500={'BbAmG':function(_0x166726,_0x51b29e,_0x4adea0){return _0x166726(_0x51b29e,_0x4adea0);},'iaBec':_0x296b87(0x1f4),'vtuJi':_0x296b87(0x253),'THmQg':function(_0x4db015,_0x9fa62d){return _0x4db015(_0x9fa62d);}},_0x360f53=await this[_0x296b87(0x27f)](_0x298071['msgId']);if(_0x360f53){if(_0x319360)this[_0x296b87(0x263)](_0x298071)[_0x296b87(0x27b)]();return _0x360f53['id'];}const _0x174ad6=this['db'][_0x296b87(0x208)](_0x2c1500[_0x296b87(0x224)]),_0x14ed86=++this[_0x296b87(0x235)];return _0x298071['id']=_0x14ed86,_0x2c1500[_0x296b87(0x270)](logDebug,_0x296b87(0x21e)+_0x298071[_0x296b87(0x255)]+_0x296b87(0x257)+_0x298071['id']),this[_0x296b87(0x267)][_0x296b87(0x27d)](_0x14ed86,_0x298071),this['msgCache'][_0x296b87(0x27d)](_0x298071[_0x296b87(0x255)],_0x298071),_0x174ad6[_0x296b87(0x1fd)](this[_0x296b87(0x235)],_0x298071[_0x296b87(0x255)],_0x298071[_0x296b87(0x261)][_0x296b87(0x21b)](),_0x298071[_0x296b87(0x25d)],_0x298071[_0x296b87(0x25a)],_0x3c789c=>{const _0x449288=_0x296b87,_0x3a5baa={'Yimye':function(_0x56d554,_0x4af749,_0x4f0f12){const _0x58f2eb=_0x236b;return _0x2c1500[_0x58f2eb(0x202)](_0x56d554,_0x4af749,_0x4f0f12);},'yGOHW':_0x2c1500['iaBec']};_0x3c789c&&(_0x3c789c[_0x449288(0x268)]===0x13?this[_0x449288(0x27f)](_0x298071[_0x449288(0x255)])[_0x449288(0x27b)](_0x3c73e8=>{const _0x147a82=_0x449288;_0x3c73e8?(this['msgCache']['set'](_0x14ed86,_0x3c73e8),this['msgCache'][_0x147a82(0x27d)](_0x3c73e8['msgId'],_0x3c73e8)):_0x3a5baa[_0x147a82(0x279)](logError,_0x3a5baa[_0x147a82(0x27a)],_0x3c789c);})[_0x449288(0x1f3)](_0x14fb68=>logError(_0x449288(0x213),_0x14fb68)):logError(_0x449288(0x24b),_0x3c789c));}),_0x14ed86;}async[_0x106e81(0x263)](_0x1c7c21){const _0x30a718=_0x106e81,_0x4223a6={'SZUjQ':function(_0x44c653,_0x34fb03,_0x532805){return _0x44c653(_0x34fb03,_0x532805);},'kdwLi':_0x30a718(0x241),'TnUtT':function(_0x3a1e23,_0x58b35f){return _0x3a1e23(_0x58b35f);},'doCnJ':'UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?'},_0x3315d4=this[_0x30a718(0x267)][_0x30a718(0x207)](_0x1c7c21['msgId']);_0x3315d4&&Object[_0x30a718(0x23c)](_0x3315d4,_0x1c7c21);_0x4223a6[_0x30a718(0x222)](logDebug,_0x30a718(0x283)+_0x1c7c21['id']+',\x20seq:\x20'+_0x1c7c21[_0x30a718(0x261)]+_0x30a718(0x1f8)+_0x1c7c21[_0x30a718(0x255)]);const _0x3e7e6f=this['db']['prepare'](_0x4223a6[_0x30a718(0x23e)]);_0x3e7e6f[_0x30a718(0x1fd)](_0x1c7c21[_0x30a718(0x261)],_0x1c7c21[_0x30a718(0x255)],_0x2d9102=>{const _0x43e148=_0x30a718;_0x2d9102&&_0x4223a6[_0x43e148(0x1ff)](logError,_0x4223a6[_0x43e148(0x1f9)],_0x2d9102);});}async[_0x106e81(0x284)](_0x48308){const _0x618d20=_0x106e81,_0xa3d90c={'XFxbi':_0x618d20(0x1f0),'ebyZs':function(_0x553c99,_0xe58123){return _0x553c99(_0xe58123);},'BRhbj':_0x618d20(0x258)},_0x412ba9=this['db'][_0x618d20(0x208)](_0xa3d90c[_0x618d20(0x269)]);return new Promise((_0x33b5a6,_0x587dde)=>{const _0x57daad=_0x618d20;_0x412ba9[_0x57daad(0x1fd)](_0x48308[_0x57daad(0x26b)],_0x48308[_0x57daad(0x286)],_0x48308[_0x57daad(0x232)],_0x48308['size'],_0x48308[_0x57daad(0x216)],_0x48308[_0x57daad(0x251)],JSON[_0x57daad(0x260)](_0x48308[_0x57daad(0x238)]),_0x48308[_0x57daad(0x21d)],_0x48308[_0x57daad(0x255)],function(_0xb99ccd){const _0x2b3c01=_0x57daad;_0xb99ccd&&(logError(_0xa3d90c[_0x2b3c01(0x23d)],_0xb99ccd),_0xa3d90c[_0x2b3c01(0x244)](_0x587dde,_0xb99ccd)),_0x33b5a6(null);});});}async['getFileCache'](_0x2d94f0,_0x18447f){const _0x3fd3cc=_0x106e81,_0x1c533a={'hqdOX':_0x3fd3cc(0x211),'bFqkH':function(_0x3b7c0e,_0x1be8f5){return _0x3b7c0e(_0x1be8f5);}},_0x1b5a20=this['db']['prepare'](_0x2d94f0);return new Promise((_0x52dade,_0x1195fb)=>{const _0x2632de=_0x3fd3cc,_0x19d9cb={'xBpLf':_0x1c533a[_0x2632de(0x240)],'oSHre':function(_0x38149a,_0x46dcf3){const _0x2e023e=_0x2632de;return _0x1c533a[_0x2e023e(0x203)](_0x38149a,_0x46dcf3);}};_0x1b5a20[_0x2632de(0x207)](..._0x18447f,(_0x26f8c9,_0x56c6f9)=>{const _0x2c3671=_0x2632de;_0x26f8c9&&(logError(_0x19d9cb[_0x2c3671(0x25f)],_0x26f8c9),_0x19d9cb[_0x2c3671(0x250)](_0x1195fb,_0x26f8c9)),_0x56c6f9&&(_0x56c6f9[_0x2c3671(0x238)]=JSON['parse'](_0x56c6f9[_0x2c3671(0x238)])),_0x19d9cb[_0x2c3671(0x250)](_0x52dade,_0x56c6f9);});});}async['getFileCacheByName'](_0x1064b0){const _0x311dc9=_0x106e81;return this[_0x311dc9(0x214)](_0x311dc9(0x1fc),[_0x1064b0]);}async[_0x106e81(0x1fe)](_0x3f52c5){const _0x2e5dc7=_0x106e81,_0x5b533d={'DSOBo':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?'};return this[_0x2e5dc7(0x214)](_0x5b533d[_0x2e5dc7(0x271)],[_0x3f52c5]);}async['updateFileCache'](_0xd353be){const _0x45a85b=_0x106e81,_0x331fb4={'atxYM':function(_0xce9652,_0x5cad6b,_0x119436){return _0xce9652(_0x5cad6b,_0x119436);},'FGUHv':'db\x20could\x20not\x20update\x20file\x20cache','cjMJr':function(_0x2b097a,_0x392f7e){return _0x2b097a(_0x392f7e);},'iDHxl':function(_0x2703fe,_0x496a4e){return _0x2703fe(_0x496a4e);}},_0x47930e=this['db']['prepare'](_0x45a85b(0x24e));return new Promise((_0x3305ba,_0x4310a1)=>{const _0x4af56c=_0x45a85b;_0x47930e[_0x4af56c(0x1fd)](_0xd353be['path'],_0xd353be[_0x4af56c(0x232)],_0xd353be['uuid'],function(_0x32c08a){const _0x27762d=_0x4af56c;_0x32c08a&&(_0x331fb4['atxYM'](logError,_0x331fb4[_0x27762d(0x26e)],_0x32c08a),_0x331fb4['cjMJr'](_0x4310a1,_0x32c08a)),_0x331fb4[_0x27762d(0x218)](_0x3305ba,null);});});}async[_0x106e81(0x1f7)](){const _0x34e44=_0x106e81,_0x5d5e21={'joWno':_0x34e44(0x205),'eaOSD':function(_0x23bd7d,_0x482741){return _0x23bd7d(_0x482741);},'AgRqK':function(_0x2c55da,_0x152924){return _0x2c55da(_0x152924);},'YwJUR':_0x34e44(0x237)},_0x2ce27b=_0x5d5e21[_0x34e44(0x280)];return new Promise((_0x39c7d0,_0x8b1baa)=>{this['db']['all'](_0x2ce27b,(_0x3447d4,_0x5aea3c)=>{const _0x591e1e=_0x236b;_0x3447d4&&(logError(_0x5d5e21['joWno'],_0x3447d4),_0x5d5e21['eaOSD'](_0x8b1baa,_0x3447d4));const _0x5d315d={};_0x5aea3c[_0x591e1e(0x231)](_0x24927f=>{const _0x2527ab=_0x591e1e;_0x5d315d[_0x24927f[_0x2527ab(0x273)]]=_0x24927f[_0x2527ab(0x21a)];}),_0x5d5e21['AgRqK'](_0x39c7d0,_0x5d315d);});});}async[_0x106e81(0x225)](_0x408c3e){const _0x508a2b=_0x106e81,_0x1434da={'ZSjXt':function(_0x378383,_0x1fc66d,_0x4ddb43){return _0x378383(_0x1fc66d,_0x4ddb43);},'oBZhf':function(_0x4f7ea0,_0x44ed06){return _0x4f7ea0(_0x44ed06);},'FFSKd':_0x508a2b(0x285)},_0x4a0d15=_0x1434da['FFSKd'];return new Promise((_0x5333cb,_0x4d1429)=>{const _0x102c9e=_0x508a2b,_0xdb489b={'HZmnf':function(_0x1fe626,_0x3c2e08,_0x2f1cc3){const _0x3729f0=_0x236b;return _0x1434da[_0x3729f0(0x27c)](_0x1fe626,_0x3c2e08,_0x2f1cc3);},'wVLOu':_0x102c9e(0x205),'hdmcP':function(_0xac423,_0xa87df0){const _0x25d9d2=_0x102c9e;return _0x1434da[_0x25d9d2(0x246)](_0xac423,_0xa87df0);}};this['db']['get'](_0x4a0d15,[_0x408c3e],(_0x191be4,_0x5edaf6)=>{const _0x3503f4=_0x102c9e;_0x191be4&&(_0xdb489b[_0x3503f4(0x219)](logError,_0xdb489b[_0x3503f4(0x266)],_0x191be4),_0xdb489b[_0x3503f4(0x24c)](_0x4d1429,_0x191be4)),_0x5333cb(_0x5edaf6?.[_0x3503f4(0x21a)]);});});}async[_0x106e81(0x242)](_0x2a041d,_0x2c3eb9){const _0x3e9f4e=_0x106e81,_0x5af9b9={'eOHTa':function(_0x2bc8c1,_0x1c3574,_0xec22f4){return _0x2bc8c1(_0x1c3574,_0xec22f4);},'vNEHw':_0x3e9f4e(0x252),'auzoR':function(_0x28a329,_0x1b5c89){return _0x28a329(_0x1b5c89);}},_0x50dbdc=await this['getUidByTempUin'](_0x2a041d);if(!_0x50dbdc){const _0x338bf7=this['db']['prepare'](_0x3e9f4e(0x220));return new Promise((_0x4b95a9,_0x317d17)=>{const _0xfcb54e=_0x3e9f4e;_0x338bf7[_0xfcb54e(0x1fd)](_0x2a041d,_0x2c3eb9,function(_0x757ebc){const _0x1e9807=_0xfcb54e;_0x757ebc&&(_0x5af9b9[_0x1e9807(0x1fb)](logError,_0x5af9b9[_0x1e9807(0x262)],_0x757ebc),_0x5af9b9[_0x1e9807(0x212)](_0x317d17,_0x757ebc)),_0x5af9b9[_0x1e9807(0x212)](_0x4b95a9,null);});});}}}function _0x1291(){const _0x497a21=['chatType','33ZhvUgx','qXbtb','peerUid','LFjrM','xBpLf','stringify','msgSeq','vNEHw','updateMsg','gfCQY','has','wVLOu','msgCache','errno','BRhbj','uskaw','name','671660hyycMe','xHvFG','FGUHv','getMsgBySeq','THmQg','DSOBo','FuDBz','uin','stack','addMsg','4fmBiWo','数据库中消息最大短id','HPcNj','Yimye','yGOHW','then','ZSjXt','set','WeQVF','getMsgByLongId','YwJUR','maCRQ','45rJCcoh','更新消息,\x20shortId:','addFileCache','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','path','db\x20could\x20not\x20add\x20file','msgList','Could\x20not\x20get\x20msg','catch','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','shortId','EJXgB','getReceivedTempUinMap',',\x20msgId:\x20','kdwLi','Vbrpm','eOHTa','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','run','getFileCacheByUuid','SZUjQ','HOQgZ','OPEN_CREATE','BbAmG','bFqkH','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','db\x20could\x20not\x20get\x20temp\x20uin\x20map','1330QgJLGo','get','prepare','init','Could\x20not\x20create\x20table\x20msgs','msgTime','Andkf','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','3ZdCnpp','LSVom','GKuQh','db\x20could\x20not\x20get\x20file\x20cache','auzoR','db\x20getMsgByLongId\x20error','getFileCache','createTable','uuid','Database','iDHxl','HZmnf','uid','toString','getCurrentMaxShortId','elementId','记录消息到数据库,\x20消息长id:\x20','zrsxZ','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','mYrsx','TnUtT','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','vtuJi','getUidByTempUin','OPEN_READWRITE','13iqXPiz','close','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','523552abnLcQ','315761hiJXKV','24542268chaDzj','Could\x20not\x20create\x20table\x20temp_uins','VfeBX','HZbwX','sqDeO','forEach','url','377526yiSOOl','OqBeI','globalMsgShortId','QmIMM','SELECT\x20*\x20FROM\x20temp_uins','element','Could\x20not\x20connect\x20to\x20database','now','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','assign','XFxbi','doCnJ','XqAVd','hqdOX','updateMsg\x20db\x20error','addTempUin','eimtI','ebyZs','longId','oBZhf','51568dLdnaj','getMsgsByMsgId','getMsg','puBtY','db\x20could\x20not\x20add\x20msg','hdmcP','maxId','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','oSHre','elementType','db\x20could\x20not\x20add\x20temp\x20uin','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','iPoIR','msgId','14919768LJlnFf',',\x20短id:\x20','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','HqTmi'];_0x1291=function(){return _0x497a21;};return _0x1291();}export const dbUtil=new DBUtil();