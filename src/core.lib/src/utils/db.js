const _0x55333a=_0x57e7;(function(_0x20272c,_0x56587f){const _0x395291=_0x57e7,_0x41d5be=_0x20272c();while(!![]){try{const _0x43eb25=parseInt(_0x395291(0x199))/0x1+-parseInt(_0x395291(0x1a1))/0x2+-parseInt(_0x395291(0x14e))/0x3+parseInt(_0x395291(0x164))/0x4+-parseInt(_0x395291(0x1a7))/0x5+parseInt(_0x395291(0x146))/0x6+parseInt(_0x395291(0x154))/0x7*(-parseInt(_0x395291(0x1a9))/0x8);if(_0x43eb25===_0x56587f)break;else _0x41d5be['push'](_0x41d5be['shift']());}catch(_0x191a23){_0x41d5be['push'](_0x41d5be['shift']());}}}(_0x5545,0xa6517));import _0x4548cb from'sqlite3';function _0x57e7(_0x4619d1,_0x391fd3){const _0x554563=_0x5545();return _0x57e7=function(_0x57e7c9,_0x81bf93){_0x57e7c9=_0x57e7c9-0x138;let _0x43d0b7=_0x554563[_0x57e7c9];return _0x43d0b7;},_0x57e7(_0x4619d1,_0x391fd3);}import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x55333a(0x194)](_0x35b02c){const _0x52fabd=_0x55333a,_0x59d17f={'WaUtu':_0x52fabd(0x190),'LLZlV':function(_0x4a0c82,_0x457575){return _0x4a0c82(_0x457575);},'ErDHH':function(_0x437fa5,_0x279eb8){return _0x437fa5|_0x279eb8;}};if(this['db'])return;return new Promise((_0x415213,_0x1bea17)=>{const _0x3b1109=_0x52fabd,_0x52c24b={'YlBcF':_0x59d17f['WaUtu'],'iklMm':function(_0x24425e,_0x336461){return _0x59d17f['LLZlV'](_0x24425e,_0x336461);}};this['db']=new _0x4548cb[(_0x3b1109(0x177))](_0x35b02c,_0x59d17f['ErDHH'](_0x4548cb[_0x3b1109(0x1a2)],_0x4548cb[_0x3b1109(0x171)]),_0x219f07=>{const _0x28a6c3=_0x3b1109;if(_0x219f07){logError(_0x52c24b['YlBcF'],_0x219f07),_0x52c24b[_0x28a6c3(0x1b7)](_0x1bea17,_0x219f07);return;}this[_0x28a6c3(0x1aa)](),_0x415213();});});}['createTable'](){const _0x4c9b73=_0x55333a,_0x2e0c16={'hpOxZ':_0x4c9b73(0x1ad)};throw new Error(_0x2e0c16[_0x4c9b73(0x1b8)]);}[_0x55333a(0x155)](){const _0x5b4eaa=_0x55333a;this['db']?.[_0x5b4eaa(0x155)]();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();[_0x55333a(0x163)]=-0x7ffffff8;constructor(){const _0x65a4d5=_0x55333a,_0x37e539={'ovZNg':function(_0x1d002b,_0x10c2de){return _0x1d002b>_0x10c2de;},'cOmQy':function(_0x59990a,_0x1a8246){return _0x59990a-_0x1a8246;},'fMEWV':function(_0x47dc0d,_0x1574b8){return _0x47dc0d*_0x1574b8;},'NACOT':function(_0x1f17c2,_0x4aced6){return _0x1f17c2(_0x4aced6);},'lAWhb':function(_0x26e294,_0x348364){return _0x26e294*_0x348364;},'GbsgQ':function(_0x25de4f,_0xff233f,_0x3bdf49){return _0x25de4f(_0xff233f,_0x3bdf49);}};super();const _0x45095c=_0x37e539[_0x65a4d5(0x16d)](0x3e8,0x3c)*0xa;_0x37e539[_0x65a4d5(0x1ae)](setInterval,()=>{const _0x6fb0a9=_0x65a4d5;_0x37e539[_0x6fb0a9(0x148)](logDebug,_0x6fb0a9(0x183)),this[_0x6fb0a9(0x14b)][_0x6fb0a9(0x1b4)]((_0x2fc6dc,_0x5f5da6)=>{const _0x1a0bc7=_0x6fb0a9;_0x37e539[_0x1a0bc7(0x1bf)](_0x37e539['cOmQy'](Date['now'](),_0x37e539[_0x1a0bc7(0x165)](_0x37e539[_0x1a0bc7(0x148)](parseInt,_0x2fc6dc[_0x1a0bc7(0x1c8)]),0x3e8)),_0x45095c)&&this['msgCache'][_0x1a0bc7(0x18b)](_0x5f5da6);});},_0x45095c);}async['init'](_0x40cb04){const _0x458029=_0x55333a;await super[_0x458029(0x194)](_0x40cb04),this[_0x458029(0x163)]=await this[_0x458029(0x188)]();}[_0x55333a(0x1aa)](){const _0x304d9c=_0x55333a,_0x4f284d={'rcvnn':function(_0x333909,_0x2dfc4d,_0x36cc34){return _0x333909(_0x2dfc4d,_0x36cc34);},'naIzY':_0x304d9c(0x16b),'eQWtu':_0x304d9c(0x19d),'obxkm':function(_0x2a3a93,_0x2c2603,_0x73460d){return _0x2a3a93(_0x2c2603,_0x73460d);}},_0xc0b6f2=_0x304d9c(0x13a);this['db'][_0x304d9c(0x1be)](_0xc0b6f2,function(_0x37d01f){const _0x3fb4fd=_0x304d9c;_0x37d01f&&_0x4f284d[_0x3fb4fd(0x19e)](logError,_0x4f284d[_0x3fb4fd(0x14a)],_0x37d01f[_0x3fb4fd(0x156)]);});const _0x1a5fbd=_0x304d9c(0x16f);this['db'][_0x304d9c(0x1be)](_0x1a5fbd,function(_0x44bd40){const _0x4dc565=_0x304d9c;_0x44bd40&&_0x4f284d[_0x4dc565(0x19e)](logError,_0x4f284d[_0x4dc565(0x1bc)],_0x44bd40);});const _0x2f1faa=_0x304d9c(0x15f);this['db'][_0x304d9c(0x1be)](_0x2f1faa,function(_0x5e532d){const _0x226e17=_0x304d9c;_0x5e532d&&_0x4f284d[_0x226e17(0x191)](logError,_0x226e17(0x17d),_0x5e532d);});}async['getCurrentMaxShortId'](){const _0x36841a=_0x55333a,_0x57d1fe={'FHeeq':_0x36841a(0x168),'acQlK':function(_0x5762ee,_0x230970){return _0x5762ee(_0x230970);},'nSsKQ':_0x36841a(0x13f),'qJuRy':_0x36841a(0x16e)};return new Promise((_0x13a87b,_0x31a22c)=>{const _0x3f27d7=_0x36841a;this['db'][_0x3f27d7(0x174)](_0x57d1fe[_0x3f27d7(0x13e)],(_0x5822dd,_0x4bcdef)=>{const _0x2daa50=_0x3f27d7;if(_0x5822dd)return logDebug(_0x57d1fe[_0x2daa50(0x1b2)],_0x5822dd),_0x57d1fe[_0x2daa50(0x142)](_0x13a87b,-0x7ffffff8);logDebug(_0x57d1fe[_0x2daa50(0x147)],_0x4bcdef?.['maxId']),_0x57d1fe[_0x2daa50(0x142)](_0x13a87b,_0x4bcdef?.[_0x2daa50(0x144)]??-0x7ffffff8);});});}async[_0x55333a(0x1a5)](_0x48a1d6,_0x517fb9){const _0xc85ec2=_0x55333a,_0x4efeef={'vaidL':function(_0x38f1f5,_0x2c0d9c,_0x59882e,_0x197926,_0x34d0bc){return _0x38f1f5(_0x2c0d9c,_0x59882e,_0x197926,_0x34d0bc);},'UOGeD':function(_0x23a016,_0x22e71e){return _0x23a016(_0x22e71e);}},_0x4e474a=this['db'][_0xc85ec2(0x1a0)](_0x48a1d6);return new Promise((_0x41b23d,_0x658f3d)=>{const _0x651823=_0xc85ec2,_0x228a76={'eIlSu':function(_0xfca80f,_0x90bd72){const _0x294fb3=_0x57e7;return _0x4efeef[_0x294fb3(0x13c)](_0xfca80f,_0x90bd72);}};_0x4e474a[_0x651823(0x174)](..._0x517fb9,(_0x3e4b43,_0x43a872)=>{const _0x46526f=_0x651823,_0x252b3c={'WBJrq':function(_0x12eb9d,_0x385241){return _0x12eb9d(_0x385241);}};if(_0x3e4b43)return _0x4efeef[_0x46526f(0x145)](logError,'Could\x20not\x20get\x20msg',_0x3e4b43,_0x48a1d6,_0x517fb9),_0x41b23d(null);if(!_0x43a872){_0x4efeef[_0x46526f(0x13c)](_0x41b23d,null);return;}const _0x19e9f0=_0x43a872[_0x46526f(0x14d)];NTQQMsgApi[_0x46526f(0x17b)]({'peerUid':_0x43a872['peerUid'],'chatType':_0x43a872['chatType']},[_0x19e9f0])['then'](_0x39af58=>{const _0x252044=_0x46526f,_0x58465b=_0x39af58[_0x252044(0x1ab)][0x0];if(!_0x58465b){_0x228a76[_0x252044(0x1c6)](_0x41b23d,null);return;}_0x58465b['id']=_0x43a872[_0x252044(0x1bb)],_0x41b23d(_0x58465b);})[_0x46526f(0x175)](_0x3530aa=>{const _0x562753=_0x46526f;_0x252b3c[_0x562753(0x15c)](_0x41b23d,null);});});});}async[_0x55333a(0x181)](_0x4fbd76){const _0x592561=_0x55333a,_0x16e6bb={'KPGzJ':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?'};if(this[_0x592561(0x14b)][_0x592561(0x169)](_0x4fbd76))return this[_0x592561(0x14b)][_0x592561(0x174)](_0x4fbd76);const _0x231fe8=_0x16e6bb[_0x592561(0x14c)];return this['getMsg'](_0x231fe8,[_0x4fbd76]);}async[_0x55333a(0x139)](_0x1d6395){const _0x27d9c4=_0x55333a,_0x804c05={'WRHWA':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?'};if(this[_0x27d9c4(0x14b)][_0x27d9c4(0x169)](_0x1d6395))return this[_0x27d9c4(0x14b)][_0x27d9c4(0x174)](_0x1d6395);return this['getMsg'](_0x804c05[_0x27d9c4(0x141)],[_0x1d6395]);}async[_0x55333a(0x1a8)](_0x3a6f33,_0x3a787e){const _0x2b890d=_0x55333a,_0x368988={'CADef':_0x2b890d(0x172)},_0x39100c=_0x368988[_0x2b890d(0x18a)];return this['getMsg'](_0x39100c,[_0x3a6f33,_0x3a787e]);}async['addMsg'](_0x41680f,_0x43453a=!![]){const _0x408a13=_0x55333a,_0x33cbba={'IEjJE':function(_0x45d333,_0x17ea18,_0x4e2182){return _0x45d333(_0x17ea18,_0x4e2182);},'juCqs':function(_0x5d6516,_0x11cd76){return _0x5d6516===_0x11cd76;},'GyiCW':function(_0xe2e0f4,_0x9619a6,_0x284770){return _0xe2e0f4(_0x9619a6,_0x284770);},'AfLdX':'db\x20could\x20not\x20add\x20msg','GhyWe':'INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','BdBGu':function(_0x52b4bd,_0x5710b2){return _0x52b4bd(_0x5710b2);}},_0x34f511=await this[_0x408a13(0x139)](_0x41680f[_0x408a13(0x1bd)]);if(_0x34f511){if(_0x43453a)this[_0x408a13(0x17f)](_0x41680f)[_0x408a13(0x152)]();return _0x34f511['id'];}const _0x10c7f0=this['db'][_0x408a13(0x1a0)](_0x33cbba[_0x408a13(0x178)]),_0x2d9493=++this[_0x408a13(0x163)];return _0x41680f['id']=_0x2d9493,_0x33cbba['BdBGu'](logDebug,'记录消息到数据库,\x20消息长id:\x20'+_0x41680f['msgId']+_0x408a13(0x1a4)+_0x41680f['id']),this['msgCache'][_0x408a13(0x196)](_0x2d9493,_0x41680f),this[_0x408a13(0x14b)][_0x408a13(0x196)](_0x41680f[_0x408a13(0x1bd)],_0x41680f),_0x10c7f0['run'](this['globalMsgShortId'],_0x41680f[_0x408a13(0x1bd)],_0x41680f[_0x408a13(0x14f)][_0x408a13(0x1b6)](),_0x41680f[_0x408a13(0x1c7)],_0x41680f[_0x408a13(0x1c4)],_0x361f81=>{const _0x1e77b6=_0x408a13;_0x361f81&&(_0x33cbba[_0x1e77b6(0x15a)](_0x361f81[_0x1e77b6(0x15d)],0x13)?this[_0x1e77b6(0x139)](_0x41680f['msgId'])[_0x1e77b6(0x152)](_0x51a57a=>{const _0x180c83=_0x1e77b6;_0x51a57a?(this[_0x180c83(0x14b)][_0x180c83(0x196)](_0x2d9493,_0x51a57a),this[_0x180c83(0x14b)]['set'](_0x51a57a[_0x180c83(0x1bd)],_0x51a57a)):_0x33cbba['IEjJE'](logError,_0x180c83(0x179),_0x361f81);})[_0x1e77b6(0x175)](_0xb7296a=>logError(_0x1e77b6(0x1b1),_0xb7296a)):_0x33cbba[_0x1e77b6(0x157)](logError,_0x33cbba[_0x1e77b6(0x185)],_0x361f81));}),_0x2d9493;}async['updateMsg'](_0x4109d9){const _0x25715d=_0x55333a,_0x578f2c={'XvCJS':function(_0x45df94,_0x7a8732,_0xb7d731){return _0x45df94(_0x7a8732,_0xb7d731);},'ybuKK':_0x25715d(0x1c0)},_0x79cefd=this[_0x25715d(0x14b)]['get'](_0x4109d9['msgId']);_0x79cefd&&Object[_0x25715d(0x176)](_0x79cefd,_0x4109d9);logDebug(_0x25715d(0x189)+_0x4109d9['id']+_0x25715d(0x170)+_0x4109d9[_0x25715d(0x14f)]+_0x25715d(0x195)+_0x4109d9[_0x25715d(0x1bd)]);const _0x1d5b65=this['db']['prepare'](_0x25715d(0x1b9));_0x1d5b65[_0x25715d(0x1be)](_0x4109d9[_0x25715d(0x14f)],_0x4109d9[_0x25715d(0x1bd)],_0x1e330f=>{const _0xcb1e8e=_0x25715d;_0x1e330f&&_0x578f2c[_0xcb1e8e(0x180)](logError,_0x578f2c[_0xcb1e8e(0x18e)],_0x1e330f);});}async[_0x55333a(0x1c3)](_0xbe638c){const _0x2d8432=_0x55333a,_0x1e44c6={'QZlck':_0x2d8432(0x140),'RNOmN':function(_0x2ff2a5,_0x148050){return _0x2ff2a5(_0x148050);},'FotMW':function(_0x80960d,_0x49bc64){return _0x80960d(_0x49bc64);}},_0x3d51d5=this['db']['prepare'](_0x2d8432(0x1a6));return new Promise((_0x32de76,_0x459711)=>{const _0x11de84=_0x2d8432,_0x3f61c4={'HODWe':function(_0x362292,_0x36c590,_0x3df70b){return _0x362292(_0x36c590,_0x3df70b);},'tAPWU':_0x1e44c6['QZlck'],'Wsghj':function(_0x364eac,_0x38c198){const _0x5ea061=_0x57e7;return _0x1e44c6[_0x5ea061(0x159)](_0x364eac,_0x38c198);},'ZvrHL':function(_0x177cea,_0x4139cf){const _0x459403=_0x57e7;return _0x1e44c6[_0x459403(0x17c)](_0x177cea,_0x4139cf);}};_0x3d51d5['run'](_0xbe638c[_0x11de84(0x182)],_0xbe638c[_0x11de84(0x16c)],_0xbe638c['url'],_0xbe638c[_0x11de84(0x13b)],_0xbe638c[_0x11de84(0x149)],_0xbe638c['elementType'],JSON[_0x11de84(0x18c)](_0xbe638c['element']),_0xbe638c[_0x11de84(0x1c5)],_0xbe638c[_0x11de84(0x1bd)],function(_0x5c5c85){const _0x45e53f=_0x11de84;_0x5c5c85&&(_0x3f61c4['HODWe'](logError,_0x3f61c4[_0x45e53f(0x184)],_0x5c5c85),_0x3f61c4['Wsghj'](_0x459711,_0x5c5c85)),_0x3f61c4['ZvrHL'](_0x32de76,null);});});}async['getFileCache'](_0x396663,_0x4c7fb0){const _0x33b8ba=_0x55333a,_0x25912d={'wrqou':function(_0x415fdd,_0x1b2b0a,_0x250935){return _0x415fdd(_0x1b2b0a,_0x250935);},'JFtoc':_0x33b8ba(0x19f),'qtTjw':function(_0x15c9e8,_0x5dd1ae){return _0x15c9e8(_0x5dd1ae);}},_0x58713d=this['db']['prepare'](_0x396663);return new Promise((_0x2923c1,_0x4a2c37)=>{const _0x421017=_0x33b8ba,_0x54559d={'ceacB':function(_0xe184e6,_0x4f5665,_0x243485){const _0x7890c8=_0x57e7;return _0x25912d[_0x7890c8(0x150)](_0xe184e6,_0x4f5665,_0x243485);},'Iwhxk':_0x25912d[_0x421017(0x17a)],'irfqv':function(_0x588e08,_0x5aa858){return _0x25912d['qtTjw'](_0x588e08,_0x5aa858);}};_0x58713d['get'](..._0x4c7fb0,(_0x2430da,_0x42f3ac)=>{const _0x44bbf8=_0x421017;_0x2430da&&(_0x54559d['ceacB'](logError,_0x54559d[_0x44bbf8(0x1b0)],_0x2430da),_0x4a2c37(_0x2430da)),_0x42f3ac&&(_0x42f3ac['element']=JSON[_0x44bbf8(0x18d)](_0x42f3ac['element'])),_0x54559d[_0x44bbf8(0x19c)](_0x2923c1,_0x42f3ac);});});}async['getFileCacheByName'](_0x451e23){const _0x46e721=_0x55333a;return this[_0x46e721(0x186)]('SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?',[_0x451e23]);}async['getFileCacheByUuid'](_0x1c48f6){const _0x5a73eb=_0x55333a,_0x44af42={'zkTEv':_0x5a73eb(0x153)};return this['getFileCache'](_0x44af42[_0x5a73eb(0x17e)],[_0x1c48f6]);}async[_0x55333a(0x166)](_0x3ccd5e){const _0x113de0=_0x55333a,_0x7156f1={'TzfPv':_0x113de0(0x162)},_0x325035=this['db'][_0x113de0(0x1a0)](_0x7156f1[_0x113de0(0x1c1)]);return new Promise((_0x2faa46,_0x1a0f78)=>{const _0x1cba0c=_0x113de0,_0x87c693={'iYiva':function(_0x2f6b98,_0x521cfc,_0x3190c7){return _0x2f6b98(_0x521cfc,_0x3190c7);}};_0x325035[_0x1cba0c(0x1be)](_0x3ccd5e[_0x1cba0c(0x16c)],_0x3ccd5e[_0x1cba0c(0x13d)],_0x3ccd5e[_0x1cba0c(0x149)],function(_0x352c50){const _0x563fb5=_0x1cba0c;_0x352c50&&(_0x87c693[_0x563fb5(0x193)](logError,_0x563fb5(0x192),_0x352c50),_0x1a0f78(_0x352c50)),_0x2faa46(null);});});}async[_0x55333a(0x1a3)](){const _0x5049e8=_0x55333a,_0x5ac977={'Bfuuf':function(_0x3baf21,_0x99752a,_0xf90c16){return _0x3baf21(_0x99752a,_0xf90c16);},'sBUVU':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','YHaJt':function(_0x4a9457,_0x4bd39d){return _0x4a9457(_0x4bd39d);}},_0x15f820=_0x5049e8(0x173);return new Promise((_0x55323e,_0x1bab7a)=>{const _0x32d83a=_0x5049e8,_0x247c82={'zQaPP':function(_0x4e0a7d,_0x4218fb,_0x174acb){const _0x369353=_0x57e7;return _0x5ac977[_0x369353(0x18f)](_0x4e0a7d,_0x4218fb,_0x174acb);},'NPqGk':_0x5ac977[_0x32d83a(0x1b5)],'gNEUJ':function(_0x4bcba0,_0x335976){const _0x1150c6=_0x32d83a;return _0x5ac977[_0x1150c6(0x15e)](_0x4bcba0,_0x335976);}};this['db'][_0x32d83a(0x15b)](_0x15f820,(_0x2565a7,_0x468ecf)=>{const _0x15bcdc=_0x32d83a;_0x2565a7&&(_0x247c82[_0x15bcdc(0x138)](logError,_0x247c82['NPqGk'],_0x2565a7),_0x247c82['gNEUJ'](_0x1bab7a,_0x2565a7));const _0x2ea7fa={};_0x468ecf[_0x15bcdc(0x1b4)](_0x283e78=>{const _0x639d6=_0x15bcdc;_0x2ea7fa[_0x283e78[_0x639d6(0x198)]]=_0x283e78[_0x639d6(0x16a)];}),_0x247c82['gNEUJ'](_0x55323e,_0x2ea7fa);});});}async[_0x55333a(0x1c2)](_0xb98ebf){const _0x451e58=_0x55333a,_0x1ada7d={'rNRTu':function(_0x484bed,_0x1acb64,_0x530f3c){return _0x484bed(_0x1acb64,_0x530f3c);},'BfJsq':_0x451e58(0x19b),'WnXeD':function(_0x1e9544,_0x57e00e){return _0x1e9544(_0x57e00e);},'HAxmK':_0x451e58(0x19a)},_0x174810=_0x1ada7d['HAxmK'];return new Promise((_0x35b20c,_0x15312b)=>{const _0x180066=_0x451e58,_0x155715={'SnMqx':function(_0x24534c,_0x2e5735,_0x4d4f36){return _0x1ada7d['rNRTu'](_0x24534c,_0x2e5735,_0x4d4f36);},'bBuyV':_0x1ada7d[_0x180066(0x167)],'GjgKK':function(_0x20548d,_0x356553){return _0x20548d(_0x356553);},'UMnpZ':function(_0x23b7b4,_0x4721ee){const _0x29b8a8=_0x180066;return _0x1ada7d[_0x29b8a8(0x160)](_0x23b7b4,_0x4721ee);}};this['db'][_0x180066(0x174)](_0x174810,[_0xb98ebf],(_0x451f31,_0x3a8c06)=>{const _0x1acff2=_0x180066;_0x451f31&&(_0x155715[_0x1acff2(0x197)](logError,_0x155715[_0x1acff2(0x1b3)],_0x451f31),_0x155715['GjgKK'](_0x15312b,_0x451f31)),_0x155715[_0x1acff2(0x151)](_0x35b20c,_0x3a8c06?.['uid']);});});}async[_0x55333a(0x161)](_0x26bdd5,_0x37a798){const _0x32b273=_0x55333a,_0x26052f={'KIoPM':function(_0x337ee1,_0x4ee2f4,_0x425a4c){return _0x337ee1(_0x4ee2f4,_0x425a4c);},'QnIyA':_0x32b273(0x158),'yjsVO':function(_0x5e7c06,_0x291ffa){return _0x5e7c06(_0x291ffa);},'PTuCe':_0x32b273(0x187)},_0x14539b=await this[_0x32b273(0x1c2)](_0x26bdd5);if(!_0x14539b){const _0x20a6b5=this['db'][_0x32b273(0x1a0)](_0x26052f[_0x32b273(0x1af)]);return new Promise((_0x5e9025,_0x296e6d)=>{_0x20a6b5['run'](_0x26bdd5,_0x37a798,function(_0x3fc0d7){const _0x4c3f72=_0x57e7;_0x3fc0d7&&(_0x26052f[_0x4c3f72(0x1ac)](logError,_0x26052f[_0x4c3f72(0x1ba)],_0x3fc0d7),_0x26052f[_0x4c3f72(0x143)](_0x296e6d,_0x3fc0d7)),_0x5e9025(null);});});}}}function _0x5545(){const _0x2c0557=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','size','UOGeD','url','qJuRy','数据库中消息最大短id','db\x20could\x20not\x20add\x20file','WRHWA','acQlK','yjsVO','maxId','vaidL','5417706DQBGwc','nSsKQ','NACOT','uuid','naIzY','msgCache','KPGzJ','longId','482247GcIbWf','msgSeq','wrqou','UMnpZ','then','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','305333pcqZnF','close','stack','GyiCW','db\x20could\x20not\x20add\x20temp\x20uin','RNOmN','juCqs','all','WBJrq','errno','YHaJt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','WnXeD','addTempUin','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','globalMsgShortId','4912300TqJmyJ','fMEWV','updateFileCache','BfJsq','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','has','uid','Could\x20not\x20create\x20table\x20msgs','path','lAWhb','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)',',\x20seq:\x20','OPEN_CREATE','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','SELECT\x20*\x20FROM\x20temp_uins','get','catch','assign','Database','GhyWe','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','JFtoc','getMsgsByMsgId','FotMW','Could\x20not\x20create\x20table\x20temp_uins','zkTEv','updateMsg','XvCJS','getMsgByShortId','name','清理消息缓存','tAPWU','AfLdX','getFileCache','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','getCurrentMaxShortId','更新消息,\x20shortId:','CADef','delete','stringify','parse','ybuKK','Bfuuf','Could\x20not\x20connect\x20to\x20database','obxkm','db\x20could\x20not\x20update\x20file\x20cache','iYiva','init',',\x20msgId:\x20','set','SnMqx','uin','265676tVSLzH','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','db\x20could\x20not\x20get\x20temp\x20uin\x20map','irfqv','Could\x20not\x20create\x20table\x20files','rcvnn','db\x20could\x20not\x20get\x20file\x20cache','prepare','230052krHvcs','OPEN_READWRITE','getReceivedTempUinMap',',\x20短id:\x20','getMsg','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','1091780swQTab','getMsgBySeq','224UoLltO','createTable','msgList','KIoPM','Method\x20not\x20implemented.','GbsgQ','PTuCe','Iwhxk','db\x20getMsgByLongId\x20error','FHeeq','bBuyV','forEach','sBUVU','toString','iklMm','hpOxZ','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','QnIyA','shortId','eQWtu','msgId','run','ovZNg','updateMsg\x20db\x20error','TzfPv','getUidByTempUin','addFileCache','chatType','elementId','eIlSu','peerUid','msgTime','zQaPP','getMsgByLongId'];_0x5545=function(){return _0x2c0557;};return _0x5545();}export const dbUtil=new DBUtil();