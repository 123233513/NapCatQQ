const _0x36f49b=_0x4ab5;(function(_0x3648a3,_0x32b7e1){const _0x30a3ed=_0x4ab5,_0x514b6f=_0x3648a3();while(!![]){try{const _0x5d73fd=-parseInt(_0x30a3ed(0x177))/0x1*(-parseInt(_0x30a3ed(0x16d))/0x2)+parseInt(_0x30a3ed(0x1a2))/0x3*(parseInt(_0x30a3ed(0x16e))/0x4)+parseInt(_0x30a3ed(0x13a))/0x5*(parseInt(_0x30a3ed(0x1b3))/0x6)+parseInt(_0x30a3ed(0x181))/0x7+-parseInt(_0x30a3ed(0x1a8))/0x8+-parseInt(_0x30a3ed(0x156))/0x9*(parseInt(_0x30a3ed(0x1a3))/0xa)+parseInt(_0x30a3ed(0x161))/0xb*(-parseInt(_0x30a3ed(0x171))/0xc);if(_0x5d73fd===_0x32b7e1)break;else _0x514b6f['push'](_0x514b6f['shift']());}catch(_0xc5dae1){_0x514b6f['push'](_0x514b6f['shift']());}}}(_0x5b07,0x73d48));import _0x1260cd from'sqlite3';import{logDebug,logError}from'@/common/utils/log';function _0x4ab5(_0x4653fc,_0x5c134c){const _0x5b074e=_0x5b07();return _0x4ab5=function(_0x4ab5d8,_0x27d6d0){_0x4ab5d8=_0x4ab5d8-0x136;let _0x573bb8=_0x5b074e[_0x4ab5d8];return _0x573bb8;},_0x4ab5(_0x4653fc,_0x5c134c);}import{NTQQMsgApi}from'@/core';function _0x5b07(){const _0x5ba835=['traPo','forEach','msgSeq','updateMsg','has','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','msgCache','清理消息缓存','qjXLc','Could\x20not\x20create\x20table\x20temp_uins','skced','gYkKr','now','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','getMsgByLongId','db\x20could\x20not\x20add\x20temp\x20uin','RXpCC','prepare','966PtALOr','110TYgxwg',',\x20seq:\x20','ONTWf','name','globalMsgShortId','2210832CnNnoM','vwgaK','OPEN_READWRITE','msgTime','hyJfd','longId','createTable','init','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','mIjkX','Database','6fRDhBF','BHQKu','url','getMsgBySeq','addFileCache','Method\x20not\x20implemented.','FEzle','db\x20could\x20not\x20update\x20file\x20cache','OEXpj','lVmwt','stringify','db\x20could\x20not\x20add\x20msg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','2190145PGQzCe','run','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','EyWTk','elementType','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','wXbwK','db\x20getMsgByLongId\x20error','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','atyoT','Could\x20not\x20get\x20msg','msgList','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','close','getCurrentMaxShortId',',\x20msgId:\x20','aSlCk','zsQJR','UUlOt','errno','HfFED','catch','SELECT\x20*\x20FROM\x20temp_uins','getReceivedTempUinMap','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','maxId','path','rTTIT','483507DjjaFn','IGSoo','QqixB','then','记录消息到数据库,\x20消息长id:\x20','aEGqn','YQcuF','TdnnO','Bqwdx','parse','stack','326667jzeXWb','getMsgsByMsgId','shortId','TRQpp','element','assign','peerUid','更新消息,\x20shortId:','wWPsd','size','OJwVQ','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','700424LdTiYH','4916fqwarX','uid','TrvJr','216EKohJI','IGQoa','addMsg','YqPEv','DXVbF','awBAk','2kIgkGm','Could\x20not\x20create\x20table\x20files','YcVUi','ygRoW','getMsg','bJveR','getFileCache','set','get','BEziG','2394714gOvcCu','Could\x20not\x20create\x20table\x20msgs','BdMqk','getUidByTempUin','puVEc','eagJV','NyAQl','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','addTempUin','uin','ESJRD','CPgoy','msgId','vCjYm'];_0x5b07=function(){return _0x5ba835;};return _0x5b07();}class DBUtilBase{['db'];async[_0x36f49b(0x1af)](_0x2b9eb9){const _0x4b0620={'skced':function(_0x2b6cdf,_0xcd47fe,_0x52e16b){return _0x2b6cdf(_0xcd47fe,_0x52e16b);},'IGQoa':'Could\x20not\x20connect\x20to\x20database','atyoT':function(_0x214346,_0x3856ab){return _0x214346(_0x3856ab);},'dTsWZ':function(_0xe0cb92){return _0xe0cb92();},'wWPsd':function(_0x5053ba,_0x3289c5){return _0x5053ba|_0x3289c5;}};if(this['db'])return;return new Promise((_0xe0b26f,_0x400953)=>{const _0x13d874=_0x4ab5,_0x369e91={'CavXM':function(_0x1932f8,_0x16ea08,_0x5be3d3){const _0x1a8bce=_0x4ab5;return _0x4b0620[_0x1a8bce(0x19a)](_0x1932f8,_0x16ea08,_0x5be3d3);},'zsQJR':_0x4b0620[_0x13d874(0x172)],'ESJRD':function(_0x4bad30,_0x3a2184){const _0x55b26f=_0x13d874;return _0x4b0620[_0x55b26f(0x143)](_0x4bad30,_0x3a2184);},'gYkKr':function(_0x3cc91e){return _0x4b0620['dTsWZ'](_0x3cc91e);}};this['db']=new _0x1260cd[(_0x13d874(0x1b2))](_0x2b9eb9,_0x4b0620[_0x13d874(0x169)](_0x1260cd[_0x13d874(0x1aa)],_0x1260cd['OPEN_CREATE']),_0x291f4d=>{const _0x51c801=_0x13d874;if(_0x291f4d){_0x369e91['CavXM'](logError,_0x369e91[_0x51c801(0x14b)],_0x291f4d),_0x369e91[_0x51c801(0x18c)](_0x400953,_0x291f4d);return;}this[_0x51c801(0x1ae)](),_0x369e91[_0x51c801(0x19b)](_0xe0b26f);});});}['createTable'](){const _0x42c059=_0x36f49b,_0x5f51fd={'CPgoy':_0x42c059(0x1b8)};throw new Error(_0x5f51fd[_0x42c059(0x18d)]);}[_0x36f49b(0x147)](){const _0x1a64ab=_0x36f49b;this['db']?.[_0x1a64ab(0x147)]();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();[_0x36f49b(0x1a7)]=-0x7ffffff8;constructor(){const _0xa520e4=_0x36f49b,_0x42ebb2={'YQcuF':function(_0x17bf63,_0x25868d){return _0x17bf63>_0x25868d;},'BQCRh':function(_0x393f86,_0xdc0e15){return _0x393f86-_0xdc0e15;},'evNoq':function(_0x12112d,_0x344e53){return _0x12112d(_0x344e53);},'aSlCk':function(_0x244778,_0x21c450){return _0x244778(_0x21c450);},'TrvJr':_0xa520e4(0x197),'KYlvN':function(_0x265050,_0x4b5d89){return _0x265050*_0x4b5d89;}};super();const _0x43bf37=_0x42ebb2['KYlvN'](0x3e8*0x3c,0xa);setInterval(()=>{const _0x51f1f1=_0xa520e4;_0x42ebb2[_0x51f1f1(0x14a)](logDebug,_0x42ebb2[_0x51f1f1(0x170)]),this['msgCache'][_0x51f1f1(0x191)]((_0x2aeebc,_0x16b658)=>{const _0x5bd67e=_0x51f1f1;_0x42ebb2[_0x5bd67e(0x15c)](_0x42ebb2['BQCRh'](Date[_0x5bd67e(0x19c)](),_0x42ebb2['evNoq'](parseInt,_0x2aeebc[_0x5bd67e(0x1ab)])*0x3e8),_0x43bf37)&&this['msgCache']['delete'](_0x16b658);});},_0x43bf37);}async[_0x36f49b(0x1af)](_0x5a2508){const _0x2f5d2a=_0x36f49b;await super[_0x2f5d2a(0x1af)](_0x5a2508),this[_0x2f5d2a(0x1a7)]=await this[_0x2f5d2a(0x148)]();}[_0x36f49b(0x1ae)](){const _0x2d81c8=_0x36f49b,_0x213d89={'puVEc':_0x2d81c8(0x182),'qDRsG':_0x2d81c8(0x178),'ONTWf':function(_0x422906,_0x4a5e6f,_0xa999e0){return _0x422906(_0x4a5e6f,_0xa999e0);},'OJwVQ':_0x2d81c8(0x199)},_0x2c5cc4=_0x2d81c8(0x1b0);this['db'][_0x2d81c8(0x13b)](_0x2c5cc4,function(_0x3620c2){const _0x4ce362=_0x2d81c8;_0x3620c2&&logError(_0x213d89[_0x4ce362(0x185)],_0x3620c2[_0x4ce362(0x160)]);});const _0xd29148=_0x2d81c8(0x139);this['db'][_0x2d81c8(0x13b)](_0xd29148,function(_0x1caee8){_0x1caee8&&logError(_0x213d89['qDRsG'],_0x1caee8);});const _0x4e1911=_0x2d81c8(0x19d);this['db'][_0x2d81c8(0x13b)](_0x4e1911,function(_0x3fe9e6){const _0x562d97=_0x2d81c8;_0x3fe9e6&&_0x213d89[_0x562d97(0x1a5)](logError,_0x213d89[_0x562d97(0x16b)],_0x3fe9e6);});}async[_0x36f49b(0x148)](){const _0x2d8409=_0x36f49b,_0xaad1c6={'HfFED':function(_0x406043,_0x3c8bdf,_0x304f72){return _0x406043(_0x3c8bdf,_0x304f72);},'umwqe':'Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','suhNa':function(_0x543ea2,_0x5dc082){return _0x543ea2(_0x5dc082);},'YqPEv':function(_0xab02d8,_0x62827,_0x25cbff){return _0xab02d8(_0x62827,_0x25cbff);},'UUlOt':'数据库中消息最大短id','FEzle':_0x2d8409(0x142)};return new Promise((_0x136ef1,_0x1a0526)=>{const _0xcae690=_0x2d8409;this['db'][_0xcae690(0x17f)](_0xaad1c6[_0xcae690(0x1b9)],(_0x3a7706,_0x3497cd)=>{const _0x128964=_0xcae690;if(_0x3a7706)return _0xaad1c6[_0x128964(0x14e)](logDebug,_0xaad1c6['umwqe'],_0x3a7706),_0xaad1c6['suhNa'](_0x136ef1,-0x7ffffff8);_0xaad1c6[_0x128964(0x174)](logDebug,_0xaad1c6[_0x128964(0x14c)],_0x3497cd?.[_0x128964(0x153)]),_0x136ef1(_0x3497cd?.['maxId']??-0x7ffffff8);});});}async['getMsg'](_0xd4c6b4,_0x3f6017){const _0x48e1f8=_0x36f49b,_0x204d80={'BEziG':function(_0x10feea,_0x5c3ca7,_0x57fc85,_0x378be2,_0x56e193){return _0x10feea(_0x5c3ca7,_0x57fc85,_0x378be2,_0x56e193);},'vCjYm':_0x48e1f8(0x144),'ygRoW':function(_0x43fa4a,_0x5029c4){return _0x43fa4a(_0x5029c4);}},_0x178e62=this['db'][_0x48e1f8(0x1a1)](_0xd4c6b4);return new Promise((_0x4370f8,_0x1ae0c0)=>{const _0x4c33bc=_0x48e1f8,_0x711871={'NAPLn':function(_0x36b7ce,_0x2e9775){const _0x525f09=_0x4ab5;return _0x204d80[_0x525f09(0x17a)](_0x36b7ce,_0x2e9775);}};_0x178e62[_0x4c33bc(0x17f)](..._0x3f6017,(_0x5c47d7,_0xa53cd)=>{const _0x5c2456=_0x4c33bc,_0x2abbf6={'GiONX':function(_0x3f87c1,_0x4ea508){return _0x3f87c1(_0x4ea508);}};if(_0x5c47d7)return _0x204d80[_0x5c2456(0x180)](logError,_0x204d80[_0x5c2456(0x18f)],_0x5c47d7,_0xd4c6b4,_0x3f6017),_0x204d80['ygRoW'](_0x4370f8,null);if(!_0xa53cd){_0x204d80[_0x5c2456(0x17a)](_0x4370f8,null);return;}const _0x40f6eb=_0xa53cd[_0x5c2456(0x1ad)];NTQQMsgApi[_0x5c2456(0x162)]({'peerUid':_0xa53cd[_0x5c2456(0x167)],'chatType':_0xa53cd['chatType']},[_0x40f6eb])[_0x5c2456(0x159)](_0xe9c69d=>{const _0x198dcc=_0x5c2456,_0x3196df=_0xe9c69d[_0x198dcc(0x145)][0x0];if(!_0x3196df){_0x711871['NAPLn'](_0x4370f8,null);return;}_0x3196df['id']=_0xa53cd[_0x198dcc(0x163)],_0x4370f8(_0x3196df);})[_0x5c2456(0x14f)](_0x202547=>{_0x2abbf6['GiONX'](_0x4370f8,null);});});});}async['getMsgByShortId'](_0x56dcd9){const _0x3d119e=_0x36f49b,_0x3cb1b8={'OEXpj':_0x3d119e(0x152)};if(this[_0x3d119e(0x196)][_0x3d119e(0x194)](_0x56dcd9))return this['msgCache'][_0x3d119e(0x17f)](_0x56dcd9);const _0x2532df=_0x3cb1b8[_0x3d119e(0x1bb)];return this[_0x3d119e(0x17b)](_0x2532df,[_0x56dcd9]);}async['getMsgByLongId'](_0x57902a){const _0x47ed3f=_0x36f49b,_0x15befc={'hyJfd':_0x47ed3f(0x13c)};if(this[_0x47ed3f(0x196)]['has'](_0x57902a))return this[_0x47ed3f(0x196)]['get'](_0x57902a);return this[_0x47ed3f(0x17b)](_0x15befc[_0x47ed3f(0x1ac)],[_0x57902a]);}async[_0x36f49b(0x1b6)](_0x5aa750,_0x50e7cd){const _0x3c0c35=_0x36f49b,_0xca2085={'rTTIT':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?'},_0x1767df=_0xca2085[_0x3c0c35(0x155)];return this['getMsg'](_0x1767df,[_0x5aa750,_0x50e7cd]);}async[_0x36f49b(0x173)](_0x596a80,_0x5b727e=!![]){const _0x312c75=_0x36f49b,_0x9377e8={'YcVUi':function(_0x31d837,_0x18abb2,_0x206785){return _0x31d837(_0x18abb2,_0x206785);},'sqrKM':_0x312c75(0x195),'awBAk':function(_0x5538ad,_0x2e4923){return _0x5538ad===_0x2e4923;},'wXbwK':_0x312c75(0x138),'TRQpp':_0x312c75(0x189),'oqzmW':function(_0x52c6b4,_0x50c04f){return _0x52c6b4(_0x50c04f);}},_0x1c579e=await this[_0x312c75(0x19e)](_0x596a80['msgId']);if(_0x1c579e){if(_0x5b727e)this[_0x312c75(0x193)](_0x596a80)[_0x312c75(0x159)]();return _0x1c579e['id'];}const _0x43f428=this['db']['prepare'](_0x9377e8[_0x312c75(0x164)]),_0x254c1d=++this[_0x312c75(0x1a7)];return _0x596a80['id']=_0x254c1d,_0x9377e8['oqzmW'](logDebug,_0x312c75(0x15a)+_0x596a80[_0x312c75(0x18e)]+',\x20短id:\x20'+_0x596a80['id']),this['msgCache'][_0x312c75(0x17e)](_0x254c1d,_0x596a80),this[_0x312c75(0x196)]['set'](_0x596a80[_0x312c75(0x18e)],_0x596a80),_0x43f428[_0x312c75(0x13b)](this[_0x312c75(0x1a7)],_0x596a80[_0x312c75(0x18e)],_0x596a80['msgSeq']['toString'](),_0x596a80[_0x312c75(0x167)],_0x596a80['chatType'],_0x19e6ac=>{const _0x21f3e7=_0x312c75;_0x19e6ac&&(_0x9377e8[_0x21f3e7(0x176)](_0x19e6ac[_0x21f3e7(0x14d)],0x13)?this[_0x21f3e7(0x19e)](_0x596a80['msgId'])[_0x21f3e7(0x159)](_0x325cb9=>{const _0xc05b6c=_0x21f3e7;_0x325cb9?(this['msgCache'][_0xc05b6c(0x17e)](_0x254c1d,_0x325cb9),this[_0xc05b6c(0x196)]['set'](_0x325cb9[_0xc05b6c(0x18e)],_0x325cb9)):_0x9377e8['YcVUi'](logError,_0x9377e8['sqrKM'],_0x19e6ac);})['catch'](_0xa9ab80=>logError(_0x21f3e7(0x141),_0xa9ab80)):_0x9377e8[_0x21f3e7(0x179)](logError,_0x9377e8[_0x21f3e7(0x140)],_0x19e6ac));}),_0x254c1d;}async[_0x36f49b(0x193)](_0x2a4643){const _0x3dc365=_0x36f49b,_0x4cfae3={'BhesE':'updateMsg\x20db\x20error','xOvtK':function(_0x5ac582,_0x597a19){return _0x5ac582(_0x597a19);},'mIjkX':_0x3dc365(0x146)},_0x3968ee=this[_0x3dc365(0x196)][_0x3dc365(0x17f)](_0x2a4643[_0x3dc365(0x18e)]);_0x3968ee&&Object[_0x3dc365(0x166)](_0x3968ee,_0x2a4643);_0x4cfae3['xOvtK'](logDebug,_0x3dc365(0x168)+_0x2a4643['id']+_0x3dc365(0x1a4)+_0x2a4643[_0x3dc365(0x192)]+_0x3dc365(0x149)+_0x2a4643[_0x3dc365(0x18e)]);const _0x83e48c=this['db'][_0x3dc365(0x1a1)](_0x4cfae3[_0x3dc365(0x1b1)]);_0x83e48c['run'](_0x2a4643[_0x3dc365(0x192)],_0x2a4643[_0x3dc365(0x18e)],_0x2416a2=>{_0x2416a2&&logError(_0x4cfae3['BhesE'],_0x2416a2);});}async[_0x36f49b(0x1b7)](_0x12e57d){const _0x107346=_0x36f49b,_0x3bd365={'BqEjB':function(_0x3021e7,_0xedc143,_0x895ea5){return _0x3021e7(_0xedc143,_0x895ea5);},'vwgaK':'db\x20could\x20not\x20add\x20file','BdMqk':function(_0x3cf369,_0x4505f0){return _0x3cf369(_0x4505f0);}},_0x4180f2=this['db']['prepare'](_0x107346(0x16c));return new Promise((_0x454195,_0x329953)=>{const _0x46e560=_0x107346;_0x4180f2[_0x46e560(0x13b)](_0x12e57d[_0x46e560(0x1a6)],_0x12e57d[_0x46e560(0x154)],_0x12e57d[_0x46e560(0x1b5)],_0x12e57d[_0x46e560(0x16a)],_0x12e57d['uuid'],_0x12e57d[_0x46e560(0x13e)],JSON[_0x46e560(0x137)](_0x12e57d[_0x46e560(0x165)]),_0x12e57d['elementId'],_0x12e57d['msgId'],function(_0x1cac4a){const _0x470012=_0x46e560;_0x1cac4a&&(_0x3bd365['BqEjB'](logError,_0x3bd365[_0x470012(0x1a9)],_0x1cac4a),_0x329953(_0x1cac4a)),_0x3bd365[_0x470012(0x183)](_0x454195,null);});});}async[_0x36f49b(0x17d)](_0x5ede2f,_0x19af50){const _0x49d162={'saJTt':function(_0x6cda36,_0x16135e){return _0x6cda36(_0x16135e);}},_0x53a5b1=this['db']['prepare'](_0x5ede2f);return new Promise((_0x46fdb1,_0x26267f)=>{const _0x3f03ea=_0x4ab5,_0x324fa3={'TdnnO':'db\x20could\x20not\x20get\x20file\x20cache','BHQKu':function(_0xb7a7c8,_0x5c4663){return _0x49d162['saJTt'](_0xb7a7c8,_0x5c4663);}};_0x53a5b1[_0x3f03ea(0x17f)](..._0x19af50,(_0x2da78a,_0x316af0)=>{const _0x35e86d=_0x3f03ea;_0x2da78a&&(logError(_0x324fa3[_0x35e86d(0x15d)],_0x2da78a),_0x324fa3[_0x35e86d(0x1b4)](_0x26267f,_0x2da78a)),_0x316af0&&(_0x316af0[_0x35e86d(0x165)]=JSON[_0x35e86d(0x15f)](_0x316af0[_0x35e86d(0x165)])),_0x324fa3[_0x35e86d(0x1b4)](_0x46fdb1,_0x316af0);});});}async['getFileCacheByName'](_0x1b1a37){const _0x5d623a=_0x36f49b,_0x11478b={'traPo':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?'};return this[_0x5d623a(0x17d)](_0x11478b[_0x5d623a(0x190)],[_0x1b1a37]);}async['getFileCacheByUuid'](_0x3f9f99){const _0x2f12cd=_0x36f49b,_0x142699={'NyAQl':_0x2f12cd(0x13f)};return this[_0x2f12cd(0x17d)](_0x142699[_0x2f12cd(0x187)],[_0x3f9f99]);}async['updateFileCache'](_0x4d75e8){const _0x49c069=_0x36f49b,_0x3bf204={'IGSoo':function(_0x4411d3,_0x39f151){return _0x4411d3(_0x39f151);},'BeFzm':function(_0x3e0c0c,_0x1cc77f){return _0x3e0c0c(_0x1cc77f);},'bGoRF':_0x49c069(0x188)},_0x5605ff=this['db'][_0x49c069(0x1a1)](_0x3bf204['bGoRF']);return new Promise((_0x322dca,_0x894b29)=>{const _0x2de408=_0x49c069;_0x5605ff[_0x2de408(0x13b)](_0x4d75e8[_0x2de408(0x154)],_0x4d75e8[_0x2de408(0x1b5)],_0x4d75e8['uuid'],function(_0x26bdd5){const _0x2417bc=_0x2de408;_0x26bdd5&&(logError(_0x2417bc(0x1ba),_0x26bdd5),_0x3bf204[_0x2417bc(0x157)](_0x894b29,_0x26bdd5)),_0x3bf204['BeFzm'](_0x322dca,null);});});}async[_0x36f49b(0x151)](){const _0x37fa23=_0x36f49b,_0x1d8309={'DXVbF':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','Bqwdx':_0x37fa23(0x150)},_0x21f455=_0x1d8309[_0x37fa23(0x15e)];return new Promise((_0x1afd0d,_0x3cce9c)=>{this['db']['all'](_0x21f455,(_0x408454,_0x1d7336)=>{const _0x178f5f=_0x4ab5;_0x408454&&(logError(_0x1d8309[_0x178f5f(0x175)],_0x408454),_0x3cce9c(_0x408454));const _0x596a9e={};_0x1d7336['forEach'](_0x41fe96=>{const _0x1f98ef=_0x178f5f;_0x596a9e[_0x41fe96[_0x1f98ef(0x18b)]]=_0x41fe96[_0x1f98ef(0x16f)];}),_0x1afd0d(_0x596a9e);});});}async['getUidByTempUin'](_0x4189f1){const _0x14843b={'eagJV':function(_0x16cfab,_0x3f33d5,_0x181553){return _0x16cfab(_0x3f33d5,_0x181553);},'aEGqn':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','lVmwt':function(_0xef6b31,_0x584b67){return _0xef6b31(_0x584b67);}},_0xb0a03d='SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?';return new Promise((_0x320b39,_0x5b8b5a)=>{const _0x4ac31c=_0x4ab5;this['db'][_0x4ac31c(0x17f)](_0xb0a03d,[_0x4189f1],(_0x439f6b,_0x357e75)=>{const _0x4e4b75=_0x4ac31c;_0x439f6b&&(_0x14843b[_0x4e4b75(0x186)](logError,_0x14843b[_0x4e4b75(0x15b)],_0x439f6b),_0x5b8b5a(_0x439f6b)),_0x14843b[_0x4e4b75(0x136)](_0x320b39,_0x357e75?.[_0x4e4b75(0x16f)]);});});}async[_0x36f49b(0x18a)](_0x20ba8b,_0x5c843f){const _0x11bb62=_0x36f49b,_0x6ddb5a={'EyWTk':function(_0x22817e,_0x34dbe9,_0x4ced49){return _0x22817e(_0x34dbe9,_0x4ced49);},'GSdNs':_0x11bb62(0x19f),'RXpCC':function(_0xc76f00,_0xcbd63f){return _0xc76f00(_0xcbd63f);},'QqixB':'INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)'},_0x3880b8=await this[_0x11bb62(0x184)](_0x20ba8b);if(!_0x3880b8){const _0x43ba9d=this['db'][_0x11bb62(0x1a1)](_0x6ddb5a[_0x11bb62(0x158)]);return new Promise((_0x2a7b64,_0xa661e7)=>{const _0x31de40=_0x11bb62,_0x15ea4e={'FWaFI':function(_0x257abd,_0xe82b54,_0x488621){const _0xba4216=_0x4ab5;return _0x6ddb5a[_0xba4216(0x13d)](_0x257abd,_0xe82b54,_0x488621);},'bJveR':_0x6ddb5a['GSdNs'],'qjXLc':function(_0x5424ac,_0x43c9ce){const _0x119aa7=_0x4ab5;return _0x6ddb5a[_0x119aa7(0x1a0)](_0x5424ac,_0x43c9ce);}};_0x43ba9d[_0x31de40(0x13b)](_0x20ba8b,_0x5c843f,function(_0x30a2f9){const _0x53e4e8=_0x31de40;_0x30a2f9&&(_0x15ea4e['FWaFI'](logError,_0x15ea4e[_0x53e4e8(0x17c)],_0x30a2f9),_0x15ea4e[_0x53e4e8(0x198)](_0xa661e7,_0x30a2f9)),_0x15ea4e[_0x53e4e8(0x198)](_0x2a7b64,null);});});}}}export const dbUtil=new DBUtil();