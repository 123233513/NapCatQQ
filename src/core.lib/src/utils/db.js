const _0x9cac34=_0x22a0;function _0x49f8(){const _0x203252=['CctnM','set','msgSeq','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','assign','USNzm','shortId','db\x20could\x20not\x20get\x20file\x20cache','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','xkMOp','deyAd','name','27202dhsAdN','jlnRu','vTqqx','KRgtx','getFileCacheByName','msgTime','db\x20could\x20not\x20update\x20file\x20cache','getUidByTempUin','updateMsg','init','ZuSJx','记录消息到数据库,\x20消息长id:\x20','qSxlh','now','Could\x20not\x20create\x20table\x20files','FWqvd','getCurrentMaxShortId','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','addMsg','doTtO','cPfMQ','VNYcF','uQDMq','ylcxh','96TGwgQD','24zDODDp','QImju','LWRrh','3312228LZpwbf','getReceivedTempUinMap','JqkJK','TCngm','db\x20could\x20not\x20add\x20msg','清理消息缓存','Htrzb','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','catch','ITPVB',',\x20msgId:\x20','MhlBv','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','DqRPz','msgId','chatType','forEach','fNJcT','getMsgByLongId','WEHHn','msgCache','LrojV','数据库中消息最大短id','7qxsaPd','TdLtX','Ccvqc','ABCKs','CxjuJ','oJUkT','get','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','Method\x20not\x20implemented.','SHxft','SkSbd','url','OdUMX','msgList','close','Yuvmb','4oxTKAi','element','addFileCache','OPEN_CREATE','xwMww','2636424LVGXzl','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','has','addTempUin','db\x20could\x20not\x20add\x20file','getMsg','KVDfK','db\x20getMsgByLongId\x20error','2143070jKujLR','path','maxId','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','prepare','Could\x20not\x20get\x20msg','NCVHC','更新消息,\x20shortId:','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','Could\x20not\x20connect\x20to\x20database','Could\x20not\x20create\x20table\x20temp_uins','NOXCM','run','cQcWR','10xRhLTm','Wsakn','stack','then','nFiaP','iDSqv','2039367IOCbXg','wnLqC','uid','KuUjM','LNfnE','2192592xvgNsQ','6532965igrafM','uin',',\x20短id:\x20','getFileCache','getMsgsByMsgId','createTable','globalMsgShortId','ZafLP','Could\x20not\x20create\x20table\x20msgs','uuid','YBPpR','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','NCmCU','longId','nxyRB','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','size','tcYVl'];_0x49f8=function(){return _0x203252;};return _0x49f8();}(function(_0x373086,_0x16895c){const _0x262740=_0x22a0,_0x4c50b5=_0x373086();while(!![]){try{const _0x371d2c=-parseInt(_0x262740(0x114))/0x1*(parseInt(_0x262740(0xfb))/0x2)+-parseInt(_0x262740(0x165))/0x3+-parseInt(_0x262740(0x13e))/0x4*(parseInt(_0x262740(0x14b))/0x5)+parseInt(_0x262740(0x117))/0x6*(-parseInt(_0x262740(0x12e))/0x7)+parseInt(_0x262740(0x143))/0x8+parseInt(_0x262740(0x166))/0x9*(parseInt(_0x262740(0x15a))/0xa)+-parseInt(_0x262740(0x160))/0xb*(-parseInt(_0x262740(0x113))/0xc);if(_0x371d2c===_0x16895c)break;else _0x4c50b5['push'](_0x4c50b5['shift']());}catch(_0x2d8062){_0x4c50b5['push'](_0x4c50b5['shift']());}}}(_0x49f8,0x7a3c2));import _0x71f827 from'sqlite3';function _0x22a0(_0xc86938,_0x3bd31f){const _0x49f8bb=_0x49f8();return _0x22a0=function(_0x22a066,_0x4983f6){_0x22a066=_0x22a066-0xe2;let _0x314f09=_0x49f8bb[_0x22a066];return _0x314f09;},_0x22a0(_0xc86938,_0x3bd31f);}import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x9cac34(0x104)](_0x481d44){const _0x172e24={'NOXCM':function(_0x619e37,_0x2aaa94){return _0x619e37(_0x2aaa94);},'oJUkT':function(_0x5e14be){return _0x5e14be();}};if(this['db'])return;return new Promise((_0x4e4d4a,_0x2be345)=>{const _0x8b128a=_0x22a0,_0x6a0099={'NCVHC':function(_0x50a3c4,_0x151b00){const _0x152c0f=_0x22a0;return _0x172e24[_0x152c0f(0x157)](_0x50a3c4,_0x151b00);},'MhlBv':function(_0x4a3259){const _0x56da30=_0x22a0;return _0x172e24[_0x56da30(0x133)](_0x4a3259);}};this['db']=new _0x71f827['Database'](_0x481d44,_0x71f827['OPEN_READWRITE']|_0x71f827[_0x8b128a(0x141)],_0x2cf93e=>{const _0x547f59=_0x8b128a;if(_0x2cf93e){logError(_0x547f59(0x155),_0x2cf93e),_0x6a0099[_0x547f59(0x152)](_0x2be345,_0x2cf93e);return;}this['createTable'](),_0x6a0099[_0x547f59(0x122)](_0x4e4d4a);});});}['createTable'](){const _0x4d8d5c=_0x9cac34;throw new Error(_0x4d8d5c(0x136));}[_0x9cac34(0x13c)](){const _0x3c76e4=_0x9cac34;this['db']?.[_0x3c76e4(0x13c)]();}}class DBUtil extends DBUtilBase{[_0x9cac34(0x12b)]=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x21b5c5=_0x9cac34,_0x55a006={'ylcxh':function(_0x7d115d,_0x111e4e){return _0x7d115d>_0x111e4e;},'TYvrg':function(_0x93ccc2,_0x1ca665){return _0x93ccc2-_0x1ca665;},'YBPpR':function(_0x57df01,_0x461330){return _0x57df01*_0x461330;},'ZuSJx':_0x21b5c5(0x11c),'Htrzb':function(_0x53bf24,_0x1af88b){return _0x53bf24*_0x1af88b;},'KuUjM':function(_0x4e01df,_0x1bc6c6,_0xb24a66){return _0x4e01df(_0x1bc6c6,_0xb24a66);}};super();const _0x43a8be=_0x55a006['YBPpR'](_0x55a006[_0x21b5c5(0x11d)](0x3e8,0x3c),0xa);_0x55a006[_0x21b5c5(0x163)](setInterval,()=>{const _0x24ee5d=_0x21b5c5;logDebug(_0x55a006[_0x24ee5d(0x105)]),this[_0x24ee5d(0x12b)][_0x24ee5d(0x127)]((_0x1673d7,_0x1557c3)=>{const _0x4a59ed=_0x24ee5d;_0x55a006[_0x4a59ed(0x112)](_0x55a006['TYvrg'](Date[_0x4a59ed(0x108)](),_0x55a006[_0x4a59ed(0xe6)](parseInt(_0x1673d7[_0x4a59ed(0x100)]),0x3e8)),_0x43a8be)&&this['msgCache']['delete'](_0x1557c3);});},_0x43a8be);}async[_0x9cac34(0x104)](_0x354136){const _0x2fdba=_0x9cac34;await super[_0x2fdba(0x104)](_0x354136),this[_0x2fdba(0xe2)]=await this[_0x2fdba(0x10b)]();}[_0x9cac34(0x16b)](){const _0xcc8ec8=_0x9cac34,_0x3d30c4={'nFiaP':function(_0x5980c1,_0x477edc,_0x287afe){return _0x5980c1(_0x477edc,_0x287afe);},'CctnM':_0xcc8ec8(0xe4),'WEHHn':_0xcc8ec8(0x109),'qSxlh':_0xcc8ec8(0x156)},_0x2f06b0='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db'][_0xcc8ec8(0x158)](_0x2f06b0,function(_0x55a7ec){const _0x5a02bb=_0xcc8ec8;_0x55a7ec&&_0x3d30c4['nFiaP'](logError,_0x3d30c4[_0x5a02bb(0xef)],_0x55a7ec[_0x5a02bb(0x15c)]);});const _0x2575b6=_0xcc8ec8(0x144);this['db'][_0xcc8ec8(0x158)](_0x2575b6,function(_0x1510a6){const _0x7d1ab0=_0xcc8ec8;_0x1510a6&&_0x3d30c4[_0x7d1ab0(0x15e)](logError,_0x3d30c4[_0x7d1ab0(0x12a)],_0x1510a6);});const _0x19060b=_0xcc8ec8(0x14f);this['db'][_0xcc8ec8(0x158)](_0x19060b,function(_0x5d7872){const _0x2c6d49=_0xcc8ec8;_0x5d7872&&_0x3d30c4[_0x2c6d49(0x15e)](logError,_0x3d30c4[_0x2c6d49(0x107)],_0x5d7872);});}async[_0x9cac34(0x10b)](){const _0x1a3f9b=_0x9cac34,_0x1a2db4={'OdUMX':_0x1a3f9b(0x14e),'fNJcT':function(_0x35f68c,_0x233b7d){return _0x35f68c(_0x233b7d);},'QImju':_0x1a3f9b(0xf2)};return new Promise((_0x2dcebc,_0x362ddd)=>{const _0x42502a=_0x1a3f9b,_0x139834={'Cfdfo':_0x1a2db4[_0x42502a(0x13a)],'wnLqC':function(_0x1ca78e,_0x37d147){const _0x3b0acd=_0x42502a;return _0x1a2db4[_0x3b0acd(0x128)](_0x1ca78e,_0x37d147);},'cPfMQ':function(_0x293be3,_0x20b32e,_0x2efec7){return _0x293be3(_0x20b32e,_0x2efec7);}};this['db'][_0x42502a(0x134)](_0x1a2db4[_0x42502a(0x115)],(_0x3a0969,_0x159e7c)=>{const _0x31a779=_0x42502a;if(_0x3a0969)return logDebug(_0x139834['Cfdfo'],_0x3a0969),_0x139834[_0x31a779(0x161)](_0x2dcebc,-0x7ffffff8);_0x139834[_0x31a779(0x10f)](logDebug,_0x31a779(0x12d),_0x159e7c?.[_0x31a779(0x14d)]),_0x2dcebc(_0x159e7c?.['maxId']??-0x7ffffff8);});});}async[_0x9cac34(0x148)](_0x286d23,_0x392c5c){const _0x587a5b=_0x9cac34,_0x53664d={'Wsakn':function(_0x234cae,_0x49ddf9,_0x2dc00e,_0x19caa2,_0x5a0249){return _0x234cae(_0x49ddf9,_0x2dc00e,_0x19caa2,_0x5a0249);},'tcYVl':function(_0x73d1f4,_0x2a2d26){return _0x73d1f4(_0x2a2d26);},'SHxft':function(_0x178d9b,_0x56d969){return _0x178d9b(_0x56d969);},'VNYcF':function(_0x35015f,_0x112fae){return _0x35015f(_0x112fae);}},_0x398002=this['db'][_0x587a5b(0x150)](_0x286d23);return new Promise((_0x5d5468,_0x5c90eb)=>{const _0x30b041={'ABCKs':function(_0x5b9557,_0x40262d){const _0x676b2e=_0x22a0;return _0x53664d[_0x676b2e(0x137)](_0x5b9557,_0x40262d);},'xkMOp':function(_0x2a0230,_0x1348f0){const _0x4a8f04=_0x22a0;return _0x53664d[_0x4a8f04(0x110)](_0x2a0230,_0x1348f0);}};_0x398002['get'](..._0x392c5c,(_0x4ab920,_0x2d1b48)=>{const _0x30592c=_0x22a0;if(_0x4ab920)return _0x53664d[_0x30592c(0x15b)](logError,_0x30592c(0x151),_0x4ab920,_0x286d23,_0x392c5c),_0x53664d[_0x30592c(0xee)](_0x5d5468,null);if(!_0x2d1b48){_0x53664d[_0x30592c(0x137)](_0x5d5468,null);return;}const _0xa14913=_0x2d1b48[_0x30592c(0xea)];NTQQMsgApi[_0x30592c(0x16a)]({'peerUid':_0x2d1b48['peerUid'],'chatType':_0x2d1b48[_0x30592c(0x126)]},[_0xa14913])[_0x30592c(0x15d)](_0x3a4cf8=>{const _0x1ce192=_0x30592c,_0x17048f=_0x3a4cf8[_0x1ce192(0x13b)][0x0];if(!_0x17048f){_0x30b041[_0x1ce192(0x131)](_0x5d5468,null);return;}_0x17048f['id']=_0x2d1b48[_0x1ce192(0xf5)],_0x30b041[_0x1ce192(0xf8)](_0x5d5468,_0x17048f);})[_0x30592c(0x11f)](_0x465429=>{_0x30b041['xkMOp'](_0x5d5468,null);});});});}async['getMsgByShortId'](_0x2cf764){const _0x4e6054=_0x9cac34,_0xf31aa5={'xwMww':_0x4e6054(0x10c)};if(this['msgCache'][_0x4e6054(0x145)](_0x2cf764))return this[_0x4e6054(0x12b)][_0x4e6054(0x134)](_0x2cf764);const _0x28e1ae=_0xf31aa5[_0x4e6054(0x142)];return this[_0x4e6054(0x148)](_0x28e1ae,[_0x2cf764]);}async[_0x9cac34(0x129)](_0x4ecb9b){const _0x524c0d=_0x9cac34;if(this[_0x524c0d(0x12b)][_0x524c0d(0x145)](_0x4ecb9b))return this[_0x524c0d(0x12b)][_0x524c0d(0x134)](_0x4ecb9b);return this[_0x524c0d(0x148)]('SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?',[_0x4ecb9b]);}async['getMsgBySeq'](_0x4ea96f,_0x3e5d2e){const _0x5f131d=_0x9cac34,_0x4311f2={'USNzm':_0x5f131d(0xe7)},_0x65ff8e=_0x4311f2[_0x5f131d(0xf4)];return this['getMsg'](_0x65ff8e,[_0x4ea96f,_0x3e5d2e]);}async[_0x9cac34(0x10d)](_0x56f4b1,_0x1ec8a5=!![]){const _0x4a092f=_0x9cac34,_0x479ce3={'uaSbC':_0x4a092f(0xf7),'uQDMq':function(_0xb1d3db,_0x292216){return _0xb1d3db===_0x292216;},'vTqqx':_0x4a092f(0x11b),'NCmCU':'INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','qXGFj':function(_0x195620,_0x482b6a){return _0x195620(_0x482b6a);}},_0x17f3a4=await this[_0x4a092f(0x129)](_0x56f4b1['msgId']);if(_0x17f3a4){if(_0x1ec8a5)this[_0x4a092f(0x103)](_0x56f4b1)[_0x4a092f(0x15d)]();return _0x17f3a4['id'];}const _0x5f4c17=this['db'][_0x4a092f(0x150)](_0x479ce3[_0x4a092f(0xe9)]),_0x2aa5d0=++this[_0x4a092f(0xe2)];return _0x56f4b1['id']=_0x2aa5d0,_0x479ce3['qXGFj'](logDebug,_0x4a092f(0x106)+_0x56f4b1[_0x4a092f(0x125)]+_0x4a092f(0x168)+_0x56f4b1['id']),this[_0x4a092f(0x12b)][_0x4a092f(0xf0)](_0x2aa5d0,_0x56f4b1),this['msgCache']['set'](_0x56f4b1[_0x4a092f(0x125)],_0x56f4b1),_0x5f4c17[_0x4a092f(0x158)](this[_0x4a092f(0xe2)],_0x56f4b1[_0x4a092f(0x125)],_0x56f4b1[_0x4a092f(0xf1)]['toString'](),_0x56f4b1['peerUid'],_0x56f4b1[_0x4a092f(0x126)],_0x898008=>{const _0x3a73d2=_0x4a092f,_0x378f81={'uoEHB':_0x479ce3['uaSbC']};_0x898008&&(_0x479ce3[_0x3a73d2(0x111)](_0x898008['errno'],0x13)?this[_0x3a73d2(0x129)](_0x56f4b1[_0x3a73d2(0x125)])[_0x3a73d2(0x15d)](_0x145226=>{const _0x4cb836=_0x3a73d2;_0x145226?(this[_0x4cb836(0x12b)][_0x4cb836(0xf0)](_0x2aa5d0,_0x145226),this[_0x4cb836(0x12b)][_0x4cb836(0xf0)](_0x145226['msgId'],_0x145226)):logError(_0x378f81['uoEHB'],_0x898008);})['catch'](_0x1fc4ce=>logError(_0x3a73d2(0x14a),_0x1fc4ce)):logError(_0x479ce3[_0x3a73d2(0xfd)],_0x898008));}),_0x2aa5d0;}async[_0x9cac34(0x103)](_0x27a7ed){const _0xb6a08a=_0x9cac34,_0x4992f8={'nxyRB':'updateMsg\x20db\x20error'},_0x55a416=this['msgCache'][_0xb6a08a(0x134)](_0x27a7ed[_0xb6a08a(0x125)]);_0x55a416&&Object[_0xb6a08a(0xf3)](_0x55a416,_0x27a7ed);logDebug(_0xb6a08a(0x153)+_0x27a7ed['id']+',\x20seq:\x20'+_0x27a7ed[_0xb6a08a(0xf1)]+_0xb6a08a(0x121)+_0x27a7ed[_0xb6a08a(0x125)]);const _0x7d474f=this['db'][_0xb6a08a(0x150)](_0xb6a08a(0x154));_0x7d474f['run'](_0x27a7ed[_0xb6a08a(0xf1)],_0x27a7ed['msgId'],_0x5acfdc=>{const _0x51b378=_0xb6a08a;_0x5acfdc&&logError(_0x4992f8[_0x51b378(0xeb)],_0x5acfdc);});}async[_0x9cac34(0x140)](_0x4bff23){const _0x5d8799=_0x9cac34,_0x20271c={'doTtO':_0x5d8799(0x147),'SkSbd':function(_0x5248eb,_0x2c1eb5){return _0x5248eb(_0x2c1eb5);},'TCngm':function(_0x57cee8,_0x3c6db1){return _0x57cee8(_0x3c6db1);},'JqkJK':'INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)'},_0x40b6a7=this['db'][_0x5d8799(0x150)](_0x20271c[_0x5d8799(0x119)]);return new Promise((_0x329de4,_0x178dff)=>{const _0x2afa7b=_0x5d8799;_0x40b6a7[_0x2afa7b(0x158)](_0x4bff23[_0x2afa7b(0xfa)],_0x4bff23[_0x2afa7b(0x14c)],_0x4bff23[_0x2afa7b(0x139)],_0x4bff23[_0x2afa7b(0xed)],_0x4bff23[_0x2afa7b(0xe5)],_0x4bff23['elementType'],JSON['stringify'](_0x4bff23[_0x2afa7b(0x13f)]),_0x4bff23['elementId'],_0x4bff23[_0x2afa7b(0x125)],function(_0x40e783){const _0x5389ac=_0x2afa7b;_0x40e783&&(logError(_0x20271c[_0x5389ac(0x10e)],_0x40e783),_0x20271c[_0x5389ac(0x138)](_0x178dff,_0x40e783)),_0x20271c[_0x5389ac(0x11a)](_0x329de4,null);});});}async[_0x9cac34(0x169)](_0x320c45,_0x35e9a9){const _0x54d971={'DqRPz':function(_0x3b41c7,_0x23ae8f,_0x39e0c7){return _0x3b41c7(_0x23ae8f,_0x39e0c7);},'ZafLP':function(_0x3ecaab,_0x2abe4f){return _0x3ecaab(_0x2abe4f);}},_0x422879=this['db']['prepare'](_0x320c45);return new Promise((_0x45729b,_0x33783b)=>{const _0x41baa6=_0x22a0;_0x422879[_0x41baa6(0x134)](..._0x35e9a9,(_0x5de3e1,_0x383b5e)=>{const _0x2fce35=_0x41baa6;_0x5de3e1&&(_0x54d971[_0x2fce35(0x124)](logError,_0x2fce35(0xf6),_0x5de3e1),_0x54d971[_0x2fce35(0xe3)](_0x33783b,_0x5de3e1)),_0x383b5e&&(_0x383b5e[_0x2fce35(0x13f)]=JSON['parse'](_0x383b5e[_0x2fce35(0x13f)])),_0x54d971[_0x2fce35(0xe3)](_0x45729b,_0x383b5e);});});}async[_0x9cac34(0xff)](_0x1c918f){const _0x5cc46e=_0x9cac34,_0x450770={'LWRrh':_0x5cc46e(0xe8)};return this[_0x5cc46e(0x169)](_0x450770[_0x5cc46e(0x116)],[_0x1c918f]);}async['getFileCacheByUuid'](_0x554e12){const _0x3854f7=_0x9cac34,_0x13cc95={'cQcWR':_0x3854f7(0xec)};return this['getFileCache'](_0x13cc95[_0x3854f7(0x159)],[_0x554e12]);}async['updateFileCache'](_0x1bf11b){const _0x59da5b=_0x9cac34,_0x4803d7={'LrojV':_0x59da5b(0x101),'Ccvqc':function(_0x2bed5d,_0x2339c0){return _0x2bed5d(_0x2339c0);},'AqfOf':_0x59da5b(0x123)},_0x5b6a6f=this['db'][_0x59da5b(0x150)](_0x4803d7['AqfOf']);return new Promise((_0x5c2c40,_0x232758)=>{const _0x4893fd=_0x59da5b,_0x23086b={'Yuvmb':function(_0x4a38a0,_0x338251,_0x16c12c){return _0x4a38a0(_0x338251,_0x16c12c);},'KVDfK':_0x4803d7[_0x4893fd(0x12c)],'SPJxm':function(_0x218f52,_0x1207f4){const _0x1c5311=_0x4893fd;return _0x4803d7[_0x1c5311(0x130)](_0x218f52,_0x1207f4);}};_0x5b6a6f[_0x4893fd(0x158)](_0x1bf11b[_0x4893fd(0x14c)],_0x1bf11b['url'],_0x1bf11b[_0x4893fd(0xe5)],function(_0x4eadf3){const _0x378f95=_0x4893fd;_0x4eadf3&&(_0x23086b[_0x378f95(0x13d)](logError,_0x23086b[_0x378f95(0x149)],_0x4eadf3),_0x23086b['SPJxm'](_0x232758,_0x4eadf3)),_0x23086b['SPJxm'](_0x5c2c40,null);});});}async[_0x9cac34(0x118)](){const _0x13d35d=_0x9cac34,_0x15a819={'KRgtx':function(_0x371100,_0x5d6e33,_0x128478){return _0x371100(_0x5d6e33,_0x128478);},'TdLtX':'db\x20could\x20not\x20get\x20temp\x20uin\x20map','jlnRu':function(_0x311e0a,_0x41e43c){return _0x311e0a(_0x41e43c);},'CxjuJ':'SELECT\x20*\x20FROM\x20temp_uins'},_0x22aa14=_0x15a819[_0x13d35d(0x132)];return new Promise((_0x16fe8b,_0x178b81)=>{this['db']['all'](_0x22aa14,(_0x322928,_0x3a7eb5)=>{const _0x5d226c=_0x22a0;_0x322928&&(_0x15a819[_0x5d226c(0xfe)](logError,_0x15a819[_0x5d226c(0x12f)],_0x322928),_0x15a819[_0x5d226c(0xfc)](_0x178b81,_0x322928));const _0x148f87={};_0x3a7eb5[_0x5d226c(0x127)](_0x595ea0=>{const _0x2d3402=_0x5d226c;_0x148f87[_0x595ea0[_0x2d3402(0x167)]]=_0x595ea0[_0x2d3402(0x162)];}),_0x16fe8b(_0x148f87);});});}async[_0x9cac34(0x102)](_0x2d6c11){const _0x35435c=_0x9cac34,_0x4a43d4={'ITPVB':function(_0x4782c4,_0x2284ba,_0x581d11){return _0x4782c4(_0x2284ba,_0x581d11);},'RgqzA':function(_0x5b0d37,_0x546bff){return _0x5b0d37(_0x546bff);},'iDSqv':function(_0x313695,_0x543122){return _0x313695(_0x543122);}},_0x16ef6a=_0x35435c(0x135);return new Promise((_0x5558df,_0x1149cd)=>{this['db']['get'](_0x16ef6a,[_0x2d6c11],(_0x2574da,_0x8719a8)=>{const _0x37d0b6=_0x22a0;_0x2574da&&(_0x4a43d4[_0x37d0b6(0x120)](logError,'db\x20could\x20not\x20get\x20temp\x20uin\x20map',_0x2574da),_0x4a43d4['RgqzA'](_0x1149cd,_0x2574da)),_0x4a43d4[_0x37d0b6(0x15f)](_0x5558df,_0x8719a8?.[_0x37d0b6(0x162)]);});});}async[_0x9cac34(0x146)](_0x45016f,_0x29b8dd){const _0x2c7624=_0x9cac34,_0x19c6b6={'TaFAv':function(_0x5b4119,_0x44c584,_0x56894f){return _0x5b4119(_0x44c584,_0x56894f);},'ESoTt':'db\x20could\x20not\x20add\x20temp\x20uin','EnbAZ':function(_0x33d3f5,_0x17de32){return _0x33d3f5(_0x17de32);},'FWqvd':_0x2c7624(0x11e)},_0x4a381a=await this['getUidByTempUin'](_0x45016f);if(!_0x4a381a){const _0x40bc49=this['db'][_0x2c7624(0x150)](_0x19c6b6[_0x2c7624(0x10a)]);return new Promise((_0x382a60,_0x3f567a)=>{const _0x25f04e=_0x2c7624,_0x3c32b2={'WpqVr':function(_0x55e93c,_0x22f11c,_0xf58701){return _0x19c6b6['TaFAv'](_0x55e93c,_0x22f11c,_0xf58701);},'deyAd':_0x19c6b6['ESoTt'],'LNfnE':function(_0x3c74d3,_0x224612){return _0x19c6b6['EnbAZ'](_0x3c74d3,_0x224612);}};_0x40bc49[_0x25f04e(0x158)](_0x45016f,_0x29b8dd,function(_0x2fb279){const _0x19489e=_0x25f04e;_0x2fb279&&(_0x3c32b2['WpqVr'](logError,_0x3c32b2[_0x19489e(0xf9)],_0x2fb279),_0x3f567a(_0x2fb279)),_0x3c32b2[_0x19489e(0x164)](_0x382a60,null);});});}}}export const dbUtil=new DBUtil();