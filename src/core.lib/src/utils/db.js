const _0x3c108a=_0x1daf;(function(_0x34c19d,_0x25804c){const _0x1cd1e6=_0x1daf,_0x6529d6=_0x34c19d();while(!![]){try{const _0x4236ea=parseInt(_0x1cd1e6(0xd2))/0x1*(parseInt(_0x1cd1e6(0xbf))/0x2)+-parseInt(_0x1cd1e6(0x88))/0x3+parseInt(_0x1cd1e6(0xc1))/0x4+parseInt(_0x1cd1e6(0xd8))/0x5+parseInt(_0x1cd1e6(0xce))/0x6*(-parseInt(_0x1cd1e6(0x97))/0x7)+-parseInt(_0x1cd1e6(0xea))/0x8+parseInt(_0x1cd1e6(0x7f))/0x9*(parseInt(_0x1cd1e6(0xdd))/0xa);if(_0x4236ea===_0x25804c)break;else _0x6529d6['push'](_0x6529d6['shift']());}catch(_0x5dc576){_0x6529d6['push'](_0x6529d6['shift']());}}}(_0x46bf,0x77316));function _0x46bf(){const _0x3bdc4b=['AamSi','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','msgSeq','db\x20could\x20not\x20get\x20file\x20cache','addTempUin','peerUid','Could\x20not\x20connect\x20to\x20database','getMsg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','GxlHM','getFileCacheByUuid','close','6GaZHng','set','elementType','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','77FLElrd','all','ahpJM','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','mycEw','errno','3324760lQpnGl','has','msgCache','WFCIs','UIAER','1838980eyffvZ','bHjar','gePbe','UPust','msgList','elementId','eoVEe','SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?','cuBAr','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','url','catch','HwCzz','5515240bwitkQ','getCurrentMaxShortId','SELECT\x20*\x20FROM\x20temp_uins','getMsgByShortId','EpKRp','YUHPU','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','Could\x20not\x20get\x20msg','lPFOH','uuid','stringify','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','uid','GgMEe','chvrp','EAaMg','Database','数据库中消息最大短id','Could\x20not\x20create\x20table\x20files','shortId','getMsgBySeq','Mghzl','UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','bmzDs','QZZxl','size','globalMsgShortId','IwCJn','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','9OGDgch','uglwn','lEvZU','记录消息到数据库,\x20消息长id:\x20','forEach','npIjf','OPEN_READWRITE','lrlso','db\x20could\x20not\x20add\x20file','2288811ESwCca','msgId','xZfOt','parse','mkHxW','getFileCache','toString','getMsgByLongId','path','MQHyo','OPEN_CREATE','addFileCache','updateFileCache','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','UxnNf','3479252jnomtm','chatType','SwycN','getReceivedTempUinMap','then','pJOqz','element','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','maxId','Could\x20not\x20create\x20table\x20temp_uins','hvKHc','lNblI','tjNGZ','prepare','xwwLR','FoNne','longId','updateMsg','run','iRZJp','init','get','HMwiI','updateMsg\x20db\x20error','tqcsX','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','db\x20could\x20not\x20add\x20temp\x20uin','getMsgsByMsgId','Method\x20not\x20implemented.','DoGxe','BWMbS','uRIhD','IzdAi',',\x20短id:\x20','txtFr','now','createTable','Could\x20not\x20create\x20table\x20msgs','db\x20could\x20not\x20get\x20temp\x20uin\x20map','EKPKN','21818WeRPSl','wDBuG','2994996ylGQRR'];_0x46bf=function(){return _0x3bdc4b;};return _0x46bf();}import _0x2a3e02 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';function _0x1daf(_0x4a3023,_0x2138e0){const _0x46bf65=_0x46bf();return _0x1daf=function(_0x1dafbb,_0x59f2bf){_0x1dafbb=_0x1dafbb-0x7e;let _0x2922d9=_0x46bf65[_0x1dafbb];return _0x2922d9;},_0x1daf(_0x4a3023,_0x2138e0);}class DBUtilBase{['db'];async[_0x3c108a(0xab)](_0x5f43ae){const _0x33ac48=_0x3c108a,_0x31bf7f={'YOwNI':function(_0x21217c,_0x54b737,_0x54921d){return _0x21217c(_0x54b737,_0x54921d);},'eoVEe':_0x33ac48(0xc8),'DFrXW':function(_0x435db5,_0x2341f8){return _0x435db5(_0x2341f8);},'HwCzz':function(_0x19313c){return _0x19313c();},'UPust':function(_0x2c7fc0,_0x356417){return _0x2c7fc0|_0x356417;}};if(this['db'])return;return new Promise((_0x50851a,_0x25f403)=>{const _0x574dd1=_0x33ac48,_0x567b63={'lNblI':function(_0x58cfdc,_0xd32c33,_0x44674c){return _0x31bf7f['YOwNI'](_0x58cfdc,_0xd32c33,_0x44674c);},'UIAER':_0x31bf7f[_0x574dd1(0xe3)],'RRXGZ':function(_0x584008,_0x1e0491){return _0x31bf7f['DFrXW'](_0x584008,_0x1e0491);},'kRspE':function(_0xae7d2c){const _0x59a65b=_0x574dd1;return _0x31bf7f[_0x59a65b(0xe9)](_0xae7d2c);}};this['db']=new _0x2a3e02[(_0x574dd1(0xfa))](_0x5f43ae,_0x31bf7f[_0x574dd1(0xe0)](_0x2a3e02[_0x574dd1(0x85)],_0x2a3e02[_0x574dd1(0x92)]),_0x53653a=>{const _0x2aee5f=_0x574dd1;if(_0x53653a){_0x567b63[_0x2aee5f(0xa2)](logError,_0x567b63[_0x2aee5f(0xdc)],_0x53653a),_0x567b63['RRXGZ'](_0x25f403,_0x53653a);return;}this[_0x2aee5f(0xbb)](),_0x567b63['kRspE'](_0x50851a);});});}['createTable'](){const _0x21d5b9=_0x3c108a;throw new Error(_0x21d5b9(0xb3));}[_0x3c108a(0xcd)](){const _0x2fa751=_0x3c108a;this['db']?.[_0x2fa751(0xcd)]();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x4fb388=_0x3c108a,_0xb816ca={'mycEw':function(_0x45bb4c,_0x2123cc){return _0x45bb4c>_0x2123cc;},'uglwn':function(_0x544705,_0x5c6372){return _0x544705(_0x5c6372);},'npIjf':function(_0x49f601,_0x4b46a3){return _0x49f601*_0x4b46a3;}};super();const _0x43f902=_0xb816ca[_0x4fb388(0x84)](_0xb816ca[_0x4fb388(0x84)](0x3e8,0x3c),0xa);setInterval(()=>{const _0x457e4a=_0x4fb388;_0xb816ca[_0x457e4a(0x80)](logDebug,'清理消息缓存'),this[_0x457e4a(0xda)][_0x457e4a(0x83)]((_0x4e6314,_0x3b5d22)=>{const _0x3d0367=_0x457e4a;_0xb816ca[_0x3d0367(0xd6)](Date[_0x3d0367(0xba)]()-parseInt(_0x4e6314['msgTime'])*0x3e8,_0x43f902)&&this[_0x3d0367(0xda)]['delete'](_0x3b5d22);});},_0x43f902);}async[_0x3c108a(0xab)](_0x32627c){const _0x49de2f=_0x3c108a;await super[_0x49de2f(0xab)](_0x32627c),this[_0x49de2f(0x105)]=await this[_0x49de2f(0xeb)]();}[_0x3c108a(0xbb)](){const _0x5e108c=_0x3c108a,_0x5b2384={'BWMbS':function(_0x2e5531,_0x49914a,_0x56cdf2){return _0x2e5531(_0x49914a,_0x56cdf2);},'hvKHc':_0x5e108c(0xfc),'bmzDs':_0x5e108c(0xa0)},_0x5893e0=_0x5e108c(0xca);this['db'][_0x5e108c(0xa9)](_0x5893e0,function(_0x119eac){const _0x172fb7=_0x5e108c;_0x119eac&&_0x5b2384[_0x172fb7(0xb5)](logError,_0x172fb7(0xbc),_0x119eac['stack']);});const _0x2d0eff='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db'][_0x5e108c(0xa9)](_0x2d0eff,function(_0x4818a6){const _0x50b414=_0x5e108c;_0x4818a6&&_0x5b2384[_0x50b414(0xb5)](logError,_0x5b2384[_0x50b414(0xa1)],_0x4818a6);});const _0x22c104=_0x5e108c(0xf0);this['db'][_0x5e108c(0xa9)](_0x22c104,function(_0x40a8c3){const _0x3f2366=_0x5e108c;_0x40a8c3&&_0x5b2384[_0x3f2366(0xb5)](logError,_0x5b2384[_0x3f2366(0x102)],_0x40a8c3);});}async[_0x3c108a(0xeb)](){const _0x4887f0=_0x3c108a,_0x2da667={'lEvZU':function(_0x5d254e,_0x56305d,_0x54dd4f){return _0x5d254e(_0x56305d,_0x54dd4f);},'lPFOH':_0x4887f0(0x7e),'UxnNf':function(_0x12669b,_0x463fad){return _0x12669b(_0x463fad);},'lrlso':'SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs'};return new Promise((_0x4c690e,_0x251c52)=>{const _0x4fd42e=_0x4887f0;this['db'][_0x4fd42e(0xac)](_0x2da667[_0x4fd42e(0x86)],(_0xb55667,_0xe1bfaf)=>{const _0x2b5a5b=_0x4fd42e;if(_0xb55667)return _0x2da667[_0x2b5a5b(0x81)](logDebug,_0x2da667[_0x2b5a5b(0xf2)],_0xb55667),_0x2da667[_0x2b5a5b(0x96)](_0x4c690e,-0x7ffffff8);_0x2da667[_0x2b5a5b(0x81)](logDebug,_0x2b5a5b(0xfb),_0xe1bfaf?.[_0x2b5a5b(0x9f)]),_0x2da667[_0x2b5a5b(0x96)](_0x4c690e,_0xe1bfaf?.[_0x2b5a5b(0x9f)]??-0x7ffffff8);});});}async[_0x3c108a(0xc9)](_0x23d738,_0x3c3b4a){const _0x1ee3c0=_0x3c108a,_0x1ab048={'tjNGZ':function(_0x224598,_0x105609){return _0x224598(_0x105609);},'HMwiI':function(_0x4fba61,_0x405337,_0x182572,_0x97d407,_0x317579){return _0x4fba61(_0x405337,_0x182572,_0x97d407,_0x317579);},'TFyzs':_0x1ee3c0(0xf1),'WeEKA':function(_0x19293d,_0x3f3f34){return _0x19293d(_0x3f3f34);},'IwCJn':function(_0x19b01d,_0x39e964){return _0x19b01d(_0x39e964);}},_0x45189e=this['db'][_0x1ee3c0(0xa4)](_0x23d738);return new Promise((_0x1bcf6f,_0x5d823e)=>{_0x45189e['get'](..._0x3c3b4a,(_0x3a8737,_0x1cb138)=>{const _0x39c59a=_0x1daf,_0x28431f={'EKPKN':function(_0x554018,_0x248a68){const _0x761687=_0x1daf;return _0x1ab048[_0x761687(0xa3)](_0x554018,_0x248a68);}};if(_0x3a8737)return _0x1ab048[_0x39c59a(0xad)](logError,_0x1ab048['TFyzs'],_0x3a8737,_0x23d738,_0x3c3b4a),_0x1ab048['WeEKA'](_0x1bcf6f,null);if(!_0x1cb138){_0x1ab048[_0x39c59a(0x106)](_0x1bcf6f,null);return;}const _0x3558a4=_0x1cb138[_0x39c59a(0xa7)];NTQQMsgApi[_0x39c59a(0xb2)]({'peerUid':_0x1cb138[_0x39c59a(0xc7)],'chatType':_0x1cb138[_0x39c59a(0x98)]},[_0x3558a4])[_0x39c59a(0x9b)](_0x59e89d=>{const _0x119e70=_0x39c59a,_0x2c1f6c=_0x59e89d[_0x119e70(0xe1)][0x0];if(!_0x2c1f6c){_0x1bcf6f(null);return;}_0x2c1f6c['id']=_0x1cb138[_0x119e70(0xfd)],_0x28431f[_0x119e70(0xbe)](_0x1bcf6f,_0x2c1f6c);})[_0x39c59a(0xe8)](_0x5d2aad=>{_0x1bcf6f(null);});});});}async[_0x3c108a(0xed)](_0x2e2d8f){const _0x360f49=_0x3c108a,_0x364cb9={'chvrp':_0x360f49(0xd5)};if(this[_0x360f49(0xda)]['has'](_0x2e2d8f))return this['msgCache'][_0x360f49(0xac)](_0x2e2d8f);const _0x4b5b95=_0x364cb9[_0x360f49(0xf8)];return this['getMsg'](_0x4b5b95,[_0x2e2d8f]);}async[_0x3c108a(0x8f)](_0x784535){const _0x26c3ed=_0x3c108a,_0xbfc24={'EpKRp':_0x26c3ed(0xd1)};if(this[_0x26c3ed(0xda)][_0x26c3ed(0xd9)](_0x784535))return this[_0x26c3ed(0xda)][_0x26c3ed(0xac)](_0x784535);return this[_0x26c3ed(0xc9)](_0xbfc24[_0x26c3ed(0xee)],[_0x784535]);}async[_0x3c108a(0xfe)](_0x41b2a9,_0x18f84c){const _0xab5284=_0x3c108a,_0x4bd53f={'cuBAr':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?'},_0x289573=_0x4bd53f[_0xab5284(0xe5)];return this[_0xab5284(0xc9)](_0x289573,[_0x41b2a9,_0x18f84c]);}async['addMsg'](_0x1c5205,_0x5b72e5=!![]){const _0x3c6da9=_0x3c108a,_0x407675={'DoGxe':function(_0x1d1d06,_0xb39497,_0x3fdc6c){return _0x1d1d06(_0xb39497,_0x3fdc6c);},'txtFr':_0x3c6da9(0xf5),'FoNne':'db\x20could\x20not\x20add\x20msg','IzdAi':function(_0x4c35c0,_0x172ec0){return _0x4c35c0(_0x172ec0);}},_0xe1f411=await this['getMsgByLongId'](_0x1c5205[_0x3c6da9(0x89)]);if(_0xe1f411){if(_0x5b72e5)this[_0x3c6da9(0xa8)](_0x1c5205)['then']();return _0xe1f411['id'];}const _0x39f0f0=this['db'][_0x3c6da9(0xa4)](_0x3c6da9(0x95)),_0x30f959=++this['globalMsgShortId'];return _0x1c5205['id']=_0x30f959,_0x407675[_0x3c6da9(0xb7)](logDebug,_0x3c6da9(0x82)+_0x1c5205[_0x3c6da9(0x89)]+_0x3c6da9(0xb8)+_0x1c5205['id']),this[_0x3c6da9(0xda)]['set'](_0x30f959,_0x1c5205),this['msgCache'][_0x3c6da9(0xcf)](_0x1c5205[_0x3c6da9(0x89)],_0x1c5205),_0x39f0f0[_0x3c6da9(0xa9)](this[_0x3c6da9(0x105)],_0x1c5205[_0x3c6da9(0x89)],_0x1c5205[_0x3c6da9(0xc4)][_0x3c6da9(0x8e)](),_0x1c5205[_0x3c6da9(0xc7)],_0x1c5205['chatType'],_0x1a13dd=>{const _0x39367b=_0x3c6da9,_0x631f47={'gePbe':function(_0x43654e,_0x44ad84,_0x559dc0){const _0x1aa506=_0x1daf;return _0x407675[_0x1aa506(0xb4)](_0x43654e,_0x44ad84,_0x559dc0);},'wDBuG':_0x407675[_0x39367b(0xb9)]};_0x1a13dd&&(_0x1a13dd[_0x39367b(0xd7)]===0x13?this[_0x39367b(0x8f)](_0x1c5205[_0x39367b(0x89)])['then'](_0x28fda8=>{const _0x3b0f37=_0x39367b;_0x28fda8?(this[_0x3b0f37(0xda)][_0x3b0f37(0xcf)](_0x30f959,_0x28fda8),this['msgCache']['set'](_0x28fda8[_0x3b0f37(0x89)],_0x28fda8)):_0x631f47[_0x3b0f37(0xdf)](logError,_0x631f47[_0x3b0f37(0xc0)],_0x1a13dd);})[_0x39367b(0xe8)](_0x111df9=>logError('db\x20getMsgByLongId\x20error',_0x111df9)):logError(_0x407675[_0x39367b(0xa6)],_0x1a13dd));}),_0x30f959;}async[_0x3c108a(0xa8)](_0x4e0262){const _0x3b6f57=_0x3c108a,_0xdb483a={'GgMEe':function(_0x4eb653,_0x55fcc7,_0x31ba3f){return _0x4eb653(_0x55fcc7,_0x31ba3f);},'ObQIj':function(_0x38a5ca,_0x1d9071){return _0x38a5ca(_0x1d9071);},'AamSi':_0x3b6f57(0xb0)},_0x172942=this['msgCache'][_0x3b6f57(0xac)](_0x4e0262[_0x3b6f57(0x89)]);_0x172942&&Object['assign'](_0x172942,_0x4e0262);_0xdb483a['ObQIj'](logDebug,'更新消息,\x20shortId:'+_0x4e0262['id']+',\x20seq:\x20'+_0x4e0262[_0x3b6f57(0xc4)]+',\x20msgId:\x20'+_0x4e0262[_0x3b6f57(0x89)]);const _0x56f25e=this['db']['prepare'](_0xdb483a[_0x3b6f57(0xc2)]);_0x56f25e[_0x3b6f57(0xa9)](_0x4e0262[_0x3b6f57(0xc4)],_0x4e0262[_0x3b6f57(0x89)],_0x2ffd9d=>{const _0x37df56=_0x3b6f57;_0x2ffd9d&&_0xdb483a[_0x37df56(0xf7)](logError,_0x37df56(0xae),_0x2ffd9d);});}async[_0x3c108a(0x93)](_0x4e23bf){const _0x40b384=_0x3c108a,_0x3335f3={'bHjar':function(_0x279fad,_0xd5a877,_0x501157){return _0x279fad(_0xd5a877,_0x501157);},'xwwLR':function(_0x4be1ec,_0x3f4798){return _0x4be1ec(_0x3f4798);},'sIfVm':function(_0x38158d,_0x37ce7f){return _0x38158d(_0x37ce7f);},'EAaMg':_0x40b384(0xc3)},_0x2e0563=this['db']['prepare'](_0x3335f3[_0x40b384(0xf9)]);return new Promise((_0x232eef,_0x5b91db)=>{const _0xcc52f9=_0x40b384;_0x2e0563[_0xcc52f9(0xa9)](_0x4e23bf['name'],_0x4e23bf[_0xcc52f9(0x90)],_0x4e23bf[_0xcc52f9(0xe7)],_0x4e23bf[_0xcc52f9(0x104)],_0x4e23bf[_0xcc52f9(0xf3)],_0x4e23bf[_0xcc52f9(0xd0)],JSON[_0xcc52f9(0xf4)](_0x4e23bf[_0xcc52f9(0x9d)]),_0x4e23bf[_0xcc52f9(0xe2)],_0x4e23bf[_0xcc52f9(0x89)],function(_0x3b51a2){const _0x1e2f83=_0xcc52f9;_0x3b51a2&&(_0x3335f3[_0x1e2f83(0xde)](logError,_0x1e2f83(0x87),_0x3b51a2),_0x3335f3[_0x1e2f83(0xa5)](_0x5b91db,_0x3b51a2)),_0x3335f3['sIfVm'](_0x232eef,null);});});}async['getFileCache'](_0x4e9b70,_0x5536a1){const _0x1b005e=_0x3c108a,_0xfd40b7={'APZjW':function(_0x332c8b,_0x4a31ef,_0x13cf5d){return _0x332c8b(_0x4a31ef,_0x13cf5d);},'QZZxl':_0x1b005e(0xc5),'MQHyo':function(_0x49a4b7,_0xa0314f){return _0x49a4b7(_0xa0314f);}},_0x1d5edf=this['db'][_0x1b005e(0xa4)](_0x4e9b70);return new Promise((_0x460a76,_0x58057e)=>{const _0x53a236=_0x1b005e;_0x1d5edf[_0x53a236(0xac)](..._0x5536a1,(_0x97e9b9,_0x591c45)=>{const _0x12b9c3=_0x53a236;_0x97e9b9&&(_0xfd40b7['APZjW'](logError,_0xfd40b7[_0x12b9c3(0x103)],_0x97e9b9),_0xfd40b7[_0x12b9c3(0x91)](_0x58057e,_0x97e9b9)),_0x591c45&&(_0x591c45[_0x12b9c3(0x9d)]=JSON[_0x12b9c3(0x8b)](_0x591c45[_0x12b9c3(0x9d)])),_0x460a76(_0x591c45);});});}async['getFileCacheByName'](_0xc369ce){const _0x566bb2=_0x3c108a,_0x11e866={'WFCIs':_0x566bb2(0x101)};return this[_0x566bb2(0x8d)](_0x11e866[_0x566bb2(0xdb)],[_0xc369ce]);}async[_0x3c108a(0xcc)](_0x3db125){const _0x47d1bb=_0x3c108a,_0x406222={'GxlHM':_0x47d1bb(0xe4)};return this[_0x47d1bb(0x8d)](_0x406222[_0x47d1bb(0xcb)],[_0x3db125]);}async[_0x3c108a(0x94)](_0x54d3f1){const _0x1c18ba=_0x3c108a,_0x5b8722={'Mghzl':'db\x20could\x20not\x20update\x20file\x20cache','YUHPU':function(_0x413178,_0x355bd1){return _0x413178(_0x355bd1);},'ZEHZF':_0x1c18ba(0x100)},_0xa1722=this['db'][_0x1c18ba(0xa4)](_0x5b8722['ZEHZF']);return new Promise((_0x56bfb3,_0x245a2b)=>{const _0x31374f=_0x1c18ba;_0xa1722[_0x31374f(0xa9)](_0x54d3f1[_0x31374f(0x90)],_0x54d3f1[_0x31374f(0xe7)],_0x54d3f1[_0x31374f(0xf3)],function(_0x2d7e2b){const _0x43a8f1=_0x31374f;_0x2d7e2b&&(logError(_0x5b8722[_0x43a8f1(0xff)],_0x2d7e2b),_0x245a2b(_0x2d7e2b)),_0x5b8722[_0x43a8f1(0xef)](_0x56bfb3,null);});});}async[_0x3c108a(0x9a)](){const _0x127cb8=_0x3c108a,_0x850368={'Cldqp':function(_0x2ba4ff,_0x4981cb,_0x217f4d){return _0x2ba4ff(_0x4981cb,_0x217f4d);},'pJOqz':function(_0x3a3074,_0x5c1014){return _0x3a3074(_0x5c1014);},'DYfOj':_0x127cb8(0xec)},_0x39a246=_0x850368['DYfOj'];return new Promise((_0x2cf1eb,_0x470755)=>{const _0xa9d514=_0x127cb8,_0x56c9df={'ahpJM':function(_0x3e340e,_0x3190da,_0x18c08d){return _0x850368['Cldqp'](_0x3e340e,_0x3190da,_0x18c08d);},'iRZJp':function(_0x137aa0,_0x3ea7e5){const _0x4256e1=_0x1daf;return _0x850368[_0x4256e1(0x9c)](_0x137aa0,_0x3ea7e5);}};this['db'][_0xa9d514(0xd3)](_0x39a246,(_0x3a38d5,_0x43a20d)=>{const _0x5a8c36=_0xa9d514;_0x3a38d5&&(_0x56c9df[_0x5a8c36(0xd4)](logError,'db\x20could\x20not\x20get\x20temp\x20uin\x20map',_0x3a38d5),_0x56c9df[_0x5a8c36(0xaa)](_0x470755,_0x3a38d5));const _0x22bee4={};_0x43a20d[_0x5a8c36(0x83)](_0x382325=>{_0x22bee4[_0x382325['uin']]=_0x382325['uid'];}),_0x2cf1eb(_0x22bee4);});});}async['getUidByTempUin'](_0x3b569b){const _0x1c21bb=_0x3c108a,_0x1caad4={'uRIhD':_0x1c21bb(0xbd),'mkHxW':_0x1c21bb(0xe6)},_0x20b7f8=_0x1caad4[_0x1c21bb(0x8c)];return new Promise((_0x44a44b,_0x2fcc91)=>{const _0x5e6e7f=_0x1c21bb,_0x5a2230={'xZfOt':_0x1caad4[_0x5e6e7f(0xb6)]};this['db'][_0x5e6e7f(0xac)](_0x20b7f8,[_0x3b569b],(_0x3cc48d,_0x3976bb)=>{const _0x56f505=_0x5e6e7f;_0x3cc48d&&(logError(_0x5a2230[_0x56f505(0x8a)],_0x3cc48d),_0x2fcc91(_0x3cc48d)),_0x44a44b(_0x3976bb?.[_0x56f505(0xf6)]);});});}async[_0x3c108a(0xc6)](_0x21eb88,_0x530ed6){const _0x1863d0=_0x3c108a,_0xef7041={'tqcsX':_0x1863d0(0xb1),'SwycN':function(_0x1a6383,_0x221cf3){return _0x1a6383(_0x221cf3);},'biZBZ':function(_0x1039b1,_0x8bb317){return _0x1039b1(_0x8bb317);}},_0x1b3e0b=await this['getUidByTempUin'](_0x21eb88);if(!_0x1b3e0b){const _0x54bb20=this['db'][_0x1863d0(0xa4)](_0x1863d0(0x9e));return new Promise((_0x59b179,_0x26a0a8)=>{const _0x50bf4d=_0x1863d0;_0x54bb20[_0x50bf4d(0xa9)](_0x21eb88,_0x530ed6,function(_0x13572a){const _0x2047a0=_0x50bf4d;_0x13572a&&(logError(_0xef7041[_0x2047a0(0xaf)],_0x13572a),_0xef7041[_0x2047a0(0x99)](_0x26a0a8,_0x13572a)),_0xef7041['biZBZ'](_0x59b179,null);});});}}}export const dbUtil=new DBUtil();