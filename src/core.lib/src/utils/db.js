const _0x543226=_0x4c04;function _0x4c04(_0x49d841,_0x25f1c3){const _0x2601b1=_0x2601();return _0x4c04=function(_0x4c04d1,_0x5dbdc5){_0x4c04d1=_0x4c04d1-0x9a;let _0x3b9554=_0x2601b1[_0x4c04d1];return _0x3b9554;},_0x4c04(_0x49d841,_0x25f1c3);}(function(_0x56b33a,_0x340873){const _0x58032f=_0x4c04,_0x30cd02=_0x56b33a();while(!![]){try{const _0x2a8398=-parseInt(_0x58032f(0x10d))/0x1*(parseInt(_0x58032f(0xe8))/0x2)+-parseInt(_0x58032f(0xb5))/0x3+-parseInt(_0x58032f(0xf6))/0x4*(parseInt(_0x58032f(0x124))/0x5)+-parseInt(_0x58032f(0xbb))/0x6*(parseInt(_0x58032f(0x106))/0x7)+parseInt(_0x58032f(0x9a))/0x8*(parseInt(_0x58032f(0xad))/0x9)+-parseInt(_0x58032f(0xb2))/0xa+parseInt(_0x58032f(0xa5))/0xb;if(_0x2a8398===_0x340873)break;else _0x30cd02['push'](_0x30cd02['shift']());}catch(_0x2feccd){_0x30cd02['push'](_0x30cd02['shift']());}}}(_0x2601,0x4f069));import _0x14510a from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';class DBUtilBase{['db'];async[_0x543226(0x10e)](_0x5cd442){const _0x11d361=_0x543226,_0x3a15f9={'YCdop':function(_0x2cd1fe,_0x9dfa89,_0x38b218){return _0x2cd1fe(_0x9dfa89,_0x38b218);},'jAQeS':_0x11d361(0x113),'Bkolz':function(_0x3b7ad0,_0x1dff09){return _0x3b7ad0(_0x1dff09);},'RATKM':function(_0x2e1754,_0x24cb2a){return _0x2e1754|_0x24cb2a;}};if(this['db'])return;return new Promise((_0x199b7c,_0x34ede3)=>{const _0x34fb36=_0x11d361,_0x3c92ab={'exqsY':function(_0x970739,_0x5061a6,_0x2e6a2e){return _0x3a15f9['YCdop'](_0x970739,_0x5061a6,_0x2e6a2e);},'wbsbl':_0x3a15f9[_0x34fb36(0x9d)],'CGfHP':function(_0x189098,_0x25faa3){return _0x3a15f9['Bkolz'](_0x189098,_0x25faa3);},'dZzCP':function(_0xc3e730){return _0xc3e730();}};this['db']=new _0x14510a[(_0x34fb36(0xd5))](_0x5cd442,_0x3a15f9[_0x34fb36(0xd3)](_0x14510a[_0x34fb36(0xb3)],_0x14510a[_0x34fb36(0x10b)]),_0x47cef0=>{const _0x4d2837=_0x34fb36;if(_0x47cef0){_0x3c92ab[_0x4d2837(0xff)](logError,_0x3c92ab['wbsbl'],_0x47cef0),_0x3c92ab['CGfHP'](_0x34ede3,_0x47cef0);return;}this['createTable'](),_0x3c92ab[_0x4d2837(0xd8)](_0x199b7c);});});}[_0x543226(0xcf)](){const _0x5577bd=_0x543226,_0x2790b3={'PuDOF':'Method\x20not\x20implemented.'};throw new Error(_0x2790b3[_0x5577bd(0xaa)]);}[_0x543226(0xa4)](){const _0x4d059f=_0x543226;this['db']?.[_0x4d059f(0xa4)]();}}class DBUtil extends DBUtilBase{[_0x543226(0xdf)]=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x51b1ba=_0x543226,_0x1d3b54={'Mnrty':function(_0x4d911b,_0x106cb4){return _0x4d911b>_0x106cb4;},'aAksd':function(_0x36defa,_0x2fe010){return _0x36defa-_0x2fe010;},'sjohe':function(_0x3ce238,_0x408e39){return _0x3ce238(_0x408e39);},'ybjVb':function(_0x2a5bfe,_0x48ebce){return _0x2a5bfe*_0x48ebce;}};super();const _0x4fb9c0=_0x1d3b54[_0x51b1ba(0x11a)](0x3e8*0x3c,0xa);setInterval(()=>{const _0xe2bb63=_0x51b1ba,_0x20a77d={'txKAo':function(_0x18fc7d,_0x71ea7a){return _0x1d3b54['Mnrty'](_0x18fc7d,_0x71ea7a);},'WHtDv':function(_0x583ad7,_0x4c1f96){const _0x3e9776=_0x4c04;return _0x1d3b54[_0x3e9776(0xe3)](_0x583ad7,_0x4c1f96);},'eYkNR':function(_0x3c5c5a,_0x12cea7){return _0x3c5c5a*_0x12cea7;},'XYVBw':function(_0x21505f,_0x5d3a4e){return _0x21505f(_0x5d3a4e);}};_0x1d3b54[_0xe2bb63(0xa3)](logDebug,_0xe2bb63(0xf9)),this[_0xe2bb63(0xdf)]['forEach']((_0x39c86b,_0x4932a0)=>{const _0x489ab2=_0xe2bb63;_0x20a77d['txKAo'](_0x20a77d[_0x489ab2(0xe2)](Date[_0x489ab2(0x101)](),_0x20a77d[_0x489ab2(0xe7)](_0x20a77d[_0x489ab2(0x111)](parseInt,_0x39c86b[_0x489ab2(0x118)]),0x3e8)),_0x4fb9c0)&&this[_0x489ab2(0xdf)]['delete'](_0x4932a0);});},_0x4fb9c0);}async['init'](_0x3eaf0e){const _0x489355=_0x543226;await super[_0x489355(0x10e)](_0x3eaf0e),this[_0x489355(0xaf)]=await this[_0x489355(0xa0)]();}[_0x543226(0xcf)](){const _0x55157c=_0x543226,_0x1896fd={'uLhag':function(_0x3afcb1,_0x215cdf,_0x4c553c){return _0x3afcb1(_0x215cdf,_0x4c553c);},'lnLLi':_0x55157c(0xf4),'HjkXX':_0x55157c(0x104),'FxFyD':_0x55157c(0xb0)},_0xa1b3b6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db'][_0x55157c(0xbe)](_0xa1b3b6,function(_0x5831d6){const _0x1c5306=_0x55157c;_0x5831d6&&_0x1896fd[_0x1c5306(0xda)](logError,_0x1896fd[_0x1c5306(0x100)],_0x5831d6[_0x1c5306(0xc5)]);});const _0x2918d7=_0x55157c(0xe0);this['db']['run'](_0x2918d7,function(_0x692834){const _0x1d0a6b=_0x55157c;_0x692834&&_0x1896fd[_0x1d0a6b(0xda)](logError,_0x1896fd['HjkXX'],_0x692834);});const _0x9965c3=_0x55157c(0xec);this['db'][_0x55157c(0xbe)](_0x9965c3,function(_0x3b0869){const _0x5a85b9=_0x55157c;_0x3b0869&&_0x1896fd[_0x5a85b9(0xda)](logError,_0x1896fd[_0x5a85b9(0xa8)],_0x3b0869);});}async[_0x543226(0xa0)](){const _0x32431=_0x543226,_0x426706={'Evqlv':function(_0x20aea8,_0x2f610a,_0x7975e2){return _0x20aea8(_0x2f610a,_0x7975e2);},'rpoRy':_0x32431(0xbd),'ByvuL':function(_0x50051a,_0x275bd9){return _0x50051a(_0x275bd9);},'StqAb':function(_0x1c918b,_0x2901a5,_0x2fe0a8){return _0x1c918b(_0x2901a5,_0x2fe0a8);},'LSwaK':_0x32431(0xc7),'UmPHF':function(_0x50ad58,_0x2bce5f){return _0x50ad58(_0x2bce5f);},'KCNWP':_0x32431(0xf5)};return new Promise((_0x2e6ab7,_0x97a0e6)=>{const _0x4f00ee=_0x32431;this['db'][_0x4f00ee(0xea)](_0x426706[_0x4f00ee(0x110)],(_0x53af08,_0x59e23a)=>{const _0x5d66bc=_0x4f00ee;if(_0x53af08)return _0x426706[_0x5d66bc(0xc2)](logDebug,_0x426706['rpoRy'],_0x53af08),_0x426706[_0x5d66bc(0x115)](_0x2e6ab7,-0x7ffffff8);_0x426706[_0x5d66bc(0x117)](logDebug,_0x426706[_0x5d66bc(0x109)],_0x59e23a?.[_0x5d66bc(0xbf)]),_0x426706['UmPHF'](_0x2e6ab7,_0x59e23a?.[_0x5d66bc(0xbf)]??-0x7ffffff8);});});}async[_0x543226(0x120)](_0x2a5299,_0x33cecc){const _0x45ee00={'rbgte':function(_0x50d9a2,_0xb04dbe){return _0x50d9a2(_0xb04dbe);}},_0x371b27=this['db']['prepare'](_0x2a5299);return new Promise((_0x35d458,_0x16e80e)=>{const _0xeb328b=_0x4c04;_0x371b27[_0xeb328b(0xea)](..._0x33cecc,(_0x9cafc9,_0x7f8fc5)=>{const _0x254fe9=_0xeb328b,_0x15e044={'tqTAS':function(_0x3cfb9c,_0xba6abc){const _0x5d7c10=_0x4c04;return _0x45ee00[_0x5d7c10(0xd7)](_0x3cfb9c,_0xba6abc);}};if(_0x9cafc9)return logError(_0x254fe9(0xc8),_0x9cafc9,_0x2a5299,_0x33cecc),_0x45ee00[_0x254fe9(0xd7)](_0x35d458,null);if(!_0x7f8fc5){_0x45ee00[_0x254fe9(0xd7)](_0x35d458,null);return;}const _0x45f44f=_0x7f8fc5[_0x254fe9(0xb7)];NTQQMsgApi[_0x254fe9(0x125)]({'peerUid':_0x7f8fc5[_0x254fe9(0xdd)],'chatType':_0x7f8fc5[_0x254fe9(0x114)]},[_0x45f44f])[_0x254fe9(0xde)](_0x33f95f=>{const _0x3ba4e2=_0x254fe9,_0xa8fe42=_0x33f95f[_0x3ba4e2(0xed)][0x0];if(!_0xa8fe42){_0x15e044[_0x3ba4e2(0xd0)](_0x35d458,null);return;}_0xa8fe42['id']=_0x7f8fc5[_0x3ba4e2(0x9c)],_0x35d458(_0xa8fe42);})[_0x254fe9(0x102)](_0x3d9f87=>{_0x35d458(null);});});});}async[_0x543226(0xd2)](_0x3bcfc0){const _0x25646a=_0x543226,_0x293f62={'vdqQs':'SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?'};if(this[_0x25646a(0xdf)][_0x25646a(0xb9)](_0x3bcfc0))return this[_0x25646a(0xdf)][_0x25646a(0xea)](_0x3bcfc0);const _0x42b632=_0x293f62[_0x25646a(0xa7)];return this[_0x25646a(0x120)](_0x42b632,[_0x3bcfc0]);}async[_0x543226(0x123)](_0xd02093){const _0x3c6f6d=_0x543226;if(this['msgCache']['has'](_0xd02093))return this[_0x3c6f6d(0xdf)][_0x3c6f6d(0xea)](_0xd02093);return this[_0x3c6f6d(0x120)](_0x3c6f6d(0xe6),[_0xd02093]);}async[_0x543226(0xeb)](_0x204392,_0xfddb26){const _0x5ac32c=_0x543226,_0xd89c16={'QsjeC':_0x5ac32c(0xd9)},_0x200bc2=_0xd89c16['QsjeC'];return this[_0x5ac32c(0x120)](_0x200bc2,[_0x204392,_0xfddb26]);}async['addMsg'](_0x243e5b,_0x121b67=!![]){const _0x34c662=_0x543226,_0x2fe61a={'PLeaL':_0x34c662(0x11d),'RSxqY':function(_0x22a2f8,_0x354e41){return _0x22a2f8===_0x354e41;},'LiRKE':function(_0x5137c8,_0x100c91,_0x572266){return _0x5137c8(_0x100c91,_0x572266);},'kxeLu':'db\x20could\x20not\x20add\x20msg','PHhuj':function(_0x5a41be,_0x3380e6){return _0x5a41be(_0x3380e6);}},_0xf4ef16=await this[_0x34c662(0x123)](_0x243e5b[_0x34c662(0xb6)]);if(_0xf4ef16){if(_0x121b67)this[_0x34c662(0xcc)](_0x243e5b)['then']();return _0xf4ef16['id'];}const _0x4ca937=this['db'][_0x34c662(0xfe)](_0x34c662(0xee)),_0x161527=++this[_0x34c662(0xaf)];return _0x243e5b['id']=_0x161527,_0x2fe61a['PHhuj'](logDebug,'记录消息到数据库,\x20消息长id:\x20'+_0x243e5b[_0x34c662(0xb6)]+_0x34c662(0xcd)+_0x243e5b['id']),this[_0x34c662(0xdf)][_0x34c662(0xfa)](_0x161527,_0x243e5b),this[_0x34c662(0xdf)][_0x34c662(0xfa)](_0x243e5b[_0x34c662(0xb6)],_0x243e5b),_0x4ca937[_0x34c662(0xbe)](this[_0x34c662(0xaf)],_0x243e5b[_0x34c662(0xb6)],_0x243e5b[_0x34c662(0xf1)]['toString'](),_0x243e5b[_0x34c662(0xdd)],_0x243e5b[_0x34c662(0x114)],_0x1657bd=>{const _0x397674=_0x34c662;_0x1657bd&&(_0x2fe61a['RSxqY'](_0x1657bd[_0x397674(0xf3)],0x13)?this[_0x397674(0x123)](_0x243e5b[_0x397674(0xb6)])['then'](_0x5bd8d7=>{const _0x557254=_0x397674;_0x5bd8d7?(this[_0x557254(0xdf)]['set'](_0x161527,_0x5bd8d7),this[_0x557254(0xdf)][_0x557254(0xfa)](_0x5bd8d7[_0x557254(0xb6)],_0x5bd8d7)):logError(_0x2fe61a[_0x557254(0xc3)],_0x1657bd);})[_0x397674(0x102)](_0x47b926=>logError(_0x397674(0xc9),_0x47b926)):_0x2fe61a[_0x397674(0x10f)](logError,_0x2fe61a['kxeLu'],_0x1657bd));}),_0x161527;}async[_0x543226(0xcc)](_0x2860ca){const _0x526c79=_0x543226,_0x2290c4={'KKgkw':function(_0xe0c5fb,_0x4004a0,_0x2d7ed2){return _0xe0c5fb(_0x4004a0,_0x2d7ed2);},'qOtGg':_0x526c79(0xc0),'uDkpX':function(_0x367d44,_0x592283){return _0x367d44(_0x592283);},'rmlfn':_0x526c79(0xd4)},_0x2b06e7=this['msgCache'][_0x526c79(0xea)](_0x2860ca['msgId']);_0x2b06e7&&Object[_0x526c79(0xe4)](_0x2b06e7,_0x2860ca);_0x2290c4[_0x526c79(0xac)](logDebug,_0x526c79(0x112)+_0x2860ca['id']+_0x526c79(0xe9)+_0x2860ca[_0x526c79(0xf1)]+_0x526c79(0x11b)+_0x2860ca[_0x526c79(0xb6)]);const _0x26dd98=this['db'][_0x526c79(0xfe)](_0x2290c4[_0x526c79(0x10c)]);_0x26dd98[_0x526c79(0xbe)](_0x2860ca[_0x526c79(0xf1)],_0x2860ca[_0x526c79(0xb6)],_0x305b4a=>{const _0x39fd16=_0x526c79;_0x305b4a&&_0x2290c4[_0x39fd16(0xae)](logError,_0x2290c4[_0x39fd16(0xfd)],_0x305b4a);});}async[_0x543226(0xfb)](_0x4761be){const _0x3db165=_0x543226,_0x397b54={'SNovg':function(_0x5ea8a7,_0x53c48e,_0x2afaea){return _0x5ea8a7(_0x53c48e,_0x2afaea);},'Bzzih':_0x3db165(0xfc),'wIyhH':function(_0x3afa06,_0x53f500){return _0x3afa06(_0x53f500);},'ZNuYO':'INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)'},_0x19747f=this['db'][_0x3db165(0xfe)](_0x397b54[_0x3db165(0xdb)]);return new Promise((_0x329fba,_0x4bdab9)=>{const _0x1d28ae=_0x3db165;_0x19747f['run'](_0x4761be[_0x1d28ae(0x103)],_0x4761be[_0x1d28ae(0xa1)],_0x4761be['url'],_0x4761be['size'],_0x4761be[_0x1d28ae(0xa2)],_0x4761be['elementType'],JSON[_0x1d28ae(0x11e)](_0x4761be[_0x1d28ae(0xef)]),_0x4761be[_0x1d28ae(0xab)],_0x4761be[_0x1d28ae(0xb6)],function(_0x352a74){const _0x27fc27=_0x1d28ae;_0x352a74&&(_0x397b54[_0x27fc27(0xa9)](logError,_0x397b54[_0x27fc27(0xc1)],_0x352a74),_0x4bdab9(_0x352a74)),_0x397b54['wIyhH'](_0x329fba,null);});});}async[_0x543226(0x108)](_0x43ec27,_0x146b77){const _0x444274=_0x543226,_0x5d5f8e={'szUuN':function(_0x1f9378,_0x2cae74,_0x1419ee){return _0x1f9378(_0x2cae74,_0x1419ee);},'IfroU':_0x444274(0xf8),'JuzaS':function(_0x5761c4,_0x4303ca){return _0x5761c4(_0x4303ca);}},_0xeefc09=this['db'][_0x444274(0xfe)](_0x43ec27);return new Promise((_0x1f8aaf,_0xcd2f4b)=>{const _0x3b2e90=_0x444274;_0xeefc09[_0x3b2e90(0xea)](..._0x146b77,(_0x5bde20,_0x20ed9a)=>{const _0x53f51c=_0x3b2e90;_0x5bde20&&(_0x5d5f8e[_0x53f51c(0x9e)](logError,_0x5d5f8e[_0x53f51c(0x9f)],_0x5bde20),_0x5d5f8e['JuzaS'](_0xcd2f4b,_0x5bde20)),_0x20ed9a&&(_0x20ed9a[_0x53f51c(0xef)]=JSON[_0x53f51c(0xce)](_0x20ed9a[_0x53f51c(0xef)])),_0x5d5f8e[_0x53f51c(0xf2)](_0x1f8aaf,_0x20ed9a);});});}async[_0x543226(0x121)](_0x87a966){const _0x1cd3d7=_0x543226,_0x624ff2={'kIycS':_0x1cd3d7(0x119)};return this[_0x1cd3d7(0x108)](_0x624ff2[_0x1cd3d7(0x107)],[_0x87a966]);}async[_0x543226(0xcb)](_0x3dcb67){const _0x46650f=_0x543226,_0x50d455={'AOnbo':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?'};return this[_0x46650f(0x108)](_0x50d455['AOnbo'],[_0x3dcb67]);}async[_0x543226(0xf7)](_0x27adeb){const _0x2c4e7b=_0x543226,_0x315c76={'laoYP':function(_0x3a34eb,_0x564fe8,_0x430882){return _0x3a34eb(_0x564fe8,_0x430882);},'WUYCa':'db\x20could\x20not\x20update\x20file\x20cache','edBCq':function(_0x432342,_0x45ba62){return _0x432342(_0x45ba62);}},_0x57b17d=this['db'][_0x2c4e7b(0xfe)]('UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?');return new Promise((_0x50ebb0,_0x3c0c1d)=>{const _0x307e9a=_0x2c4e7b;_0x57b17d[_0x307e9a(0xbe)](_0x27adeb[_0x307e9a(0xa1)],_0x27adeb['url'],_0x27adeb['uuid'],function(_0x41de7b){const _0x2cad8c=_0x307e9a;_0x41de7b&&(_0x315c76['laoYP'](logError,_0x315c76[_0x2cad8c(0x116)],_0x41de7b),_0x315c76[_0x2cad8c(0xca)](_0x3c0c1d,_0x41de7b)),_0x315c76[_0x2cad8c(0xca)](_0x50ebb0,null);});});}async['getReceivedTempUinMap'](){const _0xfef7f3=_0x543226,_0xea5263={'MwNZy':function(_0x3a24a9,_0x16ec49,_0x2886a0){return _0x3a24a9(_0x16ec49,_0x2886a0);},'hsczU':_0xfef7f3(0xb8),'Hkpfu':function(_0xad4113,_0x5deb8d){return _0xad4113(_0x5deb8d);},'TVVDF':_0xfef7f3(0xe1)},_0xdd2d54=_0xea5263['TVVDF'];return new Promise((_0x2aaeb6,_0xe4d1fb)=>{const _0x4191dc=_0xfef7f3;this['db'][_0x4191dc(0x11c)](_0xdd2d54,(_0x18121b,_0x71fe84)=>{const _0x117a57=_0x4191dc;_0x18121b&&(_0xea5263[_0x117a57(0xc4)](logError,_0xea5263[_0x117a57(0xf0)],_0x18121b),_0xea5263[_0x117a57(0xc6)](_0xe4d1fb,_0x18121b));const _0x3ee60b={};_0x71fe84[_0x117a57(0x122)](_0x3b4076=>{const _0x32b22b=_0x117a57;_0x3ee60b[_0x3b4076['uin']]=_0x3b4076[_0x32b22b(0xba)];}),_0xea5263[_0x117a57(0xc6)](_0x2aaeb6,_0x3ee60b);});});}async[_0x543226(0xb1)](_0x2cbed9){const _0x37c218=_0x543226,_0x8a19f={'Ttljs':function(_0x170a84,_0x3bb3d1,_0x48f809){return _0x170a84(_0x3bb3d1,_0x48f809);},'UsMjr':_0x37c218(0xb8),'lwdlh':_0x37c218(0xdc)},_0x3ada27=_0x8a19f[_0x37c218(0x105)];return new Promise((_0x4d6400,_0x6f2ca9)=>{const _0x4034d0=_0x37c218,_0x3d9633={'VtBcg':function(_0x213e80,_0x4bdf35,_0x1eeb70){return _0x8a19f['Ttljs'](_0x213e80,_0x4bdf35,_0x1eeb70);},'xSBmm':_0x8a19f['UsMjr'],'tUpTZ':function(_0x10cfb7,_0x2b3928){return _0x10cfb7(_0x2b3928);}};this['db'][_0x4034d0(0xea)](_0x3ada27,[_0x2cbed9],(_0x4a700e,_0x53129e)=>{const _0x71b267=_0x4034d0;_0x4a700e&&(_0x3d9633[_0x71b267(0xd1)](logError,_0x3d9633[_0x71b267(0xb4)],_0x4a700e),_0x3d9633['tUpTZ'](_0x6f2ca9,_0x4a700e)),_0x3d9633[_0x71b267(0xa6)](_0x4d6400,_0x53129e?.[_0x71b267(0xba)]);});});}async[_0x543226(0x11f)](_0x56feee,_0x3b5e59){const _0x186316=_0x543226,_0xbc687e={'PlPfB':function(_0x1761c5,_0x4c2222){return _0x1761c5(_0x4c2222);},'CHsFd':function(_0x26f467,_0x1f47ac){return _0x26f467(_0x1f47ac);},'YEsHB':_0x186316(0xbc)},_0x5e0a41=await this['getUidByTempUin'](_0x56feee);if(!_0x5e0a41){const _0xf764aa=this['db'][_0x186316(0xfe)](_0xbc687e[_0x186316(0xe5)]);return new Promise((_0x7b6e15,_0x11edf8)=>{const _0x12d4b6=_0x186316;_0xf764aa[_0x12d4b6(0xbe)](_0x56feee,_0x3b5e59,function(_0x43b726){const _0x4581d6=_0x12d4b6;_0x43b726&&(logError(_0x4581d6(0x10a),_0x43b726),_0xbc687e[_0x4581d6(0xd6)](_0x11edf8,_0x43b726)),_0xbc687e[_0x4581d6(0x9b)](_0x7b6e15,null);});});}}}export const dbUtil=new DBUtil();function _0x2601(){const _0x1f6f92=['数据库中消息最大短id','Could\x20not\x20get\x20msg','db\x20getMsgByLongId\x20error','edBCq','getFileCacheByUuid','updateMsg',',\x20短id:\x20','parse','createTable','tqTAS','VtBcg','getMsgByShortId','RATKM','UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?','Database','PlPfB','rbgte','dZzCP','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','uLhag','ZNuYO','SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?','peerUid','then','msgCache','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','SELECT\x20*\x20FROM\x20temp_uins','WHtDv','aAksd','assign','YEsHB','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','eYkNR','4dnvKWF',',\x20seq:\x20','get','getMsgBySeq','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','msgList','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','element','hsczU','msgSeq','JuzaS','errno','Could\x20not\x20create\x20table\x20msgs','SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs','52nqULDc','updateFileCache','db\x20could\x20not\x20get\x20file\x20cache','清理消息缓存','set','addFileCache','db\x20could\x20not\x20add\x20file','qOtGg','prepare','exqsY','lnLLi','now','catch','name','Could\x20not\x20create\x20table\x20files','lwdlh','25893oQQKER','kIycS','getFileCache','LSwaK','db\x20could\x20not\x20add\x20temp\x20uin','OPEN_CREATE','rmlfn','72131XYaoWt','init','LiRKE','KCNWP','XYVBw','更新消息,\x20shortId:','Could\x20not\x20connect\x20to\x20database','chatType','ByvuL','WUYCa','StqAb','msgTime','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','ybjVb',',\x20msgId:\x20','all','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','stringify','addTempUin','getMsg','getFileCacheByName','forEach','getMsgByLongId','135oerXSQ','getMsgsByMsgId','187224IXpoym','CHsFd','shortId','jAQeS','szUuN','IfroU','getCurrentMaxShortId','path','uuid','sjohe','close','9582485bqeGJN','tUpTZ','vdqQs','FxFyD','SNovg','PuDOF','elementId','uDkpX','9ADoUFj','KKgkw','globalMsgShortId','Could\x20not\x20create\x20table\x20temp_uins','getUidByTempUin','1449300eGKJAA','OPEN_READWRITE','xSBmm','167001obYPix','msgId','longId','db\x20could\x20not\x20get\x20temp\x20uin\x20map','has','uid','366NCYvwX','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','run','maxId','updateMsg\x20db\x20error','Bzzih','Evqlv','PLeaL','MwNZy','stack','Hkpfu'];_0x2601=function(){return _0x1f6f92;};return _0x2601();}