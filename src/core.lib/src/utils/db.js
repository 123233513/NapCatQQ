const _0x5acaac=_0x1ec2;function _0x23c4(){const _0x48edc9=['Could\x20not\x20get\x20msg','stack','errno','KxGYa','496hmrpCU','dfERs','updateFileCache','更新消息,\x20shortId:','299562sJJWNd','wbhAh','bgFPj','NwUNz','VddyG','Could\x20not\x20create\x20table\x20files','SPgHb','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20msgs\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20shortId\x20INTEGER\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20longId\x20TEXT\x20NOT\x20NULL\x20UNIQUE,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20seq\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20peerUid\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chatType\x20INTEGER\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','catch','QYOmw','PyFoz','get','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20files\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20path\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20url\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20size\x20INTEGER\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uuid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementType\x20INTEGER,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20element\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20elementId\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20msgId\x20TEXT\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)','uiqop','all','msgSeq','OPEN_READWRITE','elementType','msgTime','url','updateMsg','Recxt','awECC','清理消息缓存','name','IUfyX','PvTHA','getCurrentMaxShortId','delete','INSERT\x20INTO\x20files\x20(name,\x20path,\x20url,\x20size,\x20uuid,\x20elementType\x20,element,\x20elementId,\x20msgId)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)','CbrQL','1309962nuuvJV','zAxlS','lktkR','jTiNj','Could\x20not\x20connect\x20to\x20database','peerUid','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20longId\x20=\x20?','cRXJf','42834154PMEZVt','fJYXq','lpVPj','createTable','BVjNq','LeBHG','getFileCache','Could\x20not\x20create\x20table\x20msgs','msgCache','hVsjv','longId','elementId','chatType','msgId','then','430PFMZnK','EbJir','forEach','swqOH','SBIGh','wXMoT',',\x20短id:\x20','uid','prepare','path','52tMiHrT','Could\x20not\x20create\x20table\x20temp_uins','getUidByTempUin','24073gUUhfZ','INSERT\x20INTO\x20temp_uins\x20(uin,\x20uid)\x20VALUES\x20(?,\x20?)','mhoOy','gaQyQ','OPEN_CREATE','caSgZ','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20peerUid\x20=\x20?\x20AND\x20seq\x20=\x20?','db\x20could\x20not\x20add\x20msg','db\x20could\x20not\x20get\x20temp\x20uin\x20map','set','addTempUin','uuid','maxId','getMsg','has','KxjhX','SELECT\x20*\x20FROM\x20temp_uins','addFileCache','586016HgkxMK','记录消息到数据库,\x20消息长id:\x20','SELECT\x20*\x20FROM\x20msgs\x20WHERE\x20shortId\x20=\x20?','242883mdQDfK','getMsgByLongId','stringify','fdvzf','数据库中消息最大短id','PYaRp','6jbgNDw','YVOYV','BSpnk','db\x20could\x20not\x20add\x20temp\x20uin','thmBS','size','uvHob','cMmiS','run','groOa','aAgVa','qTdqr','assign','Method\x20not\x20implemented.','yNYls','globalMsgShortId','Could\x20not\x20get\x20max\x20short\x20id,\x20Use\x20default\x20-2147483640','pYZRr','close','init','INSERT\x20INTO\x20msgs\x20(shortId,\x20longId,\x20seq,\x20peerUid,\x20chatType)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)','SELECT\x20*\x20FROM\x20files\x20WHERE\x20name\x20=\x20?','element','db\x20could\x20not\x20get\x20msg\x20by\x20long\x20id','zygkF','TsAVb','ZLXOo','VGrUx','6035105WOPVtz','getFileCacheByUuid','msgList'];_0x23c4=function(){return _0x48edc9;};return _0x23c4();}(function(_0x3b2a4c,_0xa235f5){const _0xb387a8=_0x1ec2,_0x45407d=_0x3b2a4c();while(!![]){try{const _0x3ed927=-parseInt(_0xb387a8(0x19a))/0x1+-parseInt(_0xb387a8(0x14b))/0x2+-parseInt(_0xb387a8(0x17b))/0x3*(parseInt(_0xb387a8(0x136))/0x4)+-parseInt(_0xb387a8(0x170))/0x5*(parseInt(_0xb387a8(0x154))/0x6)+-parseInt(_0xb387a8(0x139))/0x7*(parseInt(_0xb387a8(0x177))/0x8)+-parseInt(_0xb387a8(0x14e))/0x9*(-parseInt(_0xb387a8(0x12c))/0xa)+parseInt(_0xb387a8(0x1a2))/0xb;if(_0x3ed927===_0xa235f5)break;else _0x45407d['push'](_0x45407d['shift']());}catch(_0x5eee8c){_0x45407d['push'](_0x45407d['shift']());}}}(_0x23c4,0xb2fd8));import _0xbf6b95 from'sqlite3';import{logDebug,logError}from'@/common/utils/log';import{NTQQMsgApi}from'@/core';function _0x1ec2(_0x5eb1a8,_0x5d7107){const _0x23c42e=_0x23c4();return _0x1ec2=function(_0x1ec238,_0x592376){_0x1ec238=_0x1ec238-0x120;let _0x398c89=_0x23c42e[_0x1ec238];return _0x398c89;},_0x1ec2(_0x5eb1a8,_0x5d7107);}class DBUtilBase{['db'];async[_0x5acaac(0x167)](_0x400035){const _0x3c6318={'QYOmw':function(_0x1ea65e,_0x3096bc,_0x198067){return _0x1ea65e(_0x3096bc,_0x198067);},'VGrUx':function(_0x2b5017,_0x19fc52){return _0x2b5017(_0x19fc52);},'wbhAh':function(_0x3ea95e){return _0x3ea95e();},'ZiOvt':function(_0x1aceee,_0x387abe){return _0x1aceee|_0x387abe;}};if(this['db'])return;return new Promise((_0x6d306a,_0x14385f)=>{const _0x253902=_0x1ec2,_0x35027b={'aAgVa':function(_0x149e91,_0x2311b8,_0x3c6b9b){const _0x136b23=_0x1ec2;return _0x3c6318[_0x136b23(0x184)](_0x149e91,_0x2311b8,_0x3c6b9b);},'VddyG':function(_0x1e7900,_0x584325){const _0x145304=_0x1ec2;return _0x3c6318[_0x145304(0x16f)](_0x1e7900,_0x584325);},'PWrDJ':function(_0x2d3657){const _0x339035=_0x1ec2;return _0x3c6318[_0x339035(0x17c)](_0x2d3657);}};this['db']=new _0xbf6b95['Database'](_0x400035,_0x3c6318['ZiOvt'](_0xbf6b95[_0x253902(0x18b)],_0xbf6b95[_0x253902(0x13d)]),_0xa0a05f=>{const _0x1427db=_0x253902;if(_0xa0a05f){_0x35027b[_0x1427db(0x15e)](logError,_0x1427db(0x19e),_0xa0a05f),_0x35027b[_0x1427db(0x17f)](_0x14385f,_0xa0a05f);return;}this[_0x1427db(0x120)](),_0x35027b['PWrDJ'](_0x6d306a);});});}[_0x5acaac(0x120)](){const _0x4d314f=_0x5acaac,_0x3e84ab={'uvHob':_0x4d314f(0x161)};throw new Error(_0x3e84ab[_0x4d314f(0x15a)]);}[_0x5acaac(0x166)](){this['db']?.['close']();}}class DBUtil extends DBUtilBase{['msgCache']=new Map();['globalMsgShortId']=-0x7ffffff8;constructor(){const _0x245d7b=_0x5acaac,_0x2ea607={'BSpnk':function(_0x261ca9,_0x4b9cf6){return _0x261ca9>_0x4b9cf6;},'yNYls':function(_0x4828b2,_0x359c6c){return _0x4828b2-_0x359c6c;},'YVOYV':function(_0x528d21,_0x315aa4){return _0x528d21*_0x315aa4;},'cRXJf':function(_0x1c36ce,_0x2f73c1){return _0x1c36ce(_0x2f73c1);},'Zmqcj':_0x245d7b(0x192),'caSgZ':function(_0x2882cb,_0x5128ef){return _0x2882cb*_0x5128ef;},'awECC':function(_0x50b65c,_0x548683){return _0x50b65c*_0x548683;}};super();const _0x42d95d=_0x2ea607[_0x245d7b(0x13e)](_0x2ea607[_0x245d7b(0x191)](0x3e8,0x3c),0xa);setInterval(()=>{const _0x32350b=_0x245d7b;_0x2ea607[_0x32350b(0x1a1)](logDebug,_0x2ea607['Zmqcj']),this[_0x32350b(0x125)][_0x32350b(0x12e)]((_0x485eef,_0xa66d92)=>{const _0x1f60d9=_0x32350b;_0x2ea607[_0x1f60d9(0x156)](_0x2ea607[_0x1f60d9(0x162)](Date['now'](),_0x2ea607[_0x1f60d9(0x155)](_0x2ea607[_0x1f60d9(0x1a1)](parseInt,_0x485eef[_0x1f60d9(0x18d)]),0x3e8)),_0x42d95d)&&this[_0x1f60d9(0x125)][_0x1f60d9(0x197)](_0xa66d92);});},_0x42d95d);}async[_0x5acaac(0x167)](_0xaf3cd1){const _0x55f98a=_0x5acaac;await super[_0x55f98a(0x167)](_0xaf3cd1),this[_0x55f98a(0x163)]=await this[_0x55f98a(0x196)]();}[_0x5acaac(0x120)](){const _0x1ebec2=_0x5acaac,_0x44f093={'mhoOy':function(_0x3f658e,_0x30fc6c,_0x1b75a3){return _0x3f658e(_0x30fc6c,_0x1b75a3);},'IUfyX':function(_0x1664de,_0x2820e9,_0x2c6a97){return _0x1664de(_0x2820e9,_0x2c6a97);},'groOa':_0x1ebec2(0x137)},_0x259643=_0x1ebec2(0x182);this['db'][_0x1ebec2(0x15c)](_0x259643,function(_0x754e6d){const _0x5dcdee=_0x1ebec2;_0x754e6d&&_0x44f093[_0x5dcdee(0x13b)](logError,_0x5dcdee(0x124),_0x754e6d[_0x5dcdee(0x174)]);});const _0x4e50e8=_0x1ebec2(0x187);this['db'][_0x1ebec2(0x15c)](_0x4e50e8,function(_0x4ae2c0){const _0x3c116b=_0x1ebec2;_0x4ae2c0&&_0x44f093[_0x3c116b(0x194)](logError,_0x3c116b(0x180),_0x4ae2c0);});const _0x4c806e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20temp_uins\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x20INTEGER\x20PRIMARY\x20KEY\x20AUTOINCREMENT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uid\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uin\x20TEXT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20)';this['db'][_0x1ebec2(0x15c)](_0x4c806e,function(_0x347b12){const _0x3c72d9=_0x1ebec2;_0x347b12&&logError(_0x44f093[_0x3c72d9(0x15d)],_0x347b12);});}async[_0x5acaac(0x196)](){const _0x9cc276=_0x5acaac,_0x22c14e={'fJYXq':function(_0x217031,_0x3e3c7a,_0x20739c){return _0x217031(_0x3e3c7a,_0x20739c);},'KxGYa':_0x9cc276(0x164),'TsAVb':_0x9cc276(0x152),'BxFqL':'SELECT\x20MAX(shortId)\x20as\x20maxId\x20FROM\x20msgs'};return new Promise((_0x437c0a,_0x3c08f9)=>{const _0x479d60=_0x9cc276;this['db'][_0x479d60(0x186)](_0x22c14e['BxFqL'],(_0x54d009,_0x4621e5)=>{const _0x133983=_0x479d60;if(_0x54d009)return _0x22c14e[_0x133983(0x1a3)](logDebug,_0x22c14e[_0x133983(0x176)],_0x54d009),_0x437c0a(-0x7ffffff8);logDebug(_0x22c14e[_0x133983(0x16d)],_0x4621e5?.[_0x133983(0x145)]),_0x437c0a(_0x4621e5?.[_0x133983(0x145)]??-0x7ffffff8);});});}async[_0x5acaac(0x146)](_0x5dbd9d,_0x320ca9){const _0x18aef4=_0x5acaac,_0x12676d={'pYZRr':function(_0x431f2a,_0x5cae41){return _0x431f2a(_0x5cae41);},'swqOH':function(_0x23fe0e,_0x387f1c,_0x207a3c,_0x1a8ac1,_0x3cdc01){return _0x23fe0e(_0x387f1c,_0x207a3c,_0x1a8ac1,_0x3cdc01);}},_0x3154cd=this['db'][_0x18aef4(0x134)](_0x5dbd9d);return new Promise((_0x518c11,_0x7e3db7)=>{const _0x309b21=_0x18aef4;_0x3154cd[_0x309b21(0x186)](..._0x320ca9,(_0x1889f6,_0x4a13e1)=>{const _0x4b00a2=_0x309b21,_0x2814e7={'gaQyQ':function(_0x68df9c,_0x553568){return _0x12676d['pYZRr'](_0x68df9c,_0x553568);},'pbZNZ':function(_0x5ecd7d,_0x2e7473){const _0x598eda=_0x1ec2;return _0x12676d[_0x598eda(0x165)](_0x5ecd7d,_0x2e7473);}};if(_0x1889f6)return _0x12676d[_0x4b00a2(0x12f)](logError,_0x4b00a2(0x173),_0x1889f6,_0x5dbd9d,_0x320ca9),_0x12676d[_0x4b00a2(0x165)](_0x518c11,null);if(!_0x4a13e1){_0x12676d[_0x4b00a2(0x165)](_0x518c11,null);return;}const _0x57f542=_0x4a13e1[_0x4b00a2(0x127)];NTQQMsgApi['getMsgsByMsgId']({'peerUid':_0x4a13e1[_0x4b00a2(0x19f)],'chatType':_0x4a13e1[_0x4b00a2(0x129)]},[_0x57f542])['then'](_0x500fbf=>{const _0x6a1b09=_0x4b00a2,_0x597884=_0x500fbf[_0x6a1b09(0x172)][0x0];if(!_0x597884){_0x2814e7[_0x6a1b09(0x13c)](_0x518c11,null);return;}_0x597884['id']=_0x4a13e1['shortId'],_0x2814e7['pbZNZ'](_0x518c11,_0x597884);})['catch'](_0x59cff8=>{const _0x586919=_0x4b00a2;_0x2814e7[_0x586919(0x13c)](_0x518c11,null);});});});}async['getMsgByShortId'](_0x4291df){const _0x2ba3b3=_0x5acaac,_0xfda709={'wXMoT':_0x2ba3b3(0x14d)};if(this[_0x2ba3b3(0x125)][_0x2ba3b3(0x147)](_0x4291df))return this[_0x2ba3b3(0x125)][_0x2ba3b3(0x186)](_0x4291df);const _0x10016a=_0xfda709[_0x2ba3b3(0x131)];return this[_0x2ba3b3(0x146)](_0x10016a,[_0x4291df]);}async['getMsgByLongId'](_0x3f5094){const _0x56de4d=_0x5acaac,_0x1708bc={'lpVPj':_0x56de4d(0x1a0)};if(this[_0x56de4d(0x125)]['has'](_0x3f5094))return this[_0x56de4d(0x125)][_0x56de4d(0x186)](_0x3f5094);return this[_0x56de4d(0x146)](_0x1708bc[_0x56de4d(0x1a4)],[_0x3f5094]);}async['getMsgBySeq'](_0x1e2405,_0x5cb34a){const _0x4186a2=_0x5acaac,_0x2bb4f9=_0x4186a2(0x13f);return this[_0x4186a2(0x146)](_0x2bb4f9,[_0x1e2405,_0x5cb34a]);}async['addMsg'](_0x44713d,_0x1fc2a8=!![]){const _0x1b9866=_0x5acaac,_0x41dae3={'PYaRp':function(_0x5e9c43,_0x95a62d){return _0x5e9c43===_0x95a62d;},'lfOAC':_0x1b9866(0x140),'xUrIZ':_0x1b9866(0x168),'ZLXOo':function(_0x271f6a,_0x53d77c){return _0x271f6a(_0x53d77c);}},_0x51b225=await this['getMsgByLongId'](_0x44713d[_0x1b9866(0x12a)]);if(_0x51b225){if(_0x1fc2a8)this[_0x1b9866(0x18f)](_0x44713d)[_0x1b9866(0x12b)]();return _0x51b225['id'];}const _0x2e9cab=this['db']['prepare'](_0x41dae3['xUrIZ']),_0x5a21a1=++this[_0x1b9866(0x163)];return _0x44713d['id']=_0x5a21a1,_0x41dae3[_0x1b9866(0x16e)](logDebug,_0x1b9866(0x14c)+_0x44713d[_0x1b9866(0x12a)]+_0x1b9866(0x132)+_0x44713d['id']),this['msgCache'][_0x1b9866(0x142)](_0x5a21a1,_0x44713d),this[_0x1b9866(0x125)][_0x1b9866(0x142)](_0x44713d[_0x1b9866(0x12a)],_0x44713d),_0x2e9cab[_0x1b9866(0x15c)](this[_0x1b9866(0x163)],_0x44713d[_0x1b9866(0x12a)],_0x44713d[_0x1b9866(0x18a)]['toString'](),_0x44713d['peerUid'],_0x44713d[_0x1b9866(0x129)],_0x42a90f=>{const _0x51ea9e=_0x1b9866;_0x42a90f&&(_0x41dae3[_0x51ea9e(0x153)](_0x42a90f[_0x51ea9e(0x175)],0x13)?this[_0x51ea9e(0x14f)](_0x44713d[_0x51ea9e(0x12a)])[_0x51ea9e(0x12b)](_0x4da8fe=>{const _0x185089=_0x51ea9e;_0x4da8fe?(this[_0x185089(0x125)][_0x185089(0x142)](_0x5a21a1,_0x4da8fe),this['msgCache'][_0x185089(0x142)](_0x4da8fe['msgId'],_0x4da8fe)):logError(_0x185089(0x16b),_0x42a90f);})[_0x51ea9e(0x183)](_0x3202e9=>logError('db\x20getMsgByLongId\x20error',_0x3202e9)):logError(_0x41dae3['lfOAC'],_0x42a90f));}),_0x5a21a1;}async[_0x5acaac(0x18f)](_0x3ccb44){const _0x24685b=_0x5acaac,_0x1b1b5d={'jTiNj':'updateMsg\x20db\x20error','cMmiS':'UPDATE\x20msgs\x20SET\x20seq=?\x20WHERE\x20longId=?'},_0x7fcd0e=this[_0x24685b(0x125)][_0x24685b(0x186)](_0x3ccb44[_0x24685b(0x12a)]);_0x7fcd0e&&Object[_0x24685b(0x160)](_0x7fcd0e,_0x3ccb44);logDebug(_0x24685b(0x17a)+_0x3ccb44['id']+',\x20seq:\x20'+_0x3ccb44[_0x24685b(0x18a)]+',\x20msgId:\x20'+_0x3ccb44[_0x24685b(0x12a)]);const _0x5e080a=this['db'][_0x24685b(0x134)](_0x1b1b5d[_0x24685b(0x15b)]);_0x5e080a['run'](_0x3ccb44[_0x24685b(0x18a)],_0x3ccb44[_0x24685b(0x12a)],_0xc69fd4=>{const _0x412adb=_0x24685b;_0xc69fd4&&logError(_0x1b1b5d[_0x412adb(0x19d)],_0xc69fd4);});}async[_0x5acaac(0x14a)](_0x5aae16){const _0x5a5f96=_0x5acaac,_0x8afa12={'XgGzs':function(_0x1fd4dc,_0x56b9cd){return _0x1fd4dc(_0x56b9cd);},'dfERs':function(_0x4a8d8b,_0xa0b2f5){return _0x4a8d8b(_0xa0b2f5);}},_0x3760de=this['db'][_0x5a5f96(0x134)](_0x5a5f96(0x198));return new Promise((_0x23b3ee,_0x20f572)=>{const _0x42c337=_0x5a5f96,_0x45f8bf={'SBIGh':function(_0x44d26c,_0x596370){return _0x8afa12['XgGzs'](_0x44d26c,_0x596370);},'NwUNz':function(_0x1086b4,_0x19aa40){const _0x565ee0=_0x1ec2;return _0x8afa12[_0x565ee0(0x178)](_0x1086b4,_0x19aa40);}};_0x3760de[_0x42c337(0x15c)](_0x5aae16[_0x42c337(0x193)],_0x5aae16[_0x42c337(0x135)],_0x5aae16[_0x42c337(0x18e)],_0x5aae16[_0x42c337(0x159)],_0x5aae16[_0x42c337(0x144)],_0x5aae16[_0x42c337(0x18c)],JSON[_0x42c337(0x150)](_0x5aae16[_0x42c337(0x16a)]),_0x5aae16[_0x42c337(0x128)],_0x5aae16[_0x42c337(0x12a)],function(_0x566647){const _0x2f408d=_0x42c337;_0x566647&&(logError('db\x20could\x20not\x20add\x20file',_0x566647),_0x45f8bf[_0x2f408d(0x130)](_0x20f572,_0x566647)),_0x45f8bf[_0x2f408d(0x17e)](_0x23b3ee,null);});});}async[_0x5acaac(0x123)](_0x408128,_0x19c1f2){const _0x84d243={'ntYxo':function(_0x1b9a62,_0x166c9f,_0x4fb475){return _0x1b9a62(_0x166c9f,_0x4fb475);},'GdFde':'db\x20could\x20not\x20get\x20file\x20cache'},_0x3d7438=this['db']['prepare'](_0x408128);return new Promise((_0x4b4f3f,_0x9bc4a1)=>{const _0x3b9fe1=_0x1ec2,_0x1f6147={'lNHHM':function(_0x18017a,_0x2eabe0,_0x1ab195){return _0x84d243['ntYxo'](_0x18017a,_0x2eabe0,_0x1ab195);},'qTdqr':_0x84d243['GdFde'],'hVsjv':function(_0x49a666,_0x20fce3){return _0x49a666(_0x20fce3);}};_0x3d7438[_0x3b9fe1(0x186)](..._0x19c1f2,(_0xf8fd39,_0x387891)=>{const _0x5c87c7=_0x3b9fe1;_0xf8fd39&&(_0x1f6147['lNHHM'](logError,_0x1f6147[_0x5c87c7(0x15f)],_0xf8fd39),_0x9bc4a1(_0xf8fd39)),_0x387891&&(_0x387891[_0x5c87c7(0x16a)]=JSON['parse'](_0x387891[_0x5c87c7(0x16a)])),_0x1f6147[_0x5c87c7(0x126)](_0x4b4f3f,_0x387891);});});}async['getFileCacheByName'](_0x5684d7){const _0x534c92=_0x5acaac,_0x13f062={'tSEav':_0x534c92(0x169)};return this[_0x534c92(0x123)](_0x13f062['tSEav'],[_0x5684d7]);}async[_0x5acaac(0x171)](_0x59c802){const _0xf5276b=_0x5acaac,_0x91185a={'PyFoz':'SELECT\x20*\x20FROM\x20files\x20WHERE\x20uuid\x20=\x20?'};return this[_0xf5276b(0x123)](_0x91185a[_0xf5276b(0x185)],[_0x59c802]);}async[_0x5acaac(0x179)](_0x5b879e){const _0x474c73=_0x5acaac,_0x8d1fa1={'gUTOJ':'db\x20could\x20not\x20update\x20file\x20cache','KxjhX':function(_0x3f85c3,_0x4bf34a){return _0x3f85c3(_0x4bf34a);},'PvTHA':'UPDATE\x20files\x20SET\x20path\x20=\x20?,\x20url\x20=\x20?\x20WHERE\x20uuid\x20=\x20?'},_0x37c5be=this['db'][_0x474c73(0x134)](_0x8d1fa1[_0x474c73(0x195)]);return new Promise((_0xc73ac0,_0x28259d)=>{const _0xd0da=_0x474c73;_0x37c5be['run'](_0x5b879e[_0xd0da(0x135)],_0x5b879e[_0xd0da(0x18e)],_0x5b879e[_0xd0da(0x144)],function(_0x2c04a9){const _0x4e09fa=_0xd0da;_0x2c04a9&&(logError(_0x8d1fa1['gUTOJ'],_0x2c04a9),_0x8d1fa1[_0x4e09fa(0x148)](_0x28259d,_0x2c04a9)),_0xc73ac0(null);});});}async['getReceivedTempUinMap'](){const _0x17014b=_0x5acaac,_0x4a1893={'bgFPj':function(_0x2fea00,_0x1faa82,_0x16d49f){return _0x2fea00(_0x1faa82,_0x16d49f);},'BVjNq':function(_0x563edb,_0xc559b8){return _0x563edb(_0xc559b8);}},_0x272125=_0x17014b(0x149);return new Promise((_0xf800fd,_0x4d43e3)=>{const _0x3f8b47=_0x17014b,_0x3bfa63={'ciNOB':function(_0x4f963f,_0x433080,_0x35373e){const _0x4de568=_0x1ec2;return _0x4a1893[_0x4de568(0x17d)](_0x4f963f,_0x433080,_0x35373e);},'CbrQL':_0x3f8b47(0x141),'lktkR':function(_0x5b16d,_0x3c8ca7){const _0x2b6b30=_0x3f8b47;return _0x4a1893[_0x2b6b30(0x121)](_0x5b16d,_0x3c8ca7);}};this['db'][_0x3f8b47(0x189)](_0x272125,(_0x477eea,_0x792b8f)=>{const _0x20ceb8=_0x3f8b47;_0x477eea&&(_0x3bfa63['ciNOB'](logError,_0x3bfa63[_0x20ceb8(0x199)],_0x477eea),_0x3bfa63[_0x20ceb8(0x19c)](_0x4d43e3,_0x477eea));const _0xf86bb4={};_0x792b8f['forEach'](_0x42f2b1=>{_0xf86bb4[_0x42f2b1['uin']]=_0x42f2b1['uid'];}),_0xf800fd(_0xf86bb4);});});}async[_0x5acaac(0x138)](_0x3d99a7){const _0x4a48c7=_0x5acaac,_0xd35d46={'qDznm':function(_0x5a7198,_0x30fbd7,_0x817485){return _0x5a7198(_0x30fbd7,_0x817485);},'SPgHb':function(_0x13b569,_0xffbff4){return _0x13b569(_0xffbff4);},'uiqop':'SELECT\x20*\x20FROM\x20temp_uins\x20WHERE\x20uin\x20=\x20?'},_0xc8fe34=_0xd35d46[_0x4a48c7(0x188)];return new Promise((_0x4d8ac5,_0x3d5030)=>{const _0x1ba2df=_0x4a48c7,_0xa13451={'zAxlS':function(_0x56dd21,_0x270799,_0x184b4d){return _0xd35d46['qDznm'](_0x56dd21,_0x270799,_0x184b4d);},'Recxt':_0x1ba2df(0x141),'EbJir':function(_0x46107a,_0x4d744f){const _0x513b6a=_0x1ba2df;return _0xd35d46[_0x513b6a(0x181)](_0x46107a,_0x4d744f);}};this['db'][_0x1ba2df(0x186)](_0xc8fe34,[_0x3d99a7],(_0x4d52a5,_0x3e7d60)=>{const _0x1e9138=_0x1ba2df;_0x4d52a5&&(_0xa13451[_0x1e9138(0x19b)](logError,_0xa13451[_0x1e9138(0x190)],_0x4d52a5),_0xa13451[_0x1e9138(0x12d)](_0x3d5030,_0x4d52a5)),_0x4d8ac5(_0x3e7d60?.[_0x1e9138(0x133)]);});});}async[_0x5acaac(0x143)](_0x5ed27d,_0x51f4c7){const _0xa09814=_0x5acaac,_0x39b669={'thmBS':function(_0x4f42e3,_0x576b23,_0x204346){return _0x4f42e3(_0x576b23,_0x204346);},'zygkF':function(_0x3f2486,_0x420c73){return _0x3f2486(_0x420c73);},'LBfIm':_0xa09814(0x13a)},_0x272cea=await this[_0xa09814(0x138)](_0x5ed27d);if(!_0x272cea){const _0x3cdaa5=this['db'][_0xa09814(0x134)](_0x39b669['LBfIm']);return new Promise((_0x34dc09,_0x13df33)=>{const _0x527403=_0xa09814,_0x22f068={'LeBHG':function(_0x2f6384,_0x11a76a,_0x28f659){const _0x305c09=_0x1ec2;return _0x39b669[_0x305c09(0x158)](_0x2f6384,_0x11a76a,_0x28f659);},'EqPPX':_0x527403(0x157),'fdvzf':function(_0x1739de,_0x6591f8){const _0x5162cd=_0x527403;return _0x39b669[_0x5162cd(0x16c)](_0x1739de,_0x6591f8);}};_0x3cdaa5[_0x527403(0x15c)](_0x5ed27d,_0x51f4c7,function(_0x277310){const _0x4556b6=_0x527403;_0x277310&&(_0x22f068[_0x4556b6(0x122)](logError,_0x22f068['EqPPX'],_0x277310),_0x13df33(_0x277310)),_0x22f068[_0x4556b6(0x151)](_0x34dc09,null);});});}}}export const dbUtil=new DBUtil();