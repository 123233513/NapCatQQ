const _0x481bd5=_0x29c8;function _0x29c8(_0x309ae4,_0xbe38b1){const _0x3c9cbc=_0x3c9c();return _0x29c8=function(_0x29c827,_0x5d5901){_0x29c827=_0x29c827-0xe2;let _0x5358ac=_0x3c9cbc[_0x29c827];return _0x5358ac;},_0x29c8(_0x309ae4,_0xbe38b1);}(function(_0x460f56,_0x30093d){const _0x1ec06e=_0x29c8,_0x190aae=_0x460f56();while(!![]){try{const _0x34da63=parseInt(_0x1ec06e(0x10b))/0x1*(-parseInt(_0x1ec06e(0xfe))/0x2)+parseInt(_0x1ec06e(0xeb))/0x3+parseInt(_0x1ec06e(0xea))/0x4+parseInt(_0x1ec06e(0xff))/0x5*(-parseInt(_0x1ec06e(0x10f))/0x6)+-parseInt(_0x1ec06e(0x107))/0x7*(-parseInt(_0x1ec06e(0xee))/0x8)+parseInt(_0x1ec06e(0xe3))/0x9*(-parseInt(_0x1ec06e(0xe2))/0xa)+parseInt(_0x1ec06e(0xfb))/0xb;if(_0x34da63===_0x30093d)break;else _0x190aae['push'](_0x190aae['shift']());}catch(_0x89725){_0x190aae['push'](_0x190aae['shift']());}}}(_0x3c9c,0x34327));import{Wrapper}from'./qqnt';import{GlobalAdapter}from'./qqnt/adapters';import{NapCatCoreWrapper}from'./wrapper';import{NapCatCoreLogin}from'./login';import{NapCatCoreSession}from'./session';import{NapCatCoreService}from'./service';import{appid,qqVersionConfigInfo}from'@/common/utils/QQBasicInfo';import{dbUtil}from'@/common/utils/db';import{hostname,systemVersion}from'@/common/utils/system';import{selfInfo}from'@/common/data';import _0xd77904 from'node:path';import _0x3b87e3 from'node:fs';import{EventEmitter}from'node:events';import*as _0x4820ba from'@log4js-node/log4js-api';export class NapCatCore extends EventEmitter{[_0x481bd5(0x110)];['adapter'];[_0x481bd5(0x103)];['login'];['session'];['service'];['loginSuccessCbList']=[];constructor(){const _0xcada82=_0x481bd5,_0x359ade={'JhhDz':_0xcada82(0x105),'zlUzv':'QQNT\x20数据目录：','XiIjX':'Core','QmvdV':'Windows\x2010\x20Pro'},_0x43b94c=_0xcada82(0xf3)[_0xcada82(0x106)]('|');let _0x66fc50=0x0;while(!![]){switch(_0x43b94c[_0x66fc50++]){case'0':this['log'][_0xcada82(0x11b)](_0x359ade[_0xcada82(0x102)],qqVersionConfigInfo['curVersion']);continue;case'1':this[_0xcada82(0x100)]=new NapCatCoreLogin(this);continue;case'2':this['adapter']=new GlobalAdapter();continue;case'3':this[_0xcada82(0x116)]=new NapCatCoreSession();continue;case'4':this['log'][_0xcada82(0x11b)](_0x359ade[_0xcada82(0x11a)],this[_0xcada82(0x103)]['dataPathGlobal']);continue;case'5':this[_0xcada82(0x10a)]=new NapCatCoreService(this);continue;case'6':super();continue;case'7':this[_0xcada82(0x110)]=_0x4820ba[_0xcada82(0x11c)](_0x359ade[_0xcada82(0x113)]);continue;case'8':this['login'][_0xcada82(0xfd)]({'machineId':'','appid':appid,'platVer':systemVersion,'commonPath':this[_0xcada82(0x103)][_0xcada82(0x112)],'clientVer':qqVersionConfigInfo[_0xcada82(0xf6)],'hostName':hostname});continue;case'9':this[_0xcada82(0x103)][_0xcada82(0xfd)]({'base_path_prefix':'','platform_type':0x3,'app_type':0x4,'app_version':qqVersionConfigInfo[_0xcada82(0xf6)],'os_version':_0x359ade['QmvdV'],'use_xlog':!![],'qua':'V1_WIN_NQ_'+qqVersionConfigInfo[_0xcada82(0xf6)][_0xcada82(0xe8)]('-','_')+_0xcada82(0xe6),'global_path_config':{'desktopGlobalPath':this[_0xcada82(0x103)][_0xcada82(0x112)]},'thumb_config':{'maxSide':0x144,'minSide':0x30,'longLimit':0x6,'density':0x2}},new Wrapper['NodeIGlobalAdapter'](this['adapter']));continue;case'10':this[_0xcada82(0x103)]=new NapCatCoreWrapper();continue;}break;}}async[_0x481bd5(0x114)](_0x44245b){const _0x2b5fc5=_0x481bd5,_0xda5224={'JKaNk':_0x2b5fc5(0x111)};this[_0x2b5fc5(0x116)]['init'](_0x44245b['uin'],_0x44245b[_0x2b5fc5(0xf1)],this[_0x2b5fc5(0x103)][_0x2b5fc5(0xec)])[_0x2b5fc5(0x118)](()=>{const _0x30c476=_0x2b5fc5;this[_0x30c476(0xfa)](_0x44245b['uin'],_0x44245b[_0x30c476(0xf1)]);})[_0x2b5fc5(0xe9)](_0xeded02=>{const _0x589e5e=_0x2b5fc5;console['error'](_0x589e5e(0x119),JSON[_0x589e5e(0xef)](_0xeded02)),this['emit'](_0xda5224[_0x589e5e(0x115)],{'code':'-1','message':_0xeded02});});}['onLoginSuccess'](_0x1c4ab5,_0x4b0a18){const _0x3aeeef=_0x481bd5,_0x1c5b6f={'aGMry':function(_0x35ec39){return _0x35ec39();},'Autrn':function(_0x1dcc27,_0x31b134){return _0x1dcc27 instanceof _0x31b134;},'MuHbL':_0x3aeeef(0xf9),'zQwRB':_0x3aeeef(0xf2)},_0x14fef4=_0xd77904[_0x3aeeef(0x10d)](this[_0x3aeeef(0x103)]['dataPath'],_0x1c5b6f[_0x3aeeef(0xf7)]);_0x3b87e3['mkdirSync'](_0x14fef4,{'recursive':!![]}),this[_0x3aeeef(0x110)][_0x3aeeef(0x11b)](_0x1c5b6f[_0x3aeeef(0xf5)],_0x14fef4),dbUtil[_0x3aeeef(0x10e)](_0xd77904[_0x3aeeef(0x10d)](_0x14fef4,'./'+_0x1c4ab5+_0x3aeeef(0x109))),selfInfo[_0x3aeeef(0x104)]=_0x1c4ab5,selfInfo[_0x3aeeef(0xf1)]=_0x4b0a18,this['service'][_0x3aeeef(0xfd)](this[_0x3aeeef(0x116)][_0x3aeeef(0x103)][_0x3aeeef(0x101)](),this[_0x3aeeef(0x116)][_0x3aeeef(0x103)]['getGroupService'](),this[_0x3aeeef(0x116)][_0x3aeeef(0x103)][_0x3aeeef(0xfc)](),this[_0x3aeeef(0x116)]['wrapper'][_0x3aeeef(0xe5)](),this[_0x3aeeef(0x116)]['wrapper'][_0x3aeeef(0x117)]()),this['loginSuccessCbList'][_0x3aeeef(0xe7)](_0xa74ef7=>{new Promise((_0x115bfc,_0x56591c)=>{const _0x2faba1=_0x29c8,_0x9b56f2=_0x1c5b6f[_0x2faba1(0xe4)](_0xa74ef7);_0x1c5b6f[_0x2faba1(0xf4)](_0x9b56f2,Promise)&&_0x9b56f2[_0x2faba1(0x118)](_0x115bfc)[_0x2faba1(0xe9)](_0x56591c);})['then']();}),this[_0x3aeeef(0xf8)]('system.online',{'uin':_0x1c4ab5,'uid':_0x4b0a18});}[_0x481bd5(0xf0)](){}[_0x481bd5(0x108)](_0x15f1bf){const _0x4c5064=_0x481bd5;this[_0x4c5064(0x10c)][_0x4c5064(0xed)](_0x15f1bf);}}function _0x3c9c(){const _0x2849e6=['init','2ObgbjA','695445fBxGys','login','getMsgService','JhhDz','wrapper','uin','QQNT\x20版本：','split','1316pmUsaV','addLoginSuccessCallback','.db','service','249XBFZcM','loginSuccessCbList','resolve','createConnection','6ZicSVx','log','system.login.error','dataPathGlobal','XiIjX','initPostLogin','JKaNk','session','getProfileLikeService','then','登录失败','zlUzv','debug','getLogger','70zAuWJY','459981zWVSRw','aGMry','getProfileService','_GW_B','map','replace','catch','914380HeLoaB','94248QflIhA','dataPath','push','12296KVxJGd','stringify','onMessage','uid','本账号数据/缓存目录：','6|7|2|10|1|3|5|0|4|9|8','Autrn','zQwRB','curVersion','MuHbL','emit','./NapCat/data','onLoginSuccess','1781263NikCKe','getBuddyService'];_0x3c9c=function(){return _0x2849e6;};return _0x3c9c();}export const napCatCore=new NapCatCore();